{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1802",
    "id": 3175608289,
    "node_id": "PR_kwDOAP4Jqs69R-_h",
    "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1802",
    "diff_url": "https://github.com/bitcoin-core/secp256k1/pull/1802.diff",
    "patch_url": "https://github.com/bitcoin-core/secp256k1/pull/1802.patch",
    "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1802",
    "commits_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1802/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1802/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1802/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin-core/secp256k1/statuses/30d6f5e8835297499a3ba71bea9d2b589fa2e921",
    "number": 1802,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "Add DLEQ proof implementing BIP 374",
    "user": {
      "login": "macgyver13",
      "id": 4712150,
      "node_id": "MDQ6VXNlcjQ3MTIxNTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4712150?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macgyver13",
      "html_url": "https://github.com/macgyver13",
      "followers_url": "https://api.github.com/users/macgyver13/followers",
      "following_url": "https://api.github.com/users/macgyver13/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/macgyver13/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/macgyver13/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/macgyver13/subscriptions",
      "organizations_url": "https://api.github.com/users/macgyver13/orgs",
      "repos_url": "https://api.github.com/users/macgyver13/repos",
      "events_url": "https://api.github.com/users/macgyver13/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/macgyver13/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "body": "This PR adds a DLEQ (Discrete Logarithm Equality) proof module as specified in [BIP 374](https://github.com/bitcoin/bips/blob/master/bip-0374.mediawiki).\r\n\r\nBased on [PR #1651](https://github.com/bitcoin-core/secp256k1/pull/1651) by @stratospher and the [secp256k1-zkp implementation](https://github.com/BlockstreamResearch/secp256k1-zkp/blob/master/src/modules/ecdsa_adaptor/dleq_impl.h).\r\n## Public API\r\n\r\nExposes two functions for proof generation and verification:\r\n- `secp256k1_dleq_prove`\r\n- `secp256k1_dleq_verify`\r\n\r\nThese are designed to support rust FFI bindings and follow the API patterns established in similar modules.\r\n## Questions for Reviewers\r\n\r\n- Should this module be optional (current behavior) or enabled by default?\r\n- Are there additional changes needed to support existing Silent Payments PRs?\r\n- Feedback on API design, documentation, and test coverage?\r\n\r\n## Notes\r\n\r\nAddressed outstanding comments from [PR #1651](https://github.com/bitcoin-core/secp256k1/pull/1651#discussion_r2417300085):\r\n- BIP-374 v0.2.0 test vectors\r\n- Proper memory clearing with memclear",
    "labels": [],
    "created_at": "2026-01-15T01:39:55Z",
    "updated_at": "2026-01-23T09:52:01Z",
    "mergeable": true,
    "mergeable_state": "clean",
    "merged": false,
    "merge_commit_sha": "21185e85c33ac53ff3108478a3d03be4d499be0c",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "macgyver13:dleq-module-standalone",
      "ref": "dleq-module-standalone",
      "sha": "30d6f5e8835297499a3ba71bea9d2b589fa2e921",
      "user": {
        "login": "macgyver13",
        "id": 4712150,
        "node_id": "MDQ6VXNlcjQ3MTIxNTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4712150?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/macgyver13",
        "html_url": "https://github.com/macgyver13",
        "followers_url": "https://api.github.com/users/macgyver13/followers",
        "following_url": "https://api.github.com/users/macgyver13/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/macgyver13/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/macgyver13/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/macgyver13/subscriptions",
        "organizations_url": "https://api.github.com/users/macgyver13/orgs",
        "repos_url": "https://api.github.com/users/macgyver13/repos",
        "events_url": "https://api.github.com/users/macgyver13/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/macgyver13/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 1049437959,
        "node_id": "R_kgDOPo0nBw",
        "name": "secp256k1",
        "full_name": "macgyver13/secp256k1",
        "owner": {
          "login": "macgyver13",
          "id": 4712150,
          "node_id": "MDQ6VXNlcjQ3MTIxNTA=",
          "avatar_url": "https://avatars.githubusercontent.com/u/4712150?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/macgyver13",
          "html_url": "https://github.com/macgyver13",
          "followers_url": "https://api.github.com/users/macgyver13/followers",
          "following_url": "https://api.github.com/users/macgyver13/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/macgyver13/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/macgyver13/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/macgyver13/subscriptions",
          "organizations_url": "https://api.github.com/users/macgyver13/orgs",
          "repos_url": "https://api.github.com/users/macgyver13/repos",
          "events_url": "https://api.github.com/users/macgyver13/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/macgyver13/received_events",
          "type": "User",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/macgyver13/secp256k1",
        "description": "Optimized C library for EC operations on curve secp256k1",
        "fork": true,
        "url": "https://api.github.com/repos/macgyver13/secp256k1",
        "archive_url": "https://api.github.com/repos/macgyver13/secp256k1/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/macgyver13/secp256k1/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/macgyver13/secp256k1/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/macgyver13/secp256k1/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/macgyver13/secp256k1/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/macgyver13/secp256k1/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/macgyver13/secp256k1/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/macgyver13/secp256k1/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/macgyver13/secp256k1/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/macgyver13/secp256k1/contributors",
        "deployments_url": "https://api.github.com/repos/macgyver13/secp256k1/deployments",
        "downloads_url": "https://api.github.com/repos/macgyver13/secp256k1/downloads",
        "events_url": "https://api.github.com/repos/macgyver13/secp256k1/events",
        "forks_url": "https://api.github.com/repos/macgyver13/secp256k1/forks",
        "git_commits_url": "https://api.github.com/repos/macgyver13/secp256k1/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/macgyver13/secp256k1/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/macgyver13/secp256k1/git/tags%7B/sha%7D",
        "git_url": "git://github.com/macgyver13/secp256k1.git",
        "issue_comment_url": "https://api.github.com/repos/macgyver13/secp256k1/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/macgyver13/secp256k1/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/macgyver13/secp256k1/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/macgyver13/secp256k1/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/macgyver13/secp256k1/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/macgyver13/secp256k1/languages",
        "merges_url": "https://api.github.com/repos/macgyver13/secp256k1/merges",
        "milestones_url": "https://api.github.com/repos/macgyver13/secp256k1/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/macgyver13/secp256k1/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/macgyver13/secp256k1/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/macgyver13/secp256k1/releases%7B/id%7D",
        "ssh_url": "git@github.com:macgyver13/secp256k1.git",
        "stargazers_url": "https://api.github.com/repos/macgyver13/secp256k1/stargazers",
        "statuses_url": "https://api.github.com/repos/macgyver13/secp256k1/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/macgyver13/secp256k1/subscribers",
        "subscription_url": "https://api.github.com/repos/macgyver13/secp256k1/subscription",
        "tags_url": "https://api.github.com/repos/macgyver13/secp256k1/tags",
        "teams_url": "https://api.github.com/repos/macgyver13/secp256k1/teams",
        "trees_url": "https://api.github.com/repos/macgyver13/secp256k1/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/macgyver13/secp256k1.git",
        "hooks_url": "https://api.github.com/repos/macgyver13/secp256k1/hooks",
        "svn_url": "https://github.com/macgyver13/secp256k1",
        "forks_count": 0,
        "stargazers_count": 0,
        "watchers_count": 0,
        "size": 12957,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-01-20T22:45:08Z",
        "created_at": "2025-09-03T01:30:51Z",
        "updated_at": "2025-09-03T01:30:51Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin-core:master",
      "ref": "master",
      "sha": "4721e077b4ac9a9ab80db3fd9a05d6dda207f5c1",
      "user": {
        "login": "bitcoin-core",
        "id": 13464320,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEzNDY0MzIw",
        "avatar_url": "https://avatars.githubusercontent.com/u/13464320?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin-core",
        "html_url": "https://github.com/bitcoin-core",
        "followers_url": "https://api.github.com/users/bitcoin-core/followers",
        "following_url": "https://api.github.com/users/bitcoin-core/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin-core/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin-core/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin-core/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin-core/orgs",
        "repos_url": "https://api.github.com/users/bitcoin-core/repos",
        "events_url": "https://api.github.com/users/bitcoin-core/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin-core/received_events",
        "type": "Organization",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 16648618,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNjY0ODYxOA==",
        "name": "secp256k1",
        "full_name": "bitcoin-core/secp256k1",
        "owner": {
          "login": "bitcoin-core",
          "id": 13464320,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjEzNDY0MzIw",
          "avatar_url": "https://avatars.githubusercontent.com/u/13464320?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin-core",
          "html_url": "https://github.com/bitcoin-core",
          "followers_url": "https://api.github.com/users/bitcoin-core/followers",
          "following_url": "https://api.github.com/users/bitcoin-core/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin-core/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin-core/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin-core/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin-core/orgs",
          "repos_url": "https://api.github.com/users/bitcoin-core/repos",
          "events_url": "https://api.github.com/users/bitcoin-core/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin-core/received_events",
          "type": "Organization",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin-core/secp256k1",
        "description": "Optimized C library for EC operations on curve secp256k1",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1",
        "archive_url": "https://api.github.com/repos/bitcoin-core/secp256k1/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin-core/secp256k1/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin-core/secp256k1/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin-core/secp256k1/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin-core/secp256k1/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin-core/secp256k1/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin-core/secp256k1/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin-core/secp256k1/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin-core/secp256k1/downloads",
        "events_url": "https://api.github.com/repos/bitcoin-core/secp256k1/events",
        "forks_url": "https://api.github.com/repos/bitcoin-core/secp256k1/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin-core/secp256k1.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin-core/secp256k1/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin-core/secp256k1/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin-core/secp256k1/languages",
        "merges_url": "https://api.github.com/repos/bitcoin-core/secp256k1/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin-core/secp256k1/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin-core/secp256k1/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin-core/secp256k1/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin-core/secp256k1.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin-core/secp256k1/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin-core/secp256k1/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin-core/secp256k1/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin-core/secp256k1/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin-core/secp256k1/tags",
        "teams_url": "https://api.github.com/repos/bitcoin-core/secp256k1/teams",
        "trees_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin-core/secp256k1.git",
        "hooks_url": "https://api.github.com/repos/bitcoin-core/secp256k1/hooks",
        "svn_url": "https://github.com/bitcoin-core/secp256k1",
        "language": "C",
        "forks_count": 1119,
        "stargazers_count": 2392,
        "watchers_count": 2392,
        "size": 14005,
        "default_branch": "master",
        "open_issues_count": 170,
        "is_template": false,
        "topics": [],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-01-21T10:14:56Z",
        "created_at": "2014-02-08T17:30:06Z",
        "updated_at": "2026-01-23T01:39:44Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1802"
      }
    },
    "author_association": "NONE",
    "draft": false,
    "additions": 975,
    "deletions": 19,
    "changed_files": 14,
    "commits": 5,
    "review_comments": 11,
    "comments": 3
  },
  "events": [
    {
      "event": "mentioned",
      "id": 22057693886,
      "node_id": "MEE_lADOAP4Jqs7jbPX2zwAAAAUivbK-",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22057693886",
      "actor": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-15T01:39:56Z"
    },
    {
      "event": "subscribed",
      "id": 22057693917,
      "node_id": "SE_lADOAP4Jqs7jbPX2zwAAAAUivbLd",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22057693917",
      "actor": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-15T01:39:56Z"
    },
    {
      "event": "commented",
      "id": 3752677364,
      "node_id": "IC_kwDOAP4Jqs7frU_0",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3752677364",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-15T03:01:01Z",
      "updated_at": "2026-01-15T03:01:10Z",
      "author_association": "MEMBER",
      "body": "Have you talked with @stratospher before opening this PR?\r\nI donâ€™t want to draw conclusions prematurely, but opening a parallel PR that implements the same changes without first engaging on the existing one by reviewing it, leaving a comment, or waiting for the author's public response is not how we usually collaborate in open source. The lack of (co)authorship on the commits is also unusual.\r\n\r\nIf you have contacted stratospher, please ignore this comment. It's just to avoid putting the original author in an unfair or difficult position if still working on the PR.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1802#issuecomment-3752677364",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1802"
    },
    {
      "event": "mentioned",
      "id": 22058962625,
      "node_id": "MEE_lADOAP4Jqs7jbPX2zwAAAAUi0Q7B",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22058962625",
      "actor": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-15T03:01:02Z"
    },
    {
      "event": "subscribed",
      "id": 22058962650,
      "node_id": "SE_lADOAP4Jqs7jbPX2zwAAAAUi0Q7a",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22058962650",
      "actor": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-15T03:01:02Z"
    },
    {
      "event": "commented",
      "id": 3752725641,
      "node_id": "IC_kwDOAP4Jqs7frgyJ",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3752725641",
      "actor": {
        "login": "macgyver13",
        "id": 4712150,
        "node_id": "MDQ6VXNlcjQ3MTIxNTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4712150?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/macgyver13",
        "html_url": "https://github.com/macgyver13",
        "followers_url": "https://api.github.com/users/macgyver13/followers",
        "following_url": "https://api.github.com/users/macgyver13/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/macgyver13/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/macgyver13/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/macgyver13/subscriptions",
        "organizations_url": "https://api.github.com/users/macgyver13/orgs",
        "repos_url": "https://api.github.com/users/macgyver13/repos",
        "events_url": "https://api.github.com/users/macgyver13/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/macgyver13/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-15T03:22:06Z",
      "updated_at": "2026-01-15T03:22:06Z",
      "author_association": "NONE",
      "body": "> Have you talked with @stratospher before opening this PR?\n\nYes, stratospher and I had discussed who should submit this new PR. I drew the short straw :)",
      "user": {
        "login": "macgyver13",
        "id": 4712150,
        "node_id": "MDQ6VXNlcjQ3MTIxNTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4712150?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/macgyver13",
        "html_url": "https://github.com/macgyver13",
        "followers_url": "https://api.github.com/users/macgyver13/followers",
        "following_url": "https://api.github.com/users/macgyver13/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/macgyver13/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/macgyver13/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/macgyver13/subscriptions",
        "organizations_url": "https://api.github.com/users/macgyver13/orgs",
        "repos_url": "https://api.github.com/users/macgyver13/repos",
        "events_url": "https://api.github.com/users/macgyver13/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/macgyver13/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1802#issuecomment-3752725641",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1802"
    },
    {
      "event": "mentioned",
      "id": 22059360428,
      "node_id": "MEE_lADOAP4Jqs7jbPX2zwAAAAUi1yCs",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22059360428",
      "actor": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-15T03:22:08Z"
    },
    {
      "event": "subscribed",
      "id": 22059360441,
      "node_id": "SE_lADOAP4Jqs7jbPX2zwAAAAUi1yC5",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22059360441",
      "actor": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-15T03:22:08Z"
    },
    {
      "event": "convert_to_draft",
      "id": 22066702647,
      "node_id": "CTDE_lADOAP4Jqs7jbPX2zwAAAAUjRyk3",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22066702647",
      "actor": {
        "login": "macgyver13",
        "id": 4712150,
        "node_id": "MDQ6VXNlcjQ3MTIxNTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4712150?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/macgyver13",
        "html_url": "https://github.com/macgyver13",
        "followers_url": "https://api.github.com/users/macgyver13/followers",
        "following_url": "https://api.github.com/users/macgyver13/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/macgyver13/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/macgyver13/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/macgyver13/subscriptions",
        "organizations_url": "https://api.github.com/users/macgyver13/orgs",
        "repos_url": "https://api.github.com/users/macgyver13/repos",
        "events_url": "https://api.github.com/users/macgyver13/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/macgyver13/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-15T10:55:46Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDI0NTdmODlkOGFiN2U3MGNkZGI4YTU2MWZiNTJlODRlMjYxNjhlOWE",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/2457f89d8ab7e70cddb8a561fb52e84e26168e9a",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/2457f89d8ab7e70cddb8a561fb52e84e26168e9a",
      "tree": {
        "sha": "dddf1b4692cc56199f0196aa5fa7bb2e7313d6f6",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/dddf1b4692cc56199f0196aa5fa7bb2e7313d6f6"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/4721e077b4ac9a9ab80db3fd9a05d6dda207f5c1",
          "sha": "4721e077b4ac9a9ab80db3fd9a05d6dda207f5c1",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/4721e077b4ac9a9ab80db3fd9a05d6dda207f5c1"
        }
      ],
      "message": "dleq: add module structure and internal implementation\n\nImplements BIP-374 Discrete Log Equality (DLEQ) proofs as a new module.\n\n- Build system integration (CMake, autotools)\n- Configure dleq module as \"optional\"\n- Public API header declarations\n- Internal cryptographic implementation (prove_internal, verify_internal)\n- Tagged SHA256 functions per BIP-374 specification\n- Nonce generation following BIP-374 v0.2.0\n\nCo-authored-by: stratospher <44024636+stratospher@users.noreply.github.com>",
      "committer": {
        "name": "macgyver13",
        "email": "4712150+macgyver13@users.noreply.github.com",
        "date": "2026-01-15T11:03:21Z"
      },
      "author": {
        "name": "macgyver13",
        "email": "4712150+macgyver13@users.noreply.github.com",
        "date": "2026-01-12T17:13:48Z"
      },
      "sha": "2457f89d8ab7e70cddb8a561fb52e84e26168e9a"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDI2MTRiMmE1MmI0MTk5YTA0YTBkMDUxZDA2NWQ3OGNlYzM0MmIwYmE",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/2614b2a52b4199a04a0d051d065d78cec342b0ba",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/2614b2a52b4199a04a0d051d065d78cec342b0ba",
      "tree": {
        "sha": "6cd7499ec958bd966909ee1b9315e08ec9ed716b",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/6cd7499ec958bd966909ee1b9315e08ec9ed716b"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/2457f89d8ab7e70cddb8a561fb52e84e26168e9a",
          "sha": "2457f89d8ab7e70cddb8a561fb52e84e26168e9a",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/2457f89d8ab7e70cddb8a561fb52e84e26168e9a"
        }
      ],
      "message": "dleq: add test framework and BIP-374 test vectors\n\n- Adds test coverage for DLEQ internal functions\n- BIP-374 official test vectors (6 generation + 13 verification cases)\n- Includes Python script for generating test vectors matching BIP-374\nspecification.\n\nTests call *_internal functions directly. Public API tests will be added in a subsequent commit.\n\nCo-authored-by: stratospher <44024636+stratospher@users.noreply.github.com>",
      "committer": {
        "name": "macgyver13",
        "email": "4712150+macgyver13@users.noreply.github.com",
        "date": "2026-01-15T11:03:21Z"
      },
      "author": {
        "name": "macgyver13",
        "email": "4712150+macgyver13@users.noreply.github.com",
        "date": "2026-01-12T17:14:02Z"
      },
      "sha": "2614b2a52b4199a04a0d051d065d78cec342b0ba"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDA3OGQyZGEzNDAxYWIyZThkZTJmODg5ZmNkMWJhN2RhOTIzNzcwZTk",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/078d2da3401ab2e8de2f889fcd1ba7da923770e9",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/078d2da3401ab2e8de2f889fcd1ba7da923770e9",
      "tree": {
        "sha": "8a233a1e7b8228a9985421a33b8c444367545aa5",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/8a233a1e7b8228a9985421a33b8c444367545aa5"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/2614b2a52b4199a04a0d051d065d78cec342b0ba",
          "sha": "2614b2a52b4199a04a0d051d065d78cec342b0ba",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/2614b2a52b4199a04a0d051d065d78cec342b0ba"
        }
      ],
      "message": "dleq: add public API wrappers\n\nAdds public API functions that wrap the internal DLEQ implementation:\n\n- secp256k1_dleq_prove(): Generate DLEQ proof from secret key and base point B.\n  Computes A = a*G and C = a*B internally, then generates proof.\n\n- secp256k1_dleq_verify(): Verify DLEQ proof given A, B, C public keys.",
      "committer": {
        "name": "macgyver13",
        "email": "4712150+macgyver13@users.noreply.github.com",
        "date": "2026-01-15T11:03:21Z"
      },
      "author": {
        "name": "macgyver13",
        "email": "4712150+macgyver13@users.noreply.github.com",
        "date": "2026-01-12T17:16:36Z"
      },
      "sha": "078d2da3401ab2e8de2f889fcd1ba7da923770e9"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDkxNDliNTdhNDI5ZjZlM2JlNWRlODY3M2RiOTdiYmJhMzJjMjRlNzM",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/9149b57a429f6e3be5de8673db97bbba32c24e73",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/9149b57a429f6e3be5de8673db97bbba32c24e73",
      "tree": {
        "sha": "37ceba5d4e07307a0b526a1070b87cd85f3874a8",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/37ceba5d4e07307a0b526a1070b87cd85f3874a8"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/078d2da3401ab2e8de2f889fcd1ba7da923770e9",
          "sha": "078d2da3401ab2e8de2f889fcd1ba7da923770e9",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/078d2da3401ab2e8de2f889fcd1ba7da923770e9"
        }
      ],
      "message": "dleq: add public API tests\n\nAdds comprehensive tests for the public DLEQ API:\n\n- secp256k1_dleq_prove(): Tests valid proof generation, NULL parameter\n  detection, invalid secret key handling, context validation\n\n- secp256k1_dleq_verify(): Tests valid verification, NULL parameter\n  detection for all required inputs (proof, A, B, C)",
      "committer": {
        "name": "macgyver13",
        "email": "4712150+macgyver13@users.noreply.github.com",
        "date": "2026-01-15T11:03:21Z"
      },
      "author": {
        "name": "macgyver13",
        "email": "4712150+macgyver13@users.noreply.github.com",
        "date": "2026-01-12T17:17:59Z"
      },
      "sha": "9149b57a429f6e3be5de8673db97bbba32c24e73"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDMwZDZmNWU4ODM1Mjk3NDk5YTNiYTcxYmVhOWQyYjU4OWZhMmU5MjE",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/30d6f5e8835297499a3ba71bea9d2b589fa2e921",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/30d6f5e8835297499a3ba71bea9d2b589fa2e921",
      "tree": {
        "sha": "5531142c2c9a11e1662a35e616201b280926d41a",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/5531142c2c9a11e1662a35e616201b280926d41a"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/9149b57a429f6e3be5de8673db97bbba32c24e73",
          "sha": "9149b57a429f6e3be5de8673db97bbba32c24e73",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/9149b57a429f6e3be5de8673db97bbba32c24e73"
        }
      ],
      "message": "ci: enable dleq module",
      "committer": {
        "name": "macgyver13",
        "email": "4712150+macgyver13@users.noreply.github.com",
        "date": "2026-01-15T11:03:21Z"
      },
      "author": {
        "name": "macgyver13",
        "email": "4712150+macgyver13@users.noreply.github.com",
        "date": "2026-01-14T20:30:14Z"
      },
      "sha": "30d6f5e8835297499a3ba71bea9d2b589fa2e921"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22066946742,
      "node_id": "HRFPE_lADOAP4Jqs7jbPX2zwAAAAUjSuK2",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22066946742",
      "actor": {
        "login": "macgyver13",
        "id": 4712150,
        "node_id": "MDQ6VXNlcjQ3MTIxNTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4712150?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/macgyver13",
        "html_url": "https://github.com/macgyver13",
        "followers_url": "https://api.github.com/users/macgyver13/followers",
        "following_url": "https://api.github.com/users/macgyver13/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/macgyver13/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/macgyver13/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/macgyver13/subscriptions",
        "organizations_url": "https://api.github.com/users/macgyver13/orgs",
        "repos_url": "https://api.github.com/users/macgyver13/repos",
        "events_url": "https://api.github.com/users/macgyver13/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/macgyver13/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "30d6f5e8835297499a3ba71bea9d2b589fa2e921",
      "commit_url": "https://api.github.com/repos/macgyver13/secp256k1/commits/30d6f5e8835297499a3ba71bea9d2b589fa2e921",
      "created_at": "2026-01-15T11:07:50Z"
    },
    {
      "event": "ready_for_review",
      "id": 22067977983,
      "node_id": "RFRE_lADOAP4Jqs7jbPX2zwAAAAUjWp7_",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22067977983",
      "actor": {
        "login": "macgyver13",
        "id": 4712150,
        "node_id": "MDQ6VXNlcjQ3MTIxNTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4712150?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/macgyver13",
        "html_url": "https://github.com/macgyver13",
        "followers_url": "https://api.github.com/users/macgyver13/followers",
        "following_url": "https://api.github.com/users/macgyver13/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/macgyver13/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/macgyver13/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/macgyver13/subscriptions",
        "organizations_url": "https://api.github.com/users/macgyver13/orgs",
        "repos_url": "https://api.github.com/users/macgyver13/repos",
        "events_url": "https://api.github.com/users/macgyver13/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/macgyver13/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-15T12:02:21Z"
    },
    {
      "event": "reviewed",
      "id": 3669337311,
      "node_id": "PRR_kwDOAP4Jqs7ataTf",
      "url": null,
      "actor": null,
      "commit_id": "30d6f5e8835297499a3ba71bea9d2b589fa2e921",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-01-17T11:44:32Z",
      "author_association": "CONTRIBUTOR",
      "body": "sorry for [the confusion](https://github.com/bitcoin-core/secp256k1/pull/1651#issuecomment-3754603104) and thank you @macgyver13 for the PR!\r\n\r\ndid an initial pass and it looks good! mostly left style nits.\r\n\r\n1 API design question I had is whether it would be better for the proof generation API to also accept `C` as an argument - that is `GenerateProof(a, B, r, G, m, C) ` kind of API instead of [`GenerateProof(a, B, r, G, m)`](https://github.com/bitcoin/bips/blob/master/bip-0374.mediawiki#dleq-proof-generation).\r\n\r\nWhen computing silent payment output points, we anyways compute shared secret/`C` for each output - so there's a possibility to avoid recomputation again if we can pass `C`. But current approach might be safer since callers could accidentally provide incorrect C and errors could happen.\r\n\r\nDid you check other use cases of DLEQ for whether they might prefer passing C or computing C internally in the proof generation function?",
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1802#pullrequestreview-3669337311",
      "submitted_at": "2026-01-17T11:44:32Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1802"
    },
    {
      "event": "commented",
      "id": 3765129220,
      "node_id": "IC_kwDOAP4Jqs7ga1AE",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3765129220",
      "actor": {
        "login": "qatkk",
        "id": 43328710,
        "node_id": "MDQ6VXNlcjQzMzI4NzEw",
        "avatar_url": "https://avatars.githubusercontent.com/u/43328710?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/qatkk",
        "html_url": "https://github.com/qatkk",
        "followers_url": "https://api.github.com/users/qatkk/followers",
        "following_url": "https://api.github.com/users/qatkk/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/qatkk/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/qatkk/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/qatkk/subscriptions",
        "organizations_url": "https://api.github.com/users/qatkk/orgs",
        "repos_url": "https://api.github.com/users/qatkk/repos",
        "events_url": "https://api.github.com/users/qatkk/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/qatkk/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-18T10:06:53Z",
      "updated_at": "2026-01-23T09:52:01Z",
      "author_association": "NONE",
      "body": "I have a question regarding the choice of parameters passed to this API, and I may be missing some design context here â€” so Iâ€™d appreciate clarification. \r\nIs there a specific reason why the second generator `B` is provided directly as an input? @furszy \r\nIn the original proposal of DLEQ proofs by Chaum and PedersenÂ [1], the correctness of the protocol relies on the prover not knowing the discreteâ€‘log relation between the two generators. Specifically, if the prover knows a scalar `b` such that `B=bâ‹…G`, then the two equations for the verification are no longer distinct and will be dependent on each other.\r\nIn the context of silent payments (and the description provided in BIP 374) this makes sense, since `B` represents another userâ€™s public key â€” a point for which the prover does not know the corresponding private key. However, as commented by stratospher https://github.com/bitcoin-core/secp256k1/pull/1651#issuecomment-3754603104 this PR is intended to support more general DLEQ use cases, I am concerned that allowing callers to supply an arbitrary `B` might introduce risks in scenarios where generator independence is not guaranteed.\r\n\r\nOther constructions with two generators on the same curve (e.g., Pedersen commitments, bulletproofs) typically derive the second generator using a hashâ€‘toâ€‘curve procedure, ensuring that no participant knows the discreteâ€‘log ratio between `G` and `B`. I was wondering whether a similar approach might help avoid potential misuse here, or whether this falls outside the intended scope of this PR.\r\nI would be very interested to hear your thoughts on this.\r\n[1] D. Chaum and T. P. Pedersen, Wallet Databases with Observers, 1992.â€¨https://www.hsslb.ch/cryptopapers/other/Chaum_WalletDBswObservers.pdf\r\n",
      "user": {
        "login": "qatkk",
        "id": 43328710,
        "node_id": "MDQ6VXNlcjQzMzI4NzEw",
        "avatar_url": "https://avatars.githubusercontent.com/u/43328710?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/qatkk",
        "html_url": "https://github.com/qatkk",
        "followers_url": "https://api.github.com/users/qatkk/followers",
        "following_url": "https://api.github.com/users/qatkk/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/qatkk/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/qatkk/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/qatkk/subscriptions",
        "organizations_url": "https://api.github.com/users/qatkk/orgs",
        "repos_url": "https://api.github.com/users/qatkk/repos",
        "events_url": "https://api.github.com/users/qatkk/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/qatkk/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1802#issuecomment-3765129220",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1802"
    },
    {
      "event": "mentioned",
      "id": 22226025748,
      "node_id": "MEE_lADOAP4Jqs7jbPX2zwAAAAUsxj0U",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22226025748",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T20:27:03Z"
    },
    {
      "event": "subscribed",
      "id": 22226025801,
      "node_id": "SE_lADOAP4Jqs7jbPX2zwAAAAUsxj1J",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22226025801",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T20:27:03Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2697323847",
      "pull_request_review_id": 3669337311,
      "id": 2697323847,
      "node_id": "PRRC_kwDOAP4Jqs6gxeVH",
      "diff_hunk": "@@ -0,0 +1,334 @@\n+/***********************************************************************\n+ * Distributed under the MIT software license, see the accompanying    *\n+ * file COPYING or https://www.opensource.org/licenses/mit-license.php.*\n+ ***********************************************************************/\n+\n+#ifndef SECP256K1_MODULE_DLEQ_MAIN_H\n+#define SECP256K1_MODULE_DLEQ_MAIN_H\n+\n+#include \"../../../include/secp256k1.h\"\n+#include \"../../../include/secp256k1_dleq.h\"\n+\n+/* Initializes SHA256 with fixed midstate. This midstate was computed by applying\n+ * SHA256 to SHA256(\"BIP0374/aux\")||SHA256(\"BIP0374/aux\"). */\n+static void secp256k1_nonce_function_bip374_sha256_tagged_aux(secp256k1_sha256 *sha) {\n+    secp256k1_sha256_initialize(sha);\n+    sha->s[0] = 0x48479343ul;\n+    sha->s[1] = 0xa9eb648cul;\n+    sha->s[2] = 0x58952fe4ul;\n+    sha->s[3] = 0x4772d3b2ul;\n+    sha->s[4] = 0x977ab0a0ul;\n+    sha->s[5] = 0xcb8e2740ul;\n+    sha->s[6] = 0x60bb4b81ul;\n+    sha->s[7] = 0x68a41b66ul;\n+\n+    sha->bytes = 64;\n+}\n+\n+/* Initializes SHA256 with fixed midstate. This midstate was computed by applying\n+ * SHA256 to SHA256(\"BIP0374/nonce\")||SHA256(\"BIP0374/nonce\"). */\n+static void secp256k1_nonce_function_bip374_sha256_tagged(secp256k1_sha256 *sha) {\n+    secp256k1_sha256_initialize(sha);\n+    sha->s[0] = 0xa810fc87ul;\n+    sha->s[1] = 0x3b4a4d2aul;\n+    sha->s[2] = 0xe302cfb4ul;\n+    sha->s[3] = 0x322df1a0ul;\n+    sha->s[4] = 0xd2e7fb82ul;\n+    sha->s[5] = 0x7808570dul;\n+    sha->s[6] = 0x9c33e0cdul;\n+    sha->s[7] = 0x2dfbf7f6ul;\n+\n+    sha->bytes = 64;\n+}\n+\n+/* Initializes SHA256 with fixed midstate. This midstate was computed by applying\n+ * SHA256 to SHA256(\"BIP0374/challenge\")||SHA256(\"BIP0374/challenge\"). */\n+static void secp256k1_dleq_sha256_tagged(secp256k1_sha256 *sha) {\n+    secp256k1_sha256_initialize(sha);\n+    sha->s[0] = 0x24f1c9c7ul;\n+    sha->s[1] = 0xd1538c75ul;\n+    sha->s[2] = 0xc9874ae8ul;\n+    sha->s[3] = 0x6566de76ul;\n+    sha->s[4] = 0x487843c9ul;\n+    sha->s[5] = 0xc13d8026ul;\n+    sha->s[6] = 0x39a2f3eful;\n+    sha->s[7] = 0x2ad0fcb3ul;\n+\n+    sha->bytes = 64;\n+}\n+\n+static int secp256k1_dleq_hash_point(secp256k1_sha256 *sha, secp256k1_ge *p) {\n+    unsigned char buf[33];\n+    size_t size = 33;\n+    /* Reject infinity point */",
      "path": "src/modules/dleq/main_impl.h",
      "position": 63,
      "original_position": 63,
      "commit_id": "30d6f5e8835297499a3ba71bea9d2b589fa2e921",
      "original_commit_id": "30d6f5e8835297499a3ba71bea9d2b589fa2e921",
      "in_reply_to_id": null,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "2457f89d: I guess [this comment](https://github.com/bitcoin-core/secp256k1/pull/1651/commits/7fa84c35339ee715e19c80692eed21174f0e68dc#r1948023074) might be applicable now since the public API takes in `secp256k1_pubkey` and the `ge` we get is now from there - so unlikely for it to be infinity and VERIFY_CHECK might be better. though if we think about a function in isolation - it makes sense to reject infinity point.\r\n\r\ncc @theStack",
      "created_at": "2026-01-16T07:32:13Z",
      "updated_at": "2026-01-17T11:44:32Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1802#discussion_r2697323847",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2697323847"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1802"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 63,
      "original_line": 63,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2697334040",
      "pull_request_review_id": 3669337311,
      "id": 2697334040,
      "node_id": "PRRC_kwDOAP4Jqs6gxg0Y",
      "diff_hunk": "@@ -0,0 +1,334 @@\n+/***********************************************************************\n+ * Distributed under the MIT software license, see the accompanying    *\n+ * file COPYING or https://www.opensource.org/licenses/mit-license.php.*\n+ ***********************************************************************/\n+\n+#ifndef SECP256K1_MODULE_DLEQ_MAIN_H\n+#define SECP256K1_MODULE_DLEQ_MAIN_H\n+\n+#include \"../../../include/secp256k1.h\"\n+#include \"../../../include/secp256k1_dleq.h\"\n+\n+/* Initializes SHA256 with fixed midstate. This midstate was computed by applying\n+ * SHA256 to SHA256(\"BIP0374/aux\")||SHA256(\"BIP0374/aux\"). */\n+static void secp256k1_nonce_function_bip374_sha256_tagged_aux(secp256k1_sha256 *sha) {\n+    secp256k1_sha256_initialize(sha);\n+    sha->s[0] = 0x48479343ul;\n+    sha->s[1] = 0xa9eb648cul;\n+    sha->s[2] = 0x58952fe4ul;\n+    sha->s[3] = 0x4772d3b2ul;\n+    sha->s[4] = 0x977ab0a0ul;\n+    sha->s[5] = 0xcb8e2740ul;\n+    sha->s[6] = 0x60bb4b81ul;\n+    sha->s[7] = 0x68a41b66ul;\n+\n+    sha->bytes = 64;\n+}\n+\n+/* Initializes SHA256 with fixed midstate. This midstate was computed by applying\n+ * SHA256 to SHA256(\"BIP0374/nonce\")||SHA256(\"BIP0374/nonce\"). */\n+static void secp256k1_nonce_function_bip374_sha256_tagged(secp256k1_sha256 *sha) {\n+    secp256k1_sha256_initialize(sha);\n+    sha->s[0] = 0xa810fc87ul;\n+    sha->s[1] = 0x3b4a4d2aul;\n+    sha->s[2] = 0xe302cfb4ul;\n+    sha->s[3] = 0x322df1a0ul;\n+    sha->s[4] = 0xd2e7fb82ul;\n+    sha->s[5] = 0x7808570dul;\n+    sha->s[6] = 0x9c33e0cdul;\n+    sha->s[7] = 0x2dfbf7f6ul;\n+\n+    sha->bytes = 64;\n+}\n+\n+/* Initializes SHA256 with fixed midstate. This midstate was computed by applying\n+ * SHA256 to SHA256(\"BIP0374/challenge\")||SHA256(\"BIP0374/challenge\"). */\n+static void secp256k1_dleq_sha256_tagged(secp256k1_sha256 *sha) {\n+    secp256k1_sha256_initialize(sha);\n+    sha->s[0] = 0x24f1c9c7ul;\n+    sha->s[1] = 0xd1538c75ul;\n+    sha->s[2] = 0xc9874ae8ul;\n+    sha->s[3] = 0x6566de76ul;\n+    sha->s[4] = 0x487843c9ul;\n+    sha->s[5] = 0xc13d8026ul;\n+    sha->s[6] = 0x39a2f3eful;\n+    sha->s[7] = 0x2ad0fcb3ul;\n+\n+    sha->bytes = 64;\n+}\n+\n+static int secp256k1_dleq_hash_point(secp256k1_sha256 *sha, secp256k1_ge *p) {\n+    unsigned char buf[33];\n+    size_t size = 33;\n+    /* Reject infinity point */\n+    if (secp256k1_ge_is_infinity(p)) {\n+        return 0;\n+    }\n+    secp256k1_eckey_pubkey_serialize33(p, buf);\n+    secp256k1_sha256_write(sha, buf, size);\n+    return 1;\n+}\n+\n+static void secp256k1_nonce_function_dleq(unsigned char *nonce32, const unsigned char *msg, size_t msglen, const unsigned char *key32, const unsigned char *aux_rand32, const unsigned char *m) {\n+    secp256k1_sha256 sha;\n+    unsigned char masked_key[32];\n+    int i;\n+\n+    if (aux_rand32 != NULL) {\n+        secp256k1_nonce_function_bip374_sha256_tagged_aux(&sha);\n+        secp256k1_sha256_write(&sha, aux_rand32, 32);\n+        secp256k1_sha256_finalize(&sha, masked_key);\n+        for (i = 0; i < 32; i++) {\n+            masked_key[i] ^= key32[i];\n+        }\n+    } else {\n+        /* Precomputed TaggedHash(\"BIP0374/aux\", 0x0000...00); */\n+        static const unsigned char ZERO_MASK[32] = {\n+            38, 255, 199, 133, 21, 94, 75, 99,\n+            18, 166, 0, 53, 197, 146, 253, 84,\n+            197, 228, 235, 145, 124, 59, 203, 21,\n+            66, 88, 250, 253, 207, 123, 43, 55\n+        };\n+        for (i = 0; i < 32; i++) {\n+            masked_key[i] = key32[i] ^ ZERO_MASK[i];\n+        }\n+    }\n+\n+    secp256k1_nonce_function_bip374_sha256_tagged(&sha);\n+    /* Hash masked-key||msg||m using the tagged hash as per BIP-374 v0.2.0 */",
      "path": "src/modules/dleq/main_impl.h",
      "position": 98,
      "original_position": 98,
      "commit_id": "30d6f5e8835297499a3ba71bea9d2b589fa2e921",
      "original_commit_id": "30d6f5e8835297499a3ba71bea9d2b589fa2e921",
      "in_reply_to_id": null,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "2457f89d: you could clarify that msg contains A and C. and that's different from m.",
      "created_at": "2026-01-16T07:36:20Z",
      "updated_at": "2026-01-17T11:44:32Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1802#discussion_r2697334040",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2697334040"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1802"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 98,
      "original_line": 98,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2697344458",
      "pull_request_review_id": 3669337311,
      "id": 2697344458,
      "node_id": "PRRC_kwDOAP4Jqs6gxjXK",
      "diff_hunk": "@@ -0,0 +1,334 @@\n+/***********************************************************************\n+ * Distributed under the MIT software license, see the accompanying    *\n+ * file COPYING or https://www.opensource.org/licenses/mit-license.php.*\n+ ***********************************************************************/\n+\n+#ifndef SECP256K1_MODULE_DLEQ_MAIN_H\n+#define SECP256K1_MODULE_DLEQ_MAIN_H\n+\n+#include \"../../../include/secp256k1.h\"\n+#include \"../../../include/secp256k1_dleq.h\"\n+\n+/* Initializes SHA256 with fixed midstate. This midstate was computed by applying\n+ * SHA256 to SHA256(\"BIP0374/aux\")||SHA256(\"BIP0374/aux\"). */\n+static void secp256k1_nonce_function_bip374_sha256_tagged_aux(secp256k1_sha256 *sha) {\n+    secp256k1_sha256_initialize(sha);\n+    sha->s[0] = 0x48479343ul;\n+    sha->s[1] = 0xa9eb648cul;\n+    sha->s[2] = 0x58952fe4ul;\n+    sha->s[3] = 0x4772d3b2ul;\n+    sha->s[4] = 0x977ab0a0ul;\n+    sha->s[5] = 0xcb8e2740ul;\n+    sha->s[6] = 0x60bb4b81ul;\n+    sha->s[7] = 0x68a41b66ul;\n+\n+    sha->bytes = 64;\n+}\n+\n+/* Initializes SHA256 with fixed midstate. This midstate was computed by applying\n+ * SHA256 to SHA256(\"BIP0374/nonce\")||SHA256(\"BIP0374/nonce\"). */\n+static void secp256k1_nonce_function_bip374_sha256_tagged(secp256k1_sha256 *sha) {\n+    secp256k1_sha256_initialize(sha);\n+    sha->s[0] = 0xa810fc87ul;\n+    sha->s[1] = 0x3b4a4d2aul;\n+    sha->s[2] = 0xe302cfb4ul;\n+    sha->s[3] = 0x322df1a0ul;\n+    sha->s[4] = 0xd2e7fb82ul;\n+    sha->s[5] = 0x7808570dul;\n+    sha->s[6] = 0x9c33e0cdul;\n+    sha->s[7] = 0x2dfbf7f6ul;\n+\n+    sha->bytes = 64;\n+}\n+\n+/* Initializes SHA256 with fixed midstate. This midstate was computed by applying\n+ * SHA256 to SHA256(\"BIP0374/challenge\")||SHA256(\"BIP0374/challenge\"). */\n+static void secp256k1_dleq_sha256_tagged(secp256k1_sha256 *sha) {\n+    secp256k1_sha256_initialize(sha);\n+    sha->s[0] = 0x24f1c9c7ul;\n+    sha->s[1] = 0xd1538c75ul;\n+    sha->s[2] = 0xc9874ae8ul;\n+    sha->s[3] = 0x6566de76ul;\n+    sha->s[4] = 0x487843c9ul;\n+    sha->s[5] = 0xc13d8026ul;\n+    sha->s[6] = 0x39a2f3eful;\n+    sha->s[7] = 0x2ad0fcb3ul;\n+\n+    sha->bytes = 64;\n+}\n+\n+static int secp256k1_dleq_hash_point(secp256k1_sha256 *sha, secp256k1_ge *p) {\n+    unsigned char buf[33];\n+    size_t size = 33;\n+    /* Reject infinity point */\n+    if (secp256k1_ge_is_infinity(p)) {\n+        return 0;\n+    }\n+    secp256k1_eckey_pubkey_serialize33(p, buf);\n+    secp256k1_sha256_write(sha, buf, size);\n+    return 1;\n+}\n+\n+static void secp256k1_nonce_function_dleq(unsigned char *nonce32, const unsigned char *msg, size_t msglen, const unsigned char *key32, const unsigned char *aux_rand32, const unsigned char *m) {\n+    secp256k1_sha256 sha;\n+    unsigned char masked_key[32];\n+    int i;\n+\n+    if (aux_rand32 != NULL) {\n+        secp256k1_nonce_function_bip374_sha256_tagged_aux(&sha);\n+        secp256k1_sha256_write(&sha, aux_rand32, 32);\n+        secp256k1_sha256_finalize(&sha, masked_key);\n+        for (i = 0; i < 32; i++) {\n+            masked_key[i] ^= key32[i];\n+        }\n+    } else {\n+        /* Precomputed TaggedHash(\"BIP0374/aux\", 0x0000...00); */\n+        static const unsigned char ZERO_MASK[32] = {\n+            38, 255, 199, 133, 21, 94, 75, 99,\n+            18, 166, 0, 53, 197, 146, 253, 84,\n+            197, 228, 235, 145, 124, 59, 203, 21,\n+            66, 88, 250, 253, 207, 123, 43, 55\n+        };\n+        for (i = 0; i < 32; i++) {\n+            masked_key[i] = key32[i] ^ ZERO_MASK[i];\n+        }\n+    }\n+\n+    secp256k1_nonce_function_bip374_sha256_tagged(&sha);\n+    /* Hash masked-key||msg||m using the tagged hash as per BIP-374 v0.2.0 */\n+    secp256k1_sha256_write(&sha, masked_key, 32);\n+    secp256k1_sha256_write(&sha, msg, msglen);\n+    if (m != NULL) {\n+        secp256k1_sha256_write(&sha, m, 32);\n+    }\n+    secp256k1_sha256_finalize(&sha, nonce32);\n+    secp256k1_sha256_clear(&sha);\n+    secp256k1_memclear_explicit(masked_key, sizeof(masked_key));\n+}\n+\n+/* Generates a nonce as defined in BIP0374 v0.2.0 */",
      "path": "src/modules/dleq/main_impl.h",
      "position": 109,
      "original_position": 109,
      "commit_id": "30d6f5e8835297499a3ba71bea9d2b589fa2e921",
      "original_commit_id": "30d6f5e8835297499a3ba71bea9d2b589fa2e921",
      "in_reply_to_id": null,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "2457f89d:  not sure if we should mention the exact version - we don't mention the version for other modules like musig for example. only difference in newer version is the randomness computation in proof generation anyways. ",
      "created_at": "2026-01-16T07:40:43Z",
      "updated_at": "2026-01-17T11:44:32Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1802#discussion_r2697344458",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2697344458"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1802"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 109,
      "original_line": 109,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2697366015",
      "pull_request_review_id": 3669337311,
      "id": 2697366015,
      "node_id": "PRRC_kwDOAP4Jqs6gxon_",
      "diff_hunk": "@@ -0,0 +1,334 @@\n+/***********************************************************************\n+ * Distributed under the MIT software license, see the accompanying    *\n+ * file COPYING or https://www.opensource.org/licenses/mit-license.php.*\n+ ***********************************************************************/\n+\n+#ifndef SECP256K1_MODULE_DLEQ_MAIN_H\n+#define SECP256K1_MODULE_DLEQ_MAIN_H\n+\n+#include \"../../../include/secp256k1.h\"\n+#include \"../../../include/secp256k1_dleq.h\"\n+\n+/* Initializes SHA256 with fixed midstate. This midstate was computed by applying\n+ * SHA256 to SHA256(\"BIP0374/aux\")||SHA256(\"BIP0374/aux\"). */\n+static void secp256k1_nonce_function_bip374_sha256_tagged_aux(secp256k1_sha256 *sha) {\n+    secp256k1_sha256_initialize(sha);\n+    sha->s[0] = 0x48479343ul;\n+    sha->s[1] = 0xa9eb648cul;\n+    sha->s[2] = 0x58952fe4ul;\n+    sha->s[3] = 0x4772d3b2ul;\n+    sha->s[4] = 0x977ab0a0ul;\n+    sha->s[5] = 0xcb8e2740ul;\n+    sha->s[6] = 0x60bb4b81ul;\n+    sha->s[7] = 0x68a41b66ul;\n+\n+    sha->bytes = 64;\n+}\n+\n+/* Initializes SHA256 with fixed midstate. This midstate was computed by applying\n+ * SHA256 to SHA256(\"BIP0374/nonce\")||SHA256(\"BIP0374/nonce\"). */\n+static void secp256k1_nonce_function_bip374_sha256_tagged(secp256k1_sha256 *sha) {\n+    secp256k1_sha256_initialize(sha);\n+    sha->s[0] = 0xa810fc87ul;\n+    sha->s[1] = 0x3b4a4d2aul;\n+    sha->s[2] = 0xe302cfb4ul;\n+    sha->s[3] = 0x322df1a0ul;\n+    sha->s[4] = 0xd2e7fb82ul;\n+    sha->s[5] = 0x7808570dul;\n+    sha->s[6] = 0x9c33e0cdul;\n+    sha->s[7] = 0x2dfbf7f6ul;\n+\n+    sha->bytes = 64;\n+}\n+\n+/* Initializes SHA256 with fixed midstate. This midstate was computed by applying\n+ * SHA256 to SHA256(\"BIP0374/challenge\")||SHA256(\"BIP0374/challenge\"). */\n+static void secp256k1_dleq_sha256_tagged(secp256k1_sha256 *sha) {\n+    secp256k1_sha256_initialize(sha);\n+    sha->s[0] = 0x24f1c9c7ul;\n+    sha->s[1] = 0xd1538c75ul;\n+    sha->s[2] = 0xc9874ae8ul;\n+    sha->s[3] = 0x6566de76ul;\n+    sha->s[4] = 0x487843c9ul;\n+    sha->s[5] = 0xc13d8026ul;\n+    sha->s[6] = 0x39a2f3eful;\n+    sha->s[7] = 0x2ad0fcb3ul;\n+\n+    sha->bytes = 64;\n+}\n+\n+static int secp256k1_dleq_hash_point(secp256k1_sha256 *sha, secp256k1_ge *p) {\n+    unsigned char buf[33];\n+    size_t size = 33;\n+    /* Reject infinity point */\n+    if (secp256k1_ge_is_infinity(p)) {\n+        return 0;\n+    }\n+    secp256k1_eckey_pubkey_serialize33(p, buf);\n+    secp256k1_sha256_write(sha, buf, size);\n+    return 1;\n+}\n+\n+static void secp256k1_nonce_function_dleq(unsigned char *nonce32, const unsigned char *msg, size_t msglen, const unsigned char *key32, const unsigned char *aux_rand32, const unsigned char *m) {\n+    secp256k1_sha256 sha;\n+    unsigned char masked_key[32];\n+    int i;\n+\n+    if (aux_rand32 != NULL) {\n+        secp256k1_nonce_function_bip374_sha256_tagged_aux(&sha);\n+        secp256k1_sha256_write(&sha, aux_rand32, 32);\n+        secp256k1_sha256_finalize(&sha, masked_key);\n+        for (i = 0; i < 32; i++) {\n+            masked_key[i] ^= key32[i];\n+        }\n+    } else {\n+        /* Precomputed TaggedHash(\"BIP0374/aux\", 0x0000...00); */\n+        static const unsigned char ZERO_MASK[32] = {\n+            38, 255, 199, 133, 21, 94, 75, 99,\n+            18, 166, 0, 53, 197, 146, 253, 84,\n+            197, 228, 235, 145, 124, 59, 203, 21,\n+            66, 88, 250, 253, 207, 123, 43, 55\n+        };\n+        for (i = 0; i < 32; i++) {\n+            masked_key[i] = key32[i] ^ ZERO_MASK[i];\n+        }\n+    }\n+\n+    secp256k1_nonce_function_bip374_sha256_tagged(&sha);\n+    /* Hash masked-key||msg||m using the tagged hash as per BIP-374 v0.2.0 */\n+    secp256k1_sha256_write(&sha, masked_key, 32);\n+    secp256k1_sha256_write(&sha, msg, msglen);\n+    if (m != NULL) {\n+        secp256k1_sha256_write(&sha, m, 32);\n+    }\n+    secp256k1_sha256_finalize(&sha, nonce32);\n+    secp256k1_sha256_clear(&sha);\n+    secp256k1_memclear_explicit(masked_key, sizeof(masked_key));\n+}\n+\n+/* Generates a nonce as defined in BIP0374 v0.2.0 */\n+static int secp256k1_dleq_nonce(secp256k1_scalar *k, const unsigned char *a32, const unsigned char *A_33, const unsigned char *C_33, const unsigned char *aux_rand32, const unsigned char *m) {\n+    unsigned char buf[66];\n+    unsigned char nonce[32];\n+\n+    memcpy(buf, A_33, 33);\n+    memcpy(buf + 33, C_33, 33);\n+    secp256k1_nonce_function_dleq(nonce, buf, 66, a32, aux_rand32, m);\n+\n+    secp256k1_scalar_set_b32(k, nonce, NULL);\n+    if (secp256k1_scalar_is_zero(k)) {\n+        return 0;\n+    }\n+\n+    return 1;\n+}\n+\n+/* Generates a challenge as defined in BIP0374 */\n+static void secp256k1_dleq_challenge(secp256k1_scalar *e, secp256k1_ge *B, secp256k1_ge *R1, secp256k1_ge *R2, secp256k1_ge *A, secp256k1_ge *C, const unsigned char *m) {\n+    unsigned char buf[32];\n+    secp256k1_sha256 sha;\n+    secp256k1_ge generator_point = secp256k1_ge_const_g;\n+\n+    secp256k1_dleq_sha256_tagged(&sha);\n+    secp256k1_dleq_hash_point(&sha, A);\n+    secp256k1_dleq_hash_point(&sha, B);\n+    secp256k1_dleq_hash_point(&sha, C);\n+    secp256k1_dleq_hash_point(&sha, &generator_point);\n+    secp256k1_dleq_hash_point(&sha, R1);\n+    secp256k1_dleq_hash_point(&sha, R2);\n+    if (m) secp256k1_sha256_write(&sha, m, 32);\n+    secp256k1_sha256_finalize(&sha, buf);\n+\n+    secp256k1_scalar_set_b32(e, buf, NULL);\n+}\n+\n+/* Generate points from scalar a such that A = a*G and C = a*B */\n+static void secp256k1_dleq_pair(const secp256k1_ecmult_gen_context *ecmult_gen_ctx, secp256k1_ge *A, secp256k1_ge *C, const secp256k1_scalar *a, const secp256k1_ge *B) {\n+    secp256k1_gej Aj, Cj;\n+\n+    secp256k1_ecmult_gen(ecmult_gen_ctx, &Aj, a);\n+    secp256k1_ge_set_gej(A, &Aj);\n+    secp256k1_ecmult_const(&Cj, B, a);\n+    secp256k1_ge_set_gej(C, &Cj);\n+}\n+\n+/* DLEQ Proof Generation (internal)\n+ *\n+ * For given elliptic curve points A, B, C, and G, the prover generates a proof to prove knowledge of a scalar a such\n+ * that A = aâ‹…G and C = aâ‹…B without revealing anything about a.\n+ *\n+ *  Returns: 1 if proof creation was successful. 0 if an error occurred.\n+ *  Out:       scalar e: part of proof = bytes(32, e) || bytes(32, s).\n+ *             scalar s: other part of proof = bytes(32, e) || bytes(32, s).\n+ *  In:     a : scalar a to be proven that both A and C were generated from\n+ *          B : point on the curve\n+ *          A : point on the curve(aâ‹…G) generated from a\n+ *          C : point on the curve(aâ‹…B) generated from a\n+ * aux_rand32 : pointer to 32-byte auxiliary randomness used to generate the nonce in secp256k1_nonce_function_dleq.\n+ *          m : an optional message\n+ * */\n+static int secp256k1_dleq_prove_internal(const secp256k1_context *ctx, secp256k1_scalar *s, secp256k1_scalar *e, const secp256k1_scalar *a, secp256k1_ge *B, secp256k1_ge *A, secp256k1_ge *C, const unsigned char *aux_rand32, const unsigned char *m) {\n+    secp256k1_ge R1, R2;\n+    secp256k1_scalar k = { 0 };\n+    unsigned char a32[32];\n+    unsigned char A_33[33];\n+    unsigned char B_33[33];\n+    unsigned char C_33[33];\n+    int ret = 1;\n+\n+    secp256k1_scalar_get_b32(a32, a);\n+    /* Reject infinity points */\n+    if (secp256k1_ge_is_infinity(B) || secp256k1_ge_is_infinity(A) || secp256k1_ge_is_infinity(C)) {\n+        return 0;\n+    }\n+    secp256k1_eckey_pubkey_serialize33(B, B_33);\n+    secp256k1_eckey_pubkey_serialize33(A, A_33);\n+    secp256k1_eckey_pubkey_serialize33(C, C_33);\n+    ret &= secp256k1_dleq_nonce(&k, a32, A_33, C_33, aux_rand32, m);\n+\n+    /* R1 = k*G, R2 = k*B */\n+    secp256k1_dleq_pair(&ctx->ecmult_gen_ctx, &R1, &R2, &k, B);\n+    /* We declassify the non-secret values R1 and R2 to allow using them as\n+     * branch points. */\n+    secp256k1_declassify(ctx, &R1, sizeof(R1));\n+    secp256k1_declassify(ctx, &R2, sizeof(R2));\n+\n+    /* e = tagged hash(A, B, C, R1, R2) */\n+    /* s = k + e * a */\n+    secp256k1_dleq_challenge(e, B, &R1, &R2, A, C, m);\n+    secp256k1_scalar_mul(s, e, a);\n+    secp256k1_scalar_add(s, s, &k);\n+\n+    secp256k1_scalar_clear(&k);\n+    secp256k1_memclear_explicit(a32, sizeof(a32));\n+    return ret;\n+}\n+\n+/* DLEQ Proof Verification (internal)\n+ *\n+ * Verifies the proof. If the following algorithm succeeds, the points A and C were both generated from the same scalar.\n+ * The former from multiplying by G, and the latter from multiplying by B.\n+ *\n+ *  Returns: 1 if proof verification was successful. 0 if an error occurred.\n+ *  In: proof : proof bytes(32, e) || bytes(32, s) consists of scalar e and scalar s\n+ *          A : point on the curve(aâ‹…G) computed from a\n+ *          B : point on the curve\n+ *          C : point on the curve(aâ‹…B) computed from a\n+ *          m : optional message\n+ * */\n+static int secp256k1_dleq_verify_internal(secp256k1_scalar *s, secp256k1_scalar *e, secp256k1_ge *A, secp256k1_ge *B, secp256k1_ge *C, const unsigned char *m) {\n+    secp256k1_scalar e_neg;\n+    secp256k1_scalar e_expected;\n+    secp256k1_gej Bj;\n+    secp256k1_gej Aj, Cj;\n+    secp256k1_gej R1j, R2j;\n+    secp256k1_ge R1, R2;\n+    secp256k1_gej tmpj;\n+\n+    secp256k1_gej_set_ge(&Aj, A);\n+    secp256k1_gej_set_ge(&Cj, C);\n+\n+    secp256k1_scalar_negate(&e_neg, e);\n+    /* R1 = s*G  - e*A */\n+    secp256k1_ecmult(&R1j, &Aj, &e_neg, s);\n+    /* R2 = s*B - e*C */\n+    secp256k1_ecmult(&tmpj, &Cj, &e_neg, &secp256k1_scalar_zero);\n+    secp256k1_gej_set_ge(&Bj, B);\n+    secp256k1_ecmult(&R2j, &Bj, s, &secp256k1_scalar_zero);\n+    secp256k1_gej_add_var(&R2j, &R2j, &tmpj, NULL);\n+\n+    secp256k1_ge_set_gej(&R1, &R1j);\n+    secp256k1_ge_set_gej(&R2, &R2j);\n+    secp256k1_dleq_challenge(&e_expected, B, &R1, &R2, A, C, m);\n+\n+    secp256k1_scalar_add(&e_expected, &e_expected, &e_neg);\n+    return secp256k1_scalar_is_zero(&e_expected);\n+}\n+\n+int secp256k1_dleq_prove(\n+    const secp256k1_context *ctx,\n+    unsigned char *proof64,\n+    const unsigned char *seckey32,\n+    const secp256k1_pubkey *pubkey_B,\n+    const unsigned char *aux_rand32,\n+    const unsigned char *msg\n+) {\n+    secp256k1_scalar a, s, e;\n+    secp256k1_ge A, B, C;\n+    int overflow;\n+    int ret;\n+\n+    VERIFY_CHECK(ctx != NULL);\n+    ARG_CHECK(secp256k1_ecmult_gen_context_is_built(&ctx->ecmult_gen_ctx));\n+    ARG_CHECK(proof64 != NULL);\n+    ARG_CHECK(seckey32 != NULL);\n+    ARG_CHECK(pubkey_B != NULL);\n+\n+    secp256k1_scalar_set_b32(&a, seckey32, &overflow);\n+    if (overflow || secp256k1_scalar_is_zero(&a)) {\n+        return 0;\n+    }\n+\n+    if (!secp256k1_pubkey_load(ctx, &B, pubkey_B)) {\n+        secp256k1_scalar_clear(&a);\n+        return 0;\n+    }\n+\n+    secp256k1_dleq_pair(&ctx->ecmult_gen_ctx, &A, &C, &a, &B);\n+\n+    ret = secp256k1_dleq_prove_internal(ctx, &s, &e, &a, &B, &A, &C, aux_rand32, msg);\n+    if (!ret) {\n+        secp256k1_scalar_clear(&a);",
      "path": "src/modules/dleq/main_impl.h",
      "position": 281,
      "original_position": 281,
      "commit_id": "30d6f5e8835297499a3ba71bea9d2b589fa2e921",
      "original_commit_id": "30d6f5e8835297499a3ba71bea9d2b589fa2e921",
      "in_reply_to_id": null,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "078d2da: since we always clear `a` - we can move it up and out of the if condition.",
      "created_at": "2026-01-16T07:49:17Z",
      "updated_at": "2026-01-17T11:44:32Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1802#discussion_r2697366015",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2697366015"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1802"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 281,
      "original_line": 281,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2697398276",
      "pull_request_review_id": 3669337311,
      "id": 2697398276,
      "node_id": "PRRC_kwDOAP4Jqs6gxwgE",
      "diff_hunk": "@@ -0,0 +1,248 @@\n+/***********************************************************************\n+ * Distributed under the MIT software license, see the accompanying    *\n+ * file COPYING or https://www.opensource.org/licenses/mit-license.php.*\n+ ***********************************************************************/\n+\n+#ifndef SECP256K1_MODULE_DLEQ_TESTS_H\n+#define SECP256K1_MODULE_DLEQ_TESTS_H\n+\n+#include \"dleq_vectors.h\"\n+\n+static void dleq_nonce_bitflip(unsigned char **args, size_t n_flip, size_t n_bytes) {\n+    secp256k1_scalar k1, k2;\n+    CHECK(secp256k1_dleq_nonce(&k1, args[0], args[1], args[2], args[3], args[4]) == 1);\n+    testrand_flip(args[n_flip], n_bytes);\n+    CHECK(secp256k1_dleq_nonce(&k2, args[0], args[1], args[2], args[3], args[4]) == 1);\n+    CHECK(secp256k1_scalar_eq(&k1, &k2) == 0);\n+}\n+\n+static void run_test_dleq_prove_verify(void) {\n+    secp256k1_scalar s, e, a, k;\n+    secp256k1_ge A, B, C;\n+    unsigned char *args[5];\n+    unsigned char a32[32];\n+    unsigned char A_33[33];\n+    unsigned char C_33[33];\n+    unsigned char aux_rand[32];\n+    unsigned char msg[32];\n+    unsigned char proof_64[64] = {0};\n+    int i;\n+    int overflow;\n+    secp256k1_sha256 sha;\n+    secp256k1_sha256 sha_optimized;\n+    unsigned char aux_tag[] = {'B', 'I', 'P', '0', '3', '7', '4', '/', 'a', 'u', 'x'};\n+    unsigned char tag[] = {'B', 'I', 'P', '0', '3', '7', '4', '/', 'n', 'o', 'n', 'c', 'e'};\n+    unsigned char challenge_tag[] = {'B', 'I', 'P', '0', '3', '7', '4', '/', 'c', 'h', 'a', 'l', 'l', 'e', 'n', 'g', 'e'};\n+\n+    /* Check that hash initialized by secp256k1_nonce_function_bip374_sha256_tagged_aux has the expected state. */\n+    secp256k1_sha256_initialize_tagged(&sha, aux_tag, sizeof(aux_tag));\n+    secp256k1_nonce_function_bip374_sha256_tagged_aux(&sha_optimized);\n+    test_sha256_eq(&sha, &sha_optimized);\n+\n+    /* Check that hash initialized by secp256k1_nonce_function_bip374_sha256_tagged has the expected state. */\n+    secp256k1_sha256_initialize_tagged(&sha, tag, sizeof(tag));\n+    secp256k1_nonce_function_bip374_sha256_tagged(&sha_optimized);\n+    test_sha256_eq(&sha, &sha_optimized);\n+\n+    /* Check that hash initialized by secp256k1_dleq_sha256_tagged has the expected state. */\n+    secp256k1_sha256_initialize_tagged(&sha, challenge_tag, sizeof(challenge_tag));\n+    secp256k1_dleq_sha256_tagged(&sha_optimized);\n+    test_sha256_eq(&sha, &sha_optimized);\n+\n+    for (i = 0; i < COUNT; i++) {\n+        testutil_random_ge_test(&B);\n+        testutil_random_scalar_order(&a);\n+        testrand256(aux_rand);\n+        testrand_bytes_test(msg, sizeof(msg));\n+        secp256k1_dleq_pair(&CTX->ecmult_gen_ctx, &A, &C, &a, &B);\n+        CHECK(secp256k1_dleq_prove_internal(CTX, &s, &e, &a, &B, &A, &C, aux_rand, (i & 1) ? msg : NULL) == 1);\n+        CHECK(secp256k1_dleq_verify_internal(&s, &e, &A, &B, &C, (i & 1) ? msg : NULL) == 1);\n+        secp256k1_scalar_set_b32(&s, proof_64, &overflow);\n+        VERIFY_CHECK(overflow == 0);\n+        secp256k1_scalar_set_b32(&e, proof_64 + 32, &overflow);\n+        VERIFY_CHECK(overflow == 0);\n+    }\n+\n+    {\n+        secp256k1_scalar tmp;\n+        secp256k1_scalar_set_int(&tmp, 1);\n+        CHECK(secp256k1_dleq_verify_internal(&tmp, &e, &A, &B, &C, msg) == 0);\n+        CHECK(secp256k1_dleq_verify_internal(&s, &tmp, &A, &B, &C, msg) == 0);\n+    }\n+    {\n+        secp256k1_ge p_tmp;\n+        testutil_random_ge_test(&p_tmp);\n+        CHECK(secp256k1_dleq_verify_internal(&s, &e, &p_tmp, &B, &C, msg) == 0);\n+        CHECK(secp256k1_dleq_verify_internal(&s, &e, &A, &p_tmp, &C, msg) == 0);\n+        CHECK(secp256k1_dleq_verify_internal(&s, &e, &A, &B, &p_tmp, msg) == 0);\n+    }\n+    {\n+        secp256k1_ge p_inf;\n+        secp256k1_ge_set_infinity(&p_inf);\n+        CHECK(secp256k1_dleq_prove_internal(CTX, &s, &e, &a, &p_inf, &A, &C, aux_rand, msg) == 0);\n+        CHECK(secp256k1_dleq_prove_internal(CTX, &s, &e, &a, &B, &p_inf, &C, aux_rand, msg) == 0);\n+        CHECK(secp256k1_dleq_prove_internal(CTX, &s, &e, &a, &B, &A, &p_inf, aux_rand, msg) == 0);\n+    }\n+\n+    /* Nonce tests */\n+    secp256k1_scalar_get_b32(a32, &a);\n+    secp256k1_eckey_pubkey_serialize33(&A, A_33);\n+    secp256k1_eckey_pubkey_serialize33(&C, C_33);\n+    CHECK(secp256k1_dleq_nonce(&k, a32, A_33, C_33, aux_rand, msg) == 1);\n+\n+    testrand_bytes_test(a32, sizeof(a32));\n+    testrand_bytes_test(A_33, sizeof(A_33));\n+    testrand_bytes_test(C_33, sizeof(C_33));\n+    testrand_bytes_test(aux_rand, sizeof(aux_rand));\n+\n+    /* Check that a bitflip in an argument results in different nonces. */\n+    args[0] = a32;\n+    args[1] = A_33;\n+    args[2] = C_33;\n+    args[3] = aux_rand;\n+    args[4] = msg;\n+    for (i = 0; i < COUNT; i++) {\n+        dleq_nonce_bitflip(args, 0, sizeof(a32));\n+        dleq_nonce_bitflip(args, 1, sizeof(A_33));\n+        /* Flip C */\n+        dleq_nonce_bitflip(args, 2, sizeof(C_33));\n+        /* Flip C again */\n+        dleq_nonce_bitflip(args, 2, sizeof(C_33));\n+        dleq_nonce_bitflip(args, 3, sizeof(aux_rand));\n+        dleq_nonce_bitflip(args, 4, sizeof(msg));\n+    }\n+\n+    /* NULL aux_rand and msg arguments are allowed.*/\n+    CHECK(secp256k1_dleq_nonce(&k, a32, A_33, C_33, NULL, NULL) == 1);\n+    CHECK(secp256k1_dleq_nonce(&k, a32, A_33, C_33, aux_rand, NULL) == 1);\n+    CHECK(secp256k1_dleq_nonce(&k, a32, A_33, C_33, NULL, msg) == 1);\n+}\n+\n+/* Test BIP-374 test vectors (\"Discrete Log Equality Proofs\").\n+ * See tools/test_vectors_dleq_generate.py\n+ * */\n+\n+static unsigned char zero_array[32] = {0x00};\n+\n+/* Helper function to check if given array is NOT equivalent to all zero array.\n+ * Used to detect test vectors where zero array can represent:\n+ *     B_bytes at infinity\n+ *     Empty optional msg_bytes\n+ * */\n+static int is_not_empty(const unsigned char *arr){\n+    return (memcmp(arr, zero_array, 32) != 0);\n+}\n+\n+static void run_test_dleq_bip374_vectors(void) {\n+    secp256k1_scalar a, s, e;\n+    secp256k1_ge A;\n+    secp256k1_ge B;\n+    secp256k1_ge C;\n+    int i;\n+\n+    /* bip-0374/test_vectors_generate_proof.csv */\n+    for (i = 0; i < 6; ++i) {\n+        int ret = 1;\n+        const unsigned char *m = NULL;\n+        secp256k1_ge_set_infinity(&B);\n+        /* expect the last 3 generate proof vectors to fail */\n+        if (i > 2) ret = 0;\n+\n+        secp256k1_scalar_set_b32(&a, a_bytes[i], NULL);\n+        if (is_not_empty(B_bytes[i])) {\n+            CHECK(secp256k1_eckey_pubkey_parse(&B, B_bytes[i], 33) == 1);\n+        }\n+\n+        secp256k1_dleq_pair(&CTX->ecmult_gen_ctx, &A, &C, &a, &B);\n+\n+        if (is_not_empty(msg_bytes[i])) {\n+            m = msg_bytes[i];\n+        }\n+        CHECK(secp256k1_dleq_prove_internal(CTX, &s, &e, &a, &B, &A, &C, (unsigned char*)(auxrand_bytes[i]), m) == ret);\n+\n+        if (ret) {\n+            unsigned char proof[64];\n+            secp256k1_scalar_get_b32(proof, &e);\n+            secp256k1_scalar_get_b32(proof + 32, &s);\n+            CHECK(memcmp(proof, proof_bytes[i], 64) == 0);\n+            CHECK(secp256k1_dleq_verify_internal(&s, &e, &A, &B, &C, m) == 1);\n+        }\n+    }\n+\n+    /* bip-0374/test_vectors_verify_proof.csv */\n+    for (i = 0; i < 13; ++i) {\n+        const unsigned char *m = NULL;\n+\n+        if (i > 2 && i < 6) {\n+            /* Skip tests indices 3-5: proof generation failure cases (a=0, a=N, B=infinity).\n+            * These contain placeholder data from test_vectors_generate_proof.csv that would\n+            * fail to parse. Only indices 0-2 and 6-12 have valid test data. ",
      "path": "src/modules/dleq/tests_impl.h",
      "position": 179,
      "original_position": 179,
      "commit_id": "30d6f5e8835297499a3ba71bea9d2b589fa2e921",
      "original_commit_id": "30d6f5e8835297499a3ba71bea9d2b589fa2e921",
      "in_reply_to_id": null,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit: 2614b2a5: extra white space",
      "created_at": "2026-01-16T08:00:31Z",
      "updated_at": "2026-01-17T11:44:32Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1802#discussion_r2697398276",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2697398276"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1802"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 179,
      "original_line": 179,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2697400316",
      "pull_request_review_id": 3669337311,
      "id": 2697400316,
      "node_id": "PRRC_kwDOAP4Jqs6gxw_8",
      "diff_hunk": "@@ -0,0 +1,248 @@\n+/***********************************************************************\n+ * Distributed under the MIT software license, see the accompanying    *\n+ * file COPYING or https://www.opensource.org/licenses/mit-license.php.*\n+ ***********************************************************************/\n+\n+#ifndef SECP256K1_MODULE_DLEQ_TESTS_H\n+#define SECP256K1_MODULE_DLEQ_TESTS_H\n+\n+#include \"dleq_vectors.h\"\n+\n+static void dleq_nonce_bitflip(unsigned char **args, size_t n_flip, size_t n_bytes) {\n+    secp256k1_scalar k1, k2;\n+    CHECK(secp256k1_dleq_nonce(&k1, args[0], args[1], args[2], args[3], args[4]) == 1);\n+    testrand_flip(args[n_flip], n_bytes);\n+    CHECK(secp256k1_dleq_nonce(&k2, args[0], args[1], args[2], args[3], args[4]) == 1);\n+    CHECK(secp256k1_scalar_eq(&k1, &k2) == 0);\n+}\n+\n+static void run_test_dleq_prove_verify(void) {\n+    secp256k1_scalar s, e, a, k;\n+    secp256k1_ge A, B, C;\n+    unsigned char *args[5];\n+    unsigned char a32[32];\n+    unsigned char A_33[33];\n+    unsigned char C_33[33];\n+    unsigned char aux_rand[32];\n+    unsigned char msg[32];\n+    unsigned char proof_64[64] = {0};\n+    int i;\n+    int overflow;\n+    secp256k1_sha256 sha;\n+    secp256k1_sha256 sha_optimized;\n+    unsigned char aux_tag[] = {'B', 'I', 'P', '0', '3', '7', '4', '/', 'a', 'u', 'x'};\n+    unsigned char tag[] = {'B', 'I', 'P', '0', '3', '7', '4', '/', 'n', 'o', 'n', 'c', 'e'};\n+    unsigned char challenge_tag[] = {'B', 'I', 'P', '0', '3', '7', '4', '/', 'c', 'h', 'a', 'l', 'l', 'e', 'n', 'g', 'e'};\n+\n+    /* Check that hash initialized by secp256k1_nonce_function_bip374_sha256_tagged_aux has the expected state. */\n+    secp256k1_sha256_initialize_tagged(&sha, aux_tag, sizeof(aux_tag));\n+    secp256k1_nonce_function_bip374_sha256_tagged_aux(&sha_optimized);\n+    test_sha256_eq(&sha, &sha_optimized);\n+\n+    /* Check that hash initialized by secp256k1_nonce_function_bip374_sha256_tagged has the expected state. */\n+    secp256k1_sha256_initialize_tagged(&sha, tag, sizeof(tag));\n+    secp256k1_nonce_function_bip374_sha256_tagged(&sha_optimized);\n+    test_sha256_eq(&sha, &sha_optimized);\n+\n+    /* Check that hash initialized by secp256k1_dleq_sha256_tagged has the expected state. */\n+    secp256k1_sha256_initialize_tagged(&sha, challenge_tag, sizeof(challenge_tag));\n+    secp256k1_dleq_sha256_tagged(&sha_optimized);\n+    test_sha256_eq(&sha, &sha_optimized);\n+\n+    for (i = 0; i < COUNT; i++) {\n+        testutil_random_ge_test(&B);\n+        testutil_random_scalar_order(&a);\n+        testrand256(aux_rand);\n+        testrand_bytes_test(msg, sizeof(msg));\n+        secp256k1_dleq_pair(&CTX->ecmult_gen_ctx, &A, &C, &a, &B);\n+        CHECK(secp256k1_dleq_prove_internal(CTX, &s, &e, &a, &B, &A, &C, aux_rand, (i & 1) ? msg : NULL) == 1);\n+        CHECK(secp256k1_dleq_verify_internal(&s, &e, &A, &B, &C, (i & 1) ? msg : NULL) == 1);\n+        secp256k1_scalar_set_b32(&s, proof_64, &overflow);\n+        VERIFY_CHECK(overflow == 0);\n+        secp256k1_scalar_set_b32(&e, proof_64 + 32, &overflow);\n+        VERIFY_CHECK(overflow == 0);\n+    }\n+\n+    {\n+        secp256k1_scalar tmp;\n+        secp256k1_scalar_set_int(&tmp, 1);\n+        CHECK(secp256k1_dleq_verify_internal(&tmp, &e, &A, &B, &C, msg) == 0);\n+        CHECK(secp256k1_dleq_verify_internal(&s, &tmp, &A, &B, &C, msg) == 0);\n+    }\n+    {\n+        secp256k1_ge p_tmp;\n+        testutil_random_ge_test(&p_tmp);\n+        CHECK(secp256k1_dleq_verify_internal(&s, &e, &p_tmp, &B, &C, msg) == 0);\n+        CHECK(secp256k1_dleq_verify_internal(&s, &e, &A, &p_tmp, &C, msg) == 0);\n+        CHECK(secp256k1_dleq_verify_internal(&s, &e, &A, &B, &p_tmp, msg) == 0);\n+    }\n+    {\n+        secp256k1_ge p_inf;\n+        secp256k1_ge_set_infinity(&p_inf);\n+        CHECK(secp256k1_dleq_prove_internal(CTX, &s, &e, &a, &p_inf, &A, &C, aux_rand, msg) == 0);\n+        CHECK(secp256k1_dleq_prove_internal(CTX, &s, &e, &a, &B, &p_inf, &C, aux_rand, msg) == 0);\n+        CHECK(secp256k1_dleq_prove_internal(CTX, &s, &e, &a, &B, &A, &p_inf, aux_rand, msg) == 0);\n+    }\n+\n+    /* Nonce tests */\n+    secp256k1_scalar_get_b32(a32, &a);\n+    secp256k1_eckey_pubkey_serialize33(&A, A_33);\n+    secp256k1_eckey_pubkey_serialize33(&C, C_33);\n+    CHECK(secp256k1_dleq_nonce(&k, a32, A_33, C_33, aux_rand, msg) == 1);\n+\n+    testrand_bytes_test(a32, sizeof(a32));\n+    testrand_bytes_test(A_33, sizeof(A_33));\n+    testrand_bytes_test(C_33, sizeof(C_33));\n+    testrand_bytes_test(aux_rand, sizeof(aux_rand));\n+\n+    /* Check that a bitflip in an argument results in different nonces. */\n+    args[0] = a32;\n+    args[1] = A_33;\n+    args[2] = C_33;\n+    args[3] = aux_rand;\n+    args[4] = msg;\n+    for (i = 0; i < COUNT; i++) {\n+        dleq_nonce_bitflip(args, 0, sizeof(a32));\n+        dleq_nonce_bitflip(args, 1, sizeof(A_33));\n+        /* Flip C */\n+        dleq_nonce_bitflip(args, 2, sizeof(C_33));\n+        /* Flip C again */\n+        dleq_nonce_bitflip(args, 2, sizeof(C_33));\n+        dleq_nonce_bitflip(args, 3, sizeof(aux_rand));\n+        dleq_nonce_bitflip(args, 4, sizeof(msg));\n+    }\n+\n+    /* NULL aux_rand and msg arguments are allowed.*/\n+    CHECK(secp256k1_dleq_nonce(&k, a32, A_33, C_33, NULL, NULL) == 1);\n+    CHECK(secp256k1_dleq_nonce(&k, a32, A_33, C_33, aux_rand, NULL) == 1);\n+    CHECK(secp256k1_dleq_nonce(&k, a32, A_33, C_33, NULL, msg) == 1);\n+}\n+\n+/* Test BIP-374 test vectors (\"Discrete Log Equality Proofs\").\n+ * See tools/test_vectors_dleq_generate.py\n+ * */\n+\n+static unsigned char zero_array[32] = {0x00};\n+\n+/* Helper function to check if given array is NOT equivalent to all zero array.\n+ * Used to detect test vectors where zero array can represent:\n+ *     B_bytes at infinity\n+ *     Empty optional msg_bytes\n+ * */\n+static int is_not_empty(const unsigned char *arr){\n+    return (memcmp(arr, zero_array, 32) != 0);\n+}\n+\n+static void run_test_dleq_bip374_vectors(void) {\n+    secp256k1_scalar a, s, e;\n+    secp256k1_ge A;\n+    secp256k1_ge B;\n+    secp256k1_ge C;\n+    int i;\n+\n+    /* bip-0374/test_vectors_generate_proof.csv */\n+    for (i = 0; i < 6; ++i) {\n+        int ret = 1;\n+        const unsigned char *m = NULL;\n+        secp256k1_ge_set_infinity(&B);\n+        /* expect the last 3 generate proof vectors to fail */\n+        if (i > 2) ret = 0;\n+\n+        secp256k1_scalar_set_b32(&a, a_bytes[i], NULL);\n+        if (is_not_empty(B_bytes[i])) {\n+            CHECK(secp256k1_eckey_pubkey_parse(&B, B_bytes[i], 33) == 1);\n+        }\n+\n+        secp256k1_dleq_pair(&CTX->ecmult_gen_ctx, &A, &C, &a, &B);\n+\n+        if (is_not_empty(msg_bytes[i])) {\n+            m = msg_bytes[i];\n+        }\n+        CHECK(secp256k1_dleq_prove_internal(CTX, &s, &e, &a, &B, &A, &C, (unsigned char*)(auxrand_bytes[i]), m) == ret);\n+\n+        if (ret) {\n+            unsigned char proof[64];\n+            secp256k1_scalar_get_b32(proof, &e);\n+            secp256k1_scalar_get_b32(proof + 32, &s);\n+            CHECK(memcmp(proof, proof_bytes[i], 64) == 0);\n+            CHECK(secp256k1_dleq_verify_internal(&s, &e, &A, &B, &C, m) == 1);\n+        }\n+    }\n+\n+    /* bip-0374/test_vectors_verify_proof.csv */\n+    for (i = 0; i < 13; ++i) {\n+        const unsigned char *m = NULL;\n+\n+        if (i > 2 && i < 6) {\n+            /* Skip tests indices 3-5: proof generation failure cases (a=0, a=N, B=infinity).\n+            * These contain placeholder data from test_vectors_generate_proof.csv that would\n+            * fail to parse. Only indices 0-2 and 6-12 have valid test data. \n+            * */\n+            continue;\n+        }\n+\n+        CHECK(secp256k1_eckey_pubkey_parse(&A, A_bytes[i], 33) == 1);\n+        CHECK(secp256k1_eckey_pubkey_parse(&B, B_bytes[i], 33) == 1);\n+        CHECK(secp256k1_eckey_pubkey_parse(&C, C_bytes[i], 33) == 1);\n+\n+        secp256k1_scalar_set_b32(&e, proof_bytes[i], NULL);\n+        secp256k1_scalar_set_b32(&s, proof_bytes[i] + 32, NULL);\n+\n+        if (is_not_empty(msg_bytes[i])) {\n+            m = msg_bytes[i];\n+        }\n+        \n+        CHECK(secp256k1_dleq_verify_internal(&s, &e, &A, &B, &C, m) == success[i]);",
      "path": "src/modules/dleq/tests_impl.h",
      "position": 195,
      "original_position": 195,
      "commit_id": "30d6f5e8835297499a3ba71bea9d2b589fa2e921",
      "original_commit_id": "30d6f5e8835297499a3ba71bea9d2b589fa2e921",
      "in_reply_to_id": null,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit: 2614b2a5: extra white space in blank line above",
      "created_at": "2026-01-16T08:01:23Z",
      "updated_at": "2026-01-17T11:44:32Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1802#discussion_r2697400316",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2697400316"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1802"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 195,
      "original_line": 195,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2697402263",
      "pull_request_review_id": 3669337311,
      "id": 2697402263,
      "node_id": "PRRC_kwDOAP4Jqs6gxxeX",
      "diff_hunk": "@@ -0,0 +1,248 @@\n+/***********************************************************************\n+ * Distributed under the MIT software license, see the accompanying    *\n+ * file COPYING or https://www.opensource.org/licenses/mit-license.php.*\n+ ***********************************************************************/\n+\n+#ifndef SECP256K1_MODULE_DLEQ_TESTS_H\n+#define SECP256K1_MODULE_DLEQ_TESTS_H\n+\n+#include \"dleq_vectors.h\"\n+\n+static void dleq_nonce_bitflip(unsigned char **args, size_t n_flip, size_t n_bytes) {\n+    secp256k1_scalar k1, k2;\n+    CHECK(secp256k1_dleq_nonce(&k1, args[0], args[1], args[2], args[3], args[4]) == 1);\n+    testrand_flip(args[n_flip], n_bytes);\n+    CHECK(secp256k1_dleq_nonce(&k2, args[0], args[1], args[2], args[3], args[4]) == 1);\n+    CHECK(secp256k1_scalar_eq(&k1, &k2) == 0);\n+}\n+\n+static void run_test_dleq_prove_verify(void) {\n+    secp256k1_scalar s, e, a, k;\n+    secp256k1_ge A, B, C;\n+    unsigned char *args[5];\n+    unsigned char a32[32];\n+    unsigned char A_33[33];\n+    unsigned char C_33[33];\n+    unsigned char aux_rand[32];\n+    unsigned char msg[32];\n+    unsigned char proof_64[64] = {0};\n+    int i;\n+    int overflow;\n+    secp256k1_sha256 sha;\n+    secp256k1_sha256 sha_optimized;\n+    unsigned char aux_tag[] = {'B', 'I', 'P', '0', '3', '7', '4', '/', 'a', 'u', 'x'};\n+    unsigned char tag[] = {'B', 'I', 'P', '0', '3', '7', '4', '/', 'n', 'o', 'n', 'c', 'e'};\n+    unsigned char challenge_tag[] = {'B', 'I', 'P', '0', '3', '7', '4', '/', 'c', 'h', 'a', 'l', 'l', 'e', 'n', 'g', 'e'};\n+\n+    /* Check that hash initialized by secp256k1_nonce_function_bip374_sha256_tagged_aux has the expected state. */\n+    secp256k1_sha256_initialize_tagged(&sha, aux_tag, sizeof(aux_tag));\n+    secp256k1_nonce_function_bip374_sha256_tagged_aux(&sha_optimized);\n+    test_sha256_eq(&sha, &sha_optimized);\n+\n+    /* Check that hash initialized by secp256k1_nonce_function_bip374_sha256_tagged has the expected state. */\n+    secp256k1_sha256_initialize_tagged(&sha, tag, sizeof(tag));\n+    secp256k1_nonce_function_bip374_sha256_tagged(&sha_optimized);\n+    test_sha256_eq(&sha, &sha_optimized);\n+\n+    /* Check that hash initialized by secp256k1_dleq_sha256_tagged has the expected state. */\n+    secp256k1_sha256_initialize_tagged(&sha, challenge_tag, sizeof(challenge_tag));\n+    secp256k1_dleq_sha256_tagged(&sha_optimized);\n+    test_sha256_eq(&sha, &sha_optimized);\n+\n+    for (i = 0; i < COUNT; i++) {\n+        testutil_random_ge_test(&B);\n+        testutil_random_scalar_order(&a);\n+        testrand256(aux_rand);\n+        testrand_bytes_test(msg, sizeof(msg));\n+        secp256k1_dleq_pair(&CTX->ecmult_gen_ctx, &A, &C, &a, &B);\n+        CHECK(secp256k1_dleq_prove_internal(CTX, &s, &e, &a, &B, &A, &C, aux_rand, (i & 1) ? msg : NULL) == 1);\n+        CHECK(secp256k1_dleq_verify_internal(&s, &e, &A, &B, &C, (i & 1) ? msg : NULL) == 1);\n+        secp256k1_scalar_set_b32(&s, proof_64, &overflow);\n+        VERIFY_CHECK(overflow == 0);\n+        secp256k1_scalar_set_b32(&e, proof_64 + 32, &overflow);\n+        VERIFY_CHECK(overflow == 0);\n+    }\n+\n+    {\n+        secp256k1_scalar tmp;\n+        secp256k1_scalar_set_int(&tmp, 1);\n+        CHECK(secp256k1_dleq_verify_internal(&tmp, &e, &A, &B, &C, msg) == 0);\n+        CHECK(secp256k1_dleq_verify_internal(&s, &tmp, &A, &B, &C, msg) == 0);\n+    }\n+    {\n+        secp256k1_ge p_tmp;\n+        testutil_random_ge_test(&p_tmp);\n+        CHECK(secp256k1_dleq_verify_internal(&s, &e, &p_tmp, &B, &C, msg) == 0);\n+        CHECK(secp256k1_dleq_verify_internal(&s, &e, &A, &p_tmp, &C, msg) == 0);\n+        CHECK(secp256k1_dleq_verify_internal(&s, &e, &A, &B, &p_tmp, msg) == 0);\n+    }\n+    {\n+        secp256k1_ge p_inf;\n+        secp256k1_ge_set_infinity(&p_inf);\n+        CHECK(secp256k1_dleq_prove_internal(CTX, &s, &e, &a, &p_inf, &A, &C, aux_rand, msg) == 0);\n+        CHECK(secp256k1_dleq_prove_internal(CTX, &s, &e, &a, &B, &p_inf, &C, aux_rand, msg) == 0);\n+        CHECK(secp256k1_dleq_prove_internal(CTX, &s, &e, &a, &B, &A, &p_inf, aux_rand, msg) == 0);\n+    }\n+\n+    /* Nonce tests */\n+    secp256k1_scalar_get_b32(a32, &a);\n+    secp256k1_eckey_pubkey_serialize33(&A, A_33);\n+    secp256k1_eckey_pubkey_serialize33(&C, C_33);\n+    CHECK(secp256k1_dleq_nonce(&k, a32, A_33, C_33, aux_rand, msg) == 1);\n+\n+    testrand_bytes_test(a32, sizeof(a32));\n+    testrand_bytes_test(A_33, sizeof(A_33));\n+    testrand_bytes_test(C_33, sizeof(C_33));\n+    testrand_bytes_test(aux_rand, sizeof(aux_rand));\n+\n+    /* Check that a bitflip in an argument results in different nonces. */\n+    args[0] = a32;\n+    args[1] = A_33;\n+    args[2] = C_33;\n+    args[3] = aux_rand;\n+    args[4] = msg;\n+    for (i = 0; i < COUNT; i++) {\n+        dleq_nonce_bitflip(args, 0, sizeof(a32));\n+        dleq_nonce_bitflip(args, 1, sizeof(A_33));\n+        /* Flip C */\n+        dleq_nonce_bitflip(args, 2, sizeof(C_33));\n+        /* Flip C again */\n+        dleq_nonce_bitflip(args, 2, sizeof(C_33));\n+        dleq_nonce_bitflip(args, 3, sizeof(aux_rand));\n+        dleq_nonce_bitflip(args, 4, sizeof(msg));\n+    }\n+\n+    /* NULL aux_rand and msg arguments are allowed.*/\n+    CHECK(secp256k1_dleq_nonce(&k, a32, A_33, C_33, NULL, NULL) == 1);\n+    CHECK(secp256k1_dleq_nonce(&k, a32, A_33, C_33, aux_rand, NULL) == 1);\n+    CHECK(secp256k1_dleq_nonce(&k, a32, A_33, C_33, NULL, msg) == 1);\n+}\n+\n+/* Test BIP-374 test vectors (\"Discrete Log Equality Proofs\").\n+ * See tools/test_vectors_dleq_generate.py\n+ * */\n+\n+static unsigned char zero_array[32] = {0x00};\n+\n+/* Helper function to check if given array is NOT equivalent to all zero array.\n+ * Used to detect test vectors where zero array can represent:\n+ *     B_bytes at infinity\n+ *     Empty optional msg_bytes\n+ * */\n+static int is_not_empty(const unsigned char *arr){\n+    return (memcmp(arr, zero_array, 32) != 0);\n+}\n+\n+static void run_test_dleq_bip374_vectors(void) {\n+    secp256k1_scalar a, s, e;\n+    secp256k1_ge A;\n+    secp256k1_ge B;\n+    secp256k1_ge C;\n+    int i;\n+\n+    /* bip-0374/test_vectors_generate_proof.csv */\n+    for (i = 0; i < 6; ++i) {\n+        int ret = 1;\n+        const unsigned char *m = NULL;\n+        secp256k1_ge_set_infinity(&B);\n+        /* expect the last 3 generate proof vectors to fail */\n+        if (i > 2) ret = 0;\n+\n+        secp256k1_scalar_set_b32(&a, a_bytes[i], NULL);\n+        if (is_not_empty(B_bytes[i])) {\n+            CHECK(secp256k1_eckey_pubkey_parse(&B, B_bytes[i], 33) == 1);\n+        }\n+\n+        secp256k1_dleq_pair(&CTX->ecmult_gen_ctx, &A, &C, &a, &B);\n+\n+        if (is_not_empty(msg_bytes[i])) {\n+            m = msg_bytes[i];\n+        }\n+        CHECK(secp256k1_dleq_prove_internal(CTX, &s, &e, &a, &B, &A, &C, (unsigned char*)(auxrand_bytes[i]), m) == ret);\n+\n+        if (ret) {\n+            unsigned char proof[64];\n+            secp256k1_scalar_get_b32(proof, &e);\n+            secp256k1_scalar_get_b32(proof + 32, &s);\n+            CHECK(memcmp(proof, proof_bytes[i], 64) == 0);\n+            CHECK(secp256k1_dleq_verify_internal(&s, &e, &A, &B, &C, m) == 1);\n+        }\n+    }\n+\n+    /* bip-0374/test_vectors_verify_proof.csv */\n+    for (i = 0; i < 13; ++i) {\n+        const unsigned char *m = NULL;\n+\n+        if (i > 2 && i < 6) {\n+            /* Skip tests indices 3-5: proof generation failure cases (a=0, a=N, B=infinity).\n+            * These contain placeholder data from test_vectors_generate_proof.csv that would\n+            * fail to parse. Only indices 0-2 and 6-12 have valid test data. \n+            * */\n+            continue;\n+        }\n+\n+        CHECK(secp256k1_eckey_pubkey_parse(&A, A_bytes[i], 33) == 1);\n+        CHECK(secp256k1_eckey_pubkey_parse(&B, B_bytes[i], 33) == 1);\n+        CHECK(secp256k1_eckey_pubkey_parse(&C, C_bytes[i], 33) == 1);\n+\n+        secp256k1_scalar_set_b32(&e, proof_bytes[i], NULL);\n+        secp256k1_scalar_set_b32(&s, proof_bytes[i] + 32, NULL);\n+\n+        if (is_not_empty(msg_bytes[i])) {\n+            m = msg_bytes[i];\n+        }\n+        \n+        CHECK(secp256k1_dleq_verify_internal(&s, &e, &A, &B, &C, m) == success[i]);\n+    }\n+}\n+\n+static void run_test_dleq_api(void) {\n+    secp256k1_pubkey B, A, C;\n+    unsigned char seckey[32];\n+    unsigned char proof[64];\n+    unsigned char aux_rand[32];\n+    unsigned char msg[32];\n+    secp256k1_scalar a;\n+    secp256k1_ge A_ge, B_ge, C_ge;\n+\n+    /* Generate prove material */\n+    testrand256(seckey);\n+    testrand256(aux_rand);\n+    testrand256(msg);\n+    testutil_random_ge_test(&B_ge);\n+    secp256k1_pubkey_save(&B, &B_ge);\n+\n+    /* Check dleq prove input validation */\n+    CHECK_ILLEGAL(STATIC_CTX, secp256k1_dleq_prove(STATIC_CTX, proof, seckey, &B, aux_rand, msg));\n+    CHECK_ILLEGAL(CTX, secp256k1_dleq_prove(CTX, NULL, seckey, &B, aux_rand, msg));\n+    CHECK_ILLEGAL(CTX, secp256k1_dleq_prove(CTX, proof, NULL, &B, aux_rand, msg));\n+    CHECK_ILLEGAL(CTX, secp256k1_dleq_prove(CTX, proof, seckey, NULL, aux_rand, msg));\n+    CHECK(secp256k1_dleq_prove(CTX, proof, seckey, &B, NULL, msg) == 1);\n+    CHECK(secp256k1_dleq_prove(CTX, proof, seckey, &B, aux_rand, NULL) == 1);\n+\n+    /* Generate verify material */\n+    secp256k1_scalar_set_b32(&a, seckey, NULL);\n+    secp256k1_dleq_pair(&CTX->ecmult_gen_ctx, &A_ge, &C_ge, &a, &B_ge);\n+    secp256k1_pubkey_save(&A, &A_ge);\n+    secp256k1_pubkey_save(&C, &C_ge);\n+\n+    /* Check dleq verify input validation */\n+    CHECK_ILLEGAL(CTX, secp256k1_dleq_verify(CTX, NULL, &A, &B, &C, msg));\n+    CHECK_ILLEGAL(CTX, secp256k1_dleq_verify(CTX, proof, NULL, &B, &C, msg));\n+    CHECK_ILLEGAL(CTX, secp256k1_dleq_verify(CTX, proof, &A, NULL, &C, msg));\n+    CHECK_ILLEGAL(CTX, secp256k1_dleq_verify(CTX, proof, &A, &B, NULL, msg));\n+    ",
      "path": "src/modules/dleq/tests_impl.h",
      "position": 234,
      "original_position": 234,
      "commit_id": "30d6f5e8835297499a3ba71bea9d2b589fa2e921",
      "original_commit_id": "30d6f5e8835297499a3ba71bea9d2b589fa2e921",
      "in_reply_to_id": null,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit: 9149b57a: extra white space in blank line",
      "created_at": "2026-01-16T08:02:17Z",
      "updated_at": "2026-01-17T11:44:32Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1802#discussion_r2697402263",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2697402263"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1802"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 234,
      "original_line": 234,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2697408756",
      "pull_request_review_id": 3669337311,
      "id": 2697408756,
      "node_id": "PRRC_kwDOAP4Jqs6gxzD0",
      "diff_hunk": "@@ -0,0 +1,3 @@\n+include_HEADERS += include/secp256k1_dleq.h\n+noinst_HEADERS += src/modules/dleq/dleq_vectors.h",
      "path": "src/modules/dleq/Makefile.am.include",
      "position": 2,
      "original_position": 2,
      "commit_id": "30d6f5e8835297499a3ba71bea9d2b589fa2e921",
      "original_commit_id": "30d6f5e8835297499a3ba71bea9d2b589fa2e921",
      "in_reply_to_id": null,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "2614b2a5: tests also need to be added. nit: slight ordering preference for main_impl before test vectors - you can refer some other makefile.",
      "created_at": "2026-01-16T08:05:11Z",
      "updated_at": "2026-01-17T11:44:32Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1802#discussion_r2697408756",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2697408756"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1802"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 2,
      "original_line": 2,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2697413839",
      "pull_request_review_id": 3669337311,
      "id": 2697413839,
      "node_id": "PRRC_kwDOAP4Jqs6gx0TP",
      "diff_hunk": "@@ -0,0 +1,146 @@\n+#!/usr/bin/env python3\n+\n+import sys\n+import csv\n+import textwrap\n+\n+if len(sys.argv) < 2:\n+    print(\n+        \"This script converts BIP 374 DLEQ test vectors in a given directory to a C file that can be used in the test framework.\"\n+    )\n+    print(\"Usage: %s <dir>\" % sys.argv[0])\n+    sys.exit(1)\n+\n+s = (\n+     \"\"\"/**\n+     * Automatically generated by %s.\n+     *\n+     * Test vectors according to BIP-374 (\"Discrete Log Equality Proofs\") are included in this file.\n+     * Tests are included in src/modules/dleq/tests_impl.h. */\n+    \"\"\" % sys.argv[0]\n+)\n+\n+def hexstr_to_intarray(str):\n+    try:\n+        return \", \".join([f\"0x{b:02X}\" for b in bytes.fromhex(str)])\n+    except ValueError:\n+        return \"0x00\"\n+\n+def create_init(name, rows, cols):\n+    return \"\"\"\n+static const unsigned char %s[%d][%d] = {\n+\"\"\" % (\n+        name,\n+        rows,\n+        cols,\n+    )\n+\n+def init_array(key):\n+    return textwrap.indent(\"{ %s };\" % \", \".join(test_case[key]), \"\")\n+\n+def init_arrays(key):\n+    s = textwrap.indent(\n+        \",\\n\".join([\"{ %s }\" % hexstr_to_intarray(x) for x in test_case[key]]), 4 * \" \"\n+    )\n+    s += textwrap.indent(\",\\n};\\n\", \"\")\n+    return s\n+\n+\n+# Define lists to store each column from the test_vectors_(generate|verify)_proof.csv files\n+test_case = {\n+    \"index\": [],\n+    \"point_G\": [],\n+    \"scalar_a\": [],\n+    \"point_A\": [],\n+    \"point_B\": [],\n+    \"point_C\": [],\n+    \"auxrand_r\": [],\n+    \"message\": [],\n+    \"comment\": [],\n+    \"result_proof\": [],\n+    \"result_success\": [],\n+}\n+\n+\n+with open(sys.argv[1] + \"/test_vectors_generate_proof.csv\", newline='') as csvfile:\n+    reader = csv.DictReader(csvfile)\n+    # Skip the first 5 rows since those test vectors don't use secp's generator point\n+    for _ in range(5):\n+        next(reader, None)\n+\n+    for row in reader:\n+        for key in test_case:\n+            if key in row:\n+                # these keys are present in test_vectors_generate_proof.csv\n+                # if special cases are encountered, \"0\" is filled in place of the value (INFINITY/INVALID/\"\")\n+                special_cases = {\n+                    \"point_B\": \"INFINITY\",\n+                    \"result_proof\": \"INVALID\",\n+                    \"message\": \"\"\n+                }\n+                test_case[key].append(\"0\" if row[key] in special_cases.get(key, []) else row[key])\n+            else:\n+                # these keys are not present in current csv file but are present in test_vectors_verify_proof.csv\n+                if key in {\"point_A\", \"point_C\"}:\n+                    # \"0\" is filled as value for these missing keys\n+                    test_case[key].append(\"0\")\n+                elif key == \"result_success\":\n+                    # success/failure value is obtained from row[\"comment\"] for the missing key \"result_success\"\n+                    test_case[key].append(\"1\" if \"Success\" in row.get(\"comment\", \"\") else \"0\")\n+                else:\n+                    sys.exit(\"Unexpected missing_key encountered when parsing test_vectors_generate_proof.csv\")\n+\n+\n+with open(sys.argv[1] + \"/test_vectors_verify_proof.csv\", newline='') as csvfile:\n+    reader = csv.DictReader(csvfile)\n+    for _ in range(5):  # Skip the first 5 rows since those test vectors don't use secp's generator point\n+        next(reader, None)\n+\n+    for i in range(3):  ",
      "path": "tools/test_vectors_dleq_generate.py",
      "position": 99,
      "original_position": 99,
      "commit_id": "30d6f5e8835297499a3ba71bea9d2b589fa2e921",
      "original_commit_id": "30d6f5e8835297499a3ba71bea9d2b589fa2e921",
      "in_reply_to_id": null,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit: 2614b2a5: extra white space",
      "created_at": "2026-01-16T08:07:13Z",
      "updated_at": "2026-01-17T11:44:32Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1802#discussion_r2697413839",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2697413839"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1802"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 99,
      "original_line": 99,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2698333940",
      "pull_request_review_id": 3669337311,
      "id": 2698333940,
      "node_id": "PRRC_kwDOAP4Jqs6g1U70",
      "diff_hunk": "@@ -0,0 +1,248 @@\n+/***********************************************************************\n+ * Distributed under the MIT software license, see the accompanying    *\n+ * file COPYING or https://www.opensource.org/licenses/mit-license.php.*\n+ ***********************************************************************/\n+\n+#ifndef SECP256K1_MODULE_DLEQ_MAIN_H\n+#define SECP256K1_MODULE_DLEQ_MAIN_H\n+\n+#include \"../../../include/secp256k1.h\"\n+#include \"../../../include/secp256k1_dleq.h\"\n+",
      "path": "src/modules/dleq/main_impl.h",
      "position": 11,
      "original_position": 11,
      "commit_id": "30d6f5e8835297499a3ba71bea9d2b589fa2e921",
      "original_commit_id": "2457f89d8ab7e70cddb8a561fb52e84e26168e9a",
      "in_reply_to_id": null,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "2457f89d: `#include \"../../hash.h\"`",
      "created_at": "2026-01-16T12:27:35Z",
      "updated_at": "2026-01-17T11:44:32Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1802#discussion_r2698333940",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2698333940"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1802"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 11,
      "original_line": 11,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2698398009",
      "pull_request_review_id": 3669337311,
      "id": 2698398009,
      "node_id": "PRRC_kwDOAP4Jqs6g1kk5",
      "diff_hunk": "@@ -0,0 +1,204 @@\n+/***********************************************************************\n+ * Distributed under the MIT software license, see the accompanying    *\n+ * file COPYING or https://www.opensource.org/licenses/mit-license.php.*\n+ ***********************************************************************/\n+\n+#ifndef SECP256K1_MODULE_DLEQ_TESTS_H\n+#define SECP256K1_MODULE_DLEQ_TESTS_H\n+\n+#include \"dleq_vectors.h\"",
      "path": "src/modules/dleq/tests_impl.h",
      "position": 9,
      "original_position": 9,
      "commit_id": "30d6f5e8835297499a3ba71bea9d2b589fa2e921",
      "original_commit_id": "2614b2a52b4199a04a0d051d065d78cec342b0ba",
      "in_reply_to_id": null,
      "user": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "2614b2a5: `#include \"../../unit_test.h\"`",
      "created_at": "2026-01-16T12:49:15Z",
      "updated_at": "2026-01-17T11:44:32Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1802#discussion_r2698398009",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2698398009"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1802"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 9,
      "original_line": 9,
      "side": "RIGHT"
    }
  ]
}