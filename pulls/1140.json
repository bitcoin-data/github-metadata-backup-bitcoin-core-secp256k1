{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1140",
    "id": 1052620740,
    "node_id": "PR_kwDOAP4Jqs4-vbfE",
    "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1140",
    "diff_url": "https://github.com/bitcoin-core/secp256k1/pull/1140.diff",
    "patch_url": "https://github.com/bitcoin-core/secp256k1/pull/1140.patch",
    "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1140",
    "commits_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1140/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1140/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1140/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin-core/secp256k1/statuses/e6978c4150b06954a02e21efbdbeed796dc739b6",
    "number": 1140,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "Schnorr sign-to-contract and anti-exfil ",
    "user": {
      "login": "benma",
      "id": 1225267,
      "node_id": "MDQ6VXNlcjEyMjUyNjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1225267?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/benma",
      "html_url": "https://github.com/benma",
      "followers_url": "https://api.github.com/users/benma/followers",
      "following_url": "https://api.github.com/users/benma/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/benma/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/benma/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/benma/subscriptions",
      "organizations_url": "https://api.github.com/users/benma/orgs",
      "repos_url": "https://api.github.com/users/benma/repos",
      "events_url": "https://api.github.com/users/benma/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/benma/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This adds sign-to-contract and anti-exfil protocol functionality to the schnorrsig module. It is based on the same functions that already exist for ECDSA here:\r\n\r\nhttps://github.com/ElementsProject/secp256k1-zkp/blob/d22774e248c703a191049b78f8d04f37d6fcfa05/include/secp256k1_ecdsa_s2c.h\r\n\r\nSome commits and functions were adapted from the original work here: https://github.com/bitcoin-core/secp256k1/pull/589/\r\n\r\n",
    "labels": [
      {
        "id": 4975353639,
        "node_id": "LA_kwDOAP4Jqs8AAAABKI3fJw",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/labels/feature",
        "name": "feature",
        "description": "",
        "color": "731E95",
        "default": false
      }
    ],
    "created_at": "2022-09-11T23:12:48Z",
    "updated_at": "2023-07-29T22:34:36Z",
    "mergeable": true,
    "mergeable_state": "unstable",
    "merge_commit_sha": "a4568160ad1c769e4041bfc758d88527e4b59956",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "benma:schnorr-s2c",
      "ref": "schnorr-s2c",
      "sha": "e6978c4150b06954a02e21efbdbeed796dc739b6",
      "user": {
        "login": "benma",
        "id": 1225267,
        "node_id": "MDQ6VXNlcjEyMjUyNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1225267?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benma",
        "html_url": "https://github.com/benma",
        "followers_url": "https://api.github.com/users/benma/followers",
        "following_url": "https://api.github.com/users/benma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benma/subscriptions",
        "organizations_url": "https://api.github.com/users/benma/orgs",
        "repos_url": "https://api.github.com/users/benma/repos",
        "events_url": "https://api.github.com/users/benma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benma/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 191352053,
        "node_id": "MDEwOlJlcG9zaXRvcnkxOTEzNTIwNTM=",
        "name": "secp256k1",
        "full_name": "benma/secp256k1",
        "owner": {
          "login": "benma",
          "id": 1225267,
          "node_id": "MDQ6VXNlcjEyMjUyNjc=",
          "avatar_url": "https://avatars.githubusercontent.com/u/1225267?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/benma",
          "html_url": "https://github.com/benma",
          "followers_url": "https://api.github.com/users/benma/followers",
          "following_url": "https://api.github.com/users/benma/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/benma/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/benma/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/benma/subscriptions",
          "organizations_url": "https://api.github.com/users/benma/orgs",
          "repos_url": "https://api.github.com/users/benma/repos",
          "events_url": "https://api.github.com/users/benma/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/benma/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/benma/secp256k1",
        "description": "Optimized C library for EC operations on curve secp256k1",
        "fork": true,
        "url": "https://api.github.com/repos/benma/secp256k1",
        "archive_url": "https://api.github.com/repos/benma/secp256k1/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/benma/secp256k1/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/benma/secp256k1/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/benma/secp256k1/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/benma/secp256k1/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/benma/secp256k1/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/benma/secp256k1/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/benma/secp256k1/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/benma/secp256k1/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/benma/secp256k1/contributors",
        "deployments_url": "https://api.github.com/repos/benma/secp256k1/deployments",
        "downloads_url": "https://api.github.com/repos/benma/secp256k1/downloads",
        "events_url": "https://api.github.com/repos/benma/secp256k1/events",
        "forks_url": "https://api.github.com/repos/benma/secp256k1/forks",
        "git_commits_url": "https://api.github.com/repos/benma/secp256k1/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/benma/secp256k1/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/benma/secp256k1/git/tags%7B/sha%7D",
        "git_url": "git://github.com/benma/secp256k1.git",
        "issue_comment_url": "https://api.github.com/repos/benma/secp256k1/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/benma/secp256k1/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/benma/secp256k1/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/benma/secp256k1/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/benma/secp256k1/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/benma/secp256k1/languages",
        "merges_url": "https://api.github.com/repos/benma/secp256k1/merges",
        "milestones_url": "https://api.github.com/repos/benma/secp256k1/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/benma/secp256k1/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/benma/secp256k1/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/benma/secp256k1/releases%7B/id%7D",
        "ssh_url": "git@github.com:benma/secp256k1.git",
        "stargazers_url": "https://api.github.com/repos/benma/secp256k1/stargazers",
        "statuses_url": "https://api.github.com/repos/benma/secp256k1/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/benma/secp256k1/subscribers",
        "subscription_url": "https://api.github.com/repos/benma/secp256k1/subscription",
        "tags_url": "https://api.github.com/repos/benma/secp256k1/tags",
        "teams_url": "https://api.github.com/repos/benma/secp256k1/teams",
        "trees_url": "https://api.github.com/repos/benma/secp256k1/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/benma/secp256k1.git",
        "hooks_url": "https://api.github.com/repos/benma/secp256k1/hooks",
        "svn_url": "https://github.com/benma/secp256k1",
        "language": "C",
        "forks_count": 0,
        "stargazers_count": 0,
        "watchers_count": 0,
        "size": 10160,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-07-29T22:34:20Z",
        "created_at": "2019-06-11T10:50:34Z",
        "updated_at": "2019-06-11T10:50:37Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin-core:master",
      "ref": "master",
      "sha": "26392da2fb7153addae0bd604495eb96f995d76c",
      "user": {
        "login": "bitcoin-core",
        "id": 13464320,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEzNDY0MzIw",
        "avatar_url": "https://avatars.githubusercontent.com/u/13464320?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin-core",
        "html_url": "https://github.com/bitcoin-core",
        "followers_url": "https://api.github.com/users/bitcoin-core/followers",
        "following_url": "https://api.github.com/users/bitcoin-core/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin-core/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin-core/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin-core/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin-core/orgs",
        "repos_url": "https://api.github.com/users/bitcoin-core/repos",
        "events_url": "https://api.github.com/users/bitcoin-core/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin-core/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 16648618,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNjY0ODYxOA==",
        "name": "secp256k1",
        "full_name": "bitcoin-core/secp256k1",
        "owner": {
          "login": "bitcoin-core",
          "id": 13464320,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjEzNDY0MzIw",
          "avatar_url": "https://avatars.githubusercontent.com/u/13464320?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin-core",
          "html_url": "https://github.com/bitcoin-core",
          "followers_url": "https://api.github.com/users/bitcoin-core/followers",
          "following_url": "https://api.github.com/users/bitcoin-core/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin-core/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin-core/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin-core/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin-core/orgs",
          "repos_url": "https://api.github.com/users/bitcoin-core/repos",
          "events_url": "https://api.github.com/users/bitcoin-core/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin-core/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin-core/secp256k1",
        "description": "Optimized C library for EC operations on curve secp256k1",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1",
        "archive_url": "https://api.github.com/repos/bitcoin-core/secp256k1/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin-core/secp256k1/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin-core/secp256k1/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin-core/secp256k1/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin-core/secp256k1/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin-core/secp256k1/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin-core/secp256k1/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin-core/secp256k1/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin-core/secp256k1/downloads",
        "events_url": "https://api.github.com/repos/bitcoin-core/secp256k1/events",
        "forks_url": "https://api.github.com/repos/bitcoin-core/secp256k1/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin-core/secp256k1.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin-core/secp256k1/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin-core/secp256k1/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin-core/secp256k1/languages",
        "merges_url": "https://api.github.com/repos/bitcoin-core/secp256k1/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin-core/secp256k1/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin-core/secp256k1/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin-core/secp256k1/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin-core/secp256k1.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin-core/secp256k1/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin-core/secp256k1/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin-core/secp256k1/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin-core/secp256k1/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin-core/secp256k1/tags",
        "teams_url": "https://api.github.com/repos/bitcoin-core/secp256k1/teams",
        "trees_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin-core/secp256k1.git",
        "hooks_url": "https://api.github.com/repos/bitcoin-core/secp256k1/hooks",
        "svn_url": "https://github.com/bitcoin-core/secp256k1",
        "language": "C",
        "forks_count": 962,
        "stargazers_count": 1800,
        "watchers_count": 1800,
        "size": 10374,
        "default_branch": "master",
        "open_issues_count": 144,
        "is_template": false,
        "topics": [],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-07-29T22:34:23Z",
        "created_at": "2014-02-08T17:30:06Z",
        "updated_at": "2023-07-29T15:58:49Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1140"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 843,
    "deletions": 64,
    "changed_files": 8,
    "commits": 5,
    "review_comments": 10,
    "comments": 9
  },
  "events": [
    {
      "event": "reviewed",
      "id": 1103367931,
      "node_id": "PRR_kwDOAP4Jqs5BxA77",
      "url": null,
      "actor": null,
      "commit_id": "25899bfe783d8e92fb6fc314d72ca011e71d021d",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "benma",
        "id": 1225267,
        "node_id": "MDQ6VXNlcjEyMjUyNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1225267?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benma",
        "html_url": "https://github.com/benma",
        "followers_url": "https://api.github.com/users/benma/followers",
        "following_url": "https://api.github.com/users/benma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benma/subscriptions",
        "organizations_url": "https://api.github.com/users/benma/orgs",
        "repos_url": "https://api.github.com/users/benma/repos",
        "events_url": "https://api.github.com/users/benma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benma/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1140#pullrequestreview-1103367931",
      "submitted_at": "2022-09-11T23:17:53Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1140"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 7366095260,
      "node_id": "HRFPE_lADOAP4Jqs5RmrT6zwAAAAG3DbGc",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/7366095260",
      "actor": {
        "login": "benma",
        "id": 1225267,
        "node_id": "MDQ6VXNlcjEyMjUyNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1225267?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benma",
        "html_url": "https://github.com/benma",
        "followers_url": "https://api.github.com/users/benma/followers",
        "following_url": "https://api.github.com/users/benma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benma/subscriptions",
        "organizations_url": "https://api.github.com/users/benma/orgs",
        "repos_url": "https://api.github.com/users/benma/repos",
        "events_url": "https://api.github.com/users/benma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benma/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-09-12T10:19:30Z"
    },
    {
      "event": "commented",
      "id": 1245316220,
      "node_id": "IC_kwDOAP4Jqs5KOgR8",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/1245316220",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-09-13T12:04:12Z",
      "updated_at": "2022-09-13T12:04:12Z",
      "author_association": "CONTRIBUTOR",
      "body": "Nice!\r\n\r\nBy the way, is there a reason why this uses S2C instead of simple addition (Scheme 6 in https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2020-March/017667.html) besides the fact that the ECDSA code uses S2C. Are you aware of any reason why the S2C variant would be preferable over Scheme 6? (I think @jonasnick once told me that he wasn't aware of all the various variants when the work was started.)    \r\n\r\n---\r\n\r\nIt seems the tests fails on s390x, which is a big-endian machine, see https://cirrus-ci.com/task/6416044628639744?logs=cat_tests_log#L4  Is there some code in this PR where endianness could be a problem? I don't see any but I only had a brief look.",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1140#issuecomment-1245316220",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1140"
    },
    {
      "event": "mentioned",
      "id": 7375978329,
      "node_id": "MEE_lADOAP4Jqs5RmrT6zwAAAAG3pH9Z",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/7375978329",
      "actor": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-09-13T12:04:12Z"
    },
    {
      "event": "subscribed",
      "id": 7375978336,
      "node_id": "SE_lADOAP4Jqs5RmrT6zwAAAAG3pH9g",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/7375978336",
      "actor": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-09-13T12:04:12Z"
    },
    {
      "event": "commented",
      "id": 1245322066,
      "node_id": "IC_kwDOAP4Jqs5KOhtS",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/1245322066",
      "actor": {
        "login": "benma",
        "id": 1225267,
        "node_id": "MDQ6VXNlcjEyMjUyNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1225267?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benma",
        "html_url": "https://github.com/benma",
        "followers_url": "https://api.github.com/users/benma/followers",
        "following_url": "https://api.github.com/users/benma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benma/subscriptions",
        "organizations_url": "https://api.github.com/users/benma/orgs",
        "repos_url": "https://api.github.com/users/benma/repos",
        "events_url": "https://api.github.com/users/benma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benma/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-09-13T12:09:43Z",
      "updated_at": "2022-09-13T12:09:43Z",
      "author_association": "CONTRIBUTOR",
      "body": "> By the way, is there a reason why this uses S2C instead of simple addition\r\n\r\nI did it this way for two reasons:\r\n\r\n- sign-to-contract seems useful also for other uses, see https://github.com/ElementsProject/secp256k1-zkp/issues/154\r\n- It seemed to be the easiest approach, seeing that the same was already implemented for ECDSA. That means it should need less time to code and review and maintain.\r\n\r\nAbout s390x: I am puzzled, I don't see anything related to endianness in the code related to the failing test, but maybe I am missing something. I also replaced the uint64_t magic by an 8-byte buffer just in case there could be problems with large integers, but it didn't seem to be the cause.",
      "user": {
        "login": "benma",
        "id": 1225267,
        "node_id": "MDQ6VXNlcjEyMjUyNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1225267?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benma",
        "html_url": "https://github.com/benma",
        "followers_url": "https://api.github.com/users/benma/followers",
        "following_url": "https://api.github.com/users/benma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benma/subscriptions",
        "organizations_url": "https://api.github.com/users/benma/orgs",
        "repos_url": "https://api.github.com/users/benma/repos",
        "events_url": "https://api.github.com/users/benma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benma/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1140#issuecomment-1245322066",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1140"
    },
    {
      "event": "commented",
      "id": 1245329608,
      "node_id": "IC_kwDOAP4Jqs5KOjjI",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/1245329608",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-09-13T12:16:32Z",
      "updated_at": "2022-09-13T12:16:32Z",
      "author_association": "CONTRIBUTOR",
      "body": "> About s390x: I am puzzled, I don't see anything related to endianness in the code related to the failing test, but maybe I am missing something. I also replaced the uint64_t magic by an 8-byte buffer just in case there could be problems with large integers, but it didn't seem to be the cause.\r\n\r\nAccording to the implementation of `counting_illegal_callback_fn` excepts an `int32_t` and not `size_t`. Maybe this is the problem.",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1140#issuecomment-1245329608",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1140"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 7376124185,
      "node_id": "HRFPE_lADOAP4Jqs5RmrT6zwAAAAG3prkZ",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/7376124185",
      "actor": {
        "login": "benma",
        "id": 1225267,
        "node_id": "MDQ6VXNlcjEyMjUyNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1225267?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benma",
        "html_url": "https://github.com/benma",
        "followers_url": "https://api.github.com/users/benma/followers",
        "following_url": "https://api.github.com/users/benma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benma/subscriptions",
        "organizations_url": "https://api.github.com/users/benma/orgs",
        "repos_url": "https://api.github.com/users/benma/repos",
        "events_url": "https://api.github.com/users/benma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benma/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-09-13T12:22:37Z"
    },
    {
      "event": "reviewed",
      "id": 1105696543,
      "node_id": "PRR_kwDOAP4Jqs5B55cf",
      "url": null,
      "actor": null,
      "commit_id": "ea28c7a9dfeaf83d64cc8cbe0f33769fb2ef9c0c",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "benma",
        "id": 1225267,
        "node_id": "MDQ6VXNlcjEyMjUyNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1225267?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benma",
        "html_url": "https://github.com/benma",
        "followers_url": "https://api.github.com/users/benma/followers",
        "following_url": "https://api.github.com/users/benma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benma/subscriptions",
        "organizations_url": "https://api.github.com/users/benma/orgs",
        "repos_url": "https://api.github.com/users/benma/repos",
        "events_url": "https://api.github.com/users/benma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benma/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1140#pullrequestreview-1105696543",
      "submitted_at": "2022-09-13T12:26:46Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1140"
    },
    {
      "event": "commented",
      "id": 1245409684,
      "node_id": "IC_kwDOAP4Jqs5KO3GU",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/1245409684",
      "actor": {
        "login": "benma",
        "id": 1225267,
        "node_id": "MDQ6VXNlcjEyMjUyNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1225267?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benma",
        "html_url": "https://github.com/benma",
        "followers_url": "https://api.github.com/users/benma/followers",
        "following_url": "https://api.github.com/users/benma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benma/subscriptions",
        "organizations_url": "https://api.github.com/users/benma/orgs",
        "repos_url": "https://api.github.com/users/benma/repos",
        "events_url": "https://api.github.com/users/benma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benma/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-09-13T13:23:56Z",
      "updated_at": "2022-09-13T13:23:56Z",
      "author_association": "CONTRIBUTOR",
      "body": "> > About s390x: I am puzzled, I don't see anything related to endianness in the code related to the failing test, but maybe I am missing something. I also replaced the uint64_t magic by an 8-byte buffer just in case there could be problems with large integers, but it didn't seem to be the cause.\r\n> \r\n> According to the implementation of `counting_illegal_callback_fn` excepts an `int32_t` and not `size_t`. Maybe this is the problem.\r\n\r\nGreat catch, that seemed to be the problem! Fixed now.",
      "user": {
        "login": "benma",
        "id": 1225267,
        "node_id": "MDQ6VXNlcjEyMjUyNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1225267?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benma",
        "html_url": "https://github.com/benma",
        "followers_url": "https://api.github.com/users/benma/followers",
        "following_url": "https://api.github.com/users/benma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benma/subscriptions",
        "organizations_url": "https://api.github.com/users/benma/orgs",
        "repos_url": "https://api.github.com/users/benma/repos",
        "events_url": "https://api.github.com/users/benma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benma/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1140#issuecomment-1245409684",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1140"
    },
    {
      "event": "ready_for_review",
      "id": 7395575219,
      "node_id": "RFRE_lADOAP4Jqs5RmrT6zwAAAAG4z4Wz",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/7395575219",
      "actor": {
        "login": "benma",
        "id": 1225267,
        "node_id": "MDQ6VXNlcjEyMjUyNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1225267?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benma",
        "html_url": "https://github.com/benma",
        "followers_url": "https://api.github.com/users/benma/followers",
        "following_url": "https://api.github.com/users/benma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benma/subscriptions",
        "organizations_url": "https://api.github.com/users/benma/orgs",
        "repos_url": "https://api.github.com/users/benma/repos",
        "events_url": "https://api.github.com/users/benma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benma/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-09-15T14:28:45Z"
    },
    {
      "event": "commented",
      "id": 1261914959,
      "node_id": "IC_kwDOAP4Jqs5LN0tP",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/1261914959",
      "actor": {
        "login": "benma",
        "id": 1225267,
        "node_id": "MDQ6VXNlcjEyMjUyNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1225267?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benma",
        "html_url": "https://github.com/benma",
        "followers_url": "https://api.github.com/users/benma/followers",
        "following_url": "https://api.github.com/users/benma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benma/subscriptions",
        "organizations_url": "https://api.github.com/users/benma/orgs",
        "repos_url": "https://api.github.com/users/benma/repos",
        "events_url": "https://api.github.com/users/benma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benma/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-09-29T08:04:59Z",
      "updated_at": "2022-09-29T08:04:59Z",
      "author_association": "CONTRIBUTOR",
      "body": "Most of the commits are taken as-is from @jonasnick and @apoelstra, with the added exfil functions working the same way as in the ECDSA version in [secp256k1-zpk](https://github.com/ElementsProject/secp256k1-zkp/tree/master/src/modules/ecdsa_s2c).\r\n\r\nIt would be great if you could review this and let me know if there is any obstacles to getting this merged. I'd like to use this in the BitBox02 to extend the anti-exfil protocol to Schnorr sigs in Taproot inputs.",
      "user": {
        "login": "benma",
        "id": 1225267,
        "node_id": "MDQ6VXNlcjEyMjUyNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1225267?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benma",
        "html_url": "https://github.com/benma",
        "followers_url": "https://api.github.com/users/benma/followers",
        "following_url": "https://api.github.com/users/benma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benma/subscriptions",
        "organizations_url": "https://api.github.com/users/benma/orgs",
        "repos_url": "https://api.github.com/users/benma/repos",
        "events_url": "https://api.github.com/users/benma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benma/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1140#issuecomment-1261914959",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1140"
    },
    {
      "event": "mentioned",
      "id": 7484245203,
      "node_id": "MEE_lADOAP4Jqs5RmrT6zwAAAAG-GITT",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/7484245203",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-09-29T08:04:59Z"
    },
    {
      "event": "subscribed",
      "id": 7484245211,
      "node_id": "SE_lADOAP4Jqs5RmrT6zwAAAAG-GITb",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/7484245211",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-09-29T08:04:59Z"
    },
    {
      "event": "mentioned",
      "id": 7484245219,
      "node_id": "MEE_lADOAP4Jqs5RmrT6zwAAAAG-GITj",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/7484245219",
      "actor": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-09-29T08:04:59Z"
    },
    {
      "event": "subscribed",
      "id": 7484245224,
      "node_id": "SE_lADOAP4Jqs5RmrT6zwAAAAG-GITo",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/7484245224",
      "actor": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-09-29T08:04:59Z"
    },
    {
      "event": "commented",
      "id": 1281579039,
      "node_id": "IC_kwDOAP4Jqs5MY1gf",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/1281579039",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2022-10-17T22:34:10Z",
      "updated_at": "2022-10-17T22:34:10Z",
      "author_association": "CONTRIBUTOR",
      "body": "> It would be great if you could review this and let me know if there is any obstacles to getting this merged\r\n\r\nI just want to let you know that this on our radar. Things can move slow here and I think most of the contributors have been pretty busy in the remaining weeks (and at least I will still be busy with other stuff for ~2 weeks). I can't speak for the others but this is a feature I'd like to see included in the library, so I'll certainly come back to this soon.\r\n ",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1140#issuecomment-1281579039",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1140"
    },
    {
      "event": "commented",
      "id": 1429847367,
      "node_id": "IC_kwDOAP4Jqs5VOb1H",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/1429847367",
      "actor": {
        "login": "benma",
        "id": 1225267,
        "node_id": "MDQ6VXNlcjEyMjUyNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1225267?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benma",
        "html_url": "https://github.com/benma",
        "followers_url": "https://api.github.com/users/benma/followers",
        "following_url": "https://api.github.com/users/benma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benma/subscriptions",
        "organizations_url": "https://api.github.com/users/benma/orgs",
        "repos_url": "https://api.github.com/users/benma/repos",
        "events_url": "https://api.github.com/users/benma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benma/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-02-14T14:36:36Z",
      "updated_at": "2023-02-14T14:36:36Z",
      "author_association": "CONTRIBUTOR",
      "body": "> > It would be great if you could review this and let me know if there is any obstacles to getting this merged\r\n> \r\n> I just want to let you know that this on our radar. Things can move slow here and I think most of the contributors have been pretty busy in the remaining weeks (and at least I will still be busy with other stuff for ~2 weeks). I can't speak for the others but this is a feature I'd like to see included in the library, so I'll certainly come back to this soon.\r\n\r\nGentle reminder :smile: The last time I did this for ECDSA, the frequent rebasings were sometimes actually very time-consuming and complicated. If would be great to review and merge this before complicated conflicts appear.",
      "user": {
        "login": "benma",
        "id": 1225267,
        "node_id": "MDQ6VXNlcjEyMjUyNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1225267?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benma",
        "html_url": "https://github.com/benma",
        "followers_url": "https://api.github.com/users/benma/followers",
        "following_url": "https://api.github.com/users/benma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benma/subscriptions",
        "organizations_url": "https://api.github.com/users/benma/orgs",
        "repos_url": "https://api.github.com/users/benma/repos",
        "events_url": "https://api.github.com/users/benma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benma/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1140#issuecomment-1429847367",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1140"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9140485294,
      "node_id": "HRFPE_lADOAP4Jqs5RmrT6zwAAAAIg0Lyu",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/9140485294",
      "actor": {
        "login": "benma",
        "id": 1225267,
        "node_id": "MDQ6VXNlcjEyMjUyNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1225267?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benma",
        "html_url": "https://github.com/benma",
        "followers_url": "https://api.github.com/users/benma/followers",
        "following_url": "https://api.github.com/users/benma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benma/subscriptions",
        "organizations_url": "https://api.github.com/users/benma/orgs",
        "repos_url": "https://api.github.com/users/benma/repos",
        "events_url": "https://api.github.com/users/benma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benma/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-01T23:46:50Z"
    },
    {
      "event": "commented",
      "id": 1532322256,
      "node_id": "IC_kwDOAP4Jqs5bVWHQ",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/1532322256",
      "actor": {
        "login": "benma",
        "id": 1225267,
        "node_id": "MDQ6VXNlcjEyMjUyNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1225267?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benma",
        "html_url": "https://github.com/benma",
        "followers_url": "https://api.github.com/users/benma/followers",
        "following_url": "https://api.github.com/users/benma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benma/subscriptions",
        "organizations_url": "https://api.github.com/users/benma/orgs",
        "repos_url": "https://api.github.com/users/benma/repos",
        "events_url": "https://api.github.com/users/benma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benma/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-05-03T00:49:10Z",
      "updated_at": "2023-05-03T00:49:10Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased to fix conflicts with `master`.",
      "user": {
        "login": "benma",
        "id": 1225267,
        "node_id": "MDQ6VXNlcjEyMjUyNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1225267?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benma",
        "html_url": "https://github.com/benma",
        "followers_url": "https://api.github.com/users/benma/followers",
        "following_url": "https://api.github.com/users/benma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benma/subscriptions",
        "organizations_url": "https://api.github.com/users/benma/orgs",
        "repos_url": "https://api.github.com/users/benma/repos",
        "events_url": "https://api.github.com/users/benma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benma/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1140#issuecomment-1532322256",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1140"
    },
    {
      "event": "commented",
      "id": 1597850788,
      "node_id": "IC_kwDOAP4Jqs5fPUSk",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/1597850788",
      "actor": {
        "login": "benma",
        "id": 1225267,
        "node_id": "MDQ6VXNlcjEyMjUyNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1225267?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benma",
        "html_url": "https://github.com/benma",
        "followers_url": "https://api.github.com/users/benma/followers",
        "following_url": "https://api.github.com/users/benma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benma/subscriptions",
        "organizations_url": "https://api.github.com/users/benma/orgs",
        "repos_url": "https://api.github.com/users/benma/repos",
        "events_url": "https://api.github.com/users/benma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benma/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-19T22:52:54Z",
      "updated_at": "2023-06-19T23:07:30Z",
      "author_association": "CONTRIBUTOR",
      "body": "@real-or-random @jonasnick @apoelstra any chance of progress here? The code should be straight forward, with a little bit of concentrated effort we could get this merged and used in production :pray: ",
      "user": {
        "login": "benma",
        "id": 1225267,
        "node_id": "MDQ6VXNlcjEyMjUyNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1225267?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benma",
        "html_url": "https://github.com/benma",
        "followers_url": "https://api.github.com/users/benma/followers",
        "following_url": "https://api.github.com/users/benma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benma/subscriptions",
        "organizations_url": "https://api.github.com/users/benma/orgs",
        "repos_url": "https://api.github.com/users/benma/repos",
        "events_url": "https://api.github.com/users/benma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benma/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1140#issuecomment-1597850788",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1140"
    },
    {
      "event": "mentioned",
      "id": 9573073115,
      "node_id": "MEE_lADOAP4Jqs5RmrT6zwAAAAI6mYDb",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/9573073115",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-19T22:52:55Z"
    },
    {
      "event": "subscribed",
      "id": 9573073122,
      "node_id": "SE_lADOAP4Jqs5RmrT6zwAAAAI6mYDi",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/9573073122",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-19T22:52:55Z"
    },
    {
      "event": "mentioned",
      "id": 9573073132,
      "node_id": "MEE_lADOAP4Jqs5RmrT6zwAAAAI6mYDs",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/9573073132",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-19T22:52:55Z"
    },
    {
      "event": "subscribed",
      "id": 9573073137,
      "node_id": "SE_lADOAP4Jqs5RmrT6zwAAAAI6mYDx",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/9573073137",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-19T22:52:55Z"
    },
    {
      "event": "mentioned",
      "id": 9573073141,
      "node_id": "MEE_lADOAP4Jqs5RmrT6zwAAAAI6mYD1",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/9573073141",
      "actor": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-19T22:52:55Z"
    },
    {
      "event": "subscribed",
      "id": 9573073147,
      "node_id": "SE_lADOAP4Jqs5RmrT6zwAAAAI6mYD7",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/9573073147",
      "actor": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-19T22:52:55Z"
    },
    {
      "event": "reviewed",
      "id": 1490779315,
      "node_id": "PRR_kwDOAP4Jqs5Y23yz",
      "url": null,
      "actor": null,
      "commit_id": "fff7e5e167d12241ba22fed465b1ff8766541479",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1140#pullrequestreview-1490779315",
      "submitted_at": "2023-06-21T13:58:33Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1140"
    },
    {
      "event": "labeled",
      "id": 9595158464,
      "node_id": "LE_lADOAP4Jqs5RmrT6zwAAAAI76n_A",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/9595158464",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-21T15:12:43Z",
      "label": {
        "name": "feature",
        "color": "A40C6C"
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDRhZTJjZDUyMWY2Y2U0OTZmZjI5NmQwNDVlNjYxMzkxNGRmNzE1Zjc",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/4ae2cd521f6ce496ff296d045e6613914df715f7",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/4ae2cd521f6ce496ff296d045e6613914df715f7",
      "tree": {
        "sha": "2698a88dbbc2658ff2fc1f447c4674d637188b1e",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/2698a88dbbc2658ff2fc1f447c4674d637188b1e"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 2698a88dbbc2658ff2fc1f447c4674d637188b1e\nparent cc557575522c4cf11e5bcde1fea9637339cea21f\nauthor Andrew Poelstra <apoelstra@wpsoftware.net> 1541068284 +0000\ncommitter Marko Bencun <mbencun+pgp@gmail.com> 1689064835 +0200\n\nadd eccommit functionality\n\nThe files are copied from:\n\n- https://github.com/ElementsProject/secp256k1-zkp/blob/d22774e248c703a191049b78f8d04f37d6fcfa05/src/eccommit.h\n- https://github.com/ElementsProject/secp256k1-zkp/blob/d22774e248c703a191049b78f8d04f37d6fcfa05/src/eccommit_impl.h\n\nThe test is copied from:\n\nhttps://github.com/ElementsProject/secp256k1-zkp/blob/d22774e248c703a191049b78f8d04f37d6fcfa05/src/tests.c#L3755\n\nOriginally introduced in:\nhttps://github.com/ElementsProject/secp256k1-zkp/commit/826bd04b43f823813c633449223595031d5c31f7,\nwhere it was used to implement sign-to-contract for ECDSA.\n\nCo-authored-by: Marko Bencun <mbencun+pgp@gmail.com>\nCo-authored-by: Jonas Nick <jonasd.nick@gmail.com>\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJKBAABCgA0FiEELYh2gQqwkuRR3KiUgEU4kow36ugFAmStFYMWHG1iZW5jdW4r\ncGdwQGdtYWlsLmNvbQAKCRCARTiSjDfq6HuDEACG+EFjUz7BPbj4bwRkjE997/Kg\n7Irj8iBf3RVHKtzPrHR9BSYLQX1J3jFLdMNUuc0/jwQASMg7G/2TV9cKMxndhmO+\nL+UMrXNh0JEbbw83VpT5ZUZ4Eanvr/up0DAmjYKvbMkuvq3Ycr6mhTxdJvsYojsE\nZcdDL6zuezu65UcLudwh/edpx+SDM+CwYtyPPJi2kloKi/VwwS8ChCMwhnWYrNq1\nd3EJLQ5iX97qr2uxu1BJwVfulSlMhQNhQ9vphr8PjcfS9j70KkSjiTC5ipydmuDh\nPSYRc5lGrvAUWfp+KqCr267gjB2OTe691j11BRwWAU9VJqVoFaiZWgmehGo4kI/O\nRFcqqrXl7rNHfC4R9rhOITtu88u9pf3UZpizxq63JkduUjsvhWF4cjBudLI4heAu\nWOxfWSYh3VKcAABaFplr260JLRTlw1qfL0rTppuWuVHzhrdXmnNL7FaJem0ZOoRn\nlFKFpCJCxt6F2AIcP0hTniKXdWdgVOkCua0so+WGMUqNINNRAvazG21x5hGKxHUg\noDkDe8rukLmWk3GNbbfQ9mcQ1iuOBGI+FOTV4/oxsvzBBPa9bOdDYnLxPZuRJA27\nNI8/STSTwlwJNrrNEeiLq+iJFObJmHC3SDeXqPhqhSQycdz1axBYcjryytuexfM/\n8zNyz4zF53K/CN07nQ==\n=aZ7J\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/cc557575522c4cf11e5bcde1fea9637339cea21f",
          "sha": "cc557575522c4cf11e5bcde1fea9637339cea21f",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/cc557575522c4cf11e5bcde1fea9637339cea21f"
        }
      ],
      "message": "add eccommit functionality\n\nThe files are copied from:\n\n- https://github.com/ElementsProject/secp256k1-zkp/blob/d22774e248c703a191049b78f8d04f37d6fcfa05/src/eccommit.h\n- https://github.com/ElementsProject/secp256k1-zkp/blob/d22774e248c703a191049b78f8d04f37d6fcfa05/src/eccommit_impl.h\n\nThe test is copied from:\n\nhttps://github.com/ElementsProject/secp256k1-zkp/blob/d22774e248c703a191049b78f8d04f37d6fcfa05/src/tests.c#L3755\n\nOriginally introduced in:\nhttps://github.com/ElementsProject/secp256k1-zkp/commit/826bd04b43f823813c633449223595031d5c31f7,\nwhere it was used to implement sign-to-contract for ECDSA.\n\nCo-authored-by: Marko Bencun <mbencun+pgp@gmail.com>\nCo-authored-by: Jonas Nick <jonasd.nick@gmail.com>",
      "committer": {
        "name": "Marko Bencun",
        "email": "mbencun+pgp@gmail.com",
        "date": "2023-07-11T08:40:35Z"
      },
      "author": {
        "name": "Andrew Poelstra",
        "email": "apoelstra@wpsoftware.net",
        "date": "2018-11-01T10:31:24Z"
      },
      "sha": "4ae2cd521f6ce496ff296d045e6613914df715f7"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDk5OWM4MmY3ZDcyMTkzNzBkY2ZiNWZmMzY0NTdkZTAwMjM5M2QwYzM",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/999c82f7d7219370dcfb5ff36457de002393d0c3",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/999c82f7d7219370dcfb5ff36457de002393d0c3",
      "tree": {
        "sha": "afcc092adaf402336f70d35aed22a092da10f190",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/afcc092adaf402336f70d35aed22a092da10f190"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree afcc092adaf402336f70d35aed22a092da10f190\nparent 4ae2cd521f6ce496ff296d045e6613914df715f7\nauthor Jonas Nick <jonasd.nick@gmail.com> 1550067323 +0000\ncommitter Marko Bencun <mbencun+pgp@gmail.com> 1689064836 +0200\n\nadd schnorr sign-to-contract opening with parse/ serialize functions\n\nAdapted from https://github.com/bitcoin-core/secp256k1/pull/589/.\n\nCo-authored-by: Marko Bencun <mbencun+pgp@gmail.com>\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJKBAABCgA0FiEELYh2gQqwkuRR3KiUgEU4kow36ugFAmStFYQWHG1iZW5jdW4r\ncGdwQGdtYWlsLmNvbQAKCRCARTiSjDfq6M9mEACm5ZRCwfurc4ZfHzZ0x06p9nqJ\nIV1qTnt37+9VRofS7Ufm2nBEVdZe3gKEwUAK3KF8RAkheGpYPfQf2ZFvOQxl7OE5\nwiyl7XPvkj0+I1/aQuRnbCJ2ziObTfid2VGhiJMAYyJGYOZU4co1abQ0vqeHSVg9\n1VmjGjSPnMt8/xNx1HYwsKo/bYRiYFPJIWMvndpkjhnuUsxmibQqlgB6O7xpAiYR\n6TxE5MWrR8zFenlRFT8IoQBRfKyNZPf+ZvQEp7K8sO/b/9tD8wNTIKC7BhZUZqwN\nTUZr4aeR+tm5q+T+LUBIJhh+kW/CfH24aur8vDHfNt2WtpiBUyzEZLIEgHne96fJ\n9LfXRcPCjXI8B6EJVyxDxkP1lVsaxF6TVQuAPCNKzJaMznblJX5odj8Tl+7wwxLY\nyVmzPNx/nBcHDsKJhlLmolTkkCQLwwWsNSRrkSEH8zsGAqYGfpZYjNVAkVFG/YPf\ne7P8A57EttR4lhGavgLhHNFisehSslWHcuDhMfccjOA4CjykgZvMyN3AuJhQiDj0\nsj1xl+cmmxat+Jz4sOf+OGFqgGjYVPO9AwCDbuQoFQknsPCqo8KYLmNW+tj0l6Tb\neZ4m3kcn0TPZg/NxJupRGhp2UIIodb9nsUNkV7089h2kE09Mejqv/eREaz0MLMLg\ncsVcQsw2suvES0QXNA==\n=6/Ph\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/4ae2cd521f6ce496ff296d045e6613914df715f7",
          "sha": "4ae2cd521f6ce496ff296d045e6613914df715f7",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/4ae2cd521f6ce496ff296d045e6613914df715f7"
        }
      ],
      "message": "add schnorr sign-to-contract opening with parse/ serialize functions\n\nAdapted from https://github.com/bitcoin-core/secp256k1/pull/589/.\n\nCo-authored-by: Marko Bencun <mbencun+pgp@gmail.com>",
      "committer": {
        "name": "Marko Bencun",
        "email": "mbencun+pgp@gmail.com",
        "date": "2023-07-11T08:40:36Z"
      },
      "author": {
        "name": "Jonas Nick",
        "email": "jonasd.nick@gmail.com",
        "date": "2019-02-13T14:15:23Z"
      },
      "sha": "999c82f7d7219370dcfb5ff36457de002393d0c3"
    },
    {
      "event": "unsubscribed",
      "id": 9786772091,
      "node_id": "UE_lADOAP4Jqs5RmrT6zwAAAAJHVkp7",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/9786772091",
      "actor": {
        "login": "romanz",
        "id": 9900,
        "node_id": "MDQ6VXNlcjk5MDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9900?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/romanz",
        "html_url": "https://github.com/romanz",
        "followers_url": "https://api.github.com/users/romanz/followers",
        "following_url": "https://api.github.com/users/romanz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/romanz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/romanz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/romanz/subscriptions",
        "organizations_url": "https://api.github.com/users/romanz/orgs",
        "repos_url": "https://api.github.com/users/romanz/repos",
        "events_url": "https://api.github.com/users/romanz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/romanz/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-11T12:22:19Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKGE4YzE5MmRkY2ZmNDYwZTcxYTY5MTcxZGQwNDIyZjNhZjg4ZTZiMjA",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/a8c192ddcff460e71a69171dd0422f3af88e6b20",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/a8c192ddcff460e71a69171dd0422f3af88e6b20",
      "tree": {
        "sha": "a700dfffe62699ae7a346ef564aa2523a90c32d5",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/a700dfffe62699ae7a346ef564aa2523a90c32d5"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree a700dfffe62699ae7a346ef564aa2523a90c32d5\nparent 999c82f7d7219370dcfb5ff36457de002393d0c3\nauthor Marko Bencun <mbencun+pgp@gmail.com> 1662893713 +0200\ncommitter Marko Bencun <mbencun+pgp@gmail.com> 1690666689 +0200\n\nallow creating and verifying Schnorr sign-to-contract commitments\n\nAdapted from https://github.com/bitcoin-core/secp256k1/pull/589/.\n\nThe data is hashed using a tagged hash with the \"s2c/schnorr/data\"\ntag, which is consistent with the data hashing done in the ECDSA\nversion of sign-to-contract (in ElementsProject/secp256k1-zkp), where\nthe \"s2c/ecdsa/data\" tag is used. Similarly, the tweak hash tag is\n\"s2c/schnorr/point\".\n\nCo-authored-by: Jonas Nick <jonasd.nick@gmail.com>\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJKBAABCgA0FiEELYh2gQqwkuRR3KiUgEU4kow36ugFAmTFhsEWHG1iZW5jdW4r\ncGdwQGdtYWlsLmNvbQAKCRCARTiSjDfq6MIbEACCLRJ8ap28fnKNJVRzeGLfUZFM\nKKtfZiJekWO+/7+NpV2j+x41DxARAm0/6ycp/CmMlmhRzdj6d+rEgA3iLh4LkySu\n0H5bMzZqEQn3fq3FYfHYcHbfCbv9VKQImLLyNWLXxLccI1Lwh/WJ0C63aSR3CRZl\nv9C7eN7fG5XJwQ6+e8W6UiL5yK3hcv2ZNNIEjRYhQXEiV6epfLKGPpO0KsHmuNqH\n0dw2ot9vqJqFpXsdoP5Rl7jbvaVQx4/dhBq7lYxdV90oBqbL1uc6QpG7k8Qx3mnY\ndsy1rBnpVZYHRXwOXlUb+oMJb2Fp+vztuB5lLMlVASpCoikg40XJ8svYSFUlRcQZ\nzz4ZsOgrNqJzZRfP3cYbNhwMbYTwg5DTqbKOWAoFzhaghICERWDDwz2PUoZDCC+z\n229+DxizUpzTxl0bjyzyYl1SqittxBFHWGfKOAwGQjLOJlWHcMAFestcTVy1SZTD\nMcBKlDTQhpQts58IWFMV50hj62eRthX+7ZeWyfKLEA6ffD7hw/R6rt7xAJdsG+m/\nmgifFbfKcrYEWDbyseMVQaCnmTuZ99FfiNKs3V9lrUaJMQpLReO8YDexAbShnCqc\nzGL3JktwK7SGIO+QMuHEIPSzaBNby134vWwwxJgC0IgdT/KxKkqaUfj0Y1wZ1Ejd\nX9grkK3RweE8Y4AcSw==\n=zckn\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/999c82f7d7219370dcfb5ff36457de002393d0c3",
          "sha": "999c82f7d7219370dcfb5ff36457de002393d0c3",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/999c82f7d7219370dcfb5ff36457de002393d0c3"
        }
      ],
      "message": "allow creating and verifying Schnorr sign-to-contract commitments\n\nAdapted from https://github.com/bitcoin-core/secp256k1/pull/589/.\n\nThe data is hashed using a tagged hash with the \"s2c/schnorr/data\"\ntag, which is consistent with the data hashing done in the ECDSA\nversion of sign-to-contract (in ElementsProject/secp256k1-zkp), where\nthe \"s2c/ecdsa/data\" tag is used. Similarly, the tweak hash tag is\n\"s2c/schnorr/point\".\n\nCo-authored-by: Jonas Nick <jonasd.nick@gmail.com>",
      "committer": {
        "name": "Marko Bencun",
        "email": "mbencun+pgp@gmail.com",
        "date": "2023-07-29T21:38:09Z"
      },
      "author": {
        "name": "Marko Bencun",
        "email": "mbencun+pgp@gmail.com",
        "date": "2022-09-11T10:55:13Z"
      },
      "sha": "a8c192ddcff460e71a69171dd0422f3af88e6b20"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDgyNTU3YjQ2N2RlZjY2M2Q0MTI5OWI2MjFkMjQxMDZhNTA2N2U1ZGE",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/82557b467def663d41299b621d24106a5067e5da",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/82557b467def663d41299b621d24106a5067e5da",
      "tree": {
        "sha": "cedac0b26834e32fa9872abbc8e6df7f3287dbe6",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/cedac0b26834e32fa9872abbc8e6df7f3287dbe6"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree cedac0b26834e32fa9872abbc8e6df7f3287dbe6\nparent a8c192ddcff460e71a69171dd0422f3af88e6b20\nauthor Marko Bencun <mbencun+pgp@gmail.com> 1662916810 +0200\ncommitter Marko Bencun <mbencun+pgp@gmail.com> 1690666690 +0200\n\nadd Schnorr anti-exfil functions\n\nThese functions allow to perform the anti-exfil protocol. It is very\nsimilar to the implementation of the same protocol for ECDSA in\nElementsProject/secp256k1-zkp.\n\nThe opening struct can't be use in\n`secp256k1_schnorrsig_anti_exfil_signer_commit()` as it contains the\n``nonce_is_negated` field, which can only be set correctly during\nsigning with s2c data. As a result, we must use the opening in the\ncommitment verification, so we also must check that the signer\ncommitment is the same as the one used during signing. The alternative\nis to only compare the x-coordinate, in which case the opening struct\ncould skip `nonce_is_negated` and the struct could be reused in\n`secp256k1_schnorrsig_anti_exfil_signer_commit()`, but it seems to\nhave a downside that it would prevent batch-verification of the\ncommitments.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJKBAABCgA0FiEELYh2gQqwkuRR3KiUgEU4kow36ugFAmTFhsIWHG1iZW5jdW4r\ncGdwQGdtYWlsLmNvbQAKCRCARTiSjDfq6H+uEACL3sVYhFcULCWqBA5YxQb+Zx9h\nHH/TnfD9qKOiIOWtCbJQTNJHAnhIjABcm5qivoochaE9TL1OFluMW68wwMX3sxUW\nBWhHjcGB1a1bR1Q/SqoyGLAdlMkooDRwB2usUd7es+4dfhermQCjp8c1quwIhcGT\nANxhzLfStD+A+ZLZJNS7IVrIr8cZ4rVYnHAWyGaDOaesNRn856XER/RnOHydeHfH\nczR+fRx6u6Jqd7Lazp6WPS0rgoVHxjXfwxtbdfvRdKtaEALpA8Zid4IlbdZJJaiZ\nyCQS1FHgGwvrVhXjluzYAv2vU5xeoYYRydwQYGWWAH0YuaE7OpW+zh6qtanvDMLz\nLm4ThKtRQILuV8FQWhEi86YnnNDoQAc187BwWD9y8sjd0CuY30tXA066YMhekeG5\nkfNi5TFt2ct/C0WKeNFOVUZF6IluHDSukfNSXkOeDnYw6iuV100Bjv1t/HUTZwr7\ne/aUi+J7Y1ChXIfsDT1Bc+OEsIc8mqmUV7NHTYfmhsLB2Qu7MxCIE9A9522OR5WX\nqs/yFQ1bC51czQ3oztHxxK9RI8s0a+YLpWtpTue127VFEQWbqUE8KquR8Qi00hTb\nbiIYVR3kAmIEufUwednZeSODrtCI81VZSNYalwyRZO+dc2GeayM5Pt3Skb0MmiXJ\nUWdtVNH95cqB/tlNXA==\n=psWa\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/a8c192ddcff460e71a69171dd0422f3af88e6b20",
          "sha": "a8c192ddcff460e71a69171dd0422f3af88e6b20",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/a8c192ddcff460e71a69171dd0422f3af88e6b20"
        }
      ],
      "message": "add Schnorr anti-exfil functions\n\nThese functions allow to perform the anti-exfil protocol. It is very\nsimilar to the implementation of the same protocol for ECDSA in\nElementsProject/secp256k1-zkp.\n\nThe opening struct can't be use in\n`secp256k1_schnorrsig_anti_exfil_signer_commit()` as it contains the\n``nonce_is_negated` field, which can only be set correctly during\nsigning with s2c data. As a result, we must use the opening in the\ncommitment verification, so we also must check that the signer\ncommitment is the same as the one used during signing. The alternative\nis to only compare the x-coordinate, in which case the opening struct\ncould skip `nonce_is_negated` and the struct could be reused in\n`secp256k1_schnorrsig_anti_exfil_signer_commit()`, but it seems to\nhave a downside that it would prevent batch-verification of the\ncommitments.",
      "committer": {
        "name": "Marko Bencun",
        "email": "mbencun+pgp@gmail.com",
        "date": "2023-07-29T21:38:10Z"
      },
      "author": {
        "name": "Marko Bencun",
        "email": "mbencun+pgp@gmail.com",
        "date": "2022-09-11T17:20:10Z"
      },
      "sha": "82557b467def663d41299b621d24106a5067e5da"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9955606296,
      "node_id": "HRFPE_lADOAP4Jqs5RmrT6zwAAAAJRZn8Y",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/9955606296",
      "actor": {
        "login": "benma",
        "id": 1225267,
        "node_id": "MDQ6VXNlcjEyMjUyNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1225267?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benma",
        "html_url": "https://github.com/benma",
        "followers_url": "https://api.github.com/users/benma/followers",
        "following_url": "https://api.github.com/users/benma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benma/subscriptions",
        "organizations_url": "https://api.github.com/users/benma/orgs",
        "repos_url": "https://api.github.com/users/benma/repos",
        "events_url": "https://api.github.com/users/benma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benma/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-29T22:31:53Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKGU2OTc4YzQxNTBiMDY5NTRhMDJlMjFlZmJkYmVlZDc5NmRjNzM5YjY",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/e6978c4150b06954a02e21efbdbeed796dc739b6",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/e6978c4150b06954a02e21efbdbeed796dc739b6",
      "tree": {
        "sha": "a476946429e53cd10eafdd4e9e46b221fe94a72c",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/a476946429e53cd10eafdd4e9e46b221fe94a72c"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree a476946429e53cd10eafdd4e9e46b221fe94a72c\nparent 82557b467def663d41299b621d24106a5067e5da\nauthor Marko Bencun <mbencun+pgp@gmail.com> 1690669701 +0200\ncommitter Marko Bencun <mbencun+pgp@gmail.com> 1690670032 +0200\n\nuse the magic in the schnorrsig extraparams struct for versioning\n\nThis ensures compatibility in that it makes sure that the\n`secp256k1_schnorrsig_sign_custom()` works for users using an older\nversion of the headers but linking against a newer version of the\nlibrary.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEELYh2gQqwkuRR3KiUgEU4kow36ugFAmTFk9AACgkQgEU4kow3\n6uiIHw/9FvstgPPR4pF9OJQuB1RIFCyUO5jM/cNIcTf9DV5SVr8p0mEKxZfRO+JK\nqVfasMTk0TqYS1ZIznXknsSpL3FJeRJkPc+KTy2Mlo2YGnNKEdeeOZ8m+CG11u2z\n11vvlgpVMlnml4d6A0fiG9Reg0OF93tTDDXmWh7Z4CWmCCOTpKk1QN8Wtvk+rAx4\n0qeui9SQOAlLUC2vO2clwJWpNsyg9B8v85S43p0iaD9u+ukPEUbRMs5Xrn2NoZ/E\nARIb09pjk5osbGiQeCklYzZY3ePUQN8j8ddOY7Gu0J8ktarLUXueiOlV+Js/LD4t\nYFKEHS13bbUHxjgR7dGO3j6bFI/vMwkP8d3t5rCCHwqUZePdIVdOdCFKlIOlADd3\nHrUWwcxgpiBLZDM+zs2Sk3VjL41AEtrZvV/clP/c8z/Cfb7j21ir6f3dEEPcjWm9\ngdu+T9GoEKBa0OXr4Iv8NEAcH/7f1ykliQSu3YHo00O0NOWaJQhBcqJzCv9fcHnS\nHtnbpx80ssnjumtfOQk3PN957l/coZi61bEb9fFJGq30neNgJGLuGWBtiK05pHRz\nmTTMDGX6jCfMsKLvC/rLXxswbqvOTOm7kLmwcosCY48tT3DPe5HT3rkwwTeoBsrT\n5MUIB9BfmJXm8XMrd1kpwvsKCGglr7H4oorx1fFtcyJUrhJIxcQ=\n=IlIl\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/82557b467def663d41299b621d24106a5067e5da",
          "sha": "82557b467def663d41299b621d24106a5067e5da",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/82557b467def663d41299b621d24106a5067e5da"
        }
      ],
      "message": "use the magic in the schnorrsig extraparams struct for versioning\n\nThis ensures compatibility in that it makes sure that the\n`secp256k1_schnorrsig_sign_custom()` works for users using an older\nversion of the headers but linking against a newer version of the\nlibrary.",
      "committer": {
        "name": "Marko Bencun",
        "email": "mbencun+pgp@gmail.com",
        "date": "2023-07-29T22:33:52Z"
      },
      "author": {
        "name": "Marko Bencun",
        "email": "mbencun+pgp@gmail.com",
        "date": "2023-07-29T22:28:21Z"
      },
      "sha": "e6978c4150b06954a02e21efbdbeed796dc739b6"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9955609884,
      "node_id": "HRFPE_lADOAP4Jqs5RmrT6zwAAAAJRZo0c",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/9955609884",
      "actor": {
        "login": "benma",
        "id": 1225267,
        "node_id": "MDQ6VXNlcjEyMjUyNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1225267?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benma",
        "html_url": "https://github.com/benma",
        "followers_url": "https://api.github.com/users/benma/followers",
        "following_url": "https://api.github.com/users/benma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benma/subscriptions",
        "organizations_url": "https://api.github.com/users/benma/orgs",
        "repos_url": "https://api.github.com/users/benma/repos",
        "events_url": "https://api.github.com/users/benma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benma/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-29T22:34:22Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/967903025",
      "pull_request_review_id": 1103367931,
      "id": 967903025,
      "node_id": "PRRC_kwDOAP4Jqs45sQcx",
      "diff_hunk": "@@ -11,6 +11,63 @@\n #include \"../../../include/secp256k1_schnorrsig.h\"\n #include \"../../hash.h\"\n \n+static uint64_t s2c_opening_magic = 0x5d0520b8b7f2b168ULL;\n+\n+static const unsigned char s2c_data_tag[16] = \"s2c/schnorr/data\";\n+static const unsigned char s2c_point_tag[17] = \"s2c/schnorr/point\";",
      "path": "src/modules/schnorrsig/main_impl.h",
      "position": 7,
      "original_position": 7,
      "commit_id": "e6978c4150b06954a02e21efbdbeed796dc739b6",
      "original_commit_id": "25899bfe783d8e92fb6fc314d72ca011e71d021d",
      "in_reply_to_id": null,
      "user": {
        "login": "benma",
        "id": 1225267,
        "node_id": "MDQ6VXNlcjEyMjUyNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1225267?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benma",
        "html_url": "https://github.com/benma",
        "followers_url": "https://api.github.com/users/benma/followers",
        "following_url": "https://api.github.com/users/benma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benma/subscriptions",
        "organizations_url": "https://api.github.com/users/benma/orgs",
        "repos_url": "https://api.github.com/users/benma/repos",
        "events_url": "https://api.github.com/users/benma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benma/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "If these tags are okay, I can add functions with precomputed states if desired.",
      "created_at": "2022-09-11T23:17:53Z",
      "updated_at": "2022-09-11T23:17:53Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1140#discussion_r967903025",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/967903025"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1140"
        }
      },
      "start_line": 16,
      "original_start_line": 16,
      "start_side": "RIGHT",
      "line": 17,
      "original_line": 17,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/969558286",
      "pull_request_review_id": 1105696543,
      "id": 969558286,
      "node_id": "PRRC_kwDOAP4Jqs45ykkO",
      "diff_hunk": "@@ -13,6 +15,63 @@ extern \"C\" {\n  *  (https://github.com/bitcoin/bips/blob/master/bip-0340.mediawiki).\n  */\n \n+/** Data structure that holds a sign-to-contract (\"s2c\") opening information.\n+ *  Sign-to-contract allows a signer to commit to some data as part of a signature. It\n+ *  can be used as an Out-argument in certain signing functions.\n+ *\n+ *  This structure is not opaque, but it is strongly discouraged to read or write to\n+ *  it directly.\n+ *\n+ *  The exact representation of data inside is implementation defined and not\n+ *  guaranteed to be portable between different platforms or versions. It can\n+ *  be safely copied/moved.\n+ */\n+typedef struct {\n+    /* magic is set during initialization */\n+    uint64_t magic;",
      "path": "include/secp256k1_schnorrsig.h",
      "position": 26,
      "original_position": 26,
      "commit_id": "e6978c4150b06954a02e21efbdbeed796dc739b6",
      "original_commit_id": "ea28c7a9dfeaf83d64cc8cbe0f33769fb2ef9c0c",
      "in_reply_to_id": null,
      "user": {
        "login": "benma",
        "id": 1225267,
        "node_id": "MDQ6VXNlcjEyMjUyNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1225267?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benma",
        "html_url": "https://github.com/benma",
        "followers_url": "https://api.github.com/users/benma/followers",
        "following_url": "https://api.github.com/users/benma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benma/subscriptions",
        "organizations_url": "https://api.github.com/users/benma/orgs",
        "repos_url": "https://api.github.com/users/benma/repos",
        "events_url": "https://api.github.com/users/benma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benma/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I took this for a commit from @jonasnick, but I am actually unsure what the purpose is of the magic. Absent programming errors inside the library, could something go wrong if there was no magic field? Are there guidelines of when to use a magic (most structs don't contain any)? ",
      "created_at": "2022-09-13T12:26:46Z",
      "updated_at": "2022-09-13T12:26:46Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1140#discussion_r969558286",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/969558286"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1140"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 31,
      "original_line": 31,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1237026078",
      "pull_request_review_id": 1490779315,
      "id": 1237026078,
      "node_id": "PRRC_kwDOAP4Jqs5Ju4Ue",
      "diff_hunk": "@@ -13,6 +15,63 @@ extern \"C\" {\n  *  (https://github.com/bitcoin/bips/blob/master/bip-0340.mediawiki).\n  */\n \n+/** Data structure that holds a sign-to-contract (\"s2c\") opening information.\n+ *  Sign-to-contract allows a signer to commit to some data as part of a signature. It\n+ *  can be used as an Out-argument in certain signing functions.\n+ *\n+ *  This structure is not opaque, but it is strongly discouraged to read or write to\n+ *  it directly.\n+ *\n+ *  The exact representation of data inside is implementation defined and not\n+ *  guaranteed to be portable between different platforms or versions. It can\n+ *  be safely copied/moved.\n+ */\n+typedef struct {\n+    /* magic is set during initialization */\n+    uint64_t magic;",
      "path": "include/secp256k1_schnorrsig.h",
      "position": 26,
      "original_position": 26,
      "commit_id": "e6978c4150b06954a02e21efbdbeed796dc739b6",
      "original_commit_id": "ea28c7a9dfeaf83d64cc8cbe0f33769fb2ef9c0c",
      "in_reply_to_id": 969558286,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think the magics are a relative recent addition, and just there for assurance, so that incorrect use can be detected. In correct usage, they serve no function.",
      "created_at": "2023-06-21T13:43:06Z",
      "updated_at": "2023-06-21T13:58:33Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1140#discussion_r1237026078",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1237026078"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1140"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 31,
      "original_line": 31,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1237036918",
      "pull_request_review_id": 1490779315,
      "id": 1237036918,
      "node_id": "PRRC_kwDOAP4Jqs5Ju692",
      "diff_hunk": "@@ -69,26 +128,36 @@ SECP256K1_API_VAR const secp256k1_nonce_function_hardened secp256k1_nonce_functi\n  *  setting it to SECP256K1_SCHNORRSIG_EXTRAPARAMS_INIT.\n  *\n  *  Members:\n- *      magic: set to SECP256K1_SCHNORRSIG_EXTRAPARAMS_MAGIC at initialization\n- *             and has no other function than making sure the object is\n- *             initialized.\n- *    noncefp: pointer to a nonce generation function. If NULL,\n- *             secp256k1_nonce_function_bip340 is used\n- *      ndata: pointer to arbitrary data used by the nonce generation function\n- *             (can be NULL). If it is non-NULL and\n- *             secp256k1_nonce_function_bip340 is used, then ndata must be a\n- *             pointer to 32-byte auxiliary randomness as per BIP-340.\n+ *         magic: set to SECP256K1_SCHNORRSIG_EXTRAPARAMS_MAGIC at initialization\n+ *                and has no other function than making sure the object is\n+ *                initialized.\n+ *       noncefp: pointer to a nonce generation function. If NULL,\n+ *                secp256k1_nonce_function_bip340 is used\n+ *         ndata: pointer to arbitrary data used by the nonce generation function\n+ *                (can be NULL). If it is non-NULL and\n+ *                secp256k1_nonce_function_bip340 is used, then ndata must be a\n+ *                pointer to 32-byte auxiliary randomness as per BIP-340.\n+ *   s2c_opening: pointer to an secp256k1_schnorrsig_s2c_opening structure which can be\n+ *                NULL but is required to be not NULL if this signature creates\n+ *                a sign-to-contract commitment (i.e. the `s2c_data32` argument\n+ *                is not NULL).\n+ *    s2c_data32: pointer to a 32-byte data to create an optional\n+ *                sign-to-contract commitment to if not NULL (can be NULL).\n  */\n typedef struct {\n     unsigned char magic[4];\n     secp256k1_nonce_function_hardened noncefp;\n     void *ndata;\n+    secp256k1_schnorrsig_s2c_opening* s2c_opening;",
      "path": "include/secp256k1_schnorrsig.h",
      "position": 122,
      "original_position": 106,
      "commit_id": "e6978c4150b06954a02e21efbdbeed796dc739b6",
      "original_commit_id": "fff7e5e167d12241ba22fed465b1ff8766541479",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Adding fields to this struct is, I think, an incompatible API break. If a user of the library uses an old version of the header, and links against a new version of the library, I believe the library will access uninitialized fields. Is that right?\r\n\r\nIn theory, that's ok, because we're still in 0.x releases, so any breaks are allowed by SemVer, but this seems unnecessarily burdensome for users. Ideally, extra fields to the struct only affect calls that are impossible to make in old code (e.g. only by new API functions, or when function arguments are set to constants that don't exist in old versions).\r\n\r\nIdly wondering: can we (ab)use the magic for this? Change the magic in the header, and make the library check whether the old or the new magic is used, and trigger behavior based on that.",
      "created_at": "2023-06-21T13:50:12Z",
      "updated_at": "2023-06-21T13:58:33Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1140#discussion_r1237036918",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1237036918"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1140"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 160,
      "original_line": 160,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1237044291",
      "pull_request_review_id": 1490779315,
      "id": 1237044291,
      "node_id": "PRRC_kwDOAP4Jqs5Ju8xD",
      "diff_hunk": "@@ -13,6 +15,63 @@ extern \"C\" {\n  *  (https://github.com/bitcoin/bips/blob/master/bip-0340.mediawiki).\n  */\n \n+/** Data structure that holds a sign-to-contract (\"s2c\") opening information.\n+ *  Sign-to-contract allows a signer to commit to some data as part of a signature. It\n+ *  can be used as an Out-argument in certain signing functions.\n+ *\n+ *  This structure is not opaque, but it is strongly discouraged to read or write to\n+ *  it directly.\n+ *\n+ *  The exact representation of data inside is implementation defined and not\n+ *  guaranteed to be portable between different platforms or versions. It can\n+ *  be safely copied/moved.\n+ */\n+typedef struct {\n+    /* magic is set during initialization */\n+    uint64_t magic;\n+    /* Public nonce before applying the sign-to-contract commitment */\n+    secp256k1_pubkey original_pubnonce;\n+    /* Byte indicating if signing algorithm negated the nonce. Alternatively when\n+     * verifying we could compute the EC commitment of original_pubnonce and the\n+     * data and negate if this would not be a valid nonce. But this would prevent\n+     * batch verification of sign-to-contract commitments. */\n+    int nonce_is_negated;\n+} secp256k1_schnorrsig_s2c_opening;\n+\n+/** The signer commitment in the anti-exfil protocol is the original public nonce. */\n+typedef secp256k1_pubkey secp256k1_schnorrsig_anti_exfil_signer_commitment;\n+\n+/** Parse a sign-to-contract opening.",
      "path": "include/secp256k1_schnorrsig.h",
      "position": 39,
      "original_position": 39,
      "commit_id": "e6978c4150b06954a02e21efbdbeed796dc739b6",
      "original_commit_id": "fff7e5e167d12241ba22fed465b1ff8766541479",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Would it be possible to add a succinct description of the actual protocol to this header, or a reference to it?\r\n\r\nThe idea is that this is essentially defining a new cryptographic protocol that isn't formally specified anywhere. If so, it'd be good to have the specification right here, so someone doesn't need to go read through the implementation in order to figure out what the exact protocol is.\r\n\r\nThat makes it easier to separately review the protocol itself, and compare the implementation to that protocol.\r\n\r\nAs an example, see https://github.com/bitcoin-core/secp256k1/pull/1129/files#diff-d3089adfea8d8bbc31e130bb67389ab9ef45ea4abf4a79eceec63a037359f39dR10-R44 for example, which does so for ElligatorSwift.",
      "created_at": "2023-06-21T13:54:38Z",
      "updated_at": "2023-06-21T13:58:33Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1140#discussion_r1237044291",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1237044291"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1140"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 44,
      "original_line": 44,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1237047272",
      "pull_request_review_id": 1490779315,
      "id": 1237047272,
      "node_id": "PRRC_kwDOAP4Jqs5Ju9fo",
      "diff_hunk": "@@ -175,6 +244,82 @@ SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_schnorrsig_verify(\n     const secp256k1_xonly_pubkey *pubkey\n ) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(5);\n \n+/** Verify a sign-to-contract commitment.\n+ *\n+ *  Returns: 1: the signature contains a commitment to data32\n+ *           0: incorrect opening\n+ *  Args:    ctx: a secp256k1 context object, initialized for verification.\n+ *  In:    sig64: the signature containing the sign-to-contract commitment (cannot be NULL)\n+ *        data32: the 32-byte data that was committed to (cannot be NULL)\n+ *       opening: pointer to the opening created during signing (cannot be NULL)\n+ */\n+SECP256K1_API int secp256k1_schnorrsig_verify_s2c_commit(\n+    const secp256k1_context* ctx,\n+    const unsigned char *sig64,\n+    const unsigned char *data32,\n+    const secp256k1_schnorrsig_s2c_opening *opening\n+) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4);\n+\n+\n+/** Create the initial host commitment to `rho`. Part of the Anti-Exfil Protocol.",
      "path": "include/secp256k1_schnorrsig.h",
      "position": 173,
      "original_position": 140,
      "commit_id": "e6978c4150b06954a02e21efbdbeed796dc739b6",
      "original_commit_id": "fff7e5e167d12241ba22fed465b1ff8766541479",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Here as well, I think it'd be good to add a specification of the Anti-Exfil protocol, and/or references to such a specification.",
      "created_at": "2023-06-21T13:56:38Z",
      "updated_at": "2023-06-21T13:58:33Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1140#discussion_r1237047272",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1237047272"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1140"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 293,
      "original_line": 293,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1259467057",
      "pull_request_review_id": 1523846108,
      "id": 1259467057,
      "node_id": "PRRC_kwDOAP4Jqs5LEfEx",
      "diff_hunk": "@@ -69,26 +128,36 @@ SECP256K1_API_VAR const secp256k1_nonce_function_hardened secp256k1_nonce_functi\n  *  setting it to SECP256K1_SCHNORRSIG_EXTRAPARAMS_INIT.\n  *\n  *  Members:\n- *      magic: set to SECP256K1_SCHNORRSIG_EXTRAPARAMS_MAGIC at initialization\n- *             and has no other function than making sure the object is\n- *             initialized.\n- *    noncefp: pointer to a nonce generation function. If NULL,\n- *             secp256k1_nonce_function_bip340 is used\n- *      ndata: pointer to arbitrary data used by the nonce generation function\n- *             (can be NULL). If it is non-NULL and\n- *             secp256k1_nonce_function_bip340 is used, then ndata must be a\n- *             pointer to 32-byte auxiliary randomness as per BIP-340.\n+ *         magic: set to SECP256K1_SCHNORRSIG_EXTRAPARAMS_MAGIC at initialization\n+ *                and has no other function than making sure the object is\n+ *                initialized.\n+ *       noncefp: pointer to a nonce generation function. If NULL,\n+ *                secp256k1_nonce_function_bip340 is used\n+ *         ndata: pointer to arbitrary data used by the nonce generation function\n+ *                (can be NULL). If it is non-NULL and\n+ *                secp256k1_nonce_function_bip340 is used, then ndata must be a\n+ *                pointer to 32-byte auxiliary randomness as per BIP-340.\n+ *   s2c_opening: pointer to an secp256k1_schnorrsig_s2c_opening structure which can be\n+ *                NULL but is required to be not NULL if this signature creates\n+ *                a sign-to-contract commitment (i.e. the `s2c_data32` argument\n+ *                is not NULL).\n+ *    s2c_data32: pointer to a 32-byte data to create an optional\n+ *                sign-to-contract commitment to if not NULL (can be NULL).\n  */\n typedef struct {\n     unsigned char magic[4];\n     secp256k1_nonce_function_hardened noncefp;\n     void *ndata;\n+    secp256k1_schnorrsig_s2c_opening* s2c_opening;",
      "path": "include/secp256k1_schnorrsig.h",
      "position": 122,
      "original_position": 106,
      "commit_id": "e6978c4150b06954a02e21efbdbeed796dc739b6",
      "original_commit_id": "fff7e5e167d12241ba22fed465b1ff8766541479",
      "in_reply_to_id": 1237036918,
      "user": {
        "login": "benma",
        "id": 1225267,
        "node_id": "MDQ6VXNlcjEyMjUyNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1225267?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benma",
        "html_url": "https://github.com/benma",
        "followers_url": "https://api.github.com/users/benma/followers",
        "following_url": "https://api.github.com/users/benma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benma/subscriptions",
        "organizations_url": "https://api.github.com/users/benma/orgs",
        "repos_url": "https://api.github.com/users/benma/repos",
        "events_url": "https://api.github.com/users/benma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benma/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": ">  I believe the library will access uninitialized fields. Is that right?\r\n\r\nThat is right, good catch.\r\n\r\nThere could be multiple solutions:\r\n\r\n1. As you suggest, the magic can be used as a version field.\r\n2. The s2c_opening struct itself contains a magic field. Instead of calling `secp256k1_schnorrsig_s2c_opening_init(s2c_opening)` to initialize it inside the signing function, we could have the caller do this instead and check that the magic is set properly. \r\n3. not adding these fields to extraparams but add another function secp256k1_schneorrsig_sign_s2c instead.\r\n\r\nIt seems to me that option 2 is worse, as if the opening magic is not set properly (e.g. by a user using the old headers with the new library), then the function would error. This is better than proceeding silently, but it still is incompatible and forces the user act. The alternative to erroring is to ignore these fields to maintain compatibility, but that would be strange for new library users that want to use the functionality and don't see a proper error message when they fail to initialize the opening struct.\r\n\r\nOption 3 seems backwards as the point of `secp256k1_schnorrsig_extraparams` struct was, I presume, to be able to extend it in a backwards compatible fashion.\r\n\r\nOption 2 probably makes sense to do for the same reason that the extraparams struct is initialized by the user - to prevent corrupting memory in case the user passes the wrong pointer, and to possibly use it as a version field in the future.  \r\n\r\nTL;DR: I think defining a new magic in the extraparams struct is the best option, and we should also have the caller initialize the `secp256k1_schnorrsig_s2c_opening` struct with the magic. What do you think? \r\n\r\nAs a sidenote: maybe it would be a good to introduce a version check or init function for this library in general, so that if breaking changes are necessary in the future, it could be caught early at runtime.\r\n",
      "created_at": "2023-07-11T09:26:08Z",
      "updated_at": "2023-07-11T09:28:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1140#discussion_r1259467057",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1259467057"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1140"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 160,
      "original_line": 160,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1271333242",
      "pull_request_review_id": 1542134271,
      "id": 1271333242,
      "node_id": "PRRC_kwDOAP4Jqs5LxwF6",
      "diff_hunk": "@@ -69,26 +128,36 @@ SECP256K1_API_VAR const secp256k1_nonce_function_hardened secp256k1_nonce_functi\n  *  setting it to SECP256K1_SCHNORRSIG_EXTRAPARAMS_INIT.\n  *\n  *  Members:\n- *      magic: set to SECP256K1_SCHNORRSIG_EXTRAPARAMS_MAGIC at initialization\n- *             and has no other function than making sure the object is\n- *             initialized.\n- *    noncefp: pointer to a nonce generation function. If NULL,\n- *             secp256k1_nonce_function_bip340 is used\n- *      ndata: pointer to arbitrary data used by the nonce generation function\n- *             (can be NULL). If it is non-NULL and\n- *             secp256k1_nonce_function_bip340 is used, then ndata must be a\n- *             pointer to 32-byte auxiliary randomness as per BIP-340.\n+ *         magic: set to SECP256K1_SCHNORRSIG_EXTRAPARAMS_MAGIC at initialization\n+ *                and has no other function than making sure the object is\n+ *                initialized.\n+ *       noncefp: pointer to a nonce generation function. If NULL,\n+ *                secp256k1_nonce_function_bip340 is used\n+ *         ndata: pointer to arbitrary data used by the nonce generation function\n+ *                (can be NULL). If it is non-NULL and\n+ *                secp256k1_nonce_function_bip340 is used, then ndata must be a\n+ *                pointer to 32-byte auxiliary randomness as per BIP-340.\n+ *   s2c_opening: pointer to an secp256k1_schnorrsig_s2c_opening structure which can be\n+ *                NULL but is required to be not NULL if this signature creates\n+ *                a sign-to-contract commitment (i.e. the `s2c_data32` argument\n+ *                is not NULL).\n+ *    s2c_data32: pointer to a 32-byte data to create an optional\n+ *                sign-to-contract commitment to if not NULL (can be NULL).\n  */\n typedef struct {\n     unsigned char magic[4];\n     secp256k1_nonce_function_hardened noncefp;\n     void *ndata;\n+    secp256k1_schnorrsig_s2c_opening* s2c_opening;",
      "path": "include/secp256k1_schnorrsig.h",
      "position": 122,
      "original_position": 106,
      "commit_id": "e6978c4150b06954a02e21efbdbeed796dc739b6",
      "original_commit_id": "fff7e5e167d12241ba22fed465b1ff8766541479",
      "in_reply_to_id": 1237036918,
      "user": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The extraparams struct was built with the intention that `magic` acts as versioning for the struct and therefore allows backward-compatible changes (there's some mention of this in the original `schnorrsig_sign_custom` PR). I implemented a variant of the idea [here](https://github.com/jonasnick/versioned-param). I was imagining to change `schnorrsig_sign_custom` to something like this:\r\n\r\n```\r\nint secp256k1_schnorrsig_sign_custom(..., secp256k1_schnorrsig_extraparams *params_in) {\r\n    secp256k1_schnorrsig_extraparams params;\r\n\r\n    if (memcmp(params_in->magic, old_magic, sizeof(params_in->magic)) == 0) {\r\n        secp256k1_extraparams_old *params_tmp;\r\n        copy_old_into_new(&params, params_tmp);\r\n    } else if (memcmp(params_in->magic, SECP256K1_SCHNORRSIG_EXTRAPARAMS_MAGIC, sizeof(params_in->magic)) == 0) {\r\n        params = *params_in;\r\n    }\r\n    /* ... */\r\n}\r\n```\r\n\r\nWhile this does work in practice, I'm not sure how compliant this is with the C standard. It would access the old extraparams struct through a pointer to a new extraparams struct. Padding shouldn't be an issue here because it only accesses the first member of the struct.\r\n\r\nIt would be better if there was a solution where correctness is more obvious.",
      "created_at": "2023-07-22T19:09:30Z",
      "updated_at": "2023-07-22T19:09:30Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1140#discussion_r1271333242",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1271333242"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1140"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 160,
      "original_line": 160,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1275049992",
      "pull_request_review_id": 1547884556,
      "id": 1275049992,
      "node_id": "PRRC_kwDOAP4Jqs5L_7gI",
      "diff_hunk": "@@ -69,26 +128,36 @@ SECP256K1_API_VAR const secp256k1_nonce_function_hardened secp256k1_nonce_functi\n  *  setting it to SECP256K1_SCHNORRSIG_EXTRAPARAMS_INIT.\n  *\n  *  Members:\n- *      magic: set to SECP256K1_SCHNORRSIG_EXTRAPARAMS_MAGIC at initialization\n- *             and has no other function than making sure the object is\n- *             initialized.\n- *    noncefp: pointer to a nonce generation function. If NULL,\n- *             secp256k1_nonce_function_bip340 is used\n- *      ndata: pointer to arbitrary data used by the nonce generation function\n- *             (can be NULL). If it is non-NULL and\n- *             secp256k1_nonce_function_bip340 is used, then ndata must be a\n- *             pointer to 32-byte auxiliary randomness as per BIP-340.\n+ *         magic: set to SECP256K1_SCHNORRSIG_EXTRAPARAMS_MAGIC at initialization\n+ *                and has no other function than making sure the object is\n+ *                initialized.\n+ *       noncefp: pointer to a nonce generation function. If NULL,\n+ *                secp256k1_nonce_function_bip340 is used\n+ *         ndata: pointer to arbitrary data used by the nonce generation function\n+ *                (can be NULL). If it is non-NULL and\n+ *                secp256k1_nonce_function_bip340 is used, then ndata must be a\n+ *                pointer to 32-byte auxiliary randomness as per BIP-340.\n+ *   s2c_opening: pointer to an secp256k1_schnorrsig_s2c_opening structure which can be\n+ *                NULL but is required to be not NULL if this signature creates\n+ *                a sign-to-contract commitment (i.e. the `s2c_data32` argument\n+ *                is not NULL).\n+ *    s2c_data32: pointer to a 32-byte data to create an optional\n+ *                sign-to-contract commitment to if not NULL (can be NULL).\n  */\n typedef struct {\n     unsigned char magic[4];\n     secp256k1_nonce_function_hardened noncefp;\n     void *ndata;\n+    secp256k1_schnorrsig_s2c_opening* s2c_opening;",
      "path": "include/secp256k1_schnorrsig.h",
      "position": 122,
      "original_position": 106,
      "commit_id": "e6978c4150b06954a02e21efbdbeed796dc739b6",
      "original_commit_id": "fff7e5e167d12241ba22fed465b1ff8766541479",
      "in_reply_to_id": 1237036918,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> I'm not sure how compliant this is with the C standard.\r\n\r\nIf you read the standard strictly, then it's just UB to have conflicting declarations for the same function: https://stackoverflow.com/a/69620952 \r\n\r\nIn practice, and probably even with a more pragmatic reading of the standard, it's unclear what should go wrong. Following your example code, the callee will read the magic value by accessing bytes through an lvalue of type unsigned char. That's always allowed (even if the new struct type has stricter alignment requirements than the old struct type). Moreover, the magic is guaranteed to be at the beginning of the struct, and it's explicitly allowed to use pointers to a struct as pointers to the first element (after an appropriate cast). After determining the version, the callee will read the struct members through an lvalue of the correct type (not identical type with same name but  \"compatible type\"), which is also allowed.\r\n\r\nAs the callee starts with reading characters, it's very much like passing an unsigned char* directly to the function and then casting it a pointer to the right struct type. I think we can do this in practice.",
      "created_at": "2023-07-26T14:31:40Z",
      "updated_at": "2023-07-26T14:31:40Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1140#discussion_r1275049992",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1275049992"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1140"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 160,
      "original_line": 160,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1278445576",
      "pull_request_review_id": 1553487347,
      "id": 1278445576,
      "node_id": "PRRC_kwDOAP4Jqs5MM4gI",
      "diff_hunk": "@@ -69,26 +128,36 @@ SECP256K1_API_VAR const secp256k1_nonce_function_hardened secp256k1_nonce_functi\n  *  setting it to SECP256K1_SCHNORRSIG_EXTRAPARAMS_INIT.\n  *\n  *  Members:\n- *      magic: set to SECP256K1_SCHNORRSIG_EXTRAPARAMS_MAGIC at initialization\n- *             and has no other function than making sure the object is\n- *             initialized.\n- *    noncefp: pointer to a nonce generation function. If NULL,\n- *             secp256k1_nonce_function_bip340 is used\n- *      ndata: pointer to arbitrary data used by the nonce generation function\n- *             (can be NULL). If it is non-NULL and\n- *             secp256k1_nonce_function_bip340 is used, then ndata must be a\n- *             pointer to 32-byte auxiliary randomness as per BIP-340.\n+ *         magic: set to SECP256K1_SCHNORRSIG_EXTRAPARAMS_MAGIC at initialization\n+ *                and has no other function than making sure the object is\n+ *                initialized.\n+ *       noncefp: pointer to a nonce generation function. If NULL,\n+ *                secp256k1_nonce_function_bip340 is used\n+ *         ndata: pointer to arbitrary data used by the nonce generation function\n+ *                (can be NULL). If it is non-NULL and\n+ *                secp256k1_nonce_function_bip340 is used, then ndata must be a\n+ *                pointer to 32-byte auxiliary randomness as per BIP-340.\n+ *   s2c_opening: pointer to an secp256k1_schnorrsig_s2c_opening structure which can be\n+ *                NULL but is required to be not NULL if this signature creates\n+ *                a sign-to-contract commitment (i.e. the `s2c_data32` argument\n+ *                is not NULL).\n+ *    s2c_data32: pointer to a 32-byte data to create an optional\n+ *                sign-to-contract commitment to if not NULL (can be NULL).\n  */\n typedef struct {\n     unsigned char magic[4];\n     secp256k1_nonce_function_hardened noncefp;\n     void *ndata;\n+    secp256k1_schnorrsig_s2c_opening* s2c_opening;",
      "path": "include/secp256k1_schnorrsig.h",
      "position": 122,
      "original_position": 106,
      "commit_id": "e6978c4150b06954a02e21efbdbeed796dc739b6",
      "original_commit_id": "fff7e5e167d12241ba22fed465b1ff8766541479",
      "in_reply_to_id": 1237036918,
      "user": {
        "login": "benma",
        "id": 1225267,
        "node_id": "MDQ6VXNlcjEyMjUyNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1225267?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benma",
        "html_url": "https://github.com/benma",
        "followers_url": "https://api.github.com/users/benma/followers",
        "following_url": "https://api.github.com/users/benma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benma/subscriptions",
        "organizations_url": "https://api.github.com/users/benma/orgs",
        "repos_url": "https://api.github.com/users/benma/repos",
        "events_url": "https://api.github.com/users/benma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benma/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thanks for the helpful inputs everyone!\r\n\r\nI added a new commit `use the magic in the schnorrsig extraparams struct for versioning` that implements this for easier review. I can squash it in the end. Please take a look.",
      "created_at": "2023-07-29T22:34:35Z",
      "updated_at": "2023-07-29T22:34:35Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1140#discussion_r1278445576",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1278445576"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1140"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 160,
      "original_line": 160,
      "side": "RIGHT"
    }
  ]
}