{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519",
    "id": 1831748262,
    "node_id": "PR_kwDOAP4Jqs5tLkKm",
    "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519",
    "diff_url": "https://github.com/bitcoin-core/secp256k1/pull/1519.diff",
    "patch_url": "https://github.com/bitcoin-core/secp256k1/pull/1519.patch",
    "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1519",
    "commits_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1519/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin-core/secp256k1/statuses/ac591050262d9d00b629943d598f62b47e1ca7ae",
    "number": 1519,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "Add BIP352 `silentpayments` module",
    "user": {
      "login": "josibake",
      "id": 7444140,
      "node_id": "MDQ6VXNlcjc0NDQxNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/josibake",
      "html_url": "https://github.com/josibake",
      "followers_url": "https://api.github.com/users/josibake/followers",
      "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
      "organizations_url": "https://api.github.com/users/josibake/orgs",
      "repos_url": "https://api.github.com/users/josibake/repos",
      "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/josibake/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This PR adds a new Silent Payments ([BIP352](https://github.com/bitcoin/bips/pull/1458)) module to secp256k1. It is a continuation of the work started in https://github.com/bitcoin-core/secp256k1/pull/1471.\r\n\r\nThe module implements the full protocol, except for transaction input filtering and silent payment address encoding / decoding as those will be the responsibility of the wallet software. It is organized with functions for sending (prefixed with `_sender`) and receiving (prefixed by `_recipient`).\r\n\r\n#### For sending\r\n\r\n1. Collect private keys into two lists: `taproot_seckeys` and `plain_seckeys`\r\n    Two lists are used since the `taproot_seckeys` may need negation. `taproot_seckeys` are passed as keypairs to avoid the function needing to compute the public key to determine parity. `plain_seckeys` are passed as just secret keys\r\n2. Create the `_silentpayment_recipient` objects\r\n    These structs hold the scan and spend public key and an index for remembering the original ordering. It is expected that a caller will start with a list of silent payment addresses (with the desired amounts), convert these into an array of `recipients` and then match the generated outputs back to the original silent payment addresses. The index is used to return the generated outputs in the original order\r\n3. Call `silentpayments_sender_create_outputs` to generate the xonly public keys for the recipients\r\n    This function can be called with one or more recipients. The same recipient may be repeated to generate multiple outputs for the same recipient\r\n    \r\n#### For scanning\r\n\r\n1. Collect the public keys into two lists `taproot_pubkeys` and `plain_pubeys`\r\n    This avoids the caller needing to convert taproot public keys into compressed public keys (and vice versa)\r\n2. Compute the input data needed, i.e. sum the public keys and compute the `input_hash`\r\n    This is done as a separate step to allow the caller to reuse this output if scanning for multiple scan keys. It also allows a caller to use this function for aggregating the transaction inputs and storing them in an index to vend to light clients later (or for faster rescans when recovering a wallet)\r\n4. Call `silentpayments_recipient_scan_outputs` to scan the transaction outputs and return the tweak data (and optionally label information) needed for spending later\r\n\r\nIn addition, a few utility functions for labels are provided for the recipient for creating a label tweak and tweaked spend public key for their address. Finally, two functions are exposed in the API for supporting light clients, `_recipient_created_shared_secret` and `_recipient_create_output_pubkey`. These functions enable incremental scanning for scenarios where the caller does not have access to the transaction outputs:\r\n\r\n1. Calculating a shared secret\r\n    This is done as a separate step to allow the caller to reuse the shared secret result when creating outputs and avoid needing to do a costly ECDH every time they need to check for an additional output\r\n3. Generate an output (with `k = 0`)\r\n5. Check if the output exists in the UTXO set (using their preferred light client protocol)\r\n6. If the output exists, proceed by generating a new output from the shared secret with `k++`\r\n\r\nSee `examples/silentpayments.c` for a demonstration of how the API is expected to be used.\r\n\r\n### Note for reviewers\r\n\r\nMy immediate goal is to get feedback on the API so that I can pull this module into https://github.com/bitcoin/bitcoin/pull/28122 (silent payments in the bitcoin core wallet). That unblocks from finishing the bitcoin core PRs while work continues on this module.\r\n\r\n#### Notable differences between this PR and the previous version\r\n\r\nSee https://github.com/bitcoin-core/secp256k1/issues/1427 and https://github.com/bitcoin-core/secp256k1/pull/1471 for discussions on the API design. This iteration of the module attempts to be much more high level and incorporate the feedback from #1471. I also added a `secp256k1_silentpayments_public_data` opaque data type, which contains the summed public key and the input_hash. My motivation here was:\r\n\r\n1. I caught myself mixing up the order of arguments between `A_sum` and `recipient_spend_key`, which was impossible to catch with `ARG_CHECKS` and would result in the scanning process finishing without errors, but not finding any outputs\r\n2. Combining public key and input_hash into the same data type allows for completely hiding `input_hash` from the caller, which makes for an overall simpler API IMO\r\n\r\nI also removed the need for the recipient to generate a shared secret before using the `secp256k1_silentpayments_recipient_scan_outputs` function and instead create the shared secret inside the function.\r\n\r\n### Outstanding work\r\n\r\n- [ ] clean up the testing code\r\n- [ ] improve test coverage (currently only using the BIP352 test vectors)\r\n- [ ] optimize the implementation, where possible",
    "labels": [
      {
        "id": 4975353639,
        "node_id": "LA_kwDOAP4Jqs8AAAABKI3fJw",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/labels/feature",
        "name": "feature",
        "description": "",
        "color": "731E95",
        "default": false
      }
    ],
    "created_at": "2024-04-19T14:21:15Z",
    "updated_at": "2024-06-29T12:01:20Z",
    "mergeable": true,
    "mergeable_state": "clean",
    "merge_commit_sha": "fda66e29e26018d6815a97c663b6f549c8122429",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "josibake:bip352-silentpayments-module",
      "ref": "bip352-silentpayments-module",
      "sha": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 751433786,
        "node_id": "R_kgDOLMn4Og",
        "name": "secp256k1",
        "full_name": "josibake/secp256k1",
        "owner": {
          "login": "josibake",
          "id": 7444140,
          "node_id": "MDQ6VXNlcjc0NDQxNDA=",
          "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/josibake",
          "html_url": "https://github.com/josibake",
          "followers_url": "https://api.github.com/users/josibake/followers",
          "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
          "organizations_url": "https://api.github.com/users/josibake/orgs",
          "repos_url": "https://api.github.com/users/josibake/repos",
          "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/josibake/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/josibake/secp256k1",
        "description": "Optimized C library for EC operations on curve secp256k1",
        "fork": true,
        "url": "https://api.github.com/repos/josibake/secp256k1",
        "archive_url": "https://api.github.com/repos/josibake/secp256k1/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/josibake/secp256k1/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/josibake/secp256k1/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/josibake/secp256k1/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/josibake/secp256k1/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/josibake/secp256k1/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/josibake/secp256k1/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/josibake/secp256k1/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/josibake/secp256k1/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/josibake/secp256k1/contributors",
        "deployments_url": "https://api.github.com/repos/josibake/secp256k1/deployments",
        "downloads_url": "https://api.github.com/repos/josibake/secp256k1/downloads",
        "events_url": "https://api.github.com/repos/josibake/secp256k1/events",
        "forks_url": "https://api.github.com/repos/josibake/secp256k1/forks",
        "git_commits_url": "https://api.github.com/repos/josibake/secp256k1/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/josibake/secp256k1/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/josibake/secp256k1/git/tags%7B/sha%7D",
        "git_url": "git://github.com/josibake/secp256k1.git",
        "issue_comment_url": "https://api.github.com/repos/josibake/secp256k1/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/josibake/secp256k1/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/josibake/secp256k1/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/josibake/secp256k1/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/josibake/secp256k1/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/josibake/secp256k1/languages",
        "merges_url": "https://api.github.com/repos/josibake/secp256k1/merges",
        "milestones_url": "https://api.github.com/repos/josibake/secp256k1/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/josibake/secp256k1/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/josibake/secp256k1/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/josibake/secp256k1/releases%7B/id%7D",
        "ssh_url": "git@github.com:josibake/secp256k1.git",
        "stargazers_url": "https://api.github.com/repos/josibake/secp256k1/stargazers",
        "statuses_url": "https://api.github.com/repos/josibake/secp256k1/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/josibake/secp256k1/subscribers",
        "subscription_url": "https://api.github.com/repos/josibake/secp256k1/subscription",
        "tags_url": "https://api.github.com/repos/josibake/secp256k1/tags",
        "teams_url": "https://api.github.com/repos/josibake/secp256k1/teams",
        "trees_url": "https://api.github.com/repos/josibake/secp256k1/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/josibake/secp256k1.git",
        "hooks_url": "https://api.github.com/repos/josibake/secp256k1/hooks",
        "svn_url": "https://github.com/josibake/secp256k1",
        "language": "C",
        "forks_count": 1,
        "stargazers_count": 0,
        "watchers_count": 0,
        "size": 12126,
        "default_branch": "master",
        "open_issues_count": 1,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-06-29T11:58:28Z",
        "created_at": "2024-02-01T15:52:50Z",
        "updated_at": "2024-05-08T12:41:33Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin-core:master",
      "ref": "master",
      "sha": "a5269373fa13ff845f654d81b90629dd78495641",
      "user": {
        "login": "bitcoin-core",
        "id": 13464320,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEzNDY0MzIw",
        "avatar_url": "https://avatars.githubusercontent.com/u/13464320?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin-core",
        "html_url": "https://github.com/bitcoin-core",
        "followers_url": "https://api.github.com/users/bitcoin-core/followers",
        "following_url": "https://api.github.com/users/bitcoin-core/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin-core/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin-core/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin-core/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin-core/orgs",
        "repos_url": "https://api.github.com/users/bitcoin-core/repos",
        "events_url": "https://api.github.com/users/bitcoin-core/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin-core/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 16648618,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNjY0ODYxOA==",
        "name": "secp256k1",
        "full_name": "bitcoin-core/secp256k1",
        "owner": {
          "login": "bitcoin-core",
          "id": 13464320,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjEzNDY0MzIw",
          "avatar_url": "https://avatars.githubusercontent.com/u/13464320?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin-core",
          "html_url": "https://github.com/bitcoin-core",
          "followers_url": "https://api.github.com/users/bitcoin-core/followers",
          "following_url": "https://api.github.com/users/bitcoin-core/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin-core/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin-core/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin-core/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin-core/orgs",
          "repos_url": "https://api.github.com/users/bitcoin-core/repos",
          "events_url": "https://api.github.com/users/bitcoin-core/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin-core/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin-core/secp256k1",
        "description": "Optimized C library for EC operations on curve secp256k1",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1",
        "archive_url": "https://api.github.com/repos/bitcoin-core/secp256k1/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin-core/secp256k1/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin-core/secp256k1/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin-core/secp256k1/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin-core/secp256k1/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin-core/secp256k1/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin-core/secp256k1/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin-core/secp256k1/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin-core/secp256k1/downloads",
        "events_url": "https://api.github.com/repos/bitcoin-core/secp256k1/events",
        "forks_url": "https://api.github.com/repos/bitcoin-core/secp256k1/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin-core/secp256k1.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin-core/secp256k1/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin-core/secp256k1/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin-core/secp256k1/languages",
        "merges_url": "https://api.github.com/repos/bitcoin-core/secp256k1/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin-core/secp256k1/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin-core/secp256k1/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin-core/secp256k1/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin-core/secp256k1.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin-core/secp256k1/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin-core/secp256k1/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin-core/secp256k1/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin-core/secp256k1/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin-core/secp256k1/tags",
        "teams_url": "https://api.github.com/repos/bitcoin-core/secp256k1/teams",
        "trees_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin-core/secp256k1.git",
        "hooks_url": "https://api.github.com/repos/bitcoin-core/secp256k1/hooks",
        "svn_url": "https://github.com/bitcoin-core/secp256k1",
        "language": "C",
        "forks_count": 973,
        "stargazers_count": 2005,
        "watchers_count": 2005,
        "size": 11920,
        "default_branch": "master",
        "open_issues_count": 136,
        "is_template": false,
        "topics": [],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-06-29T11:58:30Z",
        "created_at": "2014-02-08T17:30:06Z",
        "updated_at": "2024-06-29T10:12:55Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 6281,
    "deletions": 12,
    "changed_files": 20,
    "commits": 14,
    "review_comments": 63,
    "comments": 14
  },
  "events": [
    {
      "event": "labeled",
      "id": 12541859026,
      "node_id": "LE_lADOAP4Jqs6GTERUzwAAAALrjZTS",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/12541859026",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-19T16:18:02Z",
      "label": {
        "name": "feature",
        "color": "731E95"
      }
    },
    {
      "event": "reviewed",
      "id": 2015096769,
      "node_id": "PRR_kwDOAP4Jqs54G-_B",
      "url": null,
      "actor": null,
      "commit_id": "3d080277895655e8274ee73aacd154c4ead143e3",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK\r\n\r\nLeft some initial feedback, especially around the scanning routine, will do an in-depth review round soon. Didn't look closer at the `public_data` type routines and the examples yet.",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#pullrequestreview-2015096769",
      "submitted_at": "2024-04-22T16:26:35Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12588114369,
      "node_id": "HRFPE_lADOAP4Jqs6GTERUzwAAAALuT2HB",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/12588114369",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-24T08:38:21Z"
    },
    {
      "event": "commented",
      "id": 2074419309,
      "node_id": "IC_kwDOAP4Jqs57pSBt",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/2074419309",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-24T08:45:36Z",
      "updated_at": "2024-04-24T08:45:36Z",
      "author_association": "MEMBER",
      "body": "Rebased on #1518 (https://github.com/bitcoin-core/secp256k1/commit/3d080277895655e8274ee73aacd154c4ead143e3 -> https://github.com/bitcoin-core/secp256k1/commit/8b48bf19c3c020e653734f6c9d9364e6a47a30d1, [compare](https://github.com/josibake/secp256k1/compare/bip352-silentpayments-module-01..josibake:secp256k1:bip352-silentpayments-module-rebase))",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#issuecomment-2074419309",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1519"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12588974018,
      "node_id": "HRFPE_lADOAP4Jqs6GTERUzwAAAALuXH_C",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/12588974018",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-24T09:38:43Z"
    },
    {
      "event": "commented",
      "id": 2074531708,
      "node_id": "IC_kwDOAP4Jqs57ptd8",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/2074531708",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-24T09:39:20Z",
      "updated_at": "2024-04-24T09:39:20Z",
      "author_association": "MEMBER",
      "body": "Updated https://github.com/bitcoin-core/secp256k1/commit/8b48bf19c3c020e653734f6c9d9364e6a47a30d1 -> https://github.com/bitcoin-core/secp256k1/commit/f5585d4b93606144e76e45ad3d43a797a9afefcf ([bip352-silentpayments-module-rebase](https://github.com/josibake/secp256k1/tree/bip352-silentpayments-module-rebase) -> [bip352-silentpayments-module-02](https://github.com/josibake/secp256k1/tree/bip352-silentpayments-module-02), [compare](https://github.com/josibake/secp256k1/compare/bip352-silentpayments-module-rebase..josibake:secp256k1:bip352-silentpayments-module-02)):\r\n\r\n* Fix function documentation for `_recipient_scan_outputs`\r\n* Replace `VERIFY_CHECK` with `return 0;` in `_sender_create_outputs`\r\n* Remove unneeded `declassify` code from `_sender_create_outputs`\r\n* Change `_gej_add_ge` to `_gej_add_var` in `_recipient_public_data_create`\r\n* Fix label scanning in `_recipient_scan_outputs`\r\n* Remove unneeded prints from the tests\r\n\r\nFor the label scanning, I looked for an example of using an invalid public key but didn't see anything except for the `invalid_pubkey_bytes` in the tests. For now, if the output is found without a label, I'm setting `found_with_label = 0` and saving the found output in both the `output` and `label` field. Happy to change this if there is a better suggestion for communicating an invalid public key.\r\n\r\nI also used `secp256k1_pubkey_save` instead of `output = *tx_outputs`, as I think this makes the code more clear.",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#issuecomment-2074531708",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1519"
    },
    {
      "event": "reviewed",
      "id": 2026864465,
      "node_id": "PRR_kwDOAP4Jqs54z39R",
      "url": null,
      "actor": null,
      "commit_id": "f5585d4b93606144e76e45ad3d43a797a9afefcf",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Second review round through, looks good so far! Left a bunch of nits, mostly about naming and missing ARG_CHECKS etc.",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#pullrequestreview-2026864465",
      "submitted_at": "2024-04-28T01:45:47Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12693217589,
      "node_id": "HRFPE_lADOAP4Jqs6GTERUzwAAAAL0kyE1",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/12693217589",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-03T08:03:39Z"
    },
    {
      "event": "mentioned",
      "id": 12693287039,
      "node_id": "MEE_lADOAP4Jqs6GTERUzwAAAAL0lDB_",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/12693287039",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-03T08:10:24Z"
    },
    {
      "event": "subscribed",
      "id": 12693287051,
      "node_id": "SE_lADOAP4Jqs6GTERUzwAAAAL0lDCL",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/12693287051",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-03T08:10:24Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12693404541,
      "node_id": "HRFPE_lADOAP4Jqs6GTERUzwAAAAL0lft9",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/12693404541",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-03T08:21:32Z"
    },
    {
      "event": "commented",
      "id": 2092544520,
      "node_id": "IC_kwDOAP4Jqs58ubII",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/2092544520",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-03T08:25:39Z",
      "updated_at": "2024-05-03T08:25:39Z",
      "author_association": "MEMBER",
      "body": "Thanks for the thorough review, @theStack ! I've addressed your feedback, along with some other changes.\r\n\r\n---\r\nUpdate https://github.com/bitcoin-core/secp256k1/commit/f5585d4b93606144e76e45ad3d43a797a9afefcf -> https://github.com/bitcoin-core/secp256k1/commit/1a3a00bd0999a89e30d5dc9f927592ead72ab7a3 ([bip352-silentpayments-module-02](https://github.com/josibake/secp256k1/tree/bip352-silentpayments-module-02) -> [bip352-silentpayments-module-03](https://github.com/josibake/secp256k1/tree/bip352-silentpayments-module-03), [compare](https://github.com/josibake/secp256k1/compare/bip352-silentpayments-module-02..josibake:secp256k1:bip352-silentpayments-module-03))\r\n\r\n* Spelling and wording cleanups, notably:\r\n  *  `s/receiver/recipient/`, `s/labeled/labelled/`\r\n  * `s/scan_seckey/scan_key/`\r\n* Reduce duplicate code in `scan_outputs`\r\n* Add `ARG_CHECK`s\r\n* Update tests\r\n* Add benchmark for `scan_outputs`\r\n\r\nThe sending tests now check that the generated outputs match exactly one of the possible expected output sets. Previously, the sending tests were checking that the generated outputs exist in the array of all possible outputs, but this wouldn't catch a bug where `k` is not being set correctly e.g.  *[A<sub>k=0</sub>, B<sub>k=0</sub>]* would (incorrectly) pass *[A<sub>k=0</sub>, B<sub>k=1</sub>, A<sub>k=1</sub>, B<sub>k=0</sub>]* but will now (correctly) fail *[[A<sub>k=0</sub>, B<sub>k=1</sub>], [A<sub>k=1</sub>, B<sub>k=0</sub>]]*",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#issuecomment-2092544520",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1519"
    },
    {
      "event": "mentioned",
      "id": 12693448859,
      "node_id": "MEE_lADOAP4Jqs6GTERUzwAAAAL0lqib",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/12693448859",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-03T08:25:40Z"
    },
    {
      "event": "subscribed",
      "id": 12693448875,
      "node_id": "SE_lADOAP4Jqs6GTERUzwAAAAL0lqir",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/12693448875",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-03T08:25:40Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12695113793,
      "node_id": "HRFPE_lADOAP4Jqs6GTERUzwAAAAL0sBBB",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/12695113793",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-03T11:11:55Z"
    },
    {
      "event": "commented",
      "id": 2092802286,
      "node_id": "IC_kwDOAP4Jqs58vaDu",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/2092802286",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-03T11:17:30Z",
      "updated_at": "2024-05-03T11:17:30Z",
      "author_association": "MEMBER",
      "body": "Rebased on #1518 https://github.com/bitcoin-core/secp256k1/commit/1a3a00bd0999a89e30d5dc9f927592ead72ab7a3 -> https://github.com/bitcoin-core/secp256k1/commit/92f592023f3f4d6a66724772349fbdc4967ab50f ([bip352-silentpayments-module-03](https://github.com/josibake/secp256k1/tree/bip352-silentpayments-module-03) -> [bip352-silentpayments-module-03-rebase](https://github.com/josibake/secp256k1/tree/bip352-silentpayments-module-03-rebase), [compare](https://github.com/josibake/secp256k1/compare/bip352-silentpayments-module-03..josibake:secp256k1:bip352-silentpayments-module-03-rebase))",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#issuecomment-2092802286",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1519"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12743423674,
      "node_id": "HRFPE_lADOAP4Jqs6GTERUzwAAAAL3kTa6",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/12743423674",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-08T12:48:24Z"
    },
    {
      "event": "commented",
      "id": 2100507478,
      "node_id": "IC_kwDOAP4Jqs59MzNW",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/2100507478",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-08T12:50:33Z",
      "updated_at": "2024-05-08T12:50:33Z",
      "author_association": "MEMBER",
      "body": "Rebased on master (following #1518 merge) https://github.com/bitcoin-core/secp256k1/commit/92f592023f3f4d6a66724772349fbdc4967ab50f -> https://github.com/bitcoin-core/secp256k1/commit/56ed901b6a2239e8b44a1a3f084bd38b9e86d769 ([bip352-silentpayments-module-03-rebase](https://github.com/josibake/secp256k1/tree/bip352-silentpayments-module-03-rebase) -> [bip352-silentpayments-module-04-rebase](https://github.com/josibake/secp256k1/tree/bip352-silentpayments-module-04-rebase), [compare](https://github.com/josibake/secp256k1/compare/bip352-silentpayments-module-03-rebase..josibake:secp256k1:bip352-silentpayments-module-04-rebase))",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#issuecomment-2100507478",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1519"
    },
    {
      "event": "reviewed",
      "id": 2082332210,
      "node_id": "PRR_kwDOAP4Jqs58Hd4y",
      "url": null,
      "actor": null,
      "commit_id": "56ed901b6a2239e8b44a1a3f084bd38b9e86d769",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Went through another round. To the best of my knowledge, this PR matches the BIP352 specification and I'm close to non-cryptographer-light-ACKing it :-)\r\n\r\nFound some nits an one open TODO that should probably be discussed though.",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#pullrequestreview-2082332210",
      "submitted_at": "2024-05-28T18:19:37Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKGI1MmRjYjBiYzU2YzEyYTU2NjlkM2ZiZDAwM2NlZGU0NzQ0NmI1N2M",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/b52dcb0bc56c12a5669d3fbd003cede47446b57c",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/b52dcb0bc56c12a5669d3fbd003cede47446b57c",
      "tree": {
        "sha": "c65de6208af0471cb83cb2e325ebe3739ad262bc",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/c65de6208af0471cb83cb2e325ebe3739ad262bc"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree c65de6208af0471cb83cb2e325ebe3739ad262bc\nparent 1791f6fce4d4856a4ce2b1982768a4ffa23fcc0a\nauthor Sebastian Falbesoner <sebastian.falbesoner@gmail.com> 1695828134 +0200\ncommitter josibake <josibake@protonmail.com> 1717156816 +0200\n\nbuild: add skeleton for new silentpayments (BIP352) module\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmZZu9AACgkQity1WMTz\nPWXYmhAArCgwYemZFHPzflllytCdAmQjfX/Fej2Q1krkUdmRVv5jICE5HmpZK2RA\nvuWZbmtK4txuV7x8O3tVVXvbsBWpexpn/rrQKT4oxvG74Xvo+ELv9aOst/5+pRmo\nD3RYWIt68W0WbTyiZxMFEuWSv90PV/jERrSPAY9Kj5KTNaBRKtcMuc8gJDjwe39o\nXgbcgdihYuOQpVLEkiagdsiFyCxySPqZFHHYS6TaMF+W+wduHuz+hKykPvHtukSt\nY+p36W/o2VsE2nXQA9vjrqCYOXOEt/LNzXR6xwrjis2LtYgq0KSChmzJQVvTu+Rk\n11QZEyrntLrbZbI+QMM5wMlbZzWH/9DQmYq+YbPYz4R+xFXqMCzhA5K8nKsI1/vz\nLzcou1Ix26bsjEhaANPA7CKBtBi+jzJQBS+i+SQ+YniHNr6BCOb1RdyQXENyxDOm\nYZBizTdnN22oqM1BrbJPZBrtj3Qlfz8XSUBuPQbBVKdeYmXogPWgQBo/qkhRDXXs\n4MCSkpxEvISKcRvPk01NmDOxzNw5pGuMWemKPxRkOdI3gVfD55gbHVs4f4g/sgey\nxqIaxCn3cQtBM2merlOiK5Fx7JIaLuBBZF045s9pG4YkWNW0UcYg4ZkPY7SR853y\nBO8uyVSwQ5zBbBusx4wZjg/OTmc7S5oQ/YUn/AvcSGFZ66PuCYs=\n=T9Nu\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/1791f6fce4d4856a4ce2b1982768a4ffa23fcc0a",
          "sha": "1791f6fce4d4856a4ce2b1982768a4ffa23fcc0a",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/1791f6fce4d4856a4ce2b1982768a4ffa23fcc0a"
        }
      ],
      "message": "build: add skeleton for new silentpayments (BIP352) module",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-05-31T12:00:16Z"
      },
      "author": {
        "name": "Sebastian Falbesoner",
        "email": "sebastian.falbesoner@gmail.com",
        "date": "2023-09-27T15:22:14Z"
      },
      "sha": "b52dcb0bc56c12a5669d3fbd003cede47446b57c"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDAxZDZlNDYxYTVkYjg1YTgwODM5Yzc2M2IzYWYxNjAyYmQ2MzU0ZWE",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/01d6e461a5db85a80839c763b3af1602bd6354ea",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/01d6e461a5db85a80839c763b3af1602bd6354ea",
      "tree": {
        "sha": "9ee57616fd220afabdd53159b4266d00410ad117",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/9ee57616fd220afabdd53159b4266d00410ad117"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 9ee57616fd220afabdd53159b4266d00410ad117\nparent b52dcb0bc56c12a5669d3fbd003cede47446b57c\nauthor Sebastian Falbesoner <sebastian.falbesoner@gmail.com> 1703345298 +0100\ncommitter josibake <josibake@protonmail.com> 1717156822 +0200\n\ndoc: add module description for silentpayments\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmZZu9YACgkQity1WMTz\nPWXiig//SV+SsHKwB0djHqI5hyFRkSjKM1rcNqXU5PgTr5+QiI1eJFy8rbGDgLRn\nXiWFXwlGy5EcYucaBIxqli5dGgqWSGJn5VI38Dh8BvIoWVdrMaz85Ll2sQR/C6Y6\nGss6Bgxax7wW/EbdHraB/k4dwMD0jxIKYxzyYAA/AMGXBWiC6/T+sHOgsWIR6rZD\n4XXTO2wFUcwYB8dTEqnS3I4SH5dJAUEI77Z/TPTsE+96nfU5i9rSGJFg8sxtg6r0\nvKkGrufp5Ag2rKbkHVm6cBr3XEwVgUZzmJuI4no+HWr5+b76sKkkSHGLTwPEGOPB\nmR79AHuUqE1Ga0nf78ynfSRAODwje/fG6qwCeidXTbeM8fzv3zrFyK2DUYXmgNi3\n04nM73Ae8UCzq2PCsWOoFH6Y1XCdntazqJiqSANfOfgfyffcUQRu8JvVlsCS2FwL\nB007fUtfHdmrV+BU8jeU9Z5n/FQe475+zJtSc5g+j+tyYRhfRHkYBkVU/wwuVX0H\nd3oNFpZBwvO4v7cRWJkLHnU7RWjdIR2NOUQkhoqocRU45KNTdN15iKTdW9ct4EWV\nuQdNHnJH1wL2nWIvzFlXunWI7ltLUR049nnWSWFpCoOUKQ3Fk8HmmWQfHSzqODDv\n3PpdwfRpgF6gSRew8t44atBF3G80dwOoodlE8D4iq3VgVLCH8KY=\n=THjP\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/b52dcb0bc56c12a5669d3fbd003cede47446b57c",
          "sha": "b52dcb0bc56c12a5669d3fbd003cede47446b57c",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/b52dcb0bc56c12a5669d3fbd003cede47446b57c"
        }
      ],
      "message": "doc: add module description for silentpayments",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-05-31T12:00:22Z"
      },
      "author": {
        "name": "Sebastian Falbesoner",
        "email": "sebastian.falbesoner@gmail.com",
        "date": "2023-12-23T15:28:18Z"
      },
      "sha": "01d6e461a5db85a80839c763b3af1602bd6354ea"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKGIwODY2YTI5MTJjNTU1OWIxNmE4MmYwYjZkMzA2MWFjZDk4MDkwNDM",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/b0866a2912c5559b16a82f0b6d3061acd9809043",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/b0866a2912c5559b16a82f0b6d3061acd9809043",
      "tree": {
        "sha": "8be95369b37ecc6d26c6132fc05b5b8cac218951",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/8be95369b37ecc6d26c6132fc05b5b8cac218951"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 8be95369b37ecc6d26c6132fc05b5b8cac218951\nparent 01d6e461a5db85a80839c763b3af1602bd6354ea\nauthor josibake <josibake@protonmail.com> 1711383817 +0100\ncommitter josibake <josibake@protonmail.com> 1717157206 +0200\n\nsilentpayments: add sortable recipient struct\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmZZvVoACgkQity1WMTz\nPWVpSA/+MuWRJL/seODayYqMVEBmpeSXMEswk0eDr4ZIac29wF3cgYXvQ7YM2J7C\nonWPQmbMhMUaXzIB9u2zcIy2f6H3mUDShfrQ9XABGKAOROLMZzmqg+EyNF7mbV0F\nPIe4ugCMP+BzI2bsFu31xVsfpdkgdaW9LqfRLduP9zSU7Y9VlBG5TijVj6tMX+0p\nnYp3NSc5wMaJ87nVFvK30aIrL9yHecvDB0Cu9wUxdmo9iJqhvs3o7RSVXmfs2Rea\nvPWGk+HwqUAbWav13MYBmCJMmwBZxbjT2sxZUjNgLWxdhxVjJBy2FMt3RQSzSVtQ\nnmimBkjuk6ADLFbAc1+Xo/x+IUCoOAaOsXO+CP+aNyXMrMgjgkatDZQ/ecbPw/D6\nf1mfdJ7z17vV+5O48HIl7Kru0bOt3oJuBHVyoGJPRxYxUr6lLVfVlTTjP1sz2f7h\nWCG2WOtLPDtLY0Fu7Juw98qGlVHob3qXoR8eai6jzevIGhnKKtgtx5w4Z7259PV6\nec+OJ3h+2F0W9f882fr/L1bo/BhHFy6VnJz9qppUZTB3me8sibrzweS58hdFKi4g\naZJXNSdaZWCZZeOUi59aOekq0PTfBoQytYWMcMJLltv32OONA3c1RmjQZmVhfh8Z\nZ5wFR6+zzi81+EGWhcHCOOY3Aeij0HFIsnykvAseHkUq5IQA2tY=\n=NxVu\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/01d6e461a5db85a80839c763b3af1602bd6354ea",
          "sha": "01d6e461a5db85a80839c763b3af1602bd6354ea",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/01d6e461a5db85a80839c763b3af1602bd6354ea"
        }
      ],
      "message": "silentpayments: add sortable recipient struct",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-05-31T12:06:46Z"
      },
      "author": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-03-25T16:23:37Z"
      },
      "sha": "b0866a2912c5559b16a82f0b6d3061acd9809043"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12999995271,
      "node_id": "HRFPE_lADOAP4Jqs6GTERUzwAAAAMG3C-H",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/12999995271",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-31T12:34:48Z"
    },
    {
      "event": "commented",
      "id": 2142009213,
      "node_id": "IC_kwDOAP4Jqs5_rHd9",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/2142009213",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-31T12:36:59Z",
      "updated_at": "2024-05-31T12:36:59Z",
      "author_association": "MEMBER",
      "body": "Rebased on master to fix merge conflict https://github.com/bitcoin-core/secp256k1/commit/56ed901b6a2239e8b44a1a3f084bd38b9e86d769 ->  https://github.com/bitcoin-core/secp256k1/commit/bd66eaa22acf434f0134d7f93c4fb694303708c3 ([bip352-silentpayments-module-04-rebase](https://github.com/josibake/secp256k1/tree/bip352-silentpayments-module-04-rebase) -> [bip352-silentpayments-module-05-rebase](https://github.com/josibake/secp256k1/tree/bip352-silentpayments-module-05-rebase), [compare](https://github.com/josibake/secp256k1/compare/bip352-silentpayments-module-04-rebase..josibake:secp256k1:bip352-silentpayments-module-05-rebase))",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#issuecomment-2142009213",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1519"
    },
    {
      "event": "commented",
      "id": 2142037343,
      "node_id": "IC_kwDOAP4Jqs5_rOVf",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/2142037343",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-31T12:45:21Z",
      "updated_at": "2024-05-31T12:45:21Z",
      "author_association": "MEMBER",
      "body": "CI failure seems related to not being able to install valgrind via homebrew and unrelated to my change so ignoring for now (cc @real-or-random for confirmation?). ",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#issuecomment-2142037343",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1519"
    },
    {
      "event": "mentioned",
      "id": 13000125756,
      "node_id": "MEE_lADOAP4Jqs6GTERUzwAAAAMG3i08",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/13000125756",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-31T12:45:22Z"
    },
    {
      "event": "subscribed",
      "id": 13000125772,
      "node_id": "SE_lADOAP4Jqs6GTERUzwAAAAMG3i1M",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/13000125772",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-31T12:45:22Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13000777915,
      "node_id": "HRFPE_lADOAP4Jqs6GTERUzwAAAAMG6CC7",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/13000777915",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-31T13:37:03Z"
    },
    {
      "event": "commented",
      "id": 2142198112,
      "node_id": "IC_kwDOAP4Jqs5_r1lg",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/2142198112",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-31T13:45:02Z",
      "updated_at": "2024-05-31T13:45:02Z",
      "author_association": "MEMBER",
      "body": "Thanks for the review @theStack ! Sorry for the slow response, I somehow missed the notification for your review :sweat_smile: \r\n\r\n---\r\n\r\nUpdate https://github.com/bitcoin-core/secp256k1/commit/bd66eaa22acf434f0134d7f93c4fb694303708c3 -> https://github.com/bitcoin-core/secp256k1/commit/2dde8f1fa13687d2bd8328f85ac412a4052b040c ([bip352-silentpayments-module-05-rebase](https://github.com/josibake/secp256k1/tree/bip352-silentpayments-module-05-rebase) -> [bip352-silentpayments-module-06](https://github.com/josibake/secp256k1/tree/bip352-silentpayments-module-06), [compare](https://github.com/josibake/secp256k1/compare/bip352-silentpayments-module-05-rebase..josibake:secp256k1:bip352-silentpayments-module-06))\r\n\r\n* spelling, grammar, and fixups per @theStack 's review\r\n* Added `ARG_CHECK`s to check for the sum of the private keys / public keys being zero\r\n\r\nPer https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1617720108, I agree returning 0 is not the right thing to do, but having multiple error codes also seemed gross. I think an `ARG_CHECK` makes sense here because if the caller passed all valid seckeys / pubkeys and then they sum to zero, in principle its the caller passing incorrect arguments. The only thing the caller can do at this point is try again with different arguments. For the sender, this would mean repeating coin selection to get a different input set, and for the recipient this would mean skipping the transaction and moving on to the next one. Also happy to change if there is a better suggestion!",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#issuecomment-2142198112",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1519"
    },
    {
      "event": "mentioned",
      "id": 13000887002,
      "node_id": "MEE_lADOAP4Jqs6GTERUzwAAAAMG6cra",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/13000887002",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-31T13:45:03Z"
    },
    {
      "event": "subscribed",
      "id": 13000887022,
      "node_id": "SE_lADOAP4Jqs6GTERUzwAAAAMG6cru",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/13000887022",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-31T13:45:03Z"
    },
    {
      "event": "commented",
      "id": 2142338498,
      "node_id": "IC_kwDOAP4Jqs5_sX3C",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/2142338498",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-31T14:22:24Z",
      "updated_at": "2024-05-31T14:22:24Z",
      "author_association": "CONTRIBUTOR",
      "body": "> CI failure seems related to not being able to install valgrind via homebrew and unrelated to my change so ignoring for now (cc @real-or-random for confirmation?). \r\n\r\nIndeed, see https://github.com/bitcoin-core/secp256k1/issues/1536\r\n\r\n",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#issuecomment-2142338498",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1519"
    },
    {
      "event": "mentioned",
      "id": 13001464326,
      "node_id": "MEE_lADOAP4Jqs6GTERUzwAAAAMG8poG",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/13001464326",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-31T14:22:25Z"
    },
    {
      "event": "subscribed",
      "id": 13001464349,
      "node_id": "SE_lADOAP4Jqs6GTERUzwAAAAMG8pod",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/13001464349",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-31T14:22:25Z"
    },
    {
      "event": "commented",
      "id": 2142599641,
      "node_id": "IC_kwDOAP4Jqs5_tXnZ",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/2142599641",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-31T16:23:47Z",
      "updated_at": "2024-05-31T16:24:22Z",
      "author_association": "CONTRIBUTOR",
      "body": "\r\n## Some general notes\r\n### On error handling in general\r\nError handling is hard, and the caller usually can't really recover from an error anyway. This is in particular true on malicious inputs:  there's no reason to try to continue dealing with the attacker, and you simply want to abort. That's why, as a general rule, we try to avoid error paths as much as possible. This usually boils down to merging all errors into a single one, i.e., *a)* have just a single error \"code\" for all possible errors, *b)* and in the case of a multi-stage thing involving multiple function calls, have just a single place where errors are returned. \r\n\r\nSignature verification is a good example. A (signature, message, pubkey) triple is either valid or not. The caller *should not* care why exactly a signature fails to verify, so we don't even want to expose this to the caller.\r\n\r\n However, signature verification this is also a nice example of a case in which we stretch the rules a bit. Signature verification is implemented as two-stage process: 1. Parse the public key (which can fail). 2. Check the signature (which can fail). Purely from a \"safe\" API point of view, this is not great because we give the user two functions and two error paths instead of one. Ideally, there could just be one verification function which also takes care of parsing (this is how it's defined BIP340). The primary reason why we want to have a separate parsing function in this case is performance: if you check several signatures under the same key, you don't want to parse, which involves computing the y-coordinate, every time.\r\n\r\n### ARG_CHECK\r\n`ARG_CHECK` will call the \"illegal (argument) callback\", which, by default, crashes. See the docs here: https://github.com/bitcoin-core/secp256k1/blob/1791f6fce4d4856a4ce2b1982768a4ffa23fcc0a/include/secp256k1.h#L324 The callback/crash indicates to the caller that there's a bug in the caller's code.\r\n\r\n## What does this mean for this discussion?\r\n> * Added `ARG_CHECK`s to check for the sum of the private keys / public keys being zero\r\n> \r\n> \r\n> Per [#1519 (comment)](https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1617720108), I agree returning 0 is not the right thing to do, but having multiple error codes also seemed gross. I think an `ARG_CHECK` makes sense here because if the caller passed all valid seckeys / pubkeys and then they sum to zero, in principle its the caller passing incorrect arguments. The only thing the caller can do at this point is try again with different arguments. For the sender, this would mean repeating coin selection to get a different input set, and for the recipient this would mean skipping the transaction and moving on to the next one. Also happy to change if there is a better suggestion!\r\n\r\nSo let's take a look at the two sides:\r\n\r\n### On the sender side: The secret keys sum up to zero (`sum_i a_i = 0`)\r\nThis will happen only with negligible probability for honestly generated (=random) secret keys. That is, this will in practice only happen if the caller has a bug, or the caller has been tricked into using these secret keys, e.g., if someone else has crafted malicious secret keys for the caller. Since the latter is not a crazy scenario, we should not use `ARG_CHECK` here. \r\n\r\nWe can just return 0 here to indicate to the caller that we can't continue with these function inputs. And even if there are other error cases, I don't see a reason why the caller code should care much about why the function fails. As long as you call the function with honestly generated inputs, everything will work out. (Devs will be interested in the exact failure case when debugging the caller's code, but I think they can figure out during debugging then. \"Normal\" caller code should get just a single error code.)\r\n\r\n### On the recipient side: The public keys sum up to infinity (`sum_i A_i = 0`) [1]\r\nAgain, this can only happen if the sender is malicious. But since we're not the sender, it's entirely possible that the sender is malicious. And then these inputs are certainly legal, they're just not valid. (In the same sense as it's perfectly legal to use the signature verification algorithm on an invalid signature.) So an `ARG_CHECK` will not be appropriate at all: a malicious sender could trigger it and crash the scanning process. \r\n\r\nWe should also simply return 0 to indicate that this transaction is not well-formed/not eligible for SP. And again, even if there are other error cases, I don't see a reason why the caller should care why this transaction is not eligible.\r\n\r\nAlternatively, we could even return 1, store infinity in the `public_data`, and simply make sure that scanning won't find any payments in that case.  This would avoid the error path for this function entirely. But if the caller then calls `secp256k1_silentpayments_recipient_create_shared_secret`, I think we'd just postpone the error to this function, and for this function, I don't see another way than returning an error. So I'm not convinced that this is better. \r\n\r\n\r\n[1] We should perhaps rename \"infinity\" to \"zero\"... ;)\r\n",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#issuecomment-2142599641",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1519"
    },
    {
      "event": "commented",
      "id": 2142745728,
      "node_id": "IC_kwDOAP4Jqs5_t7SA",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/2142745728",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-31T18:06:38Z",
      "updated_at": "2024-06-01T12:08:10Z",
      "author_association": "MEMBER",
      "body": "@real-or-random thanks for the response, this is super helpful.\r\n\r\n> Devs will be interested in the exact failure case when debugging the caller's code, but I think they can figure out during debugging then\r\n\r\nIn hindsight, I think my preference for `ARG_CHECK` was \"better error messages as to what went wrong,\" but I now realize it was because I was thinking as a dev ;). Also an oversight on my part: I didn't realize/forgot that `ARG_CHECK` is actually crashing the program by default. I certainly agree that we don't want this in either failure case.\r\n\r\n> Alternatively, we could even return 1, store infinity in the public_data, and simply make sure that scanning won't find any payments in that case. This would avoid the error path for this function entirely. But if the caller then calls secp256k1_silentpayments_recipient_create_shared_secret, I think we'd just postpone the error to this function, and for this function, I don't see another way than returning an error. So I'm not convinced that this is better.\r\n\r\nIf we imagine an index + light client scenario, the `public_data` would be created by the index and then sent to the light client, where the light client would call `secp256k1_silentpayments_recipient_create_shared_secret` (and then get the error). Given this, I think it would be better to have the error path so that the index ends up not storing any data at all for the malicious crafted transaction, which saves space for the index and bandwidth for the light client.\r\n\r\n---\r\n\r\nThinking about this a bit more:\r\n\r\n> That's why, as a general rule, we try to avoid error paths as much as possible. This usually boils down to merging all errors into a single one, i.e., a) have just a single error \"code\" for all possible errors, b) and in the case of a multi-stage thing involving multiple function calls, have just a single place where errors are returned.\r\n\r\nMost of the high-level functions in our API are calling multiple lower-level functions and so far the approach has been something like:\r\n\r\n```\r\nif (!secp256k1_func_that_returns_0_on_error(args)) {\r\n    return 0;\r\n}\r\n...\r\nif (!secp256k1_another_func_that_returns_0_on_error(args)) {\r\n    return 0;\r\n}\r\n```\r\n\r\n~~Perhaps its worth looking to consolidate and try and only return an error at the end of a multi-stage process? This would mean ignoring the return values for a lot of the lower level function calls, which initially made me feel a bit weird. But in light of your recent comment, feels like this might be the preferred approach?~~\r\n\r\nEDIT: reading your comment again, I realize \"error paths\" is not really talking about branches in the code and more error paths for the user.",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#issuecomment-2142745728",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1519"
    },
    {
      "event": "mentioned",
      "id": 13004201610,
      "node_id": "MEE_lADOAP4Jqs6GTERUzwAAAAMHHF6K",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/13004201610",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-31T18:06:39Z"
    },
    {
      "event": "subscribed",
      "id": 13004201641,
      "node_id": "SE_lADOAP4Jqs6GTERUzwAAAAMHHF6p",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/13004201641",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-31T18:06:39Z"
    },
    {
      "event": "commented",
      "id": 2143167510,
      "node_id": "IC_kwDOAP4Jqs5_viQW",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/2143167510",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-06-01T00:23:18Z",
      "updated_at": "2024-06-01T00:23:18Z",
      "author_association": "CONTRIBUTOR",
      "body": "> We should also simply return 0 to indicate that this transaction is not well-formed/not eligible for SP. And again, even if there are other error cases, I don't see a reason why the caller should care why this transaction is not eligible.\r\n\r\nMakes sense. My worry was that without an explicit error-code for this corner case, some users wouldn't even be aware of an indirect \"not eligible\" case and more likely interpret a return value of 0 as \"only possible if there's a logic error on our side, so let's assert for success\" (given the passed in data is public and already verified for consensus-validity). But in the end that's more a matter of good API documentation I guess.\r\n\r\nAn example for the \"input public keys sum up to point of infinity\" case ($\\sum_i A_i = 0$) is now available on the Signet chain via tx [d73f4a19f3973e90af6df62e735bb7b31f3d5ab8e7e26e7950651b436d093313](https://mempool.space/signet/tx/d73f4a19f3973e90af6df62e735bb7b31f3d5ab8e7e26e7950651b436d093313) [1], mined in block 198023. It consists of two inputs spending P2WPKH prevouts with negated pubkeys $(x,y)$ and $(x,-y)$ (easy to verify by looking at the second item of the witness stack each, where only the first byte for encoding the sign bit differs), and one dummy P2TR output. It hopefully helps SP implementations to identify potential problems with this corner case early. As first example and proof that it triggers the discussed code path, it makes the Silent Payment Index PR [#28241](https://github.com/bitcoin/bitcoin/pull/28241) crash, which asserts on a return value of 1 for `_recipient_public_data_create`.\r\n\r\nI think it would be also a good idea to add this scenario to the BIP352 test vectors, or at least a unit test in this PR?\r\n\r\n[1] created with the following Python script: https://github.com/theStack/bitcoin/blob/202405-contrib-bip352_input_pubkeys_cancelled/contrib/silentpayments/submit_input_pubkeys_infinity_tx.py",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#issuecomment-2143167510",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1519"
    },
    {
      "event": "commented",
      "id": 2144837459,
      "node_id": "IC_kwDOAP4Jqs5_159T",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/2144837459",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-06-03T10:24:32Z",
      "updated_at": "2024-06-03T10:24:32Z",
      "author_association": "CONTRIBUTOR",
      "body": "> \r\n> ~Perhaps its worth looking to consolidate and try and only return an error at the end of a multi-stage process? This would mean ignoring the return values for a lot of the lower level function calls, which initially made me feel a bit weird. But in light of your recent comment, feels like this might be the preferred approach?~\r\n> \r\n> EDIT: reading your comment again, I realize \"error paths\" is not really talking about branches in the code and more error paths for the user.\r\n\r\nRight, it's about avoiding errors that the user would need to deal with, e.g., by more branches on the user side. So the idea is that to try to avoid complexity in the user code, perhaps at the cost of adding complexity to our code. But let me also add that this and most all of what I above is more a rule of thumb than a strict policy.\r\n\r\n> > We should also simply return 0 to indicate that this transaction is not well-formed/not eligible for SP. And again, even if there are other error cases, I don't see a reason why the caller should care why this transaction is not eligible.\r\n> \r\n> Makes sense. My worry was that without an explicit error-code for this corner case, some users wouldn't even be aware of an indirect \"not eligible\" case and more likely interpret a return value of 0 as \"only possible if there's a logic error on our side, so let's assert for success\" (given the passed in data is public and already verified for consensus-validity). But in the end that's more a matter of good API documentation I guess.\r\n\r\nOkay, I see the concern. And I agree, this should probably be a matter of documentation. I think, assuming our code is correct, there won't be a reason to return 0 unless there's something wrong with the transaction (invalid public key, keys sum up to 0), and we should just list these reasons in the docs.\r\n\r\n> I think it would be also a good idea to add this scenario to the BIP352 test vectors, or at least a unit test in this PR?\r\n\r\nIndeed, this should be in the BIP, ideally even in the pseudocode. If our code starts to reject \"payments\", then better be authorized by the standard. And I believe it's the right approach: There's no need to add complexity to implementations to deal with these malicious cases.[^1]\r\n\r\n\r\n[^1]: One thing to keep in mind are multi-sender scenarios where blaming the malicious participant could be hard. Say honest A and B have pkA and pkB, and malicious C then claims to have pkC = -(pkA + pkC) s.t. pkA + pkB + pkC = 0. And then A and B can't conclude that C is malicious. We run into such a thing in the MuSig BIP, see the first paragraph of https://github.com/bitcoin/bips/blob/master/bip-0327.mediawiki#dealing-with-infinity-in-nonce-aggregation. But IIUC this cannot happen here since C needs to show a signature under pkC.",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#issuecomment-2144837459",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1519"
    },
    {
      "event": "subscribed",
      "id": 13034935158,
      "node_id": "SE_lADOAP4Jqs6GTERUzwAAAAMI8VN2",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/13034935158",
      "actor": {
        "login": "sethforprivacy",
        "id": 40500387,
        "node_id": "MDQ6VXNlcjQwNTAwMzg3",
        "avatar_url": "https://avatars.githubusercontent.com/u/40500387?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sethforprivacy",
        "html_url": "https://github.com/sethforprivacy",
        "followers_url": "https://api.github.com/users/sethforprivacy/followers",
        "following_url": "https://api.github.com/users/sethforprivacy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sethforprivacy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sethforprivacy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sethforprivacy/subscriptions",
        "organizations_url": "https://api.github.com/users/sethforprivacy/orgs",
        "repos_url": "https://api.github.com/users/sethforprivacy/repos",
        "events_url": "https://api.github.com/users/sethforprivacy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sethforprivacy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-06-04T11:37:20Z"
    },
    {
      "event": "referenced",
      "id": 13207691565,
      "node_id": "REFE_lADOAP4Jqs6GTERUzwAAAAMTPWEt",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/13207691565",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "1ceb0b6986563854e0ffad280b4362821307ba50",
      "commit_url": "https://api.github.com/repos/theStack/bips/commits/1ceb0b6986563854e0ffad280b4362821307ba50",
      "created_at": "2024-06-18T22:47:19Z"
    },
    {
      "event": "referenced",
      "id": 13221274861,
      "node_id": "REFE_lADOAP4Jqs6GTERUzwAAAAMUDKTt",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/13221274861",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "bbc706cf4f336c74b831966f61fa334d257a5288",
      "commit_url": "https://api.github.com/repos/theStack/bips/commits/bbc706cf4f336c74b831966f61fa334d257a5288",
      "created_at": "2024-06-19T22:11:18Z"
    },
    {
      "event": "referenced",
      "id": 13221312587,
      "node_id": "REFE_lADOAP4Jqs6GTERUzwAAAAMUDThL",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/13221312587",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "a96df5abcbecb669427dd041a6d8c25e106536c2",
      "commit_url": "https://api.github.com/repos/theStack/bips/commits/a96df5abcbecb669427dd041a6d8c25e106536c2",
      "created_at": "2024-06-19T22:19:55Z"
    },
    {
      "event": "referenced",
      "id": 13221333509,
      "node_id": "REFE_lADOAP4Jqs6GTERUzwAAAAMUDYoF",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/13221333509",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "3623b60784398b08abc6f9e74a9f74d51f4f2dea",
      "commit_url": "https://api.github.com/repos/theStack/bips/commits/3623b60784398b08abc6f9e74a9f74d51f4f2dea",
      "created_at": "2024-06-19T22:24:38Z"
    },
    {
      "event": "referenced",
      "id": 13221373766,
      "node_id": "REFE_lADOAP4Jqs6GTERUzwAAAAMUDidG",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/13221373766",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "fe0f83531e35f76d3582813da4cbb518d9bb1d12",
      "commit_url": "https://api.github.com/repos/theStack/bips/commits/fe0f83531e35f76d3582813da4cbb518d9bb1d12",
      "created_at": "2024-06-19T22:33:46Z"
    },
    {
      "event": "referenced",
      "id": 13221425667,
      "node_id": "REFE_lADOAP4Jqs6GTERUzwAAAAMUDvID",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/13221425667",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "630466657557b073549f02c130de7bf5799b1cfa",
      "commit_url": "https://api.github.com/repos/theStack/bips/commits/630466657557b073549f02c130de7bf5799b1cfa",
      "created_at": "2024-06-19T22:44:51Z"
    },
    {
      "event": "referenced",
      "id": 13247893873,
      "node_id": "REFE_lADOAP4Jqs6GTERUzwAAAAMVotFx",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/13247893873",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "59cc43d727000794f18dac0a502cd87c0daec22a",
      "commit_url": "https://api.github.com/repos/theStack/bips/commits/59cc43d727000794f18dac0a502cd87c0daec22a",
      "created_at": "2024-06-21T23:58:10Z"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDdmN2ZiOTlmMzNlOTg4YmUzYThmNzU2OWUxZTg5Y2UxMzE5ZGYyNmI",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/7f7fb99f33e988be3a8f7569e1e89ce1319df26b",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/7f7fb99f33e988be3a8f7569e1e89ce1319df26b",
      "tree": {
        "sha": "b37f0e5bb0a20ca0fe8ff3b05e16035c0d0267e9",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/b37f0e5bb0a20ca0fe8ff3b05e16035c0d0267e9"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree b37f0e5bb0a20ca0fe8ff3b05e16035c0d0267e9\nparent b0866a2912c5559b16a82f0b6d3061acd9809043\nauthor Sebastian Falbesoner <sebastian.falbesoner@gmail.com> 1696468440 +0200\ncommitter josibake <josibake@protonmail.com> 1719657684 +0200\n\nsilentpayments: implement shared secret creation\n\nAdd function for calculating either a*B or A*b. This function is used by both\nthe sender and the recipient (i.e. a*B == A*b).\n\nAdd functions for generating the tagged input hash, as this is used when\ncreating the shared secret.\n\nIn a later commit, `create_shared_secret` will be exposed in the API for\nthe receiver to use when scanning as a light client.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmZ/5NkACgkQity1WMTz\nPWXDQw//b0xSC/hnmnon5pBWsY28/YOV05kdSdXDTi5TCaW+hClGC/VdOiVwIDTc\nmWKyJVep9UofPKfrGdS20fPgdI+VdXALm4WgNKJxNEaVPPFx6RET5hi34EmZW/Ca\nkYsVp+pyLyZ9E7j2cHli91IDg26acOynVStvWW9fg0ukHZYZzLw1eu1MbkIZYZYW\nwF8ZZXex6XiC1V0caKR48+fgm7ouJ6n4vhUIEKwUa/lrcjvm7lM4IUBYQZMYj4x5\nPZRrsj/FvbesCwgkzV5O4SmDoOpKyy4ghwbXRQ4HN7tkB8v4qu1zMT3mFVf6ivig\nW5l3OtfbtO4R3NFCA4p/4BQ0R+UdVWz37LiuwoNAJ8u3c5x5rDJiPprY/N6uEN/y\nKuGZ8hTTOPb4P4o9LmJRJFD3w4BKprP78PKgE2iQPuQjVL5b5AI5GOvXuIdhZUR6\nrVOTXckUcr+/Vu4q1Jo+JFcM1A1MeTItJAXLkPlc498jE8kUl6CsukLqOWuRf6Lw\npDQP5hEtgDADniCgiZWqReYI1Izsmbh8JgL1tN3BN2bD0O8JPBX2GbjJ/KgaleNH\nZUIsSMuriel/ht4UIyQTHsVhHTt1gu5eku/TgKlh9lFqwLSujAS6WeDZiGT80o/2\ntjFnQMYmcV0Y0AwU09bsqVxyXRnyhFwHYk81m7gHu6pn2Um571Y=\n=HGgD\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/b0866a2912c5559b16a82f0b6d3061acd9809043",
          "sha": "b0866a2912c5559b16a82f0b6d3061acd9809043",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/b0866a2912c5559b16a82f0b6d3061acd9809043"
        }
      ],
      "message": "silentpayments: implement shared secret creation\n\nAdd function for calculating either a*B or A*b. This function is used by both\nthe sender and the recipient (i.e. a*B == A*b).\n\nAdd functions for generating the tagged input hash, as this is used when\ncreating the shared secret.\n\nIn a later commit, `create_shared_secret` will be exposed in the API for\nthe receiver to use when scanning as a light client.",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-06-29T10:41:24Z"
      },
      "author": {
        "name": "Sebastian Falbesoner",
        "email": "sebastian.falbesoner@gmail.com",
        "date": "2023-10-05T01:14:00Z"
      },
      "sha": "7f7fb99f33e988be3a8f7569e1e89ce1319df26b"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDgxZTZiOGRjZjY4NDkwNGY5MjAxNmNmNjdhNWQ2Zjk0MTA5NzM1MGU",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/81e6b8dcf684904f92016cf67a5d6f941097350e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/81e6b8dcf684904f92016cf67a5d6f941097350e",
      "tree": {
        "sha": "23566bb5a895378d2ae2fb060a010f7838f08389",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/23566bb5a895378d2ae2fb060a010f7838f08389"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 23566bb5a895378d2ae2fb060a010f7838f08389\nparent 7f7fb99f33e988be3a8f7569e1e89ce1319df26b\nauthor Sebastian Falbesoner <sebastian.falbesoner@gmail.com> 1695853820 +0200\ncommitter josibake <josibake@protonmail.com> 1719657690 +0200\n\nsilentpayments: implement output pubkey creation\n\nAdd methods for creating an xonly output from a shared secret. This\ninvolves adding a tagged hash for creating the output.\n\nThis function will be exposed in the API in a later commit for the\nreceiver to use when scanning as a light client.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmZ/5NoACgkQity1WMTz\nPWWRYQ//Y0dkSEFe0N6spcsinLOGbrBF4hTilZtiXwkveXN8uN4kjXQWsR7XiAjN\n2MvdzF0JqRAKwFAWJ2SQbS2RFt+pGJ+cQrxwu+W3MDuCNO7QM7QET2/wyUbWRtFM\ncs9YSGNgVoGW4IqakZ0w+DkeZFGlgy0OIMytcBZkt5u/pEq5zyGFCNVQWOy7wNnR\niiVmmlTmsK5aW63DhaPaWHtAEamQB0Cj/PlBmuI5OkdG0FJT40KARUZYz12SH2yo\ne6U76vR6JTiiPxr5mNFG2dvr8Iv9yhDdCN8dA1MoIvfS5zqWdspNiBra4MAXrvWV\nYiEKr909w4R5LuxiKo/CRZ39sLYS1ArPXuOLdmMoL+xgoW9HpFYGoME+Cg9sYUqa\n2v1IuH0MwiwgnBOFTbWPw75ub4LF+xu0OC3GlRhfevj65HIfTamNT7YCJzeokUSe\nZvOcIeoC7y0uJu7B6UlOU/arriP1hC5ZWiifPMckCqN4ut/IrPxMczI9cPTuia7E\nF3DwL/93YBfKbxFJem3og+IFI5h25Y/vUsA4pH0gANrRZf+KGpTuqoUauWPceI3l\nFEK8vGkmetb0BRtPea73PthhstIRWUrtkC8CiMA0bRjqX+pJGtlVocV6LWecW3Jd\nUQGhxCKfi/0rMDMFCPQeqSE0v9fj79jK6DNMxXI9GBevrrJcrRs=\n=HQYm\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/7f7fb99f33e988be3a8f7569e1e89ce1319df26b",
          "sha": "7f7fb99f33e988be3a8f7569e1e89ce1319df26b",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/7f7fb99f33e988be3a8f7569e1e89ce1319df26b"
        }
      ],
      "message": "silentpayments: implement output pubkey creation\n\nAdd methods for creating an xonly output from a shared secret. This\ninvolves adding a tagged hash for creating the output.\n\nThis function will be exposed in the API in a later commit for the\nreceiver to use when scanning as a light client.",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-06-29T10:41:30Z"
      },
      "author": {
        "name": "Sebastian Falbesoner",
        "email": "sebastian.falbesoner@gmail.com",
        "date": "2023-09-27T22:30:20Z"
      },
      "sha": "81e6b8dcf684904f92016cf67a5d6f941097350e"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKGI5MGMyMTk5NDRlYzUxYWNiYThmYjBhMDlmNmEwNTc4MzM0MGRjMDU",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/b90c219944ec51acba8fb0a09f6a05783340dc05",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/b90c219944ec51acba8fb0a09f6a05783340dc05",
      "tree": {
        "sha": "50e352dcbad0202efa0bd7b6bbe6e7cde03ae3d6",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/50e352dcbad0202efa0bd7b6bbe6e7cde03ae3d6"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 50e352dcbad0202efa0bd7b6bbe6e7cde03ae3d6\nparent 81e6b8dcf684904f92016cf67a5d6f941097350e\nauthor josibake <josibake@protonmail.com> 1711391150 +0100\ncommitter josibake <josibake@protonmail.com> 1719657690 +0200\n\nsilentpayments: add sender routine\n\nGiven a set of private keys, the smallest outpoint, and list of recipients this\nfunction handles the entire sender flow:\n\n1. Sum up the private keys\n2. Calculate the input_hash\n3. For each recipient:\n    3a. Calculate a shared secret\n    3b. Create the requested number of outputs\n\nThis function assumes a single sender context in that it requires the\nsender to have access to all of the private keys. In the future, this\nAPI may be expanded to allow for a multiple senders or for a single\nsender who does not have access to all private keys at any given time,\nbut for now these modes are considered out of scope / unsafe.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmZ/5NoACgkQity1WMTz\nPWXStRAA11ZmqiOrZkHMaFKBKyXwXY8tnWsYO+IEQ9peTORGQl30FtGloVYgicSj\niKnQwXprdhpjS6kX3kb1mC6bYAo2ZUpvB0NHW6o3YLX1xb+nCyOXGeMRcp7US0Bw\nSKyNIbJT1FeegvlRV7feAbVGO5FBpUSZq1PmKapoWQqXoCsd13bvKY7gjUqBgH6y\ng7tG5gI8EpKyLp6J7cZVXu0c+pW1GFvv2XhULZ5IjEH13Kzr0qmLiusu4zm/xUnv\n7uNRrJ/O2W8NrCzLJAcxlDtr3LHPBlLJwHT22ErSuuhZYxbAmv1SYhJLSQa6iVpD\nV62+OJlh87QqshoI0a6DrNyGC4JZk0niwXEu/NT/tYxHqG+izflHBXMWRn4/efzM\nSRUoJcHKXJ6d1vzq+vsS+BvefLXs+rULAkj+gq7xdOYVUpsXxmB5Q3NhJxmWxM/w\ntDnqf8WqyCWsHZ53nXTwsqTo/LFxG74d5etuzDOOxZ3DIh6z3S+MSFfgTPkPjktc\nPRcYEncR8u05y60bsbM1invU1xJ3HZCHRf7CSbiL42AOdy91fyUXzkFD7OJ4hTGx\nslup1nT3Dnng7Ij5GDOk77k1Ur+rqBeDwgM7CZau0pIFUkSTyLKSDVxScx8q52PY\nSRY9dsHgK2g3rSFqbO0isLY6Ji5loZjA9sfQnkE6fa4kqr+J2HE=\n=6T6Y\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/81e6b8dcf684904f92016cf67a5d6f941097350e",
          "sha": "81e6b8dcf684904f92016cf67a5d6f941097350e",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/81e6b8dcf684904f92016cf67a5d6f941097350e"
        }
      ],
      "message": "silentpayments: add sender routine\n\nGiven a set of private keys, the smallest outpoint, and list of recipients this\nfunction handles the entire sender flow:\n\n1. Sum up the private keys\n2. Calculate the input_hash\n3. For each recipient:\n    3a. Calculate a shared secret\n    3b. Create the requested number of outputs\n\nThis function assumes a single sender context in that it requires the\nsender to have access to all of the private keys. In the future, this\nAPI may be expanded to allow for a multiple senders or for a single\nsender who does not have access to all private keys at any given time,\nbut for now these modes are considered out of scope / unsafe.",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-06-29T10:41:30Z"
      },
      "author": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-03-25T18:25:50Z"
      },
      "sha": "b90c219944ec51acba8fb0a09f6a05783340dc05"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKGUyOWE0ZjNiNzRhZWY5Y2RhZmZhMzU4MWNlNDk5ZDJlMTVjY2VjMjQ",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/e29a4f3b74aef9cdaffa3581ce499d2e15ccec24",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/e29a4f3b74aef9cdaffa3581ce499d2e15ccec24",
      "tree": {
        "sha": "9538d317719a52ff791494bc7afb998a8dff6cd9",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/9538d317719a52ff791494bc7afb998a8dff6cd9"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 9538d317719a52ff791494bc7afb998a8dff6cd9\nparent b90c219944ec51acba8fb0a09f6a05783340dc05\nauthor Sebastian Falbesoner <sebastian.falbesoner@gmail.com> 1705946165 +0100\ncommitter josibake <josibake@protonmail.com> 1719660707 +0200\n\nsilentpayments: add recipient label support\n\nAdd function for creating a label tweak. This requires a tagged hash\nfunction for labels. This function is used by the receiver for creating\nlabels to be used for a) creating labelled addresses and b) to populate\na labels cache when scanning.\n\nAdd function for creating a labelled spend pubkey. This involves taking\na label tweak, turning it into a public key and adding it to the spend\npublic key. This function is used by the receiver to create a labelled\nsilent payment address.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmZ/8KkACgkQity1WMTz\nPWVh0hAAnRCloewMPKTdcYnACpOMd9z/s51IOLycywMbBXvi/TFln1NtUQp1GCwY\nk0z69w8itamaIdq74xBiY3/6JagkcfTehi1p0x736fLerM8i/HGhee7x+YJnnxCo\nD7A6UfN6l0D40dGOCizBTputp+xB83MJgpbVn2iiuLkgasUoL1lPUxLcB7XZtbSF\nbzKNdvZy+xrkXX9pIeZqTTKi+uqyhdQZi9ERtsMB05Nkqo8jPThzaqAeT2IXwBkY\n+7nkBPnyOaalPY5lLxATk4njxLy5IxTcjiaWM/9k3T+WIty2sdfDeKyugukp+chV\nsTsZobGoymKQZ4TDVpRMJzptH7/NkoNGMignJpmQmtXOqpGmO/j/E/ZgQolsPuXX\npdIpUvcebluOdgq0XdOCB/5bN88SP4YoJVfUy1dyD6yUK5XZMbPMuBYxbxQLge1M\nc9egpMHBOm9quPljacgJ44yHuHpQO9Y9FcZWw7EwbpnQB6NOK/gvBQTtAJHdmbe0\nRFCwMiCOO05H8yMUIFIfbvIp9VMHxSxkdkqDlyWxRyC5DuqYJXwNTUKrRr2yY/3G\nDHFfDbURIAhxPTzY435r6t8P6PO3ZvPyc1HUlalulRJj6qQe5awAbUHlZxmUVnsH\nTOGOgpAuocHjjFj4ViVifr1gBVA/ESVAsJfxSErByZDQx1ui8BI=\n=iI6E\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/b90c219944ec51acba8fb0a09f6a05783340dc05",
          "sha": "b90c219944ec51acba8fb0a09f6a05783340dc05",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/b90c219944ec51acba8fb0a09f6a05783340dc05"
        }
      ],
      "message": "silentpayments: add recipient label support\n\nAdd function for creating a label tweak. This requires a tagged hash\nfunction for labels. This function is used by the receiver for creating\nlabels to be used for a) creating labelled addresses and b) to populate\na labels cache when scanning.\n\nAdd function for creating a labelled spend pubkey. This involves taking\na label tweak, turning it into a public key and adding it to the spend\npublic key. This function is used by the receiver to create a labelled\nsilent payment address.",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-06-29T11:31:47Z"
      },
      "author": {
        "name": "Sebastian Falbesoner",
        "email": "sebastian.falbesoner@gmail.com",
        "date": "2024-01-22T17:56:05Z"
      },
      "sha": "e29a4f3b74aef9cdaffa3581ce499d2e15ccec24"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKGQ3ZGZmMjI1MTYzMzcwOWIzYjYyNjFhYTlhMzZmYTkyZjQ4MzQ4ZTU",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/d7dff2251633709b3b6261aa9a36fa92f48348e5",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/d7dff2251633709b3b6261aa9a36fa92f48348e5",
      "tree": {
        "sha": "b267034080338dd177be176e88636a50e86a6769",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/b267034080338dd177be176e88636a50e86a6769"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree b267034080338dd177be176e88636a50e86a6769\nparent e29a4f3b74aef9cdaffa3581ce499d2e15ccec24\nauthor josibake <josibake@protonmail.com> 1719660810 +0200\ncommitter josibake <josibake@protonmail.com> 1719660926 +0200\n\nsilentpayments: add opaque data type `public_data`\n\nAdd data type for passing around the summed input public key (A_sum) and\nthe input hash tweak (input_hash). This data is passed to the scanner\nbefore the ECDH step as two separate elements so that the scanner can\nmultiply b_scan * input_hash before doing ECDH.\n\nAdd functions for deserializing / serializing a public_data object to\nand from a public key. When serializing a public_data object, the\ninput_hash is multplied into A_sum. This is so the object can be stored\nas public key for wallet rescanning later, or to vend to light clients.\nFor the light client, a `_parse` function is added which parses the\ncompressed public key serialization into a `public_data` object.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmZ/8YEACgkQity1WMTz\nPWVs0Q/7Bps4pJ2Jtp6On4t1NopWoRzubz03dfkk5iqyutt8sUqPEhMgmR3KIBkg\nU7MmpFteadtMqBRasNzjvyv+JEP7njjxdAIJPUsWE4gwVufAL0UHXrngIOSLao4x\nYTgYuYvUlW+8kUMz0iyv1YqNwAbOuG9ielhFiTeVy+YMYN374CUz0NLNynNw66WV\nxcjim9IikD9zu1M4h8DA4owYrMkEDAIE3mp7jz3AnXTxGcCOxzFT8yw8f7aCZXJF\nEGOWXVpnhbp4jcbdWEXnkjtJ4kGuGBaX3DmgVRSKvPCQgpoEQABIbf91NuXmdJtV\nhjwMVbND/sa1bxxaLMcN5oP2JtKtnUuImzpLQOOlWI6BFHbR6FRXjbN6/WhxzWVW\n5mmP5EETAFhg/YB6wFi24e5BJr0eNNv+s1WWVuyIMEBNHwuSIP8Kpbg/izGhaCHd\n2YsWIk3h/xFrsZjEbQNaCvyF0JLWSfyF4BmzpbP6cCj27pfyCwR8zzEMh5XSDWrK\n0dqdfwUZM8mXxy1U5iiQc4Qt1jS2Z+bTSwgAPfxtW639Un6QlyzEFgVJoay6Fz/1\neJByou/uZ9jObDlikiOjDg71u0IZoso1b5TcB4v7qNrTPM5AbzKXfKM/eTFKh8qQ\n2F+Hvr6oLgEcfBIgGnwN1Fn/OzJ70mw5qDaUmt0z74E7tzAL/Ao=\n=X1eB\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/e29a4f3b74aef9cdaffa3581ce499d2e15ccec24",
          "sha": "e29a4f3b74aef9cdaffa3581ce499d2e15ccec24",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/e29a4f3b74aef9cdaffa3581ce499d2e15ccec24"
        }
      ],
      "message": "silentpayments: add opaque data type `public_data`\n\nAdd data type for passing around the summed input public key (A_sum) and\nthe input hash tweak (input_hash). This data is passed to the scanner\nbefore the ECDH step as two separate elements so that the scanner can\nmultiply b_scan * input_hash before doing ECDH.\n\nAdd functions for deserializing / serializing a public_data object to\nand from a public key. When serializing a public_data object, the\ninput_hash is multplied into A_sum. This is so the object can be stored\nas public key for wallet rescanning later, or to vend to light clients.\nFor the light client, a `_parse` function is added which parses the\ncompressed public key serialization into a `public_data` object.",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-06-29T11:35:26Z"
      },
      "author": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-06-29T11:33:30Z"
      },
      "sha": "d7dff2251633709b3b6261aa9a36fa92f48348e5"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDJlODc5MWFlMmY2ZGQ3Y2FlNTQwOTM3NWU3ZjgyZDZiZmEzOTM2NDg",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/2e8791ae2f6dd7cae5409375e7f82d6bfa393648",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/2e8791ae2f6dd7cae5409375e7f82d6bfa393648",
      "tree": {
        "sha": "2f27cb16e4cdd1c6c214bf9de255644bce25a183",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/2f27cb16e4cdd1c6c214bf9de255644bce25a183"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 2f27cb16e4cdd1c6c214bf9de255644bce25a183\nparent d7dff2251633709b3b6261aa9a36fa92f48348e5\nauthor josibake <josibake@protonmail.com> 1713516088 +0200\ncommitter josibake <josibake@protonmail.com> 1719661025 +0200\n\nsilentpayments: add recipient scanning routine\n\nAdd routine for scanning a transaction and returning the necessary\nspending data for any found outputs. This function works with labels via\na lookup callback and requires access to the transaction outputs.\nRequiring access to the transaction outputs is not suitable for light\nclients, but light client support is enabled in followup commits.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmZ/8eUACgkQity1WMTz\nPWXzCg//SAaJnC0MIOFsa/PLzK1grvuzS6TJDElgt7hY8CCU6mE8A6du16WhzA6C\nPs87pUW1zNkz5+kMhPpN/Az1J76PXLJeMh3gEKcLOcVInZVsJxyA5uDyGE8ZZ6Iq\n9DJlLilA5EhSEkN6nz3M9UoEJQFREzaGu9V6FOyS+kdAIiQc7mmu7RdRW6ah75i8\nZ4vH3nX2Iw4QfoX1Fu12fHEq7Gs2rzeXkYZoirfvYN5vMK36AgoHiQgTYjMipNgw\nDzVI0aLz3aA1EJBaKZb5Hr7hhLc2CWk1Bl9ol4jT4GKQDRd7CRr+DHO2/ekt8+Rl\n92HVe3uN9YqS4yijjr8m+lBp2ljF0GAj7PffxA8uIe0D44Dx5FrT2l/DmBBBwl1W\nn19ygk/Rw8e/LBxHPDBufpBZhc6QTYL9Ure7kARVhVnHQVWN/psZpWzu2sZRKNkp\nUI2Xkub+f8uIBQKyUjVu+Ig12lHdUspQ1WlqCu0IA79dV/gouwO4rmSnCi/oC8Ve\nbzrURN5hHZynHdCkrjbNql6RtDVopmTUUVDDK/NgHkOS/cQkZ0izpcDNHjdTCiPu\nCjA0KRz8zKGZRx6de6Q/jKq6KJwsQcm+0KtupwhtuY8F1n3yA8bb2zlPJrvZqehH\nQ/w2UHf+HzALmZKHXbz2ASRaJ38sHS7OdBnh1SBUBZCE87DGbDA=\n=6SKK\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/d7dff2251633709b3b6261aa9a36fa92f48348e5",
          "sha": "d7dff2251633709b3b6261aa9a36fa92f48348e5",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/d7dff2251633709b3b6261aa9a36fa92f48348e5"
        }
      ],
      "message": "silentpayments: add recipient scanning routine\n\nAdd routine for scanning a transaction and returning the necessary\nspending data for any found outputs. This function works with labels via\na lookup callback and requires access to the transaction outputs.\nRequiring access to the transaction outputs is not suitable for light\nclients, but light client support is enabled in followup commits.",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-06-29T11:37:05Z"
      },
      "author": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-04-19T08:41:28Z"
      },
      "sha": "2e8791ae2f6dd7cae5409375e7f82d6bfa393648"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKGMxZWVmNWEwZGIwZGE0ZDYwNDNhZWQ5M2Y3YzMyNjQzZWNkZTMyMWI",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/c1eef5a0db0da4d6043aed93f7c32643ecde321b",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/c1eef5a0db0da4d6043aed93f7c32643ecde321b",
      "tree": {
        "sha": "bd2335c57f7f79db3f3de60263c4203ba513f845",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/bd2335c57f7f79db3f3de60263c4203ba513f845"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree bd2335c57f7f79db3f3de60263c4203ba513f845\nparent 2e8791ae2f6dd7cae5409375e7f82d6bfa393648\nauthor josibake <josibake@protonmail.com> 1713516138 +0200\ncommitter josibake <josibake@protonmail.com> 1719661029 +0200\n\nsilentpayments: add recipient light client support\n\nExpose a shared secret routine in the public API and a output_pubkey\ncreation routine. These are simple wrappers around the same functions\nthe module is using under the hood. They are exposed for the light\nclient as the minimal set of operations they need to do scanning without\naccess to the transaction outputs.\n\nThis means the light client will need to manage their own scanning\nstate, so wherever possible it is preferrable to use the\n`_recipient_scan_ouputs` function.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmZ/8eUACgkQity1WMTz\nPWU0EhAAkXoN1mn1ANuVuhS+pZBDEIhfM2oTXj3j8AEwiAxBFhtrkLxsVWgI/8fq\nIB2e5sOyX8yQLU+wM3GoMS6W7wn7iEkQ5wWTNz+Pa7/PCy+EjCbIkkII+IewfHRo\nBnq1cEstSqv5PzVRMvuy7QQTLhl8aLpX0MiHLGsIftLEwtzVGCQQOAZ7FA4o/+5B\n5bz76uab9lIORHpbBINkJvhBKva0Fj1ThD4/mFnWDYXOA5jdmQdS6+eOw/vnUxC+\nhywxhwAWYnTEbsTYCYMznBP9FnoaSmsV3fnzFKfQPjzCyrRZyBxcQpAsYQPY7ktv\nvcgt2k2IJ5/R0GB5Uu0wqeCKlH3GZiJbjWZW4BJISAbFceqOVTaCEuyIzyctqqEF\nSMhTURwM5h9VX5uvUcLjE18oPOWupe4SaWA/23/JLYLKBulbrrYI7Ibfs7PilUTY\nmQ3K7qkdqJzZyRVEeK/c1jaQwQIZQdVZBjh6XjXG+KY0Qicf5i+z6pIui3xF8ldu\nMzYv4gNqI+k8yVg/lCcxHpVk39HJqbEjqRU3c6zN9yD8hM3ReMZvO/xqpEQJMetz\n4ZRGCeJ1/uwmiYAXNLMlJYBoDG+qrKaPUW0E+jR0Z4lQqvxWQRRhU9yDuT7tcTDn\nSzYCSauFAyZmkIPqtNkraoKMH0Q2ZZFHQaGSb8pSVTTYeooDj8c=\n=l2kg\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/2e8791ae2f6dd7cae5409375e7f82d6bfa393648",
          "sha": "2e8791ae2f6dd7cae5409375e7f82d6bfa393648",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/2e8791ae2f6dd7cae5409375e7f82d6bfa393648"
        }
      ],
      "message": "silentpayments: add recipient light client support\n\nExpose a shared secret routine in the public API and a output_pubkey\ncreation routine. These are simple wrappers around the same functions\nthe module is using under the hood. They are exposed for the light\nclient as the minimal set of operations they need to do scanning without\naccess to the transaction outputs.\n\nThis means the light client will need to manage their own scanning\nstate, so wherever possible it is preferrable to use the\n`_recipient_scan_ouputs` function.",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-06-29T11:37:09Z"
      },
      "author": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-04-19T08:42:18Z"
      },
      "sha": "c1eef5a0db0da4d6043aed93f7c32643ecde321b"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDY4MTJlM2YyOTI1NmE4NDFmY2RiYjY1NzZhMmVhZjhkN2YwZDU1ZTQ",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/6812e3f29256a841fcdbb6576a2eaf8d7f0d55e4",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/6812e3f29256a841fcdbb6576a2eaf8d7f0d55e4",
      "tree": {
        "sha": "03c937a4bc6a96674543ef1f69a9b557cca54224",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/03c937a4bc6a96674543ef1f69a9b557cca54224"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 03c937a4bc6a96674543ef1f69a9b557cca54224\nparent c1eef5a0db0da4d6043aed93f7c32643ecde321b\nauthor josibake <josibake@protonmail.com> 1713202589 +0200\ncommitter josibake <josibake@protonmail.com> 1719661029 +0200\n\nsilentpayments: add examples/silentpayments.c\n\nDemonstrate sending, scanning, and light client scanning.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmZ/8eUACgkQity1WMTz\nPWVKOhAAxNAgsMWwQlsEvrouRGYV9TpfUN80hxQbzex7bqgR5OFUonZUIdhIvEYj\nYDMrbazZQ7486Mc2zp0eizYuGE572/hx8uGWK6HTON46FDJb1j0R43vbCTJxjiwY\n6vNsCXC2IECEz/PWHK7+k7Bau68l38zfDq9pR4/nMtVC2mjgbDnOoKVAifPHwn0Y\no/0Kyc69xn9cHA8o5r+KTTARbEZoLT0dHMGCPCyPbLqEZTbUWhtJ2Wx/svMZctIp\ng9N9o7x6aI7ikivRGjXqnIuJA9I5S5D5dFaBhyZ7WD4ILjGfhjdE4/AXnJu0zajt\nVvEN5QFBeMCl2oYYs0qz/cglQeAz6SxWA+rkt0+lJAjXc/8vj4PLHZ5tVs3wiciC\nsLPbcIg6wlo8YJ3sVFNDR7yCIk6gCNX0Zy/faZkSAHK/4RMyEClJNLxAR2cfCgoR\nZ/UR5TeWC+wvVJ0z8wU6KT5rkpDcgXlUiSnY/Eoi6habYP/oFbZj6s3RuqU0bjw9\nF361PHHyvLzCeSXuzW24zVBzn2qbwRz630o156WKRA4lUBwpbJM2WhyKx4IA9lE0\nCmOYfgRQkI2uqpFiE5a03HQktfRUV14shwevgY67pUluMjJr/YCmccbYNBd6AjwB\nWL0d2L+LK5eTwBQBksA9LjF0dWeB3mRETqtW/sXw0pHyYq0pSpg=\n=PNV/\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/c1eef5a0db0da4d6043aed93f7c32643ecde321b",
          "sha": "c1eef5a0db0da4d6043aed93f7c32643ecde321b",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/c1eef5a0db0da4d6043aed93f7c32643ecde321b"
        }
      ],
      "message": "silentpayments: add examples/silentpayments.c\n\nDemonstrate sending, scanning, and light client scanning.",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-06-29T11:37:09Z"
      },
      "author": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-04-15T17:36:29Z"
      },
      "sha": "6812e3f29256a841fcdbb6576a2eaf8d7f0d55e4"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDBhM2U1OWI1ZDIzY2JjYzZhZTA2NDVjNjBkMTc1YzZiZDE1NmExNWY",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/0a3e59b5d23cbcc6ae0645c60d175c6bd156a15f",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/0a3e59b5d23cbcc6ae0645c60d175c6bd156a15f",
      "tree": {
        "sha": "e5d437a6fc322b0cb42572db6796b64eb3e06b3d",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/e5d437a6fc322b0cb42572db6796b64eb3e06b3d"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree e5d437a6fc322b0cb42572db6796b64eb3e06b3d\nparent 6812e3f29256a841fcdbb6576a2eaf8d7f0d55e4\nauthor josibake <josibake@protonmail.com> 1714066415 +0200\ncommitter josibake <josibake@protonmail.com> 1719661029 +0200\n\nsilentpayments: add benchmark for `scan_outputs`\n\nAdd a benchmark for `scan_outputs` as this is the most performance\ncritical part of silent payments.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmZ/8eUACgkQity1WMTz\nPWX7bQ//dMxHVZIYlBu5HipE6jn5V6G9soSyG6XzvRE7Cbb2KNwG07ffkl+1FqPe\nUQ1oDYodQwRizd0qxpgH9E3XGNth1v2rq75nhIsG9GoHVz3npyVWyT5GVpsRl5Z+\nN/352HRZC7WIsOrXOKRBwWybtvnWr8ZoKg0aczrpzxSA6rNL8uo7qN9WufYi76Dv\nIPNG6ZZHnWzBqfpDyedKSb1/6cM3KP8xlEah1JHoFapfrLT/I8fq8DY/XjSjbHVV\n2MLjbiSZMV3CS+pAzP3LzuTDcgkaQcbvkDQmLUqLz0KhrpVGJxDJ0auamm3DcdFg\nwBgc4BcPS/9+5R2RPkh/SxaVv13Z3c/cfHKLVTH9s5nEqI/ObJnoJNqnIxNZd8FS\nwEys5wq4Crwe6+3yRKdQtUZqiVL6iuaOsASJqtqIvEmMKPCBuQnQKtbtJPHlUaBF\nGVcDZJqWFm5HQgGZ7aDqCqjL/PsJf11tKd458B+pFMbVNBDtrXh53quRq6CAa/hA\nX8rGyz1SmuTZmpncdBnDB0rzUlMREgZAaz7kTAi9fJK4XIWo5HIRBfI1qfMYXIgf\nMiujWyMBiI+AaT4Hm77BwMdqG5n6ISDVJAXuevPGdPBhG34WClK1QLX1gI8NJ+IX\nDu3fQ736DI++hSARhD27PZQnMOFMwoSoIyIg9S9br2nD82Pwezs=\n=t1j5\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/6812e3f29256a841fcdbb6576a2eaf8d7f0d55e4",
          "sha": "6812e3f29256a841fcdbb6576a2eaf8d7f0d55e4",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/6812e3f29256a841fcdbb6576a2eaf8d7f0d55e4"
        }
      ],
      "message": "silentpayments: add benchmark for `scan_outputs`\n\nAdd a benchmark for `scan_outputs` as this is the most performance\ncritical part of silent payments.",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-06-29T11:37:09Z"
      },
      "author": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-04-25T17:33:35Z"
      },
      "sha": "0a3e59b5d23cbcc6ae0645c60d175c6bd156a15f"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKGZjNmM3ZjBhYmJhYTAzZTIwNTdmOTM2NmFjY2M2MmUzZTJlZTkwMDA",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/fc6c7f0abbaa03e2057f9366accc62e3e2ee9000",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/fc6c7f0abbaa03e2057f9366accc62e3e2ee9000",
      "tree": {
        "sha": "9d0b179ee72f54da6388d0c75d7bd4dfba4077e9",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/9d0b179ee72f54da6388d0c75d7bd4dfba4077e9"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 9d0b179ee72f54da6388d0c75d7bd4dfba4077e9\nparent 0a3e59b5d23cbcc6ae0645c60d175c6bd156a15f\nauthor Sebastian Falbesoner <sebastian.falbesoner@gmail.com> 1708642163 +0100\ncommitter josibake <josibake@protonmail.com> 1719661029 +0200\n\ntests: add BIP-352 test vectors\n\nThe vectors are generated with a Python script that converts the .json\nfile from the BIP to C code:\n\n$ ./tools/tests_silentpayments_generate.py test_vectors.json > ./src/modules/silentpayments/vectors.h\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmZ/8eUACgkQity1WMTz\nPWUk7hAAvaMSzyJuaEChE+IqG8n5enHdzd2pYNE3bDtrwQxzRO7xxPXwETLkHvoR\naolUGD1qDYXts5LHY7Lr6fUlRXhGm1z6ABUv7iKek8WH9qUlLN9c+SMyy86TaPh6\nNjXAKScjPw6PMMZT4pb1HIUYM+kpoWAzerX+zxIFFT+o2t7y9kSD7lJy0n/W7Gt0\ngqjo/p80tyA69Iiu+nE54vWnennsnOx62dteP2i8KC46zg/VXaoDKmZjfUuZINU4\n1p7vQ39WJn9IPQ9axDaArCkYfFWULX+xQaym9fV+bT+Bg2fHow5DSiW/CiZm1MQC\ngFHvRVTLXZuDlD2TtIb7T8ANHVcrFA/44+Q3KSs84QICKX+ZspJ38cLt5KUO4qox\nKyVI7slW9X/r5RuNX05WnRqANtcoH2D2v8+zOih1Dp75TXINLTYP2BOWKoiTUQER\n1frORgc949fob1e6E4t1uV8pjF4ZS6d40v1/s+P7BpwEtShd4en6pkVPN7KFQZ40\nf6ConCXT3TozilGsvAqxH/2YYmkaGVj3e0l6iPC77QCiaBdeHmm2ySY0ErvgpgWX\n6s0eS7pleWT/DpDSfDEq3AixJo25h52PDsw8J0OvpLoL4lt7a3i0koibVr1WJzuV\nQjuVl+bxv8dSc+jkK5g+9WA0/TnqvjZxxNsZ0arxdohrLZxqDHE=\n=cCj8\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/0a3e59b5d23cbcc6ae0645c60d175c6bd156a15f",
          "sha": "0a3e59b5d23cbcc6ae0645c60d175c6bd156a15f",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/0a3e59b5d23cbcc6ae0645c60d175c6bd156a15f"
        }
      ],
      "message": "tests: add BIP-352 test vectors\n\nThe vectors are generated with a Python script that converts the .json\nfile from the BIP to C code:\n\n$ ./tools/tests_silentpayments_generate.py test_vectors.json > ./src/modules/silentpayments/vectors.h",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-06-29T11:37:09Z"
      },
      "author": {
        "name": "Sebastian Falbesoner",
        "email": "sebastian.falbesoner@gmail.com",
        "date": "2024-02-22T22:49:23Z"
      },
      "sha": "fc6c7f0abbaa03e2057f9366accc62e3e2ee9000"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKGFjNTkxMDUwMjYyZDlkMDBiNjI5OTQzZDU5OGY2MmI0N2UxY2E3YWU",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/ac591050262d9d00b629943d598f62b47e1ca7ae",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/ac591050262d9d00b629943d598f62b47e1ca7ae",
      "tree": {
        "sha": "ff983d3953d971752287076359321a4d6f1e34b6",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/ff983d3953d971752287076359321a4d6f1e34b6"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree ff983d3953d971752287076359321a4d6f1e34b6\nparent fc6c7f0abbaa03e2057f9366accc62e3e2ee9000\nauthor Sebastian Falbesoner <sebastian.falbesoner@gmail.com> 1708644341 +0100\ncommitter josibake <josibake@protonmail.com> 1719661029 +0200\n\nci: enable silentpayments module\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmZ/8eUACgkQity1WMTz\nPWWO3hAA2EZWlcgAnJ1WX3rZowxURFDDQ/PKEbWNoQeXP74Gi1Hp4RtBG830qB3c\nBKDd2DD502X+FhxX3b3XERMkaFlDxcO8vJaOI3VZwvoke+FltN2HvlJWhGmFLKm1\noQ4tdx8fkySVMwqe8bnj6CymWZDFupclVmJLdYwTqDKW5Emmxywr/be3KC+NSgw9\nt8Ws3B7fT1ZF2F3fDBl9eUkAsCSPVs7Q6TXXMYAnZs83Pgpo7krjBkF1iXUo9Nka\n2QcZn8g9GYCPaVrStiWtPdQppO9TfPTX6xJNuqjBq5G9Jgsu6g5w9VQbyf8uaift\nkB+C0aOiNhyA35MqS8wZx4Zyb0zxMIS1QOfkd7vJrKecHL1i0yNfjDn+uukfeY6u\nskM2Rp7/Y9O5mxaKW7+32yqn0pIxRO0CyhaKHs2P4taGBK39C95pZa2SlXqWJGLR\n52IZ5yEQeMjfC/bn85j1z5t+agSWxBn6RCLvUVAXDaTQH9PQBvfQu+EnS5igKNke\n2TX8C3mYozSW5S+unU87rg/sJ8L3vIkVTKe12Cv3aUQplbJf4tVA4SS0SA7+Ljxr\nYHwKFFisfZFS0MLurGGSwr3apNPqVqRLeIx2qBNrINYOtWvqxlZxqEuatZpxIhip\n3UH1pTARjcZaMCOVgVTWaIFfVo2T0ervq9H9z8QeEyRCYsfw+Bo=\n=sJ3o\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/fc6c7f0abbaa03e2057f9366accc62e3e2ee9000",
          "sha": "fc6c7f0abbaa03e2057f9366accc62e3e2ee9000",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/fc6c7f0abbaa03e2057f9366accc62e3e2ee9000"
        }
      ],
      "message": "ci: enable silentpayments module",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-06-29T11:37:09Z"
      },
      "author": {
        "name": "Sebastian Falbesoner",
        "email": "sebastian.falbesoner@gmail.com",
        "date": "2024-02-22T23:25:41Z"
      },
      "sha": "ac591050262d9d00b629943d598f62b47e1ca7ae"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 13339201347,
      "node_id": "HRFPE_lADOAP4Jqs6GTERUzwAAAAMbFA9D",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/13339201347",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-06-29T11:58:30Z"
    },
    {
      "event": "commented",
      "id": 2198126844,
      "node_id": "IC_kwDOAP4Jqs6DBMD8",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/2198126844",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-06-29T12:01:18Z",
      "updated_at": "2024-06-29T12:01:18Z",
      "author_association": "MEMBER",
      "body": "Update https://github.com/bitcoin-core/secp256k1/commit/2dde8f1fa13687d2bd8328f85ac412a4052b040c -> https://github.com/bitcoin-core/secp256k1/commit/ac591050262d9d00b629943d598f62b47e1ca7ae ([bip352-silentpayments-module-06](https://github.com/josibake/secp256k1/tree/bip352-silentpayments-module-06) -> [bip352-silentpayments-module-07](https://github.com/josibake/secp256k1/tree/bip352-silentpayments-module-07), [compare](https://github.com/josibake/secp256k1/compare/bip352-silentpayments-module-06..josibake:secp256k1:bip352-silentpayments-module-07))\r\n\r\n* Removes `ARG_CHECKS` for the sum to zero / infinity case\r\n* Adds the new test vector for sum to zero / infinity\r\n* Minor fix ups, e.g., `s/receiver/recipient`",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#issuecomment-2198126844",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1519"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1574947042",
      "pull_request_review_id": 2015096769,
      "id": 1574947042,
      "node_id": "PRRC_kwDOAP4Jqs5d38ji",
      "diff_hunk": "@@ -433,4 +433,137 @@ int secp256k1_silentpayments_recipient_public_data_parse(const secp256k1_context\n     return 1;\n }\n \n+int secp256k1_silentpayments_recipient_scan_outputs(\n+    const secp256k1_context *ctx,\n+    secp256k1_silentpayments_found_output **found_outputs, size_t *n_found_outputs,\n+    const secp256k1_xonly_pubkey * const *tx_outputs, size_t n_tx_outputs,\n+    const unsigned char *scan_key,\n+    const secp256k1_silentpayments_public_data *public_data,\n+    const secp256k1_pubkey *receiver_spend_pubkey,\n+    const secp256k1_silentpayments_label_lookup label_lookup,\n+    const void *label_context\n+) {\n+    secp256k1_scalar t_k_scalar;\n+    secp256k1_ge receiver_spend_pubkey_ge;\n+    secp256k1_xonly_pubkey P_output_xonly;\n+    secp256k1_pubkey A_sum;\n+    unsigned char shared_secret[33];\n+    size_t i, k, n_found;\n+    int found, combined;\n+\n+    /* Sanity check inputs */\n+    VERIFY_CHECK(ctx != NULL);\n+    ARG_CHECK(found_outputs != NULL);\n+    ARG_CHECK(tx_outputs != NULL);\n+    ARG_CHECK(scan_key != NULL);\n+    ARG_CHECK(public_data != NULL);\n+    combined = (int)public_data->data[0];\n+    {\n+        unsigned char input_hash[32];\n+        unsigned char *input_hash_ptr;\n+        if (combined) {\n+            input_hash_ptr = NULL;\n+        } else {\n+            memset(input_hash, 0, 32);\n+            input_hash_ptr = input_hash;\n+        }\n+        if (!secp256k1_silentpayments_recipient_public_data_load(ctx, &A_sum, input_hash_ptr, public_data)) {\n+            return 0;\n+        }\n+        secp256k1_pubkey_load(ctx, &receiver_spend_pubkey_ge, receiver_spend_pubkey);\n+        if (!secp256k1_silentpayments_create_shared_secret(ctx, shared_secret, scan_key, &A_sum, input_hash_ptr)) {\n+            return 0;\n+        }\n+    }\n+\n+    n_found = 0;\n+    k = 0;\n+    while (1) {\n+        secp256k1_ge P_output_ge = receiver_spend_pubkey_ge;\n+        /* Calculate t_k = hash(shared_secret || ser_32(k)) */\n+        secp256k1_silentpayments_create_t_k(&t_k_scalar, shared_secret, k);\n+\n+        /* Calculate P_output = B_spend + t_k * G */\n+        if (!secp256k1_eckey_pubkey_tweak_add(&P_output_ge, &t_k_scalar)) {\n+            return 0;\n+        }\n+\n+        /* If the calculated output matches the one from the tx, we have a direct match and can\n+         * return without labels calculation (one of the two would result in point of infinity) */\n+        secp256k1_xonly_pubkey_save(&P_output_xonly, &P_output_ge);\n+        found = 0;\n+        for (i = 0; i < n_tx_outputs; i++) {\n+            if (secp256k1_xonly_pubkey_cmp(ctx, &P_output_xonly, tx_outputs[i]) == 0) {\n+                found_outputs[n_found]->output = *tx_outputs[i];",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": null,
      "original_position": 65,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "f113564298e8e76813289fdcefa6968462dc3fda",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The `found_with_label` boolean needs to be set here, to not leave it uninitialized (I guess we don't want to rely on the user zeroing the `_found_output` struct instances before scanning):\r\n```suggestion\r\n                found_outputs[n_found]->output = *tx_outputs[i];\r\n                found_outputs[n_found]->found_with_label = 0;\r\n```\r\nShould we also set `label` here to something invalid for consistency, e.g. all-zero-bytes, even though the user wouldn't evaluate it anyways? Not sure what the best practices are in cases like this and if returning uninitialized data is acceptable.\r\n\r\nMight be nice to update the tests to also check for the `found_with_label` flag. ",
      "created_at": "2024-04-22T15:21:20Z",
      "updated_at": "2024-04-22T16:26:35Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1574947042",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1574947042"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 497,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1574962225",
      "pull_request_review_id": 2015096769,
      "id": 1574962225,
      "node_id": "PRRC_kwDOAP4Jqs5d4AQx",
      "diff_hunk": "@@ -222,6 +222,57 @@ SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipien\n     size_t n_plain_pubkeys\n ) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);\n \n+/** Scan for Silent Payment transaction outputs.\n+ *\n+ *  Given a input public sum, an input_hash, a recipient's spend public key B_spend, and the relevant transaction\n+ *  outputs, scan for outputs belong to the recipient and return the tweak(s) needed for spending\n+ *  the output(s). An optional label_lookup callback function and label_context can be passed if the\n+ *  recipient uses labels. This allows for checking if a label exists in the recipients label cache\n+ *  and retrieving the label tweak during scanning.\n+ *\n+ *  Returns: 1 if output scanning was successful. 0 if an error occured.\n+ *  Args:                  ctx: pointer to a context object\n+ *  Out:         found_outputs: pointer to an array of pointers to found output objects. The found outputs\n+ *                              array MUST be initialized to be the same length as the tx_outputs array\n+ *             n_found_outputs: pointer to an integer indicating the final size of the found outputs array.\n+ *                              This number represents the number of outputs found while scanning (0 if\n+ *                              none are found)\n+ *  In:             tx_outputs: pointer to the tx's x-only public key outputs\n+ *                n_tx_outputs: the number of tx_outputs being scanned\n+ *                    scan_key: pointer to the recipient's scan key\n+ *           public_tweak_data: pointer to the input public key sum (optionaly, with the `input_hash`",
      "path": "include/secp256k1_silentpayments.h",
      "position": null,
      "original_position": 22,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "f113564298e8e76813289fdcefa6968462dc3fda",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n *                 public_data: pointer to the input public key sum (optionaly, with the `input_hash`\r\n```",
      "created_at": "2024-04-22T15:30:04Z",
      "updated_at": "2024-04-22T16:26:35Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1574962225",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1574962225"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 243,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1574963125",
      "pull_request_review_id": 2015096769,
      "id": 1574963125,
      "node_id": "PRRC_kwDOAP4Jqs5d4Ae1",
      "diff_hunk": "@@ -222,6 +222,57 @@ SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipien\n     size_t n_plain_pubkeys\n ) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);\n \n+/** Scan for Silent Payment transaction outputs.\n+ *\n+ *  Given a input public sum, an input_hash, a recipient's spend public key B_spend, and the relevant transaction\n+ *  outputs, scan for outputs belong to the recipient and return the tweak(s) needed for spending\n+ *  the output(s). An optional label_lookup callback function and label_context can be passed if the\n+ *  recipient uses labels. This allows for checking if a label exists in the recipients label cache\n+ *  and retrieving the label tweak during scanning.\n+ *\n+ *  Returns: 1 if output scanning was successful. 0 if an error occured.\n+ *  Args:                  ctx: pointer to a context object\n+ *  Out:         found_outputs: pointer to an array of pointers to found output objects. The found outputs\n+ *                              array MUST be initialized to be the same length as the tx_outputs array\n+ *             n_found_outputs: pointer to an integer indicating the final size of the found outputs array.\n+ *                              This number represents the number of outputs found while scanning (0 if\n+ *                              none are found)\n+ *  In:             tx_outputs: pointer to the tx's x-only public key outputs\n+ *                n_tx_outputs: the number of tx_outputs being scanned\n+ *                    scan_key: pointer to the recipient's scan key\n+ *           public_tweak_data: pointer to the input public key sum (optionaly, with the `input_hash`\n+ *                              multiplied in, see `_recipient_compute_public_data`).\n+ *      recipient_spend_pubkey: pointer to the receiver's spend pubkey\n+ *                  input_hash: pointer to the input_hash. MUST be NULL if the input_hash is already\n+ *                              multipled into the input public key sum (see `_recipient_compute_public_data`)",
      "path": "include/secp256k1_silentpayments.h",
      "position": null,
      "original_position": 26,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "f113564298e8e76813289fdcefa6968462dc3fda",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n```\r\n(parameter doesn't exist anymore)",
      "created_at": "2024-04-22T15:30:22Z",
      "updated_at": "2024-04-22T16:26:35Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1574963125",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1574963125"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": 246,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 247,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1574976504",
      "pull_request_review_id": 2015096769,
      "id": 1574976504,
      "node_id": "PRRC_kwDOAP4Jqs5d4Dv4",
      "diff_hunk": "@@ -328,4 +328,109 @@ int secp256k1_silentpayments_recipient_create_labelled_spend_pubkey(const secp25\n     return 1;\n }\n \n+int secp256k1_silentpayments_recipient_public_data_create(\n+    const secp256k1_context *ctx,\n+    secp256k1_silentpayments_public_data *public_data,\n+    const unsigned char *outpoint_smallest36,\n+    const secp256k1_xonly_pubkey * const *xonly_pubkeys,\n+    size_t n_xonly_pubkeys,\n+    const secp256k1_pubkey * const *plain_pubkeys,\n+    size_t n_plain_pubkeys\n+) {\n+    size_t i;\n+    size_t pubkeylen = 65;\n+    secp256k1_pubkey A_sum;\n+    secp256k1_ge A_sum_ge, addend;\n+    secp256k1_gej A_sum_gej;\n+    unsigned char input_hash_local[32];\n+\n+    /* Sanity check inputs */\n+    VERIFY_CHECK(ctx != NULL);\n+    ARG_CHECK(public_data != NULL);\n+    ARG_CHECK(plain_pubkeys == NULL || n_plain_pubkeys >= 1);\n+    ARG_CHECK(xonly_pubkeys == NULL || n_xonly_pubkeys >= 1);\n+    ARG_CHECK((plain_pubkeys != NULL) || (xonly_pubkeys != NULL));\n+    ARG_CHECK((n_plain_pubkeys + n_xonly_pubkeys) >= 1);\n+    ARG_CHECK(outpoint_smallest36 != NULL);\n+    memset(input_hash_local, 0, 32);\n+\n+    /* Compute input public keys sum: A_sum = A_1 + A_2 + ... + A_n */\n+    secp256k1_gej_set_infinity(&A_sum_gej);\n+    for (i = 0; i < n_plain_pubkeys; i++) {\n+        secp256k1_pubkey_load(ctx, &addend, plain_pubkeys[i]);\n+        secp256k1_gej_add_ge(&A_sum_gej, &A_sum_gej, &addend);",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": null,
      "original_position": 34,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "4fb8716f4f1f6b10757f53024eb22263829fe888",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Not sure why I chose the constant-time point addition routines back then in #1471 (probably was inspired by `_ec_pubkey_combine`), but I strongly suspect that they are not needed for summing up public data:\r\n```suggestion\r\n        secp256k1_gej_add_ge_var(&A_sum_gej, &A_sum_gej, &addend, NULL);\r\n```\r\n(also for second summing loop a few lines below)",
      "created_at": "2024-04-22T15:39:48Z",
      "updated_at": "2024-04-22T16:26:35Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1574976504",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1574976504"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 361,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1574990516",
      "pull_request_review_id": 2015096769,
      "id": 1574990516,
      "node_id": "PRRC_kwDOAP4Jqs5d4HK0",
      "diff_hunk": "@@ -0,0 +1,264 @@\n+/***********************************************************************\n+ * Distributed under the MIT software license, see the accompanying    *\n+ * file COPYING or https://www.opensource.org/licenses/mit-license.php.*\n+ ***********************************************************************/\n+\n+#ifndef SECP256K1_MODULE_SILENTPAYMENTS_TESTS_H\n+#define SECP256K1_MODULE_SILENTPAYMENTS_TESTS_H\n+\n+#include \"../../../include/secp256k1_silentpayments.h\"\n+#include \"../../../src/modules/silentpayments/vectors.h\"\n+#include \"../../../examples/examples_util.h\"\n+#include \"assert.h\"\n+\n+struct label_cache_entry {\n+    secp256k1_pubkey label;\n+    unsigned char label_tweak[32];\n+};\n+struct labels_cache {\n+    const secp256k1_context *ctx;\n+    size_t entries_used;\n+    struct label_cache_entry entries[10];\n+};\n+struct labels_cache labels_cache;\n+const unsigned char* label_lookup(const secp256k1_pubkey* key, const void* cache_ptr) {\n+    const struct labels_cache* cache = (const struct labels_cache*)cache_ptr;\n+    size_t i;\n+    for (i = 0; i < cache->entries_used; i++) {\n+        if (secp256k1_ec_pubkey_cmp(cache->ctx, &cache->entries[i].label, key) == 0) {\n+            return cache->entries[i].label_tweak;\n+        }\n+    }\n+    return NULL;\n+}\n+\n+void run_silentpayments_test_vector_send(const struct bip352_test_vector *test) {\n+    secp256k1_silentpayments_recipient recipients[MAX_OUTPUTS_PER_TEST_CASE];\n+    const secp256k1_silentpayments_recipient *recipient_ptrs[MAX_OUTPUTS_PER_TEST_CASE];\n+    secp256k1_xonly_pubkey generated_outputs[MAX_OUTPUTS_PER_TEST_CASE];\n+    secp256k1_xonly_pubkey *generated_output_ptrs[MAX_OUTPUTS_PER_TEST_CASE];\n+    secp256k1_keypair taproot_keypairs[MAX_INPUTS_PER_TEST_CASE];\n+    secp256k1_keypair const *taproot_keypair_ptrs[MAX_INPUTS_PER_TEST_CASE];\n+    unsigned char const *plain_seckeys[MAX_INPUTS_PER_TEST_CASE];\n+    unsigned char created_output[32];\n+    size_t i, j;\n+    int match;\n+\n+    /* Check that sender creates expected outputs */\n+    for (i = 0; i < test->num_outputs; i++) {\n+        CHECK(secp256k1_ec_pubkey_parse(CTX, &recipients[i].scan_pubkey, test->recipient_pubkeys[i].scan_pubkey, 33));\n+        CHECK(secp256k1_ec_pubkey_parse(CTX, &recipients[i].spend_pubkey, test->recipient_pubkeys[i].spend_pubkey, 33));\n+        recipients[i].index = i;\n+        recipient_ptrs[i] = &recipients[i];\n+        generated_output_ptrs[i] = &generated_outputs[i];\n+    }\n+    for (i = 0; i < test->num_plain_inputs; i++) {\n+        plain_seckeys[i] = test->plain_seckeys[i];\n+    }\n+    for (i = 0; i < test->num_taproot_inputs; i++) {\n+        int ret = secp256k1_keypair_create(CTX, &taproot_keypairs[i], test->taproot_seckeys[i]);\n+        assert(ret);\n+        taproot_keypair_ptrs[i] = &taproot_keypairs[i];\n+    }\n+    CHECK(secp256k1_silentpayments_sender_create_outputs(CTX,\n+                generated_output_ptrs,\n+                recipient_ptrs,\n+                test->num_outputs,\n+                test->outpoint_smallest,\n+                test->num_taproot_inputs > 0 ? taproot_keypair_ptrs : NULL, test->num_taproot_inputs,\n+                test->num_plain_inputs > 0 ? plain_seckeys : NULL, test->num_plain_inputs\n+    ));\n+    for (i = 0; i < test->num_outputs; i++) {\n+        CHECK(secp256k1_xonly_pubkey_serialize(CTX, created_output, &generated_outputs[i]));\n+        match = 0;\n+        /* Loop over both lists to ensure tests don't fail due to different orderings of outputs */\n+        for (j = 0; j < test->num_recipient_outputs; j++) {\n+            if (secp256k1_memcmp_var(created_output, test->recipient_outputs[j], 32) == 0) {\n+                match = 1;\n+                break;\n+            }\n+        }\n+        CHECK(match);\n+    }\n+}\n+\n+void run_silentpayments_test_vector_receive(const struct bip352_test_vector *test) {\n+    secp256k1_pubkey plain_pubkeys_objs[MAX_INPUTS_PER_TEST_CASE];\n+    secp256k1_xonly_pubkey xonly_pubkeys_objs[MAX_INPUTS_PER_TEST_CASE];\n+    secp256k1_xonly_pubkey tx_output_objs[MAX_OUTPUTS_PER_TEST_CASE];\n+    secp256k1_silentpayments_found_output found_output_objs[MAX_OUTPUTS_PER_TEST_CASE];\n+    secp256k1_pubkey const *plain_pubkeys[MAX_INPUTS_PER_TEST_CASE];\n+    secp256k1_xonly_pubkey const *xonly_pubkeys[MAX_INPUTS_PER_TEST_CASE];\n+    secp256k1_xonly_pubkey const *tx_outputs[MAX_OUTPUTS_PER_TEST_CASE];\n+    secp256k1_silentpayments_found_output *found_outputs[MAX_OUTPUTS_PER_TEST_CASE];\n+    unsigned char found_outputs_light_client[MAX_OUTPUTS_PER_TEST_CASE][32];\n+    secp256k1_pubkey receiver_scan_pubkey;\n+    secp256k1_pubkey receiver_spend_pubkey;\n+    size_t i,j;\n+    int match;\n+    size_t n_found = 0;\n+    unsigned char found_output[32];\n+    unsigned char found_signatures[10][64];\n+    secp256k1_silentpayments_public_data public_data, public_data_index;\n+    unsigned char shared_secret_lightclient[33];\n+    unsigned char light_client_data[33];\n+\n+\n+    /* prepare the inputs */\n+    {\n+        for (i = 0; i < test->num_plain_inputs; i++) {\n+            CHECK(secp256k1_ec_pubkey_parse(CTX, &plain_pubkeys_objs[i], test->plain_pubkeys[i], 33));\n+            plain_pubkeys[i] = &plain_pubkeys_objs[i];\n+        }\n+        for (i = 0; i < test->num_taproot_inputs; i++) {\n+            CHECK(secp256k1_xonly_pubkey_parse(CTX, &xonly_pubkeys_objs[i], test->xonly_pubkeys[i]));\n+            xonly_pubkeys[i] = &xonly_pubkeys_objs[i];\n+        }\n+        CHECK(secp256k1_silentpayments_recipient_public_data_create(CTX, &public_data,\n+            test->outpoint_smallest,\n+            test->num_taproot_inputs > 0 ? xonly_pubkeys : NULL, test->num_taproot_inputs,\n+            test->num_plain_inputs > 0 ? plain_pubkeys : NULL, test->num_plain_inputs\n+        ));\n+    }\n+    /* prepare the outputs */\n+    {\n+        for (i = 0; i < test->num_to_scan_outputs; i++) {\n+            CHECK(secp256k1_xonly_pubkey_parse(CTX, &tx_output_objs[i], test->to_scan_outputs[i]));\n+            tx_outputs[i] = &tx_output_objs[i];\n+        }\n+        for (i = 0; i < test->num_found_output_pubkeys; i++) {\n+            found_outputs[i] = &found_output_objs[i];\n+        }\n+    }\n+\n+    /* scan / spend pubkeys are not in the given data of the receiver part, so let's compute them */\n+    CHECK(secp256k1_ec_pubkey_create(CTX, &receiver_scan_pubkey, test->scan_seckey));\n+    CHECK(secp256k1_ec_pubkey_create(CTX, &receiver_spend_pubkey, test->spend_seckey));\n+\n+    /* create labels cache */\n+    labels_cache.ctx = CTX;\n+    labels_cache.entries_used = 0;\n+    for (i = 0; i < test->num_labels; i++) {\n+        unsigned int m = test->label_integers[i];\n+        struct label_cache_entry *cache_entry = &labels_cache.entries[labels_cache.entries_used];\n+        CHECK(secp256k1_silentpayments_recipient_create_label_tweak(CTX, &cache_entry->label, cache_entry->label_tweak, test->scan_seckey, m));\n+        labels_cache.entries_used++;\n+    }\n+    CHECK(secp256k1_silentpayments_recipient_scan_outputs(CTX,\n+        found_outputs, &n_found,\n+        tx_outputs, test->num_to_scan_outputs,\n+        test->scan_seckey,\n+        &public_data,\n+        &receiver_spend_pubkey,\n+        label_lookup, &labels_cache)\n+    );\n+    for (i = 0; i < n_found; i++) {\n+        unsigned char full_seckey[32];\n+        secp256k1_keypair keypair;\n+        unsigned char signature[64];\n+        const unsigned char msg32[32] = /* sha256(\"message\") */\n+            {0xab,0x53,0x0a,0x13,0xe4,0x59,0x14,0x98,0x2b,0x79,0xf9,0xb7,0xe3,0xfb,0xa9,0x94,\n+             0xcf,0xd1,0xf3,0xfb,0x22,0xf7,0x1c,0xea,0x1a,0xfb,0xf0,0x2b,0x46,0x0c,0x6d,0x1d};\n+        const unsigned char aux32[32] = /* sha256(\"random auxiliary data\") */\n+            {0x0b,0x3f,0xdd,0xfd,0x67,0xbf,0x76,0xae,0x76,0x39,0xee,0x73,0x5b,0x70,0xff,0x15,\n+             0x83,0xfd,0x92,0x48,0xc0,0x57,0xd2,0x86,0x07,0xa2,0x15,0xf4,0x0b,0x0a,0x3e,0xcc};\n+        memcpy(&full_seckey, test->spend_seckey, 32);\n+        CHECK(secp256k1_ec_seckey_tweak_add(CTX, full_seckey, found_outputs[i]->tweak));\n+        CHECK(secp256k1_keypair_create(CTX, &keypair, full_seckey));\n+        CHECK(secp256k1_schnorrsig_sign32(CTX, signature, msg32, &keypair, aux32));\n+        memcpy(found_signatures[i], signature, 64);\n+    }\n+\n+    /* compare expected and scanned outputs (including calculated seckey tweaks and signatures) */\n+    for (i = 0; i < n_found; i++) {\n+        CHECK(secp256k1_xonly_pubkey_serialize(CTX, found_output, &found_outputs[i]->output));\n+        match = 0;\n+        for (j = 0; j < test->num_found_output_pubkeys; j++) {\n+            if (secp256k1_memcmp_var(&found_output, test->found_output_pubkeys[j], 32) == 0) {\n+                match = 1;\n+                CHECK(secp256k1_memcmp_var(found_outputs[i]->tweak, test->found_seckey_tweaks[j], 32) == 0);\n+                CHECK(secp256k1_memcmp_var(found_signatures[i], test->found_signatures[j], 64) == 0);\n+                break;\n+            }\n+        }\n+        CHECK(match);\n+    }\n+    CHECK(n_found == test->num_found_output_pubkeys);\n+    /* Scan as a light client\n+     * it is not recommended to use labels as a light client so here we are only\n+     * running this on tests that do not involve labels. Primarily, this test is to\n+     * ensure that _recipient_created_shared_secret and _create_shared_secret are the same\n+     */\n+    if (test->num_labels == 0) {\n+        CHECK(secp256k1_silentpayments_recipient_public_data_serialize(CTX, light_client_data, &public_data));\n+        CHECK(secp256k1_silentpayments_recipient_public_data_parse(CTX, &public_data_index, light_client_data));\n+        CHECK(secp256k1_silentpayments_recipient_create_shared_secret(CTX, shared_secret_lightclient, test->scan_seckey, &public_data_index));\n+        n_found = 0;\n+        {\n+            int found = 0;\n+            size_t k = 0;\n+            secp256k1_xonly_pubkey potential_output;\n+            unsigned char xonly_print[32];\n+\n+            while(1) {\n+\n+                CHECK(secp256k1_silentpayments_recipient_create_output_pubkey(CTX,\n+                    &potential_output,\n+                    shared_secret_lightclient,\n+                    &receiver_spend_pubkey,\n+                    k\n+                ));\n+                /* At this point, we check that the utxo exists with a light client protocol.\n+                 * For this example, we'll just iterate through the list of pubkeys */\n+                found = 0;\n+                secp256k1_xonly_pubkey_serialize(CTX, xonly_print, &potential_output);\n+                printf(\"what we generated :\");\n+                print_hex(xonly_print, 32);",
      "path": "src/modules/silentpayments/tests_impl.h",
      "position": null,
      "original_position": 216,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "85946762a59c39dfe21ac899359bcac443ab8d20",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Tests are usually silent, so this should be removed (or maybe put in some verbose/debug #if block, though I'm not sure if this is considered a good idea due to increased maintenance burden):\r\n```suggestion\r\n```",
      "created_at": "2024-04-22T15:49:34Z",
      "updated_at": "2024-04-22T16:26:35Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1574990516",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1574990516"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": 215,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 216,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1575010116",
      "pull_request_review_id": 2015096769,
      "id": 1575010116,
      "node_id": "PRRC_kwDOAP4Jqs5d4L9E",
      "diff_hunk": "@@ -433,4 +433,137 @@ int secp256k1_silentpayments_recipient_public_data_parse(const secp256k1_context\n     return 1;\n }\n \n+int secp256k1_silentpayments_recipient_scan_outputs(\n+    const secp256k1_context *ctx,\n+    secp256k1_silentpayments_found_output **found_outputs, size_t *n_found_outputs,\n+    const secp256k1_xonly_pubkey * const *tx_outputs, size_t n_tx_outputs,\n+    const unsigned char *scan_key,\n+    const secp256k1_silentpayments_public_data *public_data,\n+    const secp256k1_pubkey *receiver_spend_pubkey,\n+    const secp256k1_silentpayments_label_lookup label_lookup,\n+    const void *label_context\n+) {\n+    secp256k1_scalar t_k_scalar;\n+    secp256k1_ge receiver_spend_pubkey_ge;\n+    secp256k1_xonly_pubkey P_output_xonly;\n+    secp256k1_pubkey A_sum;\n+    unsigned char shared_secret[33];\n+    size_t i, k, n_found;\n+    int found, combined;\n+\n+    /* Sanity check inputs */\n+    VERIFY_CHECK(ctx != NULL);\n+    ARG_CHECK(found_outputs != NULL);\n+    ARG_CHECK(tx_outputs != NULL);\n+    ARG_CHECK(scan_key != NULL);\n+    ARG_CHECK(public_data != NULL);\n+    combined = (int)public_data->data[0];\n+    {\n+        unsigned char input_hash[32];\n+        unsigned char *input_hash_ptr;\n+        if (combined) {\n+            input_hash_ptr = NULL;\n+        } else {\n+            memset(input_hash, 0, 32);\n+            input_hash_ptr = input_hash;\n+        }\n+        if (!secp256k1_silentpayments_recipient_public_data_load(ctx, &A_sum, input_hash_ptr, public_data)) {\n+            return 0;\n+        }\n+        secp256k1_pubkey_load(ctx, &receiver_spend_pubkey_ge, receiver_spend_pubkey);\n+        if (!secp256k1_silentpayments_create_shared_secret(ctx, shared_secret, scan_key, &A_sum, input_hash_ptr)) {\n+            return 0;\n+        }\n+    }\n+\n+    n_found = 0;\n+    k = 0;\n+    while (1) {\n+        secp256k1_ge P_output_ge = receiver_spend_pubkey_ge;\n+        /* Calculate t_k = hash(shared_secret || ser_32(k)) */\n+        secp256k1_silentpayments_create_t_k(&t_k_scalar, shared_secret, k);\n+\n+        /* Calculate P_output = B_spend + t_k * G */\n+        if (!secp256k1_eckey_pubkey_tweak_add(&P_output_ge, &t_k_scalar)) {\n+            return 0;\n+        }\n+\n+        /* If the calculated output matches the one from the tx, we have a direct match and can\n+         * return without labels calculation (one of the two would result in point of infinity) */\n+        secp256k1_xonly_pubkey_save(&P_output_xonly, &P_output_ge);\n+        found = 0;\n+        for (i = 0; i < n_tx_outputs; i++) {\n+            if (secp256k1_xonly_pubkey_cmp(ctx, &P_output_xonly, tx_outputs[i]) == 0) {\n+                found_outputs[n_found]->output = *tx_outputs[i];\n+                secp256k1_scalar_get_b32(found_outputs[n_found]->tweak, &t_k_scalar);\n+                found = 1;\n+                n_found++;\n+                k++;\n+                break;\n+            }\n+\n+            /* If desired, also calculate label candidates */\n+            if (label_lookup != NULL) {",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": null,
      "original_position": 74,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "f113564298e8e76813289fdcefa6968462dc3fda",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The handling of the first and second scan label candidate look quite similar (both their calculation and the setting of the found output / advancing the counters if the label lookup in the cache was successful), seems like quite a bit of code could be duplicated here.",
      "created_at": "2024-04-22T16:01:32Z",
      "updated_at": "2024-04-22T16:26:35Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1575010116",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1575010116"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": 505,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 509,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1575023482",
      "pull_request_review_id": 2015096769,
      "id": 1575023482,
      "node_id": "PRRC_kwDOAP4Jqs5d4PN6",
      "diff_hunk": "@@ -40,6 +40,59 @@ typedef struct {\n     size_t index;\n } secp256k1_silentpayments_recipient;\n \n+/** Create Silent Payment outputs for recipient(s).\n+ *\n+ * Given a list of n private keys a_1...a_n (one for each silent payment\n+ * eligible input to spend), a serialized outpoint, and a list of recipients,\n+ * create the taproot outputs:\n+ *\n+ * a_sum = a_1 + a_2 + ... + a_n\n+ * input_hash = hash(outpoint_smallest || (a_sum * G))\n+ * taproot_output = B_spend + hash(a_sum * input_hash * B_scan || k) * G\n+ *\n+ * If necessary, the private keys are negated to enforce the right y-parity.\n+ * For that reason, the private keys have to be passed in via two different parameter\n+ * pairs, depending on whether they seckeys correspond to x-only outputs or not.\n+ *\n+ *  Returns: 1 if shared secret creation was successful. 0 if an error occured.\n+ *   Args:                 ctx: pointer to a context object\n+ *    Out:   generated_outputs: pointer to an array of pointers to xonly pubkeys, one per recipient.\n+ *                              The order of outputs here matches the original ordering of the\n+ *                              recipients array.\n+ *     In:          recipients: pointer to an array of pointers to silent payment recipients,",
      "path": "include/secp256k1_silentpayments.h",
      "position": 62,
      "original_position": 23,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "14ca7545780a1a60a5039a677546c066988654c0",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Considering that the array is sorted in-place, is this in the category \"In/Out\"?",
      "created_at": "2024-04-22T16:10:37Z",
      "updated_at": "2024-04-22T16:26:35Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1575023482",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1575023482"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 62,
      "original_line": 62,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1575037779",
      "pull_request_review_id": 2015096769,
      "id": 1575037779,
      "node_id": "PRRC_kwDOAP4Jqs5d4StT",
      "diff_hunk": "@@ -173,4 +173,94 @@ int secp256k1_silentpayments_create_output_pubkey(const secp256k1_context *ctx,\n     return 1;\n }\n \n+int secp256k1_silentpayments_sender_create_outputs(\n+    const secp256k1_context *ctx,\n+    secp256k1_xonly_pubkey **generated_outputs,\n+    const secp256k1_silentpayments_recipient **recipients,\n+    size_t n_recipients,\n+    const unsigned char *outpoint_smallest36,\n+    const secp256k1_keypair * const *taproot_seckeys,\n+    size_t n_taproot_seckeys,\n+    const unsigned char * const *plain_seckeys,\n+    size_t n_plain_seckeys\n+) {\n+    size_t i, k;\n+    secp256k1_scalar a_sum_scalar, addend;\n+    secp256k1_ge A_sum_ge;\n+    secp256k1_gej A_sum_gej;\n+    unsigned char input_hash[32];\n+    unsigned char a_sum[32];\n+    unsigned char shared_secret[33];\n+    secp256k1_silentpayments_recipient last_recipient;\n+\n+    /* Sanity check inputs. */\n+    VERIFY_CHECK(ctx != NULL);\n+    ARG_CHECK(recipients != NULL);\n+    ARG_CHECK(secp256k1_ecmult_gen_context_is_built(&ctx->ecmult_gen_ctx));\n+    ARG_CHECK(plain_seckeys == NULL || n_plain_seckeys >= 1);\n+    ARG_CHECK(taproot_seckeys == NULL || n_taproot_seckeys >= 1);\n+    ARG_CHECK((plain_seckeys != NULL) || (taproot_seckeys != NULL));\n+    ARG_CHECK((n_plain_seckeys + n_taproot_seckeys) >= 1);\n+    ARG_CHECK(outpoint_smallest36 != NULL);\n+    /* ensure the index field is set correctly */\n+    for (i = 0; i < n_recipients; i++) {\n+        ARG_CHECK(recipients[i]->index == i);\n+    }\n+\n+    /* Compute input private keys sum: a_sum = a_1 + a_2 + ... + a_n */\n+    a_sum_scalar = secp256k1_scalar_zero;\n+    for (i = 0; i < n_plain_seckeys; i++) {\n+        int ret = secp256k1_scalar_set_b32_seckey(&addend, plain_seckeys[i]);\n+        VERIFY_CHECK(ret);\n+        (void)ret;\n+\n+        secp256k1_scalar_add(&a_sum_scalar, &a_sum_scalar, &addend);\n+        VERIFY_CHECK(!secp256k1_scalar_is_zero(&a_sum_scalar));\n+    }\n+    /* private keys used for taproot outputs have to be negated if they resulted in an odd point */\n+    for (i = 0; i < n_taproot_seckeys; i++) {\n+        secp256k1_ge addend_point;\n+        int ret = secp256k1_keypair_load(ctx, &addend, &addend_point, taproot_seckeys[i]);\n+        VERIFY_CHECK(ret);\n+        (void)ret;\n+        /* declassify addend_point to allow using it as a branch point (this is fine because addend_point is not a secret) */\n+        secp256k1_declassify(ctx, &addend_point, sizeof(addend_point));\n+        secp256k1_fe_normalize_var(&addend_point.y);",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": null,
      "original_position": 56,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "14ca7545780a1a60a5039a677546c066988654c0",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Now that we get the point from a keypair instance, I think these lines are not needed anymore (see e.g. [a similar secret key negation code part in the schnorrsig module](https://github.com/bitcoin-core/secp256k1/blob/da515074e3ebc8abc85a4fff3a31d7694ecf897b/src/modules/schnorrsig/main_impl.h#L154-L160)):\r\n```suggestion\r\n```",
      "created_at": "2024-04-22T16:22:16Z",
      "updated_at": "2024-04-22T16:26:35Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1575037779",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1575037779"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": 226,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 228,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1575039817",
      "pull_request_review_id": 2015096769,
      "id": 1575039817,
      "node_id": "PRRC_kwDOAP4Jqs5d4TNJ",
      "diff_hunk": "@@ -173,4 +173,94 @@ int secp256k1_silentpayments_create_output_pubkey(const secp256k1_context *ctx,\n     return 1;\n }\n \n+int secp256k1_silentpayments_sender_create_outputs(\n+    const secp256k1_context *ctx,\n+    secp256k1_xonly_pubkey **generated_outputs,\n+    const secp256k1_silentpayments_recipient **recipients,\n+    size_t n_recipients,\n+    const unsigned char *outpoint_smallest36,\n+    const secp256k1_keypair * const *taproot_seckeys,\n+    size_t n_taproot_seckeys,\n+    const unsigned char * const *plain_seckeys,\n+    size_t n_plain_seckeys\n+) {\n+    size_t i, k;\n+    secp256k1_scalar a_sum_scalar, addend;\n+    secp256k1_ge A_sum_ge;\n+    secp256k1_gej A_sum_gej;\n+    unsigned char input_hash[32];\n+    unsigned char a_sum[32];\n+    unsigned char shared_secret[33];\n+    secp256k1_silentpayments_recipient last_recipient;\n+\n+    /* Sanity check inputs. */\n+    VERIFY_CHECK(ctx != NULL);\n+    ARG_CHECK(recipients != NULL);\n+    ARG_CHECK(secp256k1_ecmult_gen_context_is_built(&ctx->ecmult_gen_ctx));\n+    ARG_CHECK(plain_seckeys == NULL || n_plain_seckeys >= 1);\n+    ARG_CHECK(taproot_seckeys == NULL || n_taproot_seckeys >= 1);\n+    ARG_CHECK((plain_seckeys != NULL) || (taproot_seckeys != NULL));\n+    ARG_CHECK((n_plain_seckeys + n_taproot_seckeys) >= 1);\n+    ARG_CHECK(outpoint_smallest36 != NULL);\n+    /* ensure the index field is set correctly */\n+    for (i = 0; i < n_recipients; i++) {\n+        ARG_CHECK(recipients[i]->index == i);\n+    }\n+\n+    /* Compute input private keys sum: a_sum = a_1 + a_2 + ... + a_n */\n+    a_sum_scalar = secp256k1_scalar_zero;\n+    for (i = 0; i < n_plain_seckeys; i++) {\n+        int ret = secp256k1_scalar_set_b32_seckey(&addend, plain_seckeys[i]);\n+        VERIFY_CHECK(ret);\n+        (void)ret;\n+\n+        secp256k1_scalar_add(&a_sum_scalar, &a_sum_scalar, &addend);\n+        VERIFY_CHECK(!secp256k1_scalar_is_zero(&a_sum_scalar));\n+    }\n+    /* private keys used for taproot outputs have to be negated if they resulted in an odd point */\n+    for (i = 0; i < n_taproot_seckeys; i++) {\n+        secp256k1_ge addend_point;\n+        int ret = secp256k1_keypair_load(ctx, &addend, &addend_point, taproot_seckeys[i]);\n+        VERIFY_CHECK(ret);",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": null,
      "original_position": 52,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "14ca7545780a1a60a5039a677546c066988654c0",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Should we return an error (i.e. `return 0`) here if the user passes in an invalid keypair?",
      "created_at": "2024-04-22T16:24:01Z",
      "updated_at": "2024-04-22T16:26:35Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1575039817",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1575039817"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": 223,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 224,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1577437389",
      "pull_request_review_id": 2019121206,
      "id": 1577437389,
      "node_id": "PRRC_kwDOAP4Jqs5eBcjN",
      "diff_hunk": "@@ -40,6 +40,59 @@ typedef struct {\n     size_t index;\n } secp256k1_silentpayments_recipient;\n \n+/** Create Silent Payment outputs for recipient(s).\n+ *\n+ * Given a list of n private keys a_1...a_n (one for each silent payment\n+ * eligible input to spend), a serialized outpoint, and a list of recipients,\n+ * create the taproot outputs:\n+ *\n+ * a_sum = a_1 + a_2 + ... + a_n\n+ * input_hash = hash(outpoint_smallest || (a_sum * G))\n+ * taproot_output = B_spend + hash(a_sum * input_hash * B_scan || k) * G\n+ *\n+ * If necessary, the private keys are negated to enforce the right y-parity.\n+ * For that reason, the private keys have to be passed in via two different parameter\n+ * pairs, depending on whether they seckeys correspond to x-only outputs or not.\n+ *\n+ *  Returns: 1 if shared secret creation was successful. 0 if an error occured.\n+ *   Args:                 ctx: pointer to a context object\n+ *    Out:   generated_outputs: pointer to an array of pointers to xonly pubkeys, one per recipient.\n+ *                              The order of outputs here matches the original ordering of the\n+ *                              recipients array.\n+ *     In:          recipients: pointer to an array of pointers to silent payment recipients,",
      "path": "include/secp256k1_silentpayments.h",
      "position": 62,
      "original_position": 23,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "14ca7545780a1a60a5039a677546c066988654c0",
      "in_reply_to_id": 1575023482,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Good question. I would argue no, since the caller is passing the array in and then never using it again. The fact that the array is sorted in place is irrelevant to the caller since they shouldn't be reading those values again, anyways. But maybe there is a more strict definition of In/Out, that if the function can modify the parameter it is an Out param?",
      "created_at": "2024-04-24T07:46:38Z",
      "updated_at": "2024-04-24T07:46:38Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1577437389",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1577437389"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 62,
      "original_line": 62,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1577545322",
      "pull_request_review_id": 2019306258,
      "id": 1577545322,
      "node_id": "PRRC_kwDOAP4Jqs5eB25q",
      "diff_hunk": "@@ -40,6 +40,59 @@ typedef struct {\n     size_t index;\n } secp256k1_silentpayments_recipient;\n \n+/** Create Silent Payment outputs for recipient(s).\n+ *\n+ * Given a list of n private keys a_1...a_n (one for each silent payment\n+ * eligible input to spend), a serialized outpoint, and a list of recipients,\n+ * create the taproot outputs:\n+ *\n+ * a_sum = a_1 + a_2 + ... + a_n\n+ * input_hash = hash(outpoint_smallest || (a_sum * G))\n+ * taproot_output = B_spend + hash(a_sum * input_hash * B_scan || k) * G\n+ *\n+ * If necessary, the private keys are negated to enforce the right y-parity.\n+ * For that reason, the private keys have to be passed in via two different parameter\n+ * pairs, depending on whether they seckeys correspond to x-only outputs or not.\n+ *\n+ *  Returns: 1 if shared secret creation was successful. 0 if an error occured.\n+ *   Args:                 ctx: pointer to a context object\n+ *    Out:   generated_outputs: pointer to an array of pointers to xonly pubkeys, one per recipient.\n+ *                              The order of outputs here matches the original ordering of the\n+ *                              recipients array.\n+ *     In:          recipients: pointer to an array of pointers to silent payment recipients,",
      "path": "include/secp256k1_silentpayments.h",
      "position": 62,
      "original_position": 23,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "14ca7545780a1a60a5039a677546c066988654c0",
      "in_reply_to_id": 1575023482,
      "user": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I don't think there's a definition for this case and I don't remember a precedent. \"In\" seems fine to me if the modified argument is not supposed to be read again. The doc also mentions already that the array is modified (\"The recipient array will be sorted in place\").",
      "created_at": "2024-04-24T08:59:58Z",
      "updated_at": "2024-04-24T08:59:58Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1577545322",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1577545322"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 62,
      "original_line": 62,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1577601080",
      "pull_request_review_id": 2019395443,
      "id": 1577601080,
      "node_id": "PRRC_kwDOAP4Jqs5eCEg4",
      "diff_hunk": "@@ -173,4 +173,94 @@ int secp256k1_silentpayments_create_output_pubkey(const secp256k1_context *ctx,\n     return 1;\n }\n \n+int secp256k1_silentpayments_sender_create_outputs(\n+    const secp256k1_context *ctx,\n+    secp256k1_xonly_pubkey **generated_outputs,\n+    const secp256k1_silentpayments_recipient **recipients,\n+    size_t n_recipients,\n+    const unsigned char *outpoint_smallest36,\n+    const secp256k1_keypair * const *taproot_seckeys,\n+    size_t n_taproot_seckeys,\n+    const unsigned char * const *plain_seckeys,\n+    size_t n_plain_seckeys\n+) {\n+    size_t i, k;\n+    secp256k1_scalar a_sum_scalar, addend;\n+    secp256k1_ge A_sum_ge;\n+    secp256k1_gej A_sum_gej;\n+    unsigned char input_hash[32];\n+    unsigned char a_sum[32];\n+    unsigned char shared_secret[33];\n+    secp256k1_silentpayments_recipient last_recipient;\n+\n+    /* Sanity check inputs. */\n+    VERIFY_CHECK(ctx != NULL);\n+    ARG_CHECK(recipients != NULL);\n+    ARG_CHECK(secp256k1_ecmult_gen_context_is_built(&ctx->ecmult_gen_ctx));\n+    ARG_CHECK(plain_seckeys == NULL || n_plain_seckeys >= 1);\n+    ARG_CHECK(taproot_seckeys == NULL || n_taproot_seckeys >= 1);\n+    ARG_CHECK((plain_seckeys != NULL) || (taproot_seckeys != NULL));\n+    ARG_CHECK((n_plain_seckeys + n_taproot_seckeys) >= 1);\n+    ARG_CHECK(outpoint_smallest36 != NULL);\n+    /* ensure the index field is set correctly */\n+    for (i = 0; i < n_recipients; i++) {\n+        ARG_CHECK(recipients[i]->index == i);\n+    }\n+\n+    /* Compute input private keys sum: a_sum = a_1 + a_2 + ... + a_n */\n+    a_sum_scalar = secp256k1_scalar_zero;\n+    for (i = 0; i < n_plain_seckeys; i++) {\n+        int ret = secp256k1_scalar_set_b32_seckey(&addend, plain_seckeys[i]);\n+        VERIFY_CHECK(ret);\n+        (void)ret;\n+\n+        secp256k1_scalar_add(&a_sum_scalar, &a_sum_scalar, &addend);\n+        VERIFY_CHECK(!secp256k1_scalar_is_zero(&a_sum_scalar));\n+    }\n+    /* private keys used for taproot outputs have to be negated if they resulted in an odd point */\n+    for (i = 0; i < n_taproot_seckeys; i++) {\n+        secp256k1_ge addend_point;\n+        int ret = secp256k1_keypair_load(ctx, &addend, &addend_point, taproot_seckeys[i]);\n+        VERIFY_CHECK(ret);",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": null,
      "original_position": 52,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "14ca7545780a1a60a5039a677546c066988654c0",
      "in_reply_to_id": 1575039817,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Replaced both instances of `VERIFY_CHECK` in this function with `return 0;`.",
      "created_at": "2024-04-24T09:40:05Z",
      "updated_at": "2024-04-24T09:40:05Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1577601080",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1577601080"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": 223,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 224,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1577601481",
      "pull_request_review_id": 2019396053,
      "id": 1577601481,
      "node_id": "PRRC_kwDOAP4Jqs5eCEnJ",
      "diff_hunk": "@@ -173,4 +173,94 @@ int secp256k1_silentpayments_create_output_pubkey(const secp256k1_context *ctx,\n     return 1;\n }\n \n+int secp256k1_silentpayments_sender_create_outputs(\n+    const secp256k1_context *ctx,\n+    secp256k1_xonly_pubkey **generated_outputs,\n+    const secp256k1_silentpayments_recipient **recipients,\n+    size_t n_recipients,\n+    const unsigned char *outpoint_smallest36,\n+    const secp256k1_keypair * const *taproot_seckeys,\n+    size_t n_taproot_seckeys,\n+    const unsigned char * const *plain_seckeys,\n+    size_t n_plain_seckeys\n+) {\n+    size_t i, k;\n+    secp256k1_scalar a_sum_scalar, addend;\n+    secp256k1_ge A_sum_ge;\n+    secp256k1_gej A_sum_gej;\n+    unsigned char input_hash[32];\n+    unsigned char a_sum[32];\n+    unsigned char shared_secret[33];\n+    secp256k1_silentpayments_recipient last_recipient;\n+\n+    /* Sanity check inputs. */\n+    VERIFY_CHECK(ctx != NULL);\n+    ARG_CHECK(recipients != NULL);\n+    ARG_CHECK(secp256k1_ecmult_gen_context_is_built(&ctx->ecmult_gen_ctx));\n+    ARG_CHECK(plain_seckeys == NULL || n_plain_seckeys >= 1);\n+    ARG_CHECK(taproot_seckeys == NULL || n_taproot_seckeys >= 1);\n+    ARG_CHECK((plain_seckeys != NULL) || (taproot_seckeys != NULL));\n+    ARG_CHECK((n_plain_seckeys + n_taproot_seckeys) >= 1);\n+    ARG_CHECK(outpoint_smallest36 != NULL);\n+    /* ensure the index field is set correctly */\n+    for (i = 0; i < n_recipients; i++) {\n+        ARG_CHECK(recipients[i]->index == i);\n+    }\n+\n+    /* Compute input private keys sum: a_sum = a_1 + a_2 + ... + a_n */\n+    a_sum_scalar = secp256k1_scalar_zero;\n+    for (i = 0; i < n_plain_seckeys; i++) {\n+        int ret = secp256k1_scalar_set_b32_seckey(&addend, plain_seckeys[i]);\n+        VERIFY_CHECK(ret);\n+        (void)ret;\n+\n+        secp256k1_scalar_add(&a_sum_scalar, &a_sum_scalar, &addend);\n+        VERIFY_CHECK(!secp256k1_scalar_is_zero(&a_sum_scalar));\n+    }\n+    /* private keys used for taproot outputs have to be negated if they resulted in an odd point */\n+    for (i = 0; i < n_taproot_seckeys; i++) {\n+        secp256k1_ge addend_point;\n+        int ret = secp256k1_keypair_load(ctx, &addend, &addend_point, taproot_seckeys[i]);\n+        VERIFY_CHECK(ret);\n+        (void)ret;\n+        /* declassify addend_point to allow using it as a branch point (this is fine because addend_point is not a secret) */\n+        secp256k1_declassify(ctx, &addend_point, sizeof(addend_point));\n+        secp256k1_fe_normalize_var(&addend_point.y);",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": null,
      "original_position": 56,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "14ca7545780a1a60a5039a677546c066988654c0",
      "in_reply_to_id": 1575037779,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Removed.",
      "created_at": "2024-04-24T09:40:20Z",
      "updated_at": "2024-04-24T09:40:21Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1577601481",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1577601481"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": 226,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 228,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1577607223",
      "pull_request_review_id": 2019405342,
      "id": 1577607223,
      "node_id": "PRRC_kwDOAP4Jqs5eCGA3",
      "diff_hunk": "@@ -433,4 +433,137 @@ int secp256k1_silentpayments_recipient_public_data_parse(const secp256k1_context\n     return 1;\n }\n \n+int secp256k1_silentpayments_recipient_scan_outputs(\n+    const secp256k1_context *ctx,\n+    secp256k1_silentpayments_found_output **found_outputs, size_t *n_found_outputs,\n+    const secp256k1_xonly_pubkey * const *tx_outputs, size_t n_tx_outputs,\n+    const unsigned char *scan_key,\n+    const secp256k1_silentpayments_public_data *public_data,\n+    const secp256k1_pubkey *receiver_spend_pubkey,\n+    const secp256k1_silentpayments_label_lookup label_lookup,\n+    const void *label_context\n+) {\n+    secp256k1_scalar t_k_scalar;\n+    secp256k1_ge receiver_spend_pubkey_ge;\n+    secp256k1_xonly_pubkey P_output_xonly;\n+    secp256k1_pubkey A_sum;\n+    unsigned char shared_secret[33];\n+    size_t i, k, n_found;\n+    int found, combined;\n+\n+    /* Sanity check inputs */\n+    VERIFY_CHECK(ctx != NULL);\n+    ARG_CHECK(found_outputs != NULL);\n+    ARG_CHECK(tx_outputs != NULL);\n+    ARG_CHECK(scan_key != NULL);\n+    ARG_CHECK(public_data != NULL);\n+    combined = (int)public_data->data[0];\n+    {\n+        unsigned char input_hash[32];\n+        unsigned char *input_hash_ptr;\n+        if (combined) {\n+            input_hash_ptr = NULL;\n+        } else {\n+            memset(input_hash, 0, 32);\n+            input_hash_ptr = input_hash;\n+        }\n+        if (!secp256k1_silentpayments_recipient_public_data_load(ctx, &A_sum, input_hash_ptr, public_data)) {\n+            return 0;\n+        }\n+        secp256k1_pubkey_load(ctx, &receiver_spend_pubkey_ge, receiver_spend_pubkey);\n+        if (!secp256k1_silentpayments_create_shared_secret(ctx, shared_secret, scan_key, &A_sum, input_hash_ptr)) {\n+            return 0;\n+        }\n+    }\n+\n+    n_found = 0;\n+    k = 0;\n+    while (1) {\n+        secp256k1_ge P_output_ge = receiver_spend_pubkey_ge;\n+        /* Calculate t_k = hash(shared_secret || ser_32(k)) */\n+        secp256k1_silentpayments_create_t_k(&t_k_scalar, shared_secret, k);\n+\n+        /* Calculate P_output = B_spend + t_k * G */\n+        if (!secp256k1_eckey_pubkey_tweak_add(&P_output_ge, &t_k_scalar)) {\n+            return 0;\n+        }\n+\n+        /* If the calculated output matches the one from the tx, we have a direct match and can\n+         * return without labels calculation (one of the two would result in point of infinity) */\n+        secp256k1_xonly_pubkey_save(&P_output_xonly, &P_output_ge);\n+        found = 0;\n+        for (i = 0; i < n_tx_outputs; i++) {\n+            if (secp256k1_xonly_pubkey_cmp(ctx, &P_output_xonly, tx_outputs[i]) == 0) {\n+                found_outputs[n_found]->output = *tx_outputs[i];\n+                secp256k1_scalar_get_b32(found_outputs[n_found]->tweak, &t_k_scalar);\n+                found = 1;\n+                n_found++;\n+                k++;\n+                break;\n+            }\n+\n+            /* If desired, also calculate label candidates */\n+            if (label_lookup != NULL) {",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": null,
      "original_position": 74,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "f113564298e8e76813289fdcefa6968462dc3fda",
      "in_reply_to_id": 1575010116,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Agree! I'm working on a commit now to improve this section and also minimize the conversions between `pubkey -> ge > gej`. Specifically, there was a [comment from Llyod](https://gist.github.com/RubenSomsen/c43b79517e7cb701ebf77eec6dbb46b8?permalink_comment_id=4125475#gistcomment-4125475) on the original gist that mentions being able to test equality with `jacobian == affine`, which could save us conversions from `gej` to `ge`. I'm going to try and incorporate that feedback and remove some of the repeated code in a follow up commit.",
      "created_at": "2024-04-24T09:44:39Z",
      "updated_at": "2024-04-24T09:44:40Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1577607223",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1577607223"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": 505,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 509,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1577608530",
      "pull_request_review_id": 2019407393,
      "id": 1577608530,
      "node_id": "PRRC_kwDOAP4Jqs5eCGVS",
      "diff_hunk": "@@ -0,0 +1,264 @@\n+/***********************************************************************\n+ * Distributed under the MIT software license, see the accompanying    *\n+ * file COPYING or https://www.opensource.org/licenses/mit-license.php.*\n+ ***********************************************************************/\n+\n+#ifndef SECP256K1_MODULE_SILENTPAYMENTS_TESTS_H\n+#define SECP256K1_MODULE_SILENTPAYMENTS_TESTS_H\n+\n+#include \"../../../include/secp256k1_silentpayments.h\"\n+#include \"../../../src/modules/silentpayments/vectors.h\"\n+#include \"../../../examples/examples_util.h\"\n+#include \"assert.h\"\n+\n+struct label_cache_entry {\n+    secp256k1_pubkey label;\n+    unsigned char label_tweak[32];\n+};\n+struct labels_cache {\n+    const secp256k1_context *ctx;\n+    size_t entries_used;\n+    struct label_cache_entry entries[10];\n+};\n+struct labels_cache labels_cache;\n+const unsigned char* label_lookup(const secp256k1_pubkey* key, const void* cache_ptr) {\n+    const struct labels_cache* cache = (const struct labels_cache*)cache_ptr;\n+    size_t i;\n+    for (i = 0; i < cache->entries_used; i++) {\n+        if (secp256k1_ec_pubkey_cmp(cache->ctx, &cache->entries[i].label, key) == 0) {\n+            return cache->entries[i].label_tweak;\n+        }\n+    }\n+    return NULL;\n+}\n+\n+void run_silentpayments_test_vector_send(const struct bip352_test_vector *test) {\n+    secp256k1_silentpayments_recipient recipients[MAX_OUTPUTS_PER_TEST_CASE];\n+    const secp256k1_silentpayments_recipient *recipient_ptrs[MAX_OUTPUTS_PER_TEST_CASE];\n+    secp256k1_xonly_pubkey generated_outputs[MAX_OUTPUTS_PER_TEST_CASE];\n+    secp256k1_xonly_pubkey *generated_output_ptrs[MAX_OUTPUTS_PER_TEST_CASE];\n+    secp256k1_keypair taproot_keypairs[MAX_INPUTS_PER_TEST_CASE];\n+    secp256k1_keypair const *taproot_keypair_ptrs[MAX_INPUTS_PER_TEST_CASE];\n+    unsigned char const *plain_seckeys[MAX_INPUTS_PER_TEST_CASE];\n+    unsigned char created_output[32];\n+    size_t i, j;\n+    int match;\n+\n+    /* Check that sender creates expected outputs */\n+    for (i = 0; i < test->num_outputs; i++) {\n+        CHECK(secp256k1_ec_pubkey_parse(CTX, &recipients[i].scan_pubkey, test->recipient_pubkeys[i].scan_pubkey, 33));\n+        CHECK(secp256k1_ec_pubkey_parse(CTX, &recipients[i].spend_pubkey, test->recipient_pubkeys[i].spend_pubkey, 33));\n+        recipients[i].index = i;\n+        recipient_ptrs[i] = &recipients[i];\n+        generated_output_ptrs[i] = &generated_outputs[i];\n+    }\n+    for (i = 0; i < test->num_plain_inputs; i++) {\n+        plain_seckeys[i] = test->plain_seckeys[i];\n+    }\n+    for (i = 0; i < test->num_taproot_inputs; i++) {\n+        int ret = secp256k1_keypair_create(CTX, &taproot_keypairs[i], test->taproot_seckeys[i]);\n+        assert(ret);\n+        taproot_keypair_ptrs[i] = &taproot_keypairs[i];\n+    }\n+    CHECK(secp256k1_silentpayments_sender_create_outputs(CTX,\n+                generated_output_ptrs,\n+                recipient_ptrs,\n+                test->num_outputs,\n+                test->outpoint_smallest,\n+                test->num_taproot_inputs > 0 ? taproot_keypair_ptrs : NULL, test->num_taproot_inputs,\n+                test->num_plain_inputs > 0 ? plain_seckeys : NULL, test->num_plain_inputs\n+    ));\n+    for (i = 0; i < test->num_outputs; i++) {\n+        CHECK(secp256k1_xonly_pubkey_serialize(CTX, created_output, &generated_outputs[i]));\n+        match = 0;\n+        /* Loop over both lists to ensure tests don't fail due to different orderings of outputs */\n+        for (j = 0; j < test->num_recipient_outputs; j++) {\n+            if (secp256k1_memcmp_var(created_output, test->recipient_outputs[j], 32) == 0) {\n+                match = 1;\n+                break;\n+            }\n+        }\n+        CHECK(match);\n+    }\n+}\n+\n+void run_silentpayments_test_vector_receive(const struct bip352_test_vector *test) {\n+    secp256k1_pubkey plain_pubkeys_objs[MAX_INPUTS_PER_TEST_CASE];\n+    secp256k1_xonly_pubkey xonly_pubkeys_objs[MAX_INPUTS_PER_TEST_CASE];\n+    secp256k1_xonly_pubkey tx_output_objs[MAX_OUTPUTS_PER_TEST_CASE];\n+    secp256k1_silentpayments_found_output found_output_objs[MAX_OUTPUTS_PER_TEST_CASE];\n+    secp256k1_pubkey const *plain_pubkeys[MAX_INPUTS_PER_TEST_CASE];\n+    secp256k1_xonly_pubkey const *xonly_pubkeys[MAX_INPUTS_PER_TEST_CASE];\n+    secp256k1_xonly_pubkey const *tx_outputs[MAX_OUTPUTS_PER_TEST_CASE];\n+    secp256k1_silentpayments_found_output *found_outputs[MAX_OUTPUTS_PER_TEST_CASE];\n+    unsigned char found_outputs_light_client[MAX_OUTPUTS_PER_TEST_CASE][32];\n+    secp256k1_pubkey receiver_scan_pubkey;\n+    secp256k1_pubkey receiver_spend_pubkey;\n+    size_t i,j;\n+    int match;\n+    size_t n_found = 0;\n+    unsigned char found_output[32];\n+    unsigned char found_signatures[10][64];\n+    secp256k1_silentpayments_public_data public_data, public_data_index;\n+    unsigned char shared_secret_lightclient[33];\n+    unsigned char light_client_data[33];\n+\n+\n+    /* prepare the inputs */\n+    {\n+        for (i = 0; i < test->num_plain_inputs; i++) {\n+            CHECK(secp256k1_ec_pubkey_parse(CTX, &plain_pubkeys_objs[i], test->plain_pubkeys[i], 33));\n+            plain_pubkeys[i] = &plain_pubkeys_objs[i];\n+        }\n+        for (i = 0; i < test->num_taproot_inputs; i++) {\n+            CHECK(secp256k1_xonly_pubkey_parse(CTX, &xonly_pubkeys_objs[i], test->xonly_pubkeys[i]));\n+            xonly_pubkeys[i] = &xonly_pubkeys_objs[i];\n+        }\n+        CHECK(secp256k1_silentpayments_recipient_public_data_create(CTX, &public_data,\n+            test->outpoint_smallest,\n+            test->num_taproot_inputs > 0 ? xonly_pubkeys : NULL, test->num_taproot_inputs,\n+            test->num_plain_inputs > 0 ? plain_pubkeys : NULL, test->num_plain_inputs\n+        ));\n+    }\n+    /* prepare the outputs */\n+    {\n+        for (i = 0; i < test->num_to_scan_outputs; i++) {\n+            CHECK(secp256k1_xonly_pubkey_parse(CTX, &tx_output_objs[i], test->to_scan_outputs[i]));\n+            tx_outputs[i] = &tx_output_objs[i];\n+        }\n+        for (i = 0; i < test->num_found_output_pubkeys; i++) {\n+            found_outputs[i] = &found_output_objs[i];\n+        }\n+    }\n+\n+    /* scan / spend pubkeys are not in the given data of the receiver part, so let's compute them */\n+    CHECK(secp256k1_ec_pubkey_create(CTX, &receiver_scan_pubkey, test->scan_seckey));\n+    CHECK(secp256k1_ec_pubkey_create(CTX, &receiver_spend_pubkey, test->spend_seckey));\n+\n+    /* create labels cache */\n+    labels_cache.ctx = CTX;\n+    labels_cache.entries_used = 0;\n+    for (i = 0; i < test->num_labels; i++) {\n+        unsigned int m = test->label_integers[i];\n+        struct label_cache_entry *cache_entry = &labels_cache.entries[labels_cache.entries_used];\n+        CHECK(secp256k1_silentpayments_recipient_create_label_tweak(CTX, &cache_entry->label, cache_entry->label_tweak, test->scan_seckey, m));\n+        labels_cache.entries_used++;\n+    }\n+    CHECK(secp256k1_silentpayments_recipient_scan_outputs(CTX,\n+        found_outputs, &n_found,\n+        tx_outputs, test->num_to_scan_outputs,\n+        test->scan_seckey,\n+        &public_data,\n+        &receiver_spend_pubkey,\n+        label_lookup, &labels_cache)\n+    );\n+    for (i = 0; i < n_found; i++) {\n+        unsigned char full_seckey[32];\n+        secp256k1_keypair keypair;\n+        unsigned char signature[64];\n+        const unsigned char msg32[32] = /* sha256(\"message\") */\n+            {0xab,0x53,0x0a,0x13,0xe4,0x59,0x14,0x98,0x2b,0x79,0xf9,0xb7,0xe3,0xfb,0xa9,0x94,\n+             0xcf,0xd1,0xf3,0xfb,0x22,0xf7,0x1c,0xea,0x1a,0xfb,0xf0,0x2b,0x46,0x0c,0x6d,0x1d};\n+        const unsigned char aux32[32] = /* sha256(\"random auxiliary data\") */\n+            {0x0b,0x3f,0xdd,0xfd,0x67,0xbf,0x76,0xae,0x76,0x39,0xee,0x73,0x5b,0x70,0xff,0x15,\n+             0x83,0xfd,0x92,0x48,0xc0,0x57,0xd2,0x86,0x07,0xa2,0x15,0xf4,0x0b,0x0a,0x3e,0xcc};\n+        memcpy(&full_seckey, test->spend_seckey, 32);\n+        CHECK(secp256k1_ec_seckey_tweak_add(CTX, full_seckey, found_outputs[i]->tweak));\n+        CHECK(secp256k1_keypair_create(CTX, &keypair, full_seckey));\n+        CHECK(secp256k1_schnorrsig_sign32(CTX, signature, msg32, &keypair, aux32));\n+        memcpy(found_signatures[i], signature, 64);\n+    }\n+\n+    /* compare expected and scanned outputs (including calculated seckey tweaks and signatures) */\n+    for (i = 0; i < n_found; i++) {\n+        CHECK(secp256k1_xonly_pubkey_serialize(CTX, found_output, &found_outputs[i]->output));\n+        match = 0;\n+        for (j = 0; j < test->num_found_output_pubkeys; j++) {\n+            if (secp256k1_memcmp_var(&found_output, test->found_output_pubkeys[j], 32) == 0) {\n+                match = 1;\n+                CHECK(secp256k1_memcmp_var(found_outputs[i]->tweak, test->found_seckey_tweaks[j], 32) == 0);\n+                CHECK(secp256k1_memcmp_var(found_signatures[i], test->found_signatures[j], 64) == 0);\n+                break;\n+            }\n+        }\n+        CHECK(match);\n+    }\n+    CHECK(n_found == test->num_found_output_pubkeys);\n+    /* Scan as a light client\n+     * it is not recommended to use labels as a light client so here we are only\n+     * running this on tests that do not involve labels. Primarily, this test is to\n+     * ensure that _recipient_created_shared_secret and _create_shared_secret are the same\n+     */\n+    if (test->num_labels == 0) {\n+        CHECK(secp256k1_silentpayments_recipient_public_data_serialize(CTX, light_client_data, &public_data));\n+        CHECK(secp256k1_silentpayments_recipient_public_data_parse(CTX, &public_data_index, light_client_data));\n+        CHECK(secp256k1_silentpayments_recipient_create_shared_secret(CTX, shared_secret_lightclient, test->scan_seckey, &public_data_index));\n+        n_found = 0;\n+        {\n+            int found = 0;\n+            size_t k = 0;\n+            secp256k1_xonly_pubkey potential_output;\n+            unsigned char xonly_print[32];\n+\n+            while(1) {\n+\n+                CHECK(secp256k1_silentpayments_recipient_create_output_pubkey(CTX,\n+                    &potential_output,\n+                    shared_secret_lightclient,\n+                    &receiver_spend_pubkey,\n+                    k\n+                ));\n+                /* At this point, we check that the utxo exists with a light client protocol.\n+                 * For this example, we'll just iterate through the list of pubkeys */\n+                found = 0;\n+                secp256k1_xonly_pubkey_serialize(CTX, xonly_print, &potential_output);\n+                printf(\"what we generated :\");\n+                print_hex(xonly_print, 32);",
      "path": "src/modules/silentpayments/tests_impl.h",
      "position": null,
      "original_position": 216,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "85946762a59c39dfe21ac899359bcac443ab8d20",
      "in_reply_to_id": 1574990516,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": ":doh: those sneaked in from my debugging, good catch!",
      "created_at": "2024-04-24T09:45:40Z",
      "updated_at": "2024-04-24T09:45:40Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1577608530",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1577608530"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": 215,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 216,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1577608898",
      "pull_request_review_id": 2019407957,
      "id": 1577608898,
      "node_id": "PRRC_kwDOAP4Jqs5eCGbC",
      "diff_hunk": "@@ -328,4 +328,109 @@ int secp256k1_silentpayments_recipient_create_labelled_spend_pubkey(const secp25\n     return 1;\n }\n \n+int secp256k1_silentpayments_recipient_public_data_create(\n+    const secp256k1_context *ctx,\n+    secp256k1_silentpayments_public_data *public_data,\n+    const unsigned char *outpoint_smallest36,\n+    const secp256k1_xonly_pubkey * const *xonly_pubkeys,\n+    size_t n_xonly_pubkeys,\n+    const secp256k1_pubkey * const *plain_pubkeys,\n+    size_t n_plain_pubkeys\n+) {\n+    size_t i;\n+    size_t pubkeylen = 65;\n+    secp256k1_pubkey A_sum;\n+    secp256k1_ge A_sum_ge, addend;\n+    secp256k1_gej A_sum_gej;\n+    unsigned char input_hash_local[32];\n+\n+    /* Sanity check inputs */\n+    VERIFY_CHECK(ctx != NULL);\n+    ARG_CHECK(public_data != NULL);\n+    ARG_CHECK(plain_pubkeys == NULL || n_plain_pubkeys >= 1);\n+    ARG_CHECK(xonly_pubkeys == NULL || n_xonly_pubkeys >= 1);\n+    ARG_CHECK((plain_pubkeys != NULL) || (xonly_pubkeys != NULL));\n+    ARG_CHECK((n_plain_pubkeys + n_xonly_pubkeys) >= 1);\n+    ARG_CHECK(outpoint_smallest36 != NULL);\n+    memset(input_hash_local, 0, 32);\n+\n+    /* Compute input public keys sum: A_sum = A_1 + A_2 + ... + A_n */\n+    secp256k1_gej_set_infinity(&A_sum_gej);\n+    for (i = 0; i < n_plain_pubkeys; i++) {\n+        secp256k1_pubkey_load(ctx, &addend, plain_pubkeys[i]);\n+        secp256k1_gej_add_ge(&A_sum_gej, &A_sum_gej, &addend);",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": null,
      "original_position": 34,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "4fb8716f4f1f6b10757f53024eb22263829fe888",
      "in_reply_to_id": 1574976504,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done.",
      "created_at": "2024-04-24T09:45:56Z",
      "updated_at": "2024-04-24T09:45:56Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1577608898",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1577608898"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 361,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1577609153",
      "pull_request_review_id": 2019408344,
      "id": 1577609153,
      "node_id": "PRRC_kwDOAP4Jqs5eCGfB",
      "diff_hunk": "@@ -222,6 +222,57 @@ SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipien\n     size_t n_plain_pubkeys\n ) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);\n \n+/** Scan for Silent Payment transaction outputs.\n+ *\n+ *  Given a input public sum, an input_hash, a recipient's spend public key B_spend, and the relevant transaction\n+ *  outputs, scan for outputs belong to the recipient and return the tweak(s) needed for spending\n+ *  the output(s). An optional label_lookup callback function and label_context can be passed if the\n+ *  recipient uses labels. This allows for checking if a label exists in the recipients label cache\n+ *  and retrieving the label tweak during scanning.\n+ *\n+ *  Returns: 1 if output scanning was successful. 0 if an error occured.\n+ *  Args:                  ctx: pointer to a context object\n+ *  Out:         found_outputs: pointer to an array of pointers to found output objects. The found outputs\n+ *                              array MUST be initialized to be the same length as the tx_outputs array\n+ *             n_found_outputs: pointer to an integer indicating the final size of the found outputs array.\n+ *                              This number represents the number of outputs found while scanning (0 if\n+ *                              none are found)\n+ *  In:             tx_outputs: pointer to the tx's x-only public key outputs\n+ *                n_tx_outputs: the number of tx_outputs being scanned\n+ *                    scan_key: pointer to the recipient's scan key\n+ *           public_tweak_data: pointer to the input public key sum (optionaly, with the `input_hash`",
      "path": "include/secp256k1_silentpayments.h",
      "position": null,
      "original_position": 22,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "f113564298e8e76813289fdcefa6968462dc3fda",
      "in_reply_to_id": 1574962225,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fixed.",
      "created_at": "2024-04-24T09:46:07Z",
      "updated_at": "2024-04-24T09:46:07Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1577609153",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1577609153"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 243,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1577609295",
      "pull_request_review_id": 2019408535,
      "id": 1577609295,
      "node_id": "PRRC_kwDOAP4Jqs5eCGhP",
      "diff_hunk": "@@ -222,6 +222,57 @@ SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipien\n     size_t n_plain_pubkeys\n ) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);\n \n+/** Scan for Silent Payment transaction outputs.\n+ *\n+ *  Given a input public sum, an input_hash, a recipient's spend public key B_spend, and the relevant transaction\n+ *  outputs, scan for outputs belong to the recipient and return the tweak(s) needed for spending\n+ *  the output(s). An optional label_lookup callback function and label_context can be passed if the\n+ *  recipient uses labels. This allows for checking if a label exists in the recipients label cache\n+ *  and retrieving the label tweak during scanning.\n+ *\n+ *  Returns: 1 if output scanning was successful. 0 if an error occured.\n+ *  Args:                  ctx: pointer to a context object\n+ *  Out:         found_outputs: pointer to an array of pointers to found output objects. The found outputs\n+ *                              array MUST be initialized to be the same length as the tx_outputs array\n+ *             n_found_outputs: pointer to an integer indicating the final size of the found outputs array.\n+ *                              This number represents the number of outputs found while scanning (0 if\n+ *                              none are found)\n+ *  In:             tx_outputs: pointer to the tx's x-only public key outputs\n+ *                n_tx_outputs: the number of tx_outputs being scanned\n+ *                    scan_key: pointer to the recipient's scan key\n+ *           public_tweak_data: pointer to the input public key sum (optionaly, with the `input_hash`\n+ *                              multiplied in, see `_recipient_compute_public_data`).\n+ *      recipient_spend_pubkey: pointer to the receiver's spend pubkey\n+ *                  input_hash: pointer to the input_hash. MUST be NULL if the input_hash is already\n+ *                              multipled into the input public key sum (see `_recipient_compute_public_data`)",
      "path": "include/secp256k1_silentpayments.h",
      "position": null,
      "original_position": 26,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "f113564298e8e76813289fdcefa6968462dc3fda",
      "in_reply_to_id": 1574963125,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fixed.",
      "created_at": "2024-04-24T09:46:12Z",
      "updated_at": "2024-04-24T09:46:12Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1577609295",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1577609295"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": 246,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 247,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1577610073",
      "pull_request_review_id": 2019409884,
      "id": 1577610073,
      "node_id": "PRRC_kwDOAP4Jqs5eCGtZ",
      "diff_hunk": "@@ -433,4 +433,137 @@ int secp256k1_silentpayments_recipient_public_data_parse(const secp256k1_context\n     return 1;\n }\n \n+int secp256k1_silentpayments_recipient_scan_outputs(\n+    const secp256k1_context *ctx,\n+    secp256k1_silentpayments_found_output **found_outputs, size_t *n_found_outputs,\n+    const secp256k1_xonly_pubkey * const *tx_outputs, size_t n_tx_outputs,\n+    const unsigned char *scan_key,\n+    const secp256k1_silentpayments_public_data *public_data,\n+    const secp256k1_pubkey *receiver_spend_pubkey,\n+    const secp256k1_silentpayments_label_lookup label_lookup,\n+    const void *label_context\n+) {\n+    secp256k1_scalar t_k_scalar;\n+    secp256k1_ge receiver_spend_pubkey_ge;\n+    secp256k1_xonly_pubkey P_output_xonly;\n+    secp256k1_pubkey A_sum;\n+    unsigned char shared_secret[33];\n+    size_t i, k, n_found;\n+    int found, combined;\n+\n+    /* Sanity check inputs */\n+    VERIFY_CHECK(ctx != NULL);\n+    ARG_CHECK(found_outputs != NULL);\n+    ARG_CHECK(tx_outputs != NULL);\n+    ARG_CHECK(scan_key != NULL);\n+    ARG_CHECK(public_data != NULL);\n+    combined = (int)public_data->data[0];\n+    {\n+        unsigned char input_hash[32];\n+        unsigned char *input_hash_ptr;\n+        if (combined) {\n+            input_hash_ptr = NULL;\n+        } else {\n+            memset(input_hash, 0, 32);\n+            input_hash_ptr = input_hash;\n+        }\n+        if (!secp256k1_silentpayments_recipient_public_data_load(ctx, &A_sum, input_hash_ptr, public_data)) {\n+            return 0;\n+        }\n+        secp256k1_pubkey_load(ctx, &receiver_spend_pubkey_ge, receiver_spend_pubkey);\n+        if (!secp256k1_silentpayments_create_shared_secret(ctx, shared_secret, scan_key, &A_sum, input_hash_ptr)) {\n+            return 0;\n+        }\n+    }\n+\n+    n_found = 0;\n+    k = 0;\n+    while (1) {\n+        secp256k1_ge P_output_ge = receiver_spend_pubkey_ge;\n+        /* Calculate t_k = hash(shared_secret || ser_32(k)) */\n+        secp256k1_silentpayments_create_t_k(&t_k_scalar, shared_secret, k);\n+\n+        /* Calculate P_output = B_spend + t_k * G */\n+        if (!secp256k1_eckey_pubkey_tweak_add(&P_output_ge, &t_k_scalar)) {\n+            return 0;\n+        }\n+\n+        /* If the calculated output matches the one from the tx, we have a direct match and can\n+         * return without labels calculation (one of the two would result in point of infinity) */\n+        secp256k1_xonly_pubkey_save(&P_output_xonly, &P_output_ge);\n+        found = 0;\n+        for (i = 0; i < n_tx_outputs; i++) {\n+            if (secp256k1_xonly_pubkey_cmp(ctx, &P_output_xonly, tx_outputs[i]) == 0) {\n+                found_outputs[n_found]->output = *tx_outputs[i];",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": null,
      "original_position": 65,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "f113564298e8e76813289fdcefa6968462dc3fda",
      "in_reply_to_id": 1574947042,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Updated and for now am just setting the label with the output when the output is found without a label, but would be better if we have a \"canonical\" invalid pubkey I can use.",
      "created_at": "2024-04-24T09:46:51Z",
      "updated_at": "2024-04-24T09:48:09Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1577610073",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1577610073"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 497,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1577623058",
      "pull_request_review_id": 2019430407,
      "id": 1577623058,
      "node_id": "PRRC_kwDOAP4Jqs5eCJ4S",
      "diff_hunk": "@@ -40,6 +40,59 @@ typedef struct {\n     size_t index;\n } secp256k1_silentpayments_recipient;\n \n+/** Create Silent Payment outputs for recipient(s).\n+ *\n+ * Given a list of n private keys a_1...a_n (one for each silent payment\n+ * eligible input to spend), a serialized outpoint, and a list of recipients,\n+ * create the taproot outputs:\n+ *\n+ * a_sum = a_1 + a_2 + ... + a_n\n+ * input_hash = hash(outpoint_smallest || (a_sum * G))\n+ * taproot_output = B_spend + hash(a_sum * input_hash * B_scan || k) * G\n+ *\n+ * If necessary, the private keys are negated to enforce the right y-parity.\n+ * For that reason, the private keys have to be passed in via two different parameter\n+ * pairs, depending on whether they seckeys correspond to x-only outputs or not.\n+ *\n+ *  Returns: 1 if shared secret creation was successful. 0 if an error occured.\n+ *   Args:                 ctx: pointer to a context object\n+ *    Out:   generated_outputs: pointer to an array of pointers to xonly pubkeys, one per recipient.\n+ *                              The order of outputs here matches the original ordering of the\n+ *                              recipients array.\n+ *     In:          recipients: pointer to an array of pointers to silent payment recipients,",
      "path": "include/secp256k1_silentpayments.h",
      "position": 62,
      "original_position": 23,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "14ca7545780a1a60a5039a677546c066988654c0",
      "in_reply_to_id": 1575023482,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Going to leave it as \"In\" for now. I think it makes it more clear to the caller that they are supposed to read the `recipients` array after the function call.",
      "created_at": "2024-04-24T09:56:37Z",
      "updated_at": "2024-04-24T09:56:38Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1577623058",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1577623058"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 62,
      "original_line": 62,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581992204",
      "pull_request_review_id": 2026864465,
      "id": 1581992204,
      "node_id": "PRRC_kwDOAP4Jqs5eS0kM",
      "diff_hunk": "@@ -9,8 +9,36 @@\n #include \"../../../include/secp256k1.h\"\n #include \"../../../include/secp256k1_silentpayments.h\"\n \n-/* TODO: implement functions for sender side. */\n+/** Sort an array of silent payment recipients. This is used to group recipients by scan pubkey to\n+ *  ensure the correct values of k are used when creating multiple outputs for a recipient. */\n+static int secp256k1_silentpayments_recipient_sort_cmp(const void* pk1, const void* pk2, void *cmp_data) {\n+    return secp256k1_ec_pubkey_cmp(\n+        ((secp256k1_ec_pubkey_sort_cmp_data*)cmp_data)->ctx,\n+        &(*(const secp256k1_silentpayments_recipient **)pk1)->scan_pubkey,\n+        &(*(const secp256k1_silentpayments_recipient **)pk2)->scan_pubkey",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": 19,
      "original_position": 11,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "97220f7b29b77677e66a527ec933b022ceb2cceb",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "`pk1`/`pk2` are addresses for _silentpayments_recipient instances, so involving double-pointers here doesn't seem to be necessary:\r\n```suggestion\r\n        &((const secp256k1_silentpayments_recipient *)pk1)->scan_pubkey,\r\n        &((const secp256k1_silentpayments_recipient *)pk2)->scan_pubkey\r\n```",
      "created_at": "2024-04-28T01:18:12Z",
      "updated_at": "2024-04-28T01:45:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1581992204",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581992204"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": 18,
      "original_start_line": 17,
      "start_side": "RIGHT",
      "line": 19,
      "original_line": 19,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581992289",
      "pull_request_review_id": 2026864465,
      "id": 1581992289,
      "node_id": "PRRC_kwDOAP4Jqs5eS0lh",
      "diff_hunk": "@@ -9,8 +9,36 @@\n #include \"../../../include/secp256k1.h\"\n #include \"../../../include/secp256k1_silentpayments.h\"\n \n-/* TODO: implement functions for sender side. */\n+/** Sort an array of silent payment recipients. This is used to group recipients by scan pubkey to\n+ *  ensure the correct values of k are used when creating multiple outputs for a recipient. */\n+static int secp256k1_silentpayments_recipient_sort_cmp(const void* pk1, const void* pk2, void *cmp_data) {\n+    return secp256k1_ec_pubkey_cmp(\n+        ((secp256k1_ec_pubkey_sort_cmp_data*)cmp_data)->ctx,\n+        &(*(const secp256k1_silentpayments_recipient **)pk1)->scan_pubkey,\n+        &(*(const secp256k1_silentpayments_recipient **)pk2)->scan_pubkey\n+    );\n+}\n \n-/* TODO: implement functions for receiver side. */\n+int secp256k1_silentpayments_recipient_sort(const secp256k1_context* ctx, const secp256k1_silentpayments_recipient **recipients, size_t n_recipients) {",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": 23,
      "original_position": 16,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "97220f7b29b77677e66a527ec933b022ceb2cceb",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: could be static, since it's not part of the public API",
      "created_at": "2024-04-28T01:18:51Z",
      "updated_at": "2024-04-28T01:45:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1581992289",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581992289"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 23,
      "original_line": 23,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581992522",
      "pull_request_review_id": 2026864465,
      "id": 1581992522,
      "node_id": "PRRC_kwDOAP4Jqs5eS0pK",
      "diff_hunk": "@@ -173,4 +173,90 @@ int secp256k1_silentpayments_create_output_pubkey(const secp256k1_context *ctx,\n     return 1;\n }\n \n+int secp256k1_silentpayments_sender_create_outputs(\n+    const secp256k1_context *ctx,\n+    secp256k1_xonly_pubkey **generated_outputs,\n+    const secp256k1_silentpayments_recipient **recipients,\n+    size_t n_recipients,\n+    const unsigned char *outpoint_smallest36,\n+    const secp256k1_keypair * const *taproot_seckeys,\n+    size_t n_taproot_seckeys,\n+    const unsigned char * const *plain_seckeys,\n+    size_t n_plain_seckeys\n+) {\n+    size_t i, k;\n+    secp256k1_scalar a_sum_scalar, addend;\n+    secp256k1_ge A_sum_ge;\n+    secp256k1_gej A_sum_gej;\n+    unsigned char input_hash[32];\n+    unsigned char a_sum[32];\n+    unsigned char shared_secret[33];\n+    secp256k1_silentpayments_recipient last_recipient;\n+\n+    /* Sanity check inputs. */\n+    VERIFY_CHECK(ctx != NULL);\n+    ARG_CHECK(recipients != NULL);",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": 198,
      "original_position": 26,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "50dcc1aeddfc2d522ebe02b9709f8c1c119c6027",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "could also ARG_CHECK for n_recipients here:\r\n```suggestion\r\n    ARG_CHECK(recipients != NULL);\r\n    ARG_CHECK(n_recipients >= 1);\r\n```",
      "created_at": "2024-04-28T01:21:29Z",
      "updated_at": "2024-04-28T01:45:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1581992522",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581992522"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 198,
      "original_line": 198,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581992596",
      "pull_request_review_id": 2026864465,
      "id": 1581992596,
      "node_id": "PRRC_kwDOAP4Jqs5eS0qU",
      "diff_hunk": "@@ -40,6 +40,59 @@ typedef struct {\n     size_t index;\n } secp256k1_silentpayments_recipient;\n \n+/** Create Silent Payment outputs for recipient(s).\n+ *\n+ * Given a list of n private keys a_1...a_n (one for each silent payment\n+ * eligible input to spend), a serialized outpoint, and a list of recipients,\n+ * create the taproot outputs:\n+ *\n+ * a_sum = a_1 + a_2 + ... + a_n\n+ * input_hash = hash(outpoint_smallest || (a_sum * G))\n+ * taproot_output = B_spend + hash(a_sum * input_hash * B_scan || k) * G\n+ *\n+ * If necessary, the private keys are negated to enforce the right y-parity.\n+ * For that reason, the private keys have to be passed in via two different parameter\n+ * pairs, depending on whether they seckeys correspond to x-only outputs or not.",
      "path": "include/secp256k1_silentpayments.h",
      "position": null,
      "original_position": 16,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "50dcc1aeddfc2d522ebe02b9709f8c1c119c6027",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "typo\r\n```suggestion\r\n * pairs, depending on whether the seckeys correspond to x-only outputs or not.\r\n```",
      "created_at": "2024-04-28T01:22:20Z",
      "updated_at": "2024-04-28T01:45:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1581992596",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581992596"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 55,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581992633",
      "pull_request_review_id": 2026864465,
      "id": 1581992633,
      "node_id": "PRRC_kwDOAP4Jqs5eS0q5",
      "diff_hunk": "@@ -40,6 +40,59 @@ typedef struct {\n     size_t index;\n } secp256k1_silentpayments_recipient;\n \n+/** Create Silent Payment outputs for recipient(s).\n+ *\n+ * Given a list of n private keys a_1...a_n (one for each silent payment\n+ * eligible input to spend), a serialized outpoint, and a list of recipients,\n+ * create the taproot outputs:\n+ *\n+ * a_sum = a_1 + a_2 + ... + a_n\n+ * input_hash = hash(outpoint_smallest || (a_sum * G))\n+ * taproot_output = B_spend + hash(a_sum * input_hash * B_scan || k) * G\n+ *\n+ * If necessary, the private keys are negated to enforce the right y-parity.\n+ * For that reason, the private keys have to be passed in via two different parameter\n+ * pairs, depending on whether they seckeys correspond to x-only outputs or not.\n+ *\n+ *  Returns: 1 if shared secret creation was successful. 0 if an error occured.",
      "path": "include/secp256k1_silentpayments.h",
      "position": null,
      "original_position": 18,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "50dcc1aeddfc2d522ebe02b9709f8c1c119c6027",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n *  Returns: 1 if creation of outputs was successful. 0 if an error occured.\r\n```",
      "created_at": "2024-04-28T01:23:07Z",
      "updated_at": "2024-04-28T01:45:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1581992633",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581992633"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 57,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581993053",
      "pull_request_review_id": 2026864465,
      "id": 1581993053,
      "node_id": "PRRC_kwDOAP4Jqs5eS0xd",
      "diff_hunk": "@@ -93,6 +93,51 @@ SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_sender_c\n     size_t n_plain_seckeys\n ) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(5);\n \n+/** Create Silent Payment label tweak and label.\n+ *\n+ *  Given a recipient's scan private key b_scan and a label integer m, calculate\n+ *  the corresponding label tweak and label:\n+ *\n+ *  label_tweak = hash(b_scan || m)\n+ *  label = label_tweak * G\n+ *\n+ *  Returns: 1 if label tweak and label creation was successful. 0 if an error occured.\n+ *  Args:                  ctx: pointer to a context object\n+ *  Out:           label_tweak: pointer to the resulting label tweak\n+ *   In:  receiver_scan_seckey: pointer to the receiver's scan private key\n+ *                           m: label integer (0 is used for change outputs)\n+ */\n+SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipient_create_label_tweak(\n+    const secp256k1_context *ctx,\n+    secp256k1_pubkey *label,\n+    unsigned char *label_tweak32,\n+    const unsigned char *receiver_scan_seckey,\n+    unsigned int m\n+) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4);\n+\n+/** Create Silent Payment labelled spend public key.\n+ *\n+ *  Given a recipient's spend public key B_spend and a label, calculate\n+ *  the corresponding serialized labelled spend public key:\n+ *\n+ *  B_m = B_spend + label\n+ *\n+ *  The result is used by the recipient to create a Silent Payment address, consisting\n+ *  of the serialized and concatenated scan public key and (labelled) spend public key each.\n+ *\n+ *  Returns: 1 if labelled spend public key creation was successful. 0 if an error occured.\n+ *  Args:                  ctx: pointer to a context object\n+ *  Out: l_addr_spend_pubkey33: pointer to the resulting labelled spend public key\n+ *   In: receiver_spend_pubkey: pointer to the receiver's spend pubkey\n+ *                       label: pointer to the the receiver's label\n+ */\n+SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipient_create_labelled_spend_pubkey(\n+    const secp256k1_context *ctx,\n+    secp256k1_pubkey *labeled_spend_pubkey,",
      "path": "include/secp256k1_silentpayments.h",
      "position": null,
      "original_position": 44,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "aeef18499580e576f2078b20936842b899b05bd3",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: should use either `labeled` or `labelled` consistently (both seem to be correct english) for function name vs parameter",
      "created_at": "2024-04-28T01:27:04Z",
      "updated_at": "2024-04-28T01:45:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1581993053",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581993053"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": 134,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 136,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581993106",
      "pull_request_review_id": 2026864465,
      "id": 1581993106,
      "node_id": "PRRC_kwDOAP4Jqs5eS0yS",
      "diff_hunk": "@@ -93,6 +93,51 @@ SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_sender_c\n     size_t n_plain_seckeys\n ) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(5);\n \n+/** Create Silent Payment label tweak and label.\n+ *\n+ *  Given a recipient's scan private key b_scan and a label integer m, calculate\n+ *  the corresponding label tweak and label:\n+ *\n+ *  label_tweak = hash(b_scan || m)\n+ *  label = label_tweak * G\n+ *\n+ *  Returns: 1 if label tweak and label creation was successful. 0 if an error occured.\n+ *  Args:                  ctx: pointer to a context object\n+ *  Out:           label_tweak: pointer to the resulting label tweak\n+ *   In:  receiver_scan_seckey: pointer to the receiver's scan private key\n+ *                           m: label integer (0 is used for change outputs)\n+ */\n+SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipient_create_label_tweak(\n+    const secp256k1_context *ctx,\n+    secp256k1_pubkey *label,\n+    unsigned char *label_tweak32,\n+    const unsigned char *receiver_scan_seckey,\n+    unsigned int m\n+) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4);\n+\n+/** Create Silent Payment labelled spend public key.\n+ *\n+ *  Given a recipient's spend public key B_spend and a label, calculate\n+ *  the corresponding serialized labelled spend public key:\n+ *\n+ *  B_m = B_spend + label\n+ *\n+ *  The result is used by the recipient to create a Silent Payment address, consisting\n+ *  of the serialized and concatenated scan public key and (labelled) spend public key each.\n+ *\n+ *  Returns: 1 if labelled spend public key creation was successful. 0 if an error occured.\n+ *  Args:                  ctx: pointer to a context object\n+ *  Out: l_addr_spend_pubkey33: pointer to the resulting labelled spend public key",
      "path": "include/secp256k1_silentpayments.h",
      "position": null,
      "original_position": 38,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "aeef18499580e576f2078b20936842b899b05bd3",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "the out-param description for `label` is missing",
      "created_at": "2024-04-28T01:27:36Z",
      "updated_at": "2024-04-28T01:45:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1581993106",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581993106"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 130,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581993315",
      "pull_request_review_id": 2026864465,
      "id": 1581993315,
      "node_id": "PRRC_kwDOAP4Jqs5eS01j",
      "diff_hunk": "@@ -138,6 +138,90 @@ SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipien\n     const secp256k1_pubkey *label\n ) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4);\n \n+/** Opaque data structure that holds silent payments public input data.\n+ *\n+ *  This structure does not contain secret data. Guaranteed to be 98 bytes in size. It can be safely\n+ *  copied/moved. Created with `secp256k1_silentpayments_compute_public_data`. Can be serialized as\n+ *  a compressed public key using `secp256k1_silentpayments_public_data_serialize`. The serialization\n+ *  is intended for sending the public input data to light clients. Light clients can use this\n+ *  serialization with `secp256k1_silentpayments_public_data_parse`.\n+ */\n+typedef struct {\n+    unsigned char data[98];\n+} secp256k1_silentpayments_public_data;\n+\n+/** Parse a 33-byte sequence into a silent_payments_public_data object.\n+ *\n+ *  Returns: 1 if the data was able to be parsed.\n+ *           0 if the sequence is invalid (e.g. does not represnt a valid public key).\n+ *\n+ *  Args:        ctx: pointer to a context object.\n+ *  Out: public_data: pointer to a silentpayments_public_data object. If 1 is returned, it is set to a\n+ *                    parsed version of input33.\n+ *  In:      input33: pointer to a serialized silentpayments_public_data.\n+ */\n+\n+SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipient_public_data_parse(\n+    const secp256k1_context *ctx,\n+    secp256k1_silentpayments_public_data *public_data,\n+    const unsigned char *input33\n+) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);\n+\n+/** Serialize a silentpayments_public_data object into a 33-byte sequence.\n+ *\n+ *  Returns: 1 always.\n+ *\n+ *  Args:       ctx: pointer to a context object.\n+ *  Out:   output33: pointer to a 32-byte array to place the serialized key in.",
      "path": "include/secp256k1_silentpayments.h",
      "position": null,
      "original_position": 38,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "41cd97dea39f10a9f537b206b8e3b6a6ab015f35",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n *  Out:   output33: pointer to a 33-byte array to place the serialized silentpayments_public_data in.\r\n```",
      "created_at": "2024-04-28T01:30:42Z",
      "updated_at": "2024-04-28T01:45:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1581993315",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581993315"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 175,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581993393",
      "pull_request_review_id": 2026864465,
      "id": 1581993393,
      "node_id": "PRRC_kwDOAP4Jqs5eS02x",
      "diff_hunk": "@@ -138,6 +138,90 @@ SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipien\n     const secp256k1_pubkey *label\n ) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4);\n \n+/** Opaque data structure that holds silent payments public input data.\n+ *\n+ *  This structure does not contain secret data. Guaranteed to be 98 bytes in size. It can be safely\n+ *  copied/moved. Created with `secp256k1_silentpayments_compute_public_data`. Can be serialized as\n+ *  a compressed public key using `secp256k1_silentpayments_public_data_serialize`. The serialization\n+ *  is intended for sending the public input data to light clients. Light clients can use this\n+ *  serialization with `secp256k1_silentpayments_public_data_parse`.\n+ */\n+typedef struct {\n+    unsigned char data[98];\n+} secp256k1_silentpayments_public_data;\n+\n+/** Parse a 33-byte sequence into a silent_payments_public_data object.\n+ *\n+ *  Returns: 1 if the data was able to be parsed.\n+ *           0 if the sequence is invalid (e.g. does not represnt a valid public key).",
      "path": "include/secp256k1_silentpayments.h",
      "position": null,
      "original_position": 19,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "41cd97dea39f10a9f537b206b8e3b6a6ab015f35",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n *           0 if the sequence is invalid (e.g. does not represent a valid public key).\r\n```",
      "created_at": "2024-04-28T01:31:17Z",
      "updated_at": "2024-04-28T01:45:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1581993393",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581993393"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 156,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581993506",
      "pull_request_review_id": 2026864465,
      "id": 1581993506,
      "node_id": "PRRC_kwDOAP4Jqs5eS04i",
      "diff_hunk": "@@ -324,4 +324,109 @@ int secp256k1_silentpayments_recipient_create_labelled_spend_pubkey(const secp25\n     return 1;\n }\n \n+int secp256k1_silentpayments_recipient_public_data_create(\n+    const secp256k1_context *ctx,\n+    secp256k1_silentpayments_public_data *public_data,\n+    const unsigned char *outpoint_smallest36,\n+    const secp256k1_xonly_pubkey * const *xonly_pubkeys,\n+    size_t n_xonly_pubkeys,\n+    const secp256k1_pubkey * const *plain_pubkeys,\n+    size_t n_plain_pubkeys\n+) {\n+    size_t i;\n+    size_t pubkeylen = 65;\n+    secp256k1_pubkey A_sum;\n+    secp256k1_ge A_sum_ge, addend;\n+    secp256k1_gej A_sum_gej;\n+    unsigned char input_hash_local[32];\n+\n+    /* Sanity check inputs */\n+    VERIFY_CHECK(ctx != NULL);\n+    ARG_CHECK(public_data != NULL);\n+    ARG_CHECK(plain_pubkeys == NULL || n_plain_pubkeys >= 1);\n+    ARG_CHECK(xonly_pubkeys == NULL || n_xonly_pubkeys >= 1);\n+    ARG_CHECK((plain_pubkeys != NULL) || (xonly_pubkeys != NULL));\n+    ARG_CHECK((n_plain_pubkeys + n_xonly_pubkeys) >= 1);\n+    ARG_CHECK(outpoint_smallest36 != NULL);\n+    memset(input_hash_local, 0, 32);\n+\n+    /* Compute input public keys sum: A_sum = A_1 + A_2 + ... + A_n */\n+    secp256k1_gej_set_infinity(&A_sum_gej);\n+    for (i = 0; i < n_plain_pubkeys; i++) {\n+        secp256k1_pubkey_load(ctx, &addend, plain_pubkeys[i]);\n+        secp256k1_gej_add_ge_var(&A_sum_gej, &A_sum_gej, &addend, NULL);\n+    }\n+    for (i = 0; i < n_xonly_pubkeys; i++) {\n+        secp256k1_xonly_pubkey_load(ctx, &addend, xonly_pubkeys[i]);\n+        secp256k1_gej_add_ge(&A_sum_gej, &A_sum_gej, &addend);",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": null,
      "original_position": 38,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "41cd97dea39f10a9f537b206b8e3b6a6ab015f35",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "can use non-constant-time ge adding for the second loop here as well:\r\n```suggestion\r\n        secp256k1_gej_add_ge_var(&A_sum_gej, &A_sum_gej, &addend, NULL);\r\n```",
      "created_at": "2024-04-28T01:32:12Z",
      "updated_at": "2024-04-28T01:45:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1581993506",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581993506"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 361,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581993573",
      "pull_request_review_id": 2026864465,
      "id": 1581993573,
      "node_id": "PRRC_kwDOAP4Jqs5eS05l",
      "diff_hunk": "@@ -324,4 +324,109 @@ int secp256k1_silentpayments_recipient_create_labelled_spend_pubkey(const secp25\n     return 1;\n }\n \n+int secp256k1_silentpayments_recipient_public_data_create(\n+    const secp256k1_context *ctx,\n+    secp256k1_silentpayments_public_data *public_data,\n+    const unsigned char *outpoint_smallest36,\n+    const secp256k1_xonly_pubkey * const *xonly_pubkeys,\n+    size_t n_xonly_pubkeys,\n+    const secp256k1_pubkey * const *plain_pubkeys,\n+    size_t n_plain_pubkeys\n+) {\n+    size_t i;\n+    size_t pubkeylen = 65;\n+    secp256k1_pubkey A_sum;\n+    secp256k1_ge A_sum_ge, addend;\n+    secp256k1_gej A_sum_gej;\n+    unsigned char input_hash_local[32];\n+\n+    /* Sanity check inputs */\n+    VERIFY_CHECK(ctx != NULL);\n+    ARG_CHECK(public_data != NULL);\n+    ARG_CHECK(plain_pubkeys == NULL || n_plain_pubkeys >= 1);\n+    ARG_CHECK(xonly_pubkeys == NULL || n_xonly_pubkeys >= 1);\n+    ARG_CHECK((plain_pubkeys != NULL) || (xonly_pubkeys != NULL));\n+    ARG_CHECK((n_plain_pubkeys + n_xonly_pubkeys) >= 1);\n+    ARG_CHECK(outpoint_smallest36 != NULL);\n+    memset(input_hash_local, 0, 32);\n+\n+    /* Compute input public keys sum: A_sum = A_1 + A_2 + ... + A_n */\n+    secp256k1_gej_set_infinity(&A_sum_gej);\n+    for (i = 0; i < n_plain_pubkeys; i++) {\n+        secp256k1_pubkey_load(ctx, &addend, plain_pubkeys[i]);\n+        secp256k1_gej_add_ge_var(&A_sum_gej, &A_sum_gej, &addend, NULL);\n+    }\n+    for (i = 0; i < n_xonly_pubkeys; i++) {\n+        secp256k1_xonly_pubkey_load(ctx, &addend, xonly_pubkeys[i]);\n+        secp256k1_gej_add_ge(&A_sum_gej, &A_sum_gej, &addend);\n+    }\n+    if (secp256k1_gej_is_infinity(&A_sum_gej)) {\n+        /* TODO: do we need a special error return code for this case? */\n+        return 0;\n+    }\n+    secp256k1_ge_set_gej(&A_sum_ge, &A_sum_gej);\n+\n+    /* Compute input_hash = hash(outpoint_L || A_sum) */\n+    secp256k1_silentpayments_calculate_input_hash(input_hash_local, outpoint_smallest36, &A_sum_ge);\n+    secp256k1_pubkey_save(&A_sum, &A_sum_ge);\n+    /* serialize the public_data struct */\n+    public_data->data[0] = 0;\n+    secp256k1_ec_pubkey_serialize(ctx, &public_data->data[1], &pubkeylen, &A_sum, SECP256K1_EC_UNCOMPRESSED);\n+    memcpy(&public_data->data[1 + pubkeylen], input_hash_local, 32);\n+    return 1;\n+}\n+\n+int secp256k1_silentpayments_recipient_public_data_load(const secp256k1_context *ctx, secp256k1_pubkey *pubkey, unsigned char *input_hash, const secp256k1_silentpayments_public_data *public_data) {",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": null,
      "original_position": 56,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "41cd97dea39f10a9f537b206b8e3b6a6ab015f35",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: not used in public API, could be made static",
      "created_at": "2024-04-28T01:33:00Z",
      "updated_at": "2024-04-28T01:45:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1581993573",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581993573"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 379,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581993849",
      "pull_request_review_id": 2026864465,
      "id": 1581993849,
      "node_id": "PRRC_kwDOAP4Jqs5eS095",
      "diff_hunk": "@@ -138,6 +138,90 @@ SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipien\n     const secp256k1_pubkey *label\n ) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4);\n \n+/** Opaque data structure that holds silent payments public input data.\n+ *\n+ *  This structure does not contain secret data. Guaranteed to be 98 bytes in size. It can be safely\n+ *  copied/moved. Created with `secp256k1_silentpayments_compute_public_data`. Can be serialized as\n+ *  a compressed public key using `secp256k1_silentpayments_public_data_serialize`. The serialization\n+ *  is intended for sending the public input data to light clients. Light clients can use this\n+ *  serialization with `secp256k1_silentpayments_public_data_parse`.\n+ */\n+typedef struct {\n+    unsigned char data[98];\n+} secp256k1_silentpayments_public_data;\n+\n+/** Parse a 33-byte sequence into a silent_payments_public_data object.\n+ *\n+ *  Returns: 1 if the data was able to be parsed.\n+ *           0 if the sequence is invalid (e.g. does not represnt a valid public key).\n+ *\n+ *  Args:        ctx: pointer to a context object.\n+ *  Out: public_data: pointer to a silentpayments_public_data object. If 1 is returned, it is set to a\n+ *                    parsed version of input33.\n+ *  In:      input33: pointer to a serialized silentpayments_public_data.\n+ */\n+\n+SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipient_public_data_parse(\n+    const secp256k1_context *ctx,\n+    secp256k1_silentpayments_public_data *public_data,\n+    const unsigned char *input33\n+) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);\n+\n+/** Serialize a silentpayments_public_data object into a 33-byte sequence.\n+ *\n+ *  Returns: 1 always.\n+ *\n+ *  Args:       ctx: pointer to a context object.\n+ *  Out:   output33: pointer to a 32-byte array to place the serialized key in.\n+ *  In: public_data: pointer to an initialized silentpayments_public_data object.\n+ */\n+SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipient_public_data_serialize(\n+    const secp256k1_context *ctx,\n+    unsigned char *output33,\n+    const secp256k1_silentpayments_public_data *public_data\n+) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);\n+\n+/** Compute Silent Payment public data from input public keys and transaction inputs.\n+ *\n+ * Given a list of n public keys A_1...A_n (one for each silent payment\n+ * eligible input to spend) and a serialized outpoint_smallest, compute\n+ * the corresponding input public tweak data:\n+ *\n+ * A_sum = A_1 + A_2 + ... + A_n\n+ * input_hash = hash(outpoint_lowest || A_sum)\n+ *\n+ * The public keys have to be passed in via two different parameter pairs,\n+ * one for regular and one for x-only public keys, in order to avoid the need\n+ * of users converting to a common pubkey format before calling this function.\n+ * The resulting data is can be used for scanning on the recipient side, or stored\n+ * in an index for late use (e.g. wallet rescanning, vending data to light clients).\n+ *\n+ * If calling this function for scanning, the reciever must provide an output param\n+ * for the `input_hash`. If calling this function for simply aggregating the inputs\n+ * for later use, the caller can save the result with `silentpayments_public_data_serialize`.\n+ *\n+ *  Returns: 1 if tweak data creation was successful. 0 if an error occured.\n+ *  Args:                  ctx: pointer to a context object\n+ *  Out:           public_data: pointer to public_data object containing the summed public key and\n+ *                              input_hash.\n+ *  In:    outpoint_smallest36: serialized smallest outpoint\n+ *               xonly_pubkeys: pointer to an array of pointers to taproot x-only\n+ *                              public keys (can be NULL if no taproot inputs are used)\n+ *             n_xonly_pubkeys: the number of taproot input public keys\n+ *               plain_pubkeys: pointer to an array of pointers to non-taproot\n+ *                              public keys (can be NULL if no non-taproot inputs are used)\n+ *             n_plain_pubkeys: the number of non-taproot input public keys\n+ */\n+SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipient_public_data_create(",
      "path": "include/secp256k1_silentpayments.h",
      "position": 185,
      "original_position": 78,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "41cd97dea39f10a9f537b206b8e3b6a6ab015f35",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: could reorder that function to be above the other _public_data API functions, since that's the first one in the lifecycle of a `_public_data` instance.",
      "created_at": "2024-04-28T01:35:43Z",
      "updated_at": "2024-04-28T01:45:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1581993849",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581993849"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 185,
      "original_line": 185,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581993914",
      "pull_request_review_id": 2026864465,
      "id": 1581993914,
      "node_id": "PRRC_kwDOAP4Jqs5eS0-6",
      "diff_hunk": "@@ -138,6 +138,90 @@ SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipien\n     const secp256k1_pubkey *label\n ) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4);\n \n+/** Opaque data structure that holds silent payments public input data.\n+ *\n+ *  This structure does not contain secret data. Guaranteed to be 98 bytes in size. It can be safely\n+ *  copied/moved. Created with `secp256k1_silentpayments_compute_public_data`. Can be serialized as",
      "path": "include/secp256k1_silentpayments.h",
      "position": null,
      "original_position": 7,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "41cd97dea39f10a9f537b206b8e3b6a6ab015f35",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n *  copied/moved. Created with `secp256k1_silentpayments_public_data_create`. Can be serialized as\r\n```",
      "created_at": "2024-04-28T01:36:52Z",
      "updated_at": "2024-04-28T01:45:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1581993914",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581993914"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 144,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581994092",
      "pull_request_review_id": 2026864465,
      "id": 1581994092,
      "node_id": "PRRC_kwDOAP4Jqs5eS1Bs",
      "diff_hunk": "@@ -222,6 +222,55 @@ SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipien\n     size_t n_plain_pubkeys\n ) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);\n \n+/** Scan for Silent Payment transaction outputs.\n+ *\n+ *  Given a input public sum, an input_hash, a recipient's spend public key B_spend, and the relevant transaction\n+ *  outputs, scan for outputs belong to the recipient and return the tweak(s) needed for spending\n+ *  the output(s). An optional label_lookup callback function and label_context can be passed if the\n+ *  recipient uses labels. This allows for checking if a label exists in the recipients label cache\n+ *  and retrieving the label tweak during scanning.\n+ *\n+ *  Returns: 1 if output scanning was successful. 0 if an error occured.\n+ *  Args:                  ctx: pointer to a context object\n+ *  Out:         found_outputs: pointer to an array of pointers to found output objects. The found outputs\n+ *                              array MUST be initialized to be the same length as the tx_outputs array\n+ *             n_found_outputs: pointer to an integer indicating the final size of the found outputs array.\n+ *                              This number represents the number of outputs found while scanning (0 if\n+ *                              none are found)\n+ *  In:             tx_outputs: pointer to the tx's x-only public key outputs\n+ *                n_tx_outputs: the number of tx_outputs being scanned\n+ *                    scan_key: pointer to the recipient's scan key\n+ *                 public_data: pointer to the input public key sum (optionaly, with the `input_hash`\n+ *                              multiplied in, see `_recipient_compute_public_data`).\n+ *      recipient_spend_pubkey: pointer to the receiver's spend pubkey\n+ *                label_lookup: pointer to a callback function for looking up a label value. This fucntion\n+ *                              takes a label pubkey as an argument and returns a pointer to the label tweak\n+ *                              if the label exists, otherwise returns a nullptr (NULL if labels are not used)\n+ *               label_context: pointer to a label context object (NULL if labels are not used)\n+ */\n+\n+typedef const unsigned char* (*secp256k1_silentpayments_label_lookup)(const secp256k1_pubkey*, const void*);\n+typedef struct {\n+    secp256k1_xonly_pubkey output;\n+    unsigned char tweak[32];\n+    int found_with_label;\n+    secp256k1_pubkey label;\n+} secp256k1_silentpayments_found_output;\n+\n+SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipient_scan_outputs(\n+    const secp256k1_context *ctx,\n+    secp256k1_silentpayments_found_output **found_outputs,\n+    size_t *n_found_outputs,\n+    const secp256k1_xonly_pubkey * const *tx_outputs,\n+    size_t n_tx_outputs,\n+    const unsigned char *scan_key,",
      "path": "include/secp256k1_silentpayments.h",
      "position": null,
      "original_position": 45,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "016c20d95f96a7cdbe2e36793c37fcb35532f5dd",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit, to match the spend key naming:\r\n```suggestion\r\n    const unsigned char *recipient_scan_seckey,\r\n```",
      "created_at": "2024-04-28T01:39:30Z",
      "updated_at": "2024-04-28T01:45:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1581994092",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581994092"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 266,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581994368",
      "pull_request_review_id": 2026864465,
      "id": 1581994368,
      "node_id": "PRRC_kwDOAP4Jqs5eS1GA",
      "diff_hunk": "@@ -429,4 +429,139 @@ int secp256k1_silentpayments_recipient_public_data_parse(const secp256k1_context\n     return 1;\n }\n \n+int secp256k1_silentpayments_recipient_scan_outputs(\n+    const secp256k1_context *ctx,\n+    secp256k1_silentpayments_found_output **found_outputs, size_t *n_found_outputs,\n+    const secp256k1_xonly_pubkey * const *tx_outputs, size_t n_tx_outputs,\n+    const unsigned char *scan_key,\n+    const secp256k1_silentpayments_public_data *public_data,\n+    const secp256k1_pubkey *receiver_spend_pubkey,\n+    const secp256k1_silentpayments_label_lookup label_lookup,\n+    const void *label_context\n+) {\n+    secp256k1_scalar t_k_scalar;\n+    secp256k1_ge receiver_spend_pubkey_ge;\n+    secp256k1_xonly_pubkey P_output_xonly;\n+    secp256k1_pubkey A_sum;\n+    unsigned char shared_secret[33];\n+    size_t i, k, n_found;\n+    int found, combined;\n+\n+    /* Sanity check inputs */\n+    VERIFY_CHECK(ctx != NULL);\n+    ARG_CHECK(found_outputs != NULL);\n+    ARG_CHECK(tx_outputs != NULL);\n+    ARG_CHECK(scan_key != NULL);\n+    ARG_CHECK(public_data != NULL);",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": 465,
      "original_position": 27,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "016c20d95f96a7cdbe2e36793c37fcb35532f5dd",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "could add ARG_CHECKS for `n_found_outputs != NULL` and `n_tx_outputs >= 1` here",
      "created_at": "2024-04-28T01:40:57Z",
      "updated_at": "2024-04-28T01:45:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1581994368",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581994368"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 465,
      "original_line": 465,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581994645",
      "pull_request_review_id": 2026864465,
      "id": 1581994645,
      "node_id": "PRRC_kwDOAP4Jqs5eS1KV",
      "diff_hunk": "@@ -0,0 +1,417 @@\n+/*************************************************************************\n+ * Written in 2024 by josibake                                           *\n+ * To the extent possible under law, the author(s) have dedicated all    *\n+ * copyright and related and neighboring rights to the software in this  *\n+ * file to the public domain worldwide. This software is distributed     *\n+ * without any warranty. For the CC0 Public Domain Dedication, see       *\n+ * EXAMPLES_COPYING or https://creativecommons.org/publicdomain/zero/1.0 *\n+ *************************************************************************/\n+\n+#include <stdio.h>\n+#include <assert.h>\n+#include <string.h>\n+\n+#include <secp256k1.h>\n+#include <secp256k1_extrakeys.h>\n+#include <secp256k1_silentpayments.h>\n+\n+#include \"examples_util.h\"\n+\n+/* Static data for Bob and Carol's silent payment addresses.\n+ * This consists of a scan key for each and the addresse data for each\n+ */\n+static unsigned char smallest_outpoint[36] = {\n+    0x16,0x9e,0x1e,0x83,0xe9,0x30,0x85,0x33,0x91,\n+    0xbc,0x6f,0x35,0xf6,0x05,0xc6,0x75,0x4c,0xfe,\n+    0xad,0x57,0xcf,0x83,0x87,0x63,0x9d,0x3b,0x40,\n+    0x96,0xc5,0x4f,0x18,0xf4,0x00,0x00,0x00,0x00\n+};\n+static unsigned char bob_scan_key[32] = {\n+    0xa8,0x90,0x54,0xc9,0x5b,0xe3,0xc3,0x01,\n+    0x56,0x65,0x74,0xf2,0xaa,0x93,0xad,0xe0,\n+    0x51,0x85,0x09,0x03,0xa6,0x9c,0xbd,0xd1,\n+    0xd4,0x7e,0xae,0x26,0x3d,0x7b,0xc0,0x31\n+};\n+static unsigned char bob_spend_pubkey[33] = {\n+    0x02,0xee,0x97,0xdf,0x83,0xb2,0x54,0x6a,\n+    0xf5,0xa7,0xd0,0x62,0x15,0xd9,0x8b,0xcb,\n+    0x63,0x7f,0xe0,0x5d,0xd0,0xfa,0x37,0x3b,\n+    0xd8,0x20,0xe6,0x64,0xd3,0x72,0xde,0x9a,0x01\n+};\n+static unsigned char bob_address[2][33] = {\n+    {\n+        0x02,0x15,0x40,0xae,0xa8,0x97,0x54,0x7a,\n+        0xd4,0x39,0xb4,0xe0,0xf6,0x09,0xe5,0xf0,\n+        0xfa,0x63,0xde,0x89,0xab,0x11,0xed,0xe3,\n+        0x1e,0x8c,0xde,0x4b,0xe2,0x19,0x42,0x5f,0x23\n+    },\n+    {\n+        0x02,0x3e,0xff,0xf8,0x18,0x51,0x65,0xea,\n+        0x63,0xa9,0x92,0xb3,0x9f,0x31,0xd8,0xfd,\n+        0x8e,0x0e,0x64,0xae,0xf9,0xd3,0x88,0x07,\n+        0x34,0x97,0x37,0x14,0xa5,0x3d,0x83,0x11,0x8d\n+    }\n+};\n+static unsigned char carol_scan_key[32] = {\n+    0x04,0xb2,0xa4,0x11,0x63,0x5c,0x09,0x77,\n+    0x59,0xaa,0xcd,0x0f,0x00,0x5a,0x4c,0x82,\n+    0xc8,0xc9,0x28,0x62,0xc6,0xfc,0x28,0x4b,\n+    0x80,0xb8,0xef,0xeb,0xc2,0x0c,0x3d,0x17\n+};\n+static unsigned char carol_address[2][33] = {\n+    {\n+        0x03,0xbb,0xc6,0x3f,0x12,0x74,0x5d,0x3b,\n+        0x9e,0x9d,0x24,0xc6,0xcd,0x7a,0x1e,0xfe,\n+        0xba,0xd0,0xa7,0xf4,0x69,0x23,0x2f,0xbe,\n+        0xcf,0x31,0xfb,0xa7,0xb4,0xf7,0xdd,0xed,0xa8\n+    },\n+    {\n+        0x03,0x81,0xeb,0x9a,0x9a,0x9e,0xc7,0x39,\n+        0xd5,0x27,0xc1,0x63,0x1b,0x31,0xb4,0x21,\n+        0x56,0x6f,0x5c,0x2a,0x47,0xb4,0xab,0x5b,\n+        0x1f,0x6a,0x68,0x6d,0xfb,0x68,0xea,0xb7,0x16\n+    }\n+};\n+\n+/* Labels\n+ * The structs and call back function are for demonstration only and not optimized.\n+ * In a production usecase, it is expected that the caller will be using a much more performant\n+ * method for storing and querying labels.\n+ */\n+\n+struct label_cache_entry {\n+    secp256k1_pubkey label;\n+    unsigned char label_tweak[32];\n+};\n+\n+struct labels_cache {\n+    const secp256k1_context *ctx;\n+    size_t entries_used;\n+    struct label_cache_entry entries[5];\n+};\n+\n+const unsigned char* label_lookup(const secp256k1_pubkey* key, const void* cache_ptr) {\n+    const struct labels_cache* cache = (const struct labels_cache*)cache_ptr;\n+    size_t i;\n+    for (i = 0; i < cache->entries_used; i++) {\n+        if (secp256k1_ec_pubkey_cmp(cache->ctx, &cache->entries[i].label, key) == 0) {\n+            return cache->entries[i].label_tweak;\n+        }\n+    }\n+    return NULL;\n+}\n+\n+int main(void) {\n+    enum { N_TX_INPUTS = 2, N_TX_OUTPUTS = 3 };\n+    unsigned char randomize[32];\n+    unsigned char xonly_print[32];\n+    secp256k1_xonly_pubkey tx_inputs[N_TX_INPUTS];\n+    secp256k1_xonly_pubkey tx_outputs[N_TX_OUTPUTS];\n+    int ret;\n+    size_t i;\n+    /* Before we can call actual API functions, we need to create a \"context\". */\n+    secp256k1_context* ctx = secp256k1_context_create(SECP256K1_CONTEXT_NONE);\n+    if (!fill_random(randomize, sizeof(randomize))) {\n+        printf(\"Failed to generate randomness\\n\");\n+        return 1;\n+    }\n+    /* Randomizing the context is recommended to protect against side-channel\n+     * leakage See `secp256k1_context_randomize` in secp256k1.h for more\n+     * information about it. This should never fail. */\n+    ret = secp256k1_context_randomize(ctx, randomize);\n+    assert(ret);\n+\n+    /*** Sending ***/\n+    {\n+        secp256k1_keypair sender_seckeys[N_TX_INPUTS];\n+        const secp256k1_keypair *sender_seckey_ptrs[N_TX_INPUTS];\n+        secp256k1_silentpayments_recipient recipients[N_TX_OUTPUTS];\n+        const secp256k1_silentpayments_recipient *recipient_ptrs[N_TX_OUTPUTS];\n+        secp256k1_xonly_pubkey *generated_output_ptrs[N_TX_OUTPUTS];\n+        char* address_amounts[N_TX_OUTPUTS] = {\"1.0 BTC\", \"2.0 BTC\", \"3.0 BTC\"};\n+        unsigned char (*sp_addresses[N_TX_OUTPUTS])[2][33];\n+\n+        /*** Generate private keys for the sender ***\n+         *\n+         * In this example, only taproot inputs are used but the function can be called with\n+         * a mix of taproot seckeys and plain seckeys. Taproot seckeys are passed as keypairs\n+         * to allow the sending function to check if the private keys need to be negated without needing\n+         * to do an expensive pubkey generation. This is not needed for plain seckeys since there is no need\n+         * for negation.\n+         *\n+         * The public key from each input keypair is saved in the `tx_inputs` array. This array will be used\n+         * later in the example to represent the public keys the recipient will extracte from the\n+         * transaction inputs.\n+         */\n+\n+        for (i = 0; i < 2; i++) {\n+            /* If the secret key is zero or out of range (bigger than secp256k1's\n+             * order), we try to sample a new key. Note that the probability of this\n+             * happening is negligible. */\n+            while (1) {\n+                unsigned char seckey[32];\n+                if (!fill_random(seckey, sizeof(seckey))) {\n+                    printf(\"Failed to generate randomness\\n\");\n+                    return 1;\n+                }\n+                /* Try to create a keypair with a valid context, it should only fail if\n+                 * the secret key is zero or out of range. */\n+                if (secp256k1_keypair_create(ctx, &sender_seckeys[i], seckey)) {\n+                    sender_seckey_ptrs[i] = &sender_seckeys[i];\n+                    ret = secp256k1_keypair_xonly_pub(ctx, &tx_inputs[i], NULL, &sender_seckeys[i]);\n+                    assert(ret);\n+                    break;\n+                } else {\n+                    printf(\"Failed to create keypair\\n\");\n+                    return 1;\n+                }",
      "path": "examples/silentpayments.c",
      "position": 167,
      "original_position": 167,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "6704738b690c2e07e96ef6f5a4266bd617701e02",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: i think the else-brach can be removed (or at least, the `return 1;` in it); if keypair creation fails, we want to continue in the loop and try with another secret key",
      "created_at": "2024-04-28T01:44:35Z",
      "updated_at": "2024-04-28T01:45:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1581994645",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1581994645"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": 164,
      "original_start_line": 164,
      "start_side": "RIGHT",
      "line": 167,
      "original_line": 167,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588884794",
      "pull_request_review_id": 2037624531,
      "id": 1588884794,
      "node_id": "PRRC_kwDOAP4Jqs5etHU6",
      "diff_hunk": "@@ -0,0 +1,417 @@\n+/*************************************************************************\n+ * Written in 2024 by josibake                                           *\n+ * To the extent possible under law, the author(s) have dedicated all    *\n+ * copyright and related and neighboring rights to the software in this  *\n+ * file to the public domain worldwide. This software is distributed     *\n+ * without any warranty. For the CC0 Public Domain Dedication, see       *\n+ * EXAMPLES_COPYING or https://creativecommons.org/publicdomain/zero/1.0 *\n+ *************************************************************************/\n+\n+#include <stdio.h>\n+#include <assert.h>\n+#include <string.h>\n+\n+#include <secp256k1.h>\n+#include <secp256k1_extrakeys.h>\n+#include <secp256k1_silentpayments.h>\n+\n+#include \"examples_util.h\"\n+\n+/* Static data for Bob and Carol's silent payment addresses.\n+ * This consists of a scan key for each and the addresse data for each\n+ */\n+static unsigned char smallest_outpoint[36] = {\n+    0x16,0x9e,0x1e,0x83,0xe9,0x30,0x85,0x33,0x91,\n+    0xbc,0x6f,0x35,0xf6,0x05,0xc6,0x75,0x4c,0xfe,\n+    0xad,0x57,0xcf,0x83,0x87,0x63,0x9d,0x3b,0x40,\n+    0x96,0xc5,0x4f,0x18,0xf4,0x00,0x00,0x00,0x00\n+};\n+static unsigned char bob_scan_key[32] = {\n+    0xa8,0x90,0x54,0xc9,0x5b,0xe3,0xc3,0x01,\n+    0x56,0x65,0x74,0xf2,0xaa,0x93,0xad,0xe0,\n+    0x51,0x85,0x09,0x03,0xa6,0x9c,0xbd,0xd1,\n+    0xd4,0x7e,0xae,0x26,0x3d,0x7b,0xc0,0x31\n+};\n+static unsigned char bob_spend_pubkey[33] = {\n+    0x02,0xee,0x97,0xdf,0x83,0xb2,0x54,0x6a,\n+    0xf5,0xa7,0xd0,0x62,0x15,0xd9,0x8b,0xcb,\n+    0x63,0x7f,0xe0,0x5d,0xd0,0xfa,0x37,0x3b,\n+    0xd8,0x20,0xe6,0x64,0xd3,0x72,0xde,0x9a,0x01\n+};\n+static unsigned char bob_address[2][33] = {\n+    {\n+        0x02,0x15,0x40,0xae,0xa8,0x97,0x54,0x7a,\n+        0xd4,0x39,0xb4,0xe0,0xf6,0x09,0xe5,0xf0,\n+        0xfa,0x63,0xde,0x89,0xab,0x11,0xed,0xe3,\n+        0x1e,0x8c,0xde,0x4b,0xe2,0x19,0x42,0x5f,0x23\n+    },\n+    {\n+        0x02,0x3e,0xff,0xf8,0x18,0x51,0x65,0xea,\n+        0x63,0xa9,0x92,0xb3,0x9f,0x31,0xd8,0xfd,\n+        0x8e,0x0e,0x64,0xae,0xf9,0xd3,0x88,0x07,\n+        0x34,0x97,0x37,0x14,0xa5,0x3d,0x83,0x11,0x8d\n+    }\n+};\n+static unsigned char carol_scan_key[32] = {\n+    0x04,0xb2,0xa4,0x11,0x63,0x5c,0x09,0x77,\n+    0x59,0xaa,0xcd,0x0f,0x00,0x5a,0x4c,0x82,\n+    0xc8,0xc9,0x28,0x62,0xc6,0xfc,0x28,0x4b,\n+    0x80,0xb8,0xef,0xeb,0xc2,0x0c,0x3d,0x17\n+};\n+static unsigned char carol_address[2][33] = {\n+    {\n+        0x03,0xbb,0xc6,0x3f,0x12,0x74,0x5d,0x3b,\n+        0x9e,0x9d,0x24,0xc6,0xcd,0x7a,0x1e,0xfe,\n+        0xba,0xd0,0xa7,0xf4,0x69,0x23,0x2f,0xbe,\n+        0xcf,0x31,0xfb,0xa7,0xb4,0xf7,0xdd,0xed,0xa8\n+    },\n+    {\n+        0x03,0x81,0xeb,0x9a,0x9a,0x9e,0xc7,0x39,\n+        0xd5,0x27,0xc1,0x63,0x1b,0x31,0xb4,0x21,\n+        0x56,0x6f,0x5c,0x2a,0x47,0xb4,0xab,0x5b,\n+        0x1f,0x6a,0x68,0x6d,0xfb,0x68,0xea,0xb7,0x16\n+    }\n+};\n+\n+/* Labels\n+ * The structs and call back function are for demonstration only and not optimized.\n+ * In a production usecase, it is expected that the caller will be using a much more performant\n+ * method for storing and querying labels.\n+ */\n+\n+struct label_cache_entry {\n+    secp256k1_pubkey label;\n+    unsigned char label_tweak[32];\n+};\n+\n+struct labels_cache {\n+    const secp256k1_context *ctx;\n+    size_t entries_used;\n+    struct label_cache_entry entries[5];\n+};\n+\n+const unsigned char* label_lookup(const secp256k1_pubkey* key, const void* cache_ptr) {\n+    const struct labels_cache* cache = (const struct labels_cache*)cache_ptr;\n+    size_t i;\n+    for (i = 0; i < cache->entries_used; i++) {\n+        if (secp256k1_ec_pubkey_cmp(cache->ctx, &cache->entries[i].label, key) == 0) {\n+            return cache->entries[i].label_tweak;\n+        }\n+    }\n+    return NULL;\n+}\n+\n+int main(void) {\n+    enum { N_TX_INPUTS = 2, N_TX_OUTPUTS = 3 };\n+    unsigned char randomize[32];\n+    unsigned char xonly_print[32];\n+    secp256k1_xonly_pubkey tx_inputs[N_TX_INPUTS];\n+    secp256k1_xonly_pubkey tx_outputs[N_TX_OUTPUTS];\n+    int ret;\n+    size_t i;\n+    /* Before we can call actual API functions, we need to create a \"context\". */\n+    secp256k1_context* ctx = secp256k1_context_create(SECP256K1_CONTEXT_NONE);\n+    if (!fill_random(randomize, sizeof(randomize))) {\n+        printf(\"Failed to generate randomness\\n\");\n+        return 1;\n+    }\n+    /* Randomizing the context is recommended to protect against side-channel\n+     * leakage See `secp256k1_context_randomize` in secp256k1.h for more\n+     * information about it. This should never fail. */\n+    ret = secp256k1_context_randomize(ctx, randomize);\n+    assert(ret);\n+\n+    /*** Sending ***/\n+    {\n+        secp256k1_keypair sender_seckeys[N_TX_INPUTS];\n+        const secp256k1_keypair *sender_seckey_ptrs[N_TX_INPUTS];\n+        secp256k1_silentpayments_recipient recipients[N_TX_OUTPUTS];\n+        const secp256k1_silentpayments_recipient *recipient_ptrs[N_TX_OUTPUTS];\n+        secp256k1_xonly_pubkey *generated_output_ptrs[N_TX_OUTPUTS];\n+        char* address_amounts[N_TX_OUTPUTS] = {\"1.0 BTC\", \"2.0 BTC\", \"3.0 BTC\"};\n+        unsigned char (*sp_addresses[N_TX_OUTPUTS])[2][33];\n+\n+        /*** Generate private keys for the sender ***\n+         *\n+         * In this example, only taproot inputs are used but the function can be called with\n+         * a mix of taproot seckeys and plain seckeys. Taproot seckeys are passed as keypairs\n+         * to allow the sending function to check if the private keys need to be negated without needing\n+         * to do an expensive pubkey generation. This is not needed for plain seckeys since there is no need\n+         * for negation.\n+         *\n+         * The public key from each input keypair is saved in the `tx_inputs` array. This array will be used\n+         * later in the example to represent the public keys the recipient will extracte from the\n+         * transaction inputs.\n+         */\n+\n+        for (i = 0; i < 2; i++) {\n+            /* If the secret key is zero or out of range (bigger than secp256k1's\n+             * order), we try to sample a new key. Note that the probability of this\n+             * happening is negligible. */\n+            while (1) {\n+                unsigned char seckey[32];\n+                if (!fill_random(seckey, sizeof(seckey))) {\n+                    printf(\"Failed to generate randomness\\n\");\n+                    return 1;\n+                }\n+                /* Try to create a keypair with a valid context, it should only fail if\n+                 * the secret key is zero or out of range. */\n+                if (secp256k1_keypair_create(ctx, &sender_seckeys[i], seckey)) {\n+                    sender_seckey_ptrs[i] = &sender_seckeys[i];\n+                    ret = secp256k1_keypair_xonly_pub(ctx, &tx_inputs[i], NULL, &sender_seckeys[i]);\n+                    assert(ret);\n+                    break;\n+                } else {\n+                    printf(\"Failed to create keypair\\n\");\n+                    return 1;\n+                }",
      "path": "examples/silentpayments.c",
      "position": 167,
      "original_position": 167,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "6704738b690c2e07e96ef6f5a4266bd617701e02",
      "in_reply_to_id": 1581994645,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done.",
      "created_at": "2024-05-03T08:10:38Z",
      "updated_at": "2024-05-03T08:10:38Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1588884794",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588884794"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": 164,
      "original_start_line": 164,
      "start_side": "RIGHT",
      "line": 167,
      "original_line": 167,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588885068",
      "pull_request_review_id": 2037624941,
      "id": 1588885068,
      "node_id": "PRRC_kwDOAP4Jqs5etHZM",
      "diff_hunk": "@@ -429,4 +429,139 @@ int secp256k1_silentpayments_recipient_public_data_parse(const secp256k1_context\n     return 1;\n }\n \n+int secp256k1_silentpayments_recipient_scan_outputs(\n+    const secp256k1_context *ctx,\n+    secp256k1_silentpayments_found_output **found_outputs, size_t *n_found_outputs,\n+    const secp256k1_xonly_pubkey * const *tx_outputs, size_t n_tx_outputs,\n+    const unsigned char *scan_key,\n+    const secp256k1_silentpayments_public_data *public_data,\n+    const secp256k1_pubkey *receiver_spend_pubkey,\n+    const secp256k1_silentpayments_label_lookup label_lookup,\n+    const void *label_context\n+) {\n+    secp256k1_scalar t_k_scalar;\n+    secp256k1_ge receiver_spend_pubkey_ge;\n+    secp256k1_xonly_pubkey P_output_xonly;\n+    secp256k1_pubkey A_sum;\n+    unsigned char shared_secret[33];\n+    size_t i, k, n_found;\n+    int found, combined;\n+\n+    /* Sanity check inputs */\n+    VERIFY_CHECK(ctx != NULL);\n+    ARG_CHECK(found_outputs != NULL);\n+    ARG_CHECK(tx_outputs != NULL);\n+    ARG_CHECK(scan_key != NULL);\n+    ARG_CHECK(public_data != NULL);",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": 465,
      "original_position": 27,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "016c20d95f96a7cdbe2e36793c37fcb35532f5dd",
      "in_reply_to_id": 1581994368,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Added.",
      "created_at": "2024-05-03T08:10:53Z",
      "updated_at": "2024-05-03T08:10:53Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1588885068",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588885068"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 465,
      "original_line": 465,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588886367",
      "pull_request_review_id": 2037627106,
      "id": 1588886367,
      "node_id": "PRRC_kwDOAP4Jqs5etHtf",
      "diff_hunk": "@@ -222,6 +222,55 @@ SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipien\n     size_t n_plain_pubkeys\n ) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);\n \n+/** Scan for Silent Payment transaction outputs.\n+ *\n+ *  Given a input public sum, an input_hash, a recipient's spend public key B_spend, and the relevant transaction\n+ *  outputs, scan for outputs belong to the recipient and return the tweak(s) needed for spending\n+ *  the output(s). An optional label_lookup callback function and label_context can be passed if the\n+ *  recipient uses labels. This allows for checking if a label exists in the recipients label cache\n+ *  and retrieving the label tweak during scanning.\n+ *\n+ *  Returns: 1 if output scanning was successful. 0 if an error occured.\n+ *  Args:                  ctx: pointer to a context object\n+ *  Out:         found_outputs: pointer to an array of pointers to found output objects. The found outputs\n+ *                              array MUST be initialized to be the same length as the tx_outputs array\n+ *             n_found_outputs: pointer to an integer indicating the final size of the found outputs array.\n+ *                              This number represents the number of outputs found while scanning (0 if\n+ *                              none are found)\n+ *  In:             tx_outputs: pointer to the tx's x-only public key outputs\n+ *                n_tx_outputs: the number of tx_outputs being scanned\n+ *                    scan_key: pointer to the recipient's scan key\n+ *                 public_data: pointer to the input public key sum (optionaly, with the `input_hash`\n+ *                              multiplied in, see `_recipient_compute_public_data`).\n+ *      recipient_spend_pubkey: pointer to the receiver's spend pubkey\n+ *                label_lookup: pointer to a callback function for looking up a label value. This fucntion\n+ *                              takes a label pubkey as an argument and returns a pointer to the label tweak\n+ *                              if the label exists, otherwise returns a nullptr (NULL if labels are not used)\n+ *               label_context: pointer to a label context object (NULL if labels are not used)\n+ */\n+\n+typedef const unsigned char* (*secp256k1_silentpayments_label_lookup)(const secp256k1_pubkey*, const void*);\n+typedef struct {\n+    secp256k1_xonly_pubkey output;\n+    unsigned char tweak[32];\n+    int found_with_label;\n+    secp256k1_pubkey label;\n+} secp256k1_silentpayments_found_output;\n+\n+SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipient_scan_outputs(\n+    const secp256k1_context *ctx,\n+    secp256k1_silentpayments_found_output **found_outputs,\n+    size_t *n_found_outputs,\n+    const secp256k1_xonly_pubkey * const *tx_outputs,\n+    size_t n_tx_outputs,\n+    const unsigned char *scan_key,",
      "path": "include/secp256k1_silentpayments.h",
      "position": null,
      "original_position": 45,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "016c20d95f96a7cdbe2e36793c37fcb35532f5dd",
      "in_reply_to_id": 1581994092,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Changed `s/receiver/recipient/` consistently. Also removed references to `seckey` and \"private,\" considering the scan key is not a private key.",
      "created_at": "2024-05-03T08:12:00Z",
      "updated_at": "2024-05-03T08:12:00Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1588886367",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588886367"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 266,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588886604",
      "pull_request_review_id": 2037627449,
      "id": 1588886604,
      "node_id": "PRRC_kwDOAP4Jqs5etHxM",
      "diff_hunk": "@@ -138,6 +138,90 @@ SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipien\n     const secp256k1_pubkey *label\n ) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4);\n \n+/** Opaque data structure that holds silent payments public input data.\n+ *\n+ *  This structure does not contain secret data. Guaranteed to be 98 bytes in size. It can be safely\n+ *  copied/moved. Created with `secp256k1_silentpayments_compute_public_data`. Can be serialized as",
      "path": "include/secp256k1_silentpayments.h",
      "position": null,
      "original_position": 7,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "41cd97dea39f10a9f537b206b8e3b6a6ab015f35",
      "in_reply_to_id": 1581993914,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fixed.",
      "created_at": "2024-05-03T08:12:13Z",
      "updated_at": "2024-05-03T08:12:13Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1588886604",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588886604"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 144,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588886793",
      "pull_request_review_id": 2037627751,
      "id": 1588886793,
      "node_id": "PRRC_kwDOAP4Jqs5etH0J",
      "diff_hunk": "@@ -138,6 +138,90 @@ SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipien\n     const secp256k1_pubkey *label\n ) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4);\n \n+/** Opaque data structure that holds silent payments public input data.\n+ *\n+ *  This structure does not contain secret data. Guaranteed to be 98 bytes in size. It can be safely\n+ *  copied/moved. Created with `secp256k1_silentpayments_compute_public_data`. Can be serialized as\n+ *  a compressed public key using `secp256k1_silentpayments_public_data_serialize`. The serialization\n+ *  is intended for sending the public input data to light clients. Light clients can use this\n+ *  serialization with `secp256k1_silentpayments_public_data_parse`.\n+ */\n+typedef struct {\n+    unsigned char data[98];\n+} secp256k1_silentpayments_public_data;\n+\n+/** Parse a 33-byte sequence into a silent_payments_public_data object.\n+ *\n+ *  Returns: 1 if the data was able to be parsed.\n+ *           0 if the sequence is invalid (e.g. does not represnt a valid public key).\n+ *\n+ *  Args:        ctx: pointer to a context object.\n+ *  Out: public_data: pointer to a silentpayments_public_data object. If 1 is returned, it is set to a\n+ *                    parsed version of input33.\n+ *  In:      input33: pointer to a serialized silentpayments_public_data.\n+ */\n+\n+SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipient_public_data_parse(\n+    const secp256k1_context *ctx,\n+    secp256k1_silentpayments_public_data *public_data,\n+    const unsigned char *input33\n+) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);\n+\n+/** Serialize a silentpayments_public_data object into a 33-byte sequence.\n+ *\n+ *  Returns: 1 always.\n+ *\n+ *  Args:       ctx: pointer to a context object.\n+ *  Out:   output33: pointer to a 32-byte array to place the serialized key in.\n+ *  In: public_data: pointer to an initialized silentpayments_public_data object.\n+ */\n+SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipient_public_data_serialize(\n+    const secp256k1_context *ctx,\n+    unsigned char *output33,\n+    const secp256k1_silentpayments_public_data *public_data\n+) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);\n+\n+/** Compute Silent Payment public data from input public keys and transaction inputs.\n+ *\n+ * Given a list of n public keys A_1...A_n (one for each silent payment\n+ * eligible input to spend) and a serialized outpoint_smallest, compute\n+ * the corresponding input public tweak data:\n+ *\n+ * A_sum = A_1 + A_2 + ... + A_n\n+ * input_hash = hash(outpoint_lowest || A_sum)\n+ *\n+ * The public keys have to be passed in via two different parameter pairs,\n+ * one for regular and one for x-only public keys, in order to avoid the need\n+ * of users converting to a common pubkey format before calling this function.\n+ * The resulting data is can be used for scanning on the recipient side, or stored\n+ * in an index for late use (e.g. wallet rescanning, vending data to light clients).\n+ *\n+ * If calling this function for scanning, the reciever must provide an output param\n+ * for the `input_hash`. If calling this function for simply aggregating the inputs\n+ * for later use, the caller can save the result with `silentpayments_public_data_serialize`.\n+ *\n+ *  Returns: 1 if tweak data creation was successful. 0 if an error occured.\n+ *  Args:                  ctx: pointer to a context object\n+ *  Out:           public_data: pointer to public_data object containing the summed public key and\n+ *                              input_hash.\n+ *  In:    outpoint_smallest36: serialized smallest outpoint\n+ *               xonly_pubkeys: pointer to an array of pointers to taproot x-only\n+ *                              public keys (can be NULL if no taproot inputs are used)\n+ *             n_xonly_pubkeys: the number of taproot input public keys\n+ *               plain_pubkeys: pointer to an array of pointers to non-taproot\n+ *                              public keys (can be NULL if no non-taproot inputs are used)\n+ *             n_plain_pubkeys: the number of non-taproot input public keys\n+ */\n+SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipient_public_data_create(",
      "path": "include/secp256k1_silentpayments.h",
      "position": 185,
      "original_position": 78,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "41cd97dea39f10a9f537b206b8e3b6a6ab015f35",
      "in_reply_to_id": 1581993849,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done.",
      "created_at": "2024-05-03T08:12:24Z",
      "updated_at": "2024-05-03T08:12:24Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1588886793",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588886793"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 185,
      "original_line": 185,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588886959",
      "pull_request_review_id": 2037628025,
      "id": 1588886959,
      "node_id": "PRRC_kwDOAP4Jqs5etH2v",
      "diff_hunk": "@@ -324,4 +324,109 @@ int secp256k1_silentpayments_recipient_create_labelled_spend_pubkey(const secp25\n     return 1;\n }\n \n+int secp256k1_silentpayments_recipient_public_data_create(\n+    const secp256k1_context *ctx,\n+    secp256k1_silentpayments_public_data *public_data,\n+    const unsigned char *outpoint_smallest36,\n+    const secp256k1_xonly_pubkey * const *xonly_pubkeys,\n+    size_t n_xonly_pubkeys,\n+    const secp256k1_pubkey * const *plain_pubkeys,\n+    size_t n_plain_pubkeys\n+) {\n+    size_t i;\n+    size_t pubkeylen = 65;\n+    secp256k1_pubkey A_sum;\n+    secp256k1_ge A_sum_ge, addend;\n+    secp256k1_gej A_sum_gej;\n+    unsigned char input_hash_local[32];\n+\n+    /* Sanity check inputs */\n+    VERIFY_CHECK(ctx != NULL);\n+    ARG_CHECK(public_data != NULL);\n+    ARG_CHECK(plain_pubkeys == NULL || n_plain_pubkeys >= 1);\n+    ARG_CHECK(xonly_pubkeys == NULL || n_xonly_pubkeys >= 1);\n+    ARG_CHECK((plain_pubkeys != NULL) || (xonly_pubkeys != NULL));\n+    ARG_CHECK((n_plain_pubkeys + n_xonly_pubkeys) >= 1);\n+    ARG_CHECK(outpoint_smallest36 != NULL);\n+    memset(input_hash_local, 0, 32);\n+\n+    /* Compute input public keys sum: A_sum = A_1 + A_2 + ... + A_n */\n+    secp256k1_gej_set_infinity(&A_sum_gej);\n+    for (i = 0; i < n_plain_pubkeys; i++) {\n+        secp256k1_pubkey_load(ctx, &addend, plain_pubkeys[i]);\n+        secp256k1_gej_add_ge_var(&A_sum_gej, &A_sum_gej, &addend, NULL);\n+    }\n+    for (i = 0; i < n_xonly_pubkeys; i++) {\n+        secp256k1_xonly_pubkey_load(ctx, &addend, xonly_pubkeys[i]);\n+        secp256k1_gej_add_ge(&A_sum_gej, &A_sum_gej, &addend);\n+    }\n+    if (secp256k1_gej_is_infinity(&A_sum_gej)) {\n+        /* TODO: do we need a special error return code for this case? */\n+        return 0;\n+    }\n+    secp256k1_ge_set_gej(&A_sum_ge, &A_sum_gej);\n+\n+    /* Compute input_hash = hash(outpoint_L || A_sum) */\n+    secp256k1_silentpayments_calculate_input_hash(input_hash_local, outpoint_smallest36, &A_sum_ge);\n+    secp256k1_pubkey_save(&A_sum, &A_sum_ge);\n+    /* serialize the public_data struct */\n+    public_data->data[0] = 0;\n+    secp256k1_ec_pubkey_serialize(ctx, &public_data->data[1], &pubkeylen, &A_sum, SECP256K1_EC_UNCOMPRESSED);\n+    memcpy(&public_data->data[1 + pubkeylen], input_hash_local, 32);\n+    return 1;\n+}\n+\n+int secp256k1_silentpayments_recipient_public_data_load(const secp256k1_context *ctx, secp256k1_pubkey *pubkey, unsigned char *input_hash, const secp256k1_silentpayments_public_data *public_data) {",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": null,
      "original_position": 56,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "41cd97dea39f10a9f537b206b8e3b6a6ab015f35",
      "in_reply_to_id": 1581993573,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done.",
      "created_at": "2024-05-03T08:12:35Z",
      "updated_at": "2024-05-03T08:12:36Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1588886959",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588886959"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 379,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588887146",
      "pull_request_review_id": 2037628330,
      "id": 1588887146,
      "node_id": "PRRC_kwDOAP4Jqs5etH5q",
      "diff_hunk": "@@ -324,4 +324,109 @@ int secp256k1_silentpayments_recipient_create_labelled_spend_pubkey(const secp25\n     return 1;\n }\n \n+int secp256k1_silentpayments_recipient_public_data_create(\n+    const secp256k1_context *ctx,\n+    secp256k1_silentpayments_public_data *public_data,\n+    const unsigned char *outpoint_smallest36,\n+    const secp256k1_xonly_pubkey * const *xonly_pubkeys,\n+    size_t n_xonly_pubkeys,\n+    const secp256k1_pubkey * const *plain_pubkeys,\n+    size_t n_plain_pubkeys\n+) {\n+    size_t i;\n+    size_t pubkeylen = 65;\n+    secp256k1_pubkey A_sum;\n+    secp256k1_ge A_sum_ge, addend;\n+    secp256k1_gej A_sum_gej;\n+    unsigned char input_hash_local[32];\n+\n+    /* Sanity check inputs */\n+    VERIFY_CHECK(ctx != NULL);\n+    ARG_CHECK(public_data != NULL);\n+    ARG_CHECK(plain_pubkeys == NULL || n_plain_pubkeys >= 1);\n+    ARG_CHECK(xonly_pubkeys == NULL || n_xonly_pubkeys >= 1);\n+    ARG_CHECK((plain_pubkeys != NULL) || (xonly_pubkeys != NULL));\n+    ARG_CHECK((n_plain_pubkeys + n_xonly_pubkeys) >= 1);\n+    ARG_CHECK(outpoint_smallest36 != NULL);\n+    memset(input_hash_local, 0, 32);\n+\n+    /* Compute input public keys sum: A_sum = A_1 + A_2 + ... + A_n */\n+    secp256k1_gej_set_infinity(&A_sum_gej);\n+    for (i = 0; i < n_plain_pubkeys; i++) {\n+        secp256k1_pubkey_load(ctx, &addend, plain_pubkeys[i]);\n+        secp256k1_gej_add_ge_var(&A_sum_gej, &A_sum_gej, &addend, NULL);\n+    }\n+    for (i = 0; i < n_xonly_pubkeys; i++) {\n+        secp256k1_xonly_pubkey_load(ctx, &addend, xonly_pubkeys[i]);\n+        secp256k1_gej_add_ge(&A_sum_gej, &A_sum_gej, &addend);",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": null,
      "original_position": 38,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "41cd97dea39f10a9f537b206b8e3b6a6ab015f35",
      "in_reply_to_id": 1581993506,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fixed.",
      "created_at": "2024-05-03T08:12:48Z",
      "updated_at": "2024-05-03T08:12:48Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1588887146",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588887146"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 361,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588887330",
      "pull_request_review_id": 2037628563,
      "id": 1588887330,
      "node_id": "PRRC_kwDOAP4Jqs5etH8i",
      "diff_hunk": "@@ -138,6 +138,90 @@ SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipien\n     const secp256k1_pubkey *label\n ) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4);\n \n+/** Opaque data structure that holds silent payments public input data.\n+ *\n+ *  This structure does not contain secret data. Guaranteed to be 98 bytes in size. It can be safely\n+ *  copied/moved. Created with `secp256k1_silentpayments_compute_public_data`. Can be serialized as\n+ *  a compressed public key using `secp256k1_silentpayments_public_data_serialize`. The serialization\n+ *  is intended for sending the public input data to light clients. Light clients can use this\n+ *  serialization with `secp256k1_silentpayments_public_data_parse`.\n+ */\n+typedef struct {\n+    unsigned char data[98];\n+} secp256k1_silentpayments_public_data;\n+\n+/** Parse a 33-byte sequence into a silent_payments_public_data object.\n+ *\n+ *  Returns: 1 if the data was able to be parsed.\n+ *           0 if the sequence is invalid (e.g. does not represnt a valid public key).",
      "path": "include/secp256k1_silentpayments.h",
      "position": null,
      "original_position": 19,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "41cd97dea39f10a9f537b206b8e3b6a6ab015f35",
      "in_reply_to_id": 1581993393,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fixed.",
      "created_at": "2024-05-03T08:12:58Z",
      "updated_at": "2024-05-03T08:12:58Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1588887330",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588887330"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 156,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588889660",
      "pull_request_review_id": 2037632371,
      "id": 1588889660,
      "node_id": "PRRC_kwDOAP4Jqs5etIg8",
      "diff_hunk": "@@ -93,6 +93,51 @@ SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_sender_c\n     size_t n_plain_seckeys\n ) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(5);\n \n+/** Create Silent Payment label tweak and label.\n+ *\n+ *  Given a recipient's scan private key b_scan and a label integer m, calculate\n+ *  the corresponding label tweak and label:\n+ *\n+ *  label_tweak = hash(b_scan || m)\n+ *  label = label_tweak * G\n+ *\n+ *  Returns: 1 if label tweak and label creation was successful. 0 if an error occured.\n+ *  Args:                  ctx: pointer to a context object\n+ *  Out:           label_tweak: pointer to the resulting label tweak\n+ *   In:  receiver_scan_seckey: pointer to the receiver's scan private key\n+ *                           m: label integer (0 is used for change outputs)\n+ */\n+SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipient_create_label_tweak(\n+    const secp256k1_context *ctx,\n+    secp256k1_pubkey *label,\n+    unsigned char *label_tweak32,\n+    const unsigned char *receiver_scan_seckey,\n+    unsigned int m\n+) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4);\n+\n+/** Create Silent Payment labelled spend public key.\n+ *\n+ *  Given a recipient's spend public key B_spend and a label, calculate\n+ *  the corresponding serialized labelled spend public key:\n+ *\n+ *  B_m = B_spend + label\n+ *\n+ *  The result is used by the recipient to create a Silent Payment address, consisting\n+ *  of the serialized and concatenated scan public key and (labelled) spend public key each.\n+ *\n+ *  Returns: 1 if labelled spend public key creation was successful. 0 if an error occured.\n+ *  Args:                  ctx: pointer to a context object\n+ *  Out: l_addr_spend_pubkey33: pointer to the resulting labelled spend public key",
      "path": "include/secp256k1_silentpayments.h",
      "position": null,
      "original_position": 38,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "aeef18499580e576f2078b20936842b899b05bd3",
      "in_reply_to_id": 1581993106,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Added.",
      "created_at": "2024-05-03T08:15:27Z",
      "updated_at": "2024-05-03T08:15:27Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1588889660",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588889660"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 130,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588889968",
      "pull_request_review_id": 2037632929,
      "id": 1588889968,
      "node_id": "PRRC_kwDOAP4Jqs5etIlw",
      "diff_hunk": "@@ -93,6 +93,51 @@ SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_sender_c\n     size_t n_plain_seckeys\n ) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(5);\n \n+/** Create Silent Payment label tweak and label.\n+ *\n+ *  Given a recipient's scan private key b_scan and a label integer m, calculate\n+ *  the corresponding label tweak and label:\n+ *\n+ *  label_tweak = hash(b_scan || m)\n+ *  label = label_tweak * G\n+ *\n+ *  Returns: 1 if label tweak and label creation was successful. 0 if an error occured.\n+ *  Args:                  ctx: pointer to a context object\n+ *  Out:           label_tweak: pointer to the resulting label tweak\n+ *   In:  receiver_scan_seckey: pointer to the receiver's scan private key\n+ *                           m: label integer (0 is used for change outputs)\n+ */\n+SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipient_create_label_tweak(\n+    const secp256k1_context *ctx,\n+    secp256k1_pubkey *label,\n+    unsigned char *label_tweak32,\n+    const unsigned char *receiver_scan_seckey,\n+    unsigned int m\n+) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4);\n+\n+/** Create Silent Payment labelled spend public key.\n+ *\n+ *  Given a recipient's spend public key B_spend and a label, calculate\n+ *  the corresponding serialized labelled spend public key:\n+ *\n+ *  B_m = B_spend + label\n+ *\n+ *  The result is used by the recipient to create a Silent Payment address, consisting\n+ *  of the serialized and concatenated scan public key and (labelled) spend public key each.\n+ *\n+ *  Returns: 1 if labelled spend public key creation was successful. 0 if an error occured.\n+ *  Args:                  ctx: pointer to a context object\n+ *  Out: l_addr_spend_pubkey33: pointer to the resulting labelled spend public key\n+ *   In: receiver_spend_pubkey: pointer to the receiver's spend pubkey\n+ *                       label: pointer to the the receiver's label\n+ */\n+SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipient_create_labelled_spend_pubkey(\n+    const secp256k1_context *ctx,\n+    secp256k1_pubkey *labeled_spend_pubkey,",
      "path": "include/secp256k1_silentpayments.h",
      "position": null,
      "original_position": 44,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "aeef18499580e576f2078b20936842b899b05bd3",
      "in_reply_to_id": 1581993053,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Used `labelled` throughout.",
      "created_at": "2024-05-03T08:15:50Z",
      "updated_at": "2024-05-03T08:15:50Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1588889968",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588889968"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": 134,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 136,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588890103",
      "pull_request_review_id": 2037633133,
      "id": 1588890103,
      "node_id": "PRRC_kwDOAP4Jqs5etIn3",
      "diff_hunk": "@@ -40,6 +40,59 @@ typedef struct {\n     size_t index;\n } secp256k1_silentpayments_recipient;\n \n+/** Create Silent Payment outputs for recipient(s).\n+ *\n+ * Given a list of n private keys a_1...a_n (one for each silent payment\n+ * eligible input to spend), a serialized outpoint, and a list of recipients,\n+ * create the taproot outputs:\n+ *\n+ * a_sum = a_1 + a_2 + ... + a_n\n+ * input_hash = hash(outpoint_smallest || (a_sum * G))\n+ * taproot_output = B_spend + hash(a_sum * input_hash * B_scan || k) * G\n+ *\n+ * If necessary, the private keys are negated to enforce the right y-parity.\n+ * For that reason, the private keys have to be passed in via two different parameter\n+ * pairs, depending on whether they seckeys correspond to x-only outputs or not.\n+ *\n+ *  Returns: 1 if shared secret creation was successful. 0 if an error occured.",
      "path": "include/secp256k1_silentpayments.h",
      "position": null,
      "original_position": 18,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "50dcc1aeddfc2d522ebe02b9709f8c1c119c6027",
      "in_reply_to_id": 1581992633,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fixed.",
      "created_at": "2024-05-03T08:15:59Z",
      "updated_at": "2024-05-03T08:15:59Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1588890103",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588890103"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 57,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588890267",
      "pull_request_review_id": 2037633411,
      "id": 1588890267,
      "node_id": "PRRC_kwDOAP4Jqs5etIqb",
      "diff_hunk": "@@ -40,6 +40,59 @@ typedef struct {\n     size_t index;\n } secp256k1_silentpayments_recipient;\n \n+/** Create Silent Payment outputs for recipient(s).\n+ *\n+ * Given a list of n private keys a_1...a_n (one for each silent payment\n+ * eligible input to spend), a serialized outpoint, and a list of recipients,\n+ * create the taproot outputs:\n+ *\n+ * a_sum = a_1 + a_2 + ... + a_n\n+ * input_hash = hash(outpoint_smallest || (a_sum * G))\n+ * taproot_output = B_spend + hash(a_sum * input_hash * B_scan || k) * G\n+ *\n+ * If necessary, the private keys are negated to enforce the right y-parity.\n+ * For that reason, the private keys have to be passed in via two different parameter\n+ * pairs, depending on whether they seckeys correspond to x-only outputs or not.",
      "path": "include/secp256k1_silentpayments.h",
      "position": null,
      "original_position": 16,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "50dcc1aeddfc2d522ebe02b9709f8c1c119c6027",
      "in_reply_to_id": 1581992596,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fixed.",
      "created_at": "2024-05-03T08:16:10Z",
      "updated_at": "2024-05-03T08:16:10Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1588890267",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588890267"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 55,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588892139",
      "pull_request_review_id": 2037636286,
      "id": 1588892139,
      "node_id": "PRRC_kwDOAP4Jqs5etJHr",
      "diff_hunk": "@@ -173,4 +173,90 @@ int secp256k1_silentpayments_create_output_pubkey(const secp256k1_context *ctx,\n     return 1;\n }\n \n+int secp256k1_silentpayments_sender_create_outputs(\n+    const secp256k1_context *ctx,\n+    secp256k1_xonly_pubkey **generated_outputs,\n+    const secp256k1_silentpayments_recipient **recipients,\n+    size_t n_recipients,\n+    const unsigned char *outpoint_smallest36,\n+    const secp256k1_keypair * const *taproot_seckeys,\n+    size_t n_taproot_seckeys,\n+    const unsigned char * const *plain_seckeys,\n+    size_t n_plain_seckeys\n+) {\n+    size_t i, k;\n+    secp256k1_scalar a_sum_scalar, addend;\n+    secp256k1_ge A_sum_ge;\n+    secp256k1_gej A_sum_gej;\n+    unsigned char input_hash[32];\n+    unsigned char a_sum[32];\n+    unsigned char shared_secret[33];\n+    secp256k1_silentpayments_recipient last_recipient;\n+\n+    /* Sanity check inputs. */\n+    VERIFY_CHECK(ctx != NULL);\n+    ARG_CHECK(recipients != NULL);",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": 198,
      "original_position": 26,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "50dcc1aeddfc2d522ebe02b9709f8c1c119c6027",
      "in_reply_to_id": 1581992522,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Added. Out of curiosity, I noticed we have `VERIFY_CHECK` and `ARG_CHECK`, do you know when one is preferred over the other? In most cases, I see `VERIFY_CHECK` being used to check the `ctx`, but there were a few places where `VERIFY_CHECK` was also being used to check the arguments.",
      "created_at": "2024-05-03T08:17:35Z",
      "updated_at": "2024-05-03T08:17:35Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1588892139",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588892139"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 198,
      "original_line": 198,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588892272",
      "pull_request_review_id": 2037636462,
      "id": 1588892272,
      "node_id": "PRRC_kwDOAP4Jqs5etJJw",
      "diff_hunk": "@@ -9,8 +9,36 @@\n #include \"../../../include/secp256k1.h\"\n #include \"../../../include/secp256k1_silentpayments.h\"\n \n-/* TODO: implement functions for sender side. */\n+/** Sort an array of silent payment recipients. This is used to group recipients by scan pubkey to\n+ *  ensure the correct values of k are used when creating multiple outputs for a recipient. */\n+static int secp256k1_silentpayments_recipient_sort_cmp(const void* pk1, const void* pk2, void *cmp_data) {\n+    return secp256k1_ec_pubkey_cmp(\n+        ((secp256k1_ec_pubkey_sort_cmp_data*)cmp_data)->ctx,\n+        &(*(const secp256k1_silentpayments_recipient **)pk1)->scan_pubkey,\n+        &(*(const secp256k1_silentpayments_recipient **)pk2)->scan_pubkey\n+    );\n+}\n \n-/* TODO: implement functions for receiver side. */\n+int secp256k1_silentpayments_recipient_sort(const secp256k1_context* ctx, const secp256k1_silentpayments_recipient **recipients, size_t n_recipients) {",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": 23,
      "original_position": 16,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "97220f7b29b77677e66a527ec933b022ceb2cceb",
      "in_reply_to_id": 1581992289,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done.",
      "created_at": "2024-05-03T08:17:42Z",
      "updated_at": "2024-05-03T08:17:43Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1588892272",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588892272"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 23,
      "original_line": 23,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588894474",
      "pull_request_review_id": 2037639947,
      "id": 1588894474,
      "node_id": "PRRC_kwDOAP4Jqs5etJsK",
      "diff_hunk": "@@ -9,8 +9,36 @@\n #include \"../../../include/secp256k1.h\"\n #include \"../../../include/secp256k1_silentpayments.h\"\n \n-/* TODO: implement functions for sender side. */\n+/** Sort an array of silent payment recipients. This is used to group recipients by scan pubkey to\n+ *  ensure the correct values of k are used when creating multiple outputs for a recipient. */\n+static int secp256k1_silentpayments_recipient_sort_cmp(const void* pk1, const void* pk2, void *cmp_data) {\n+    return secp256k1_ec_pubkey_cmp(\n+        ((secp256k1_ec_pubkey_sort_cmp_data*)cmp_data)->ctx,\n+        &(*(const secp256k1_silentpayments_recipient **)pk1)->scan_pubkey,\n+        &(*(const secp256k1_silentpayments_recipient **)pk2)->scan_pubkey",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": 19,
      "original_position": 11,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "97220f7b29b77677e66a527ec933b022ceb2cceb",
      "in_reply_to_id": 1581992204,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I'll admit, I don't fully understand why the double pointers are necessary, but they are: when I removed them, my tests would pass locally but the branch would fail the CI. I noticed the double pointers are also used for the `secp256k1_pubkey_sort` function, so leaving for now.",
      "created_at": "2024-05-03T08:20:03Z",
      "updated_at": "2024-05-03T08:20:03Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1588894474",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588894474"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": 18,
      "original_start_line": 17,
      "start_side": "RIGHT",
      "line": 19,
      "original_line": 19,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588895904",
      "pull_request_review_id": 2037642324,
      "id": 1588895904,
      "node_id": "PRRC_kwDOAP4Jqs5etKCg",
      "diff_hunk": "@@ -138,6 +138,90 @@ SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipien\n     const secp256k1_pubkey *label\n ) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4);\n \n+/** Opaque data structure that holds silent payments public input data.\n+ *\n+ *  This structure does not contain secret data. Guaranteed to be 98 bytes in size. It can be safely\n+ *  copied/moved. Created with `secp256k1_silentpayments_compute_public_data`. Can be serialized as\n+ *  a compressed public key using `secp256k1_silentpayments_public_data_serialize`. The serialization\n+ *  is intended for sending the public input data to light clients. Light clients can use this\n+ *  serialization with `secp256k1_silentpayments_public_data_parse`.\n+ */\n+typedef struct {\n+    unsigned char data[98];\n+} secp256k1_silentpayments_public_data;\n+\n+/** Parse a 33-byte sequence into a silent_payments_public_data object.\n+ *\n+ *  Returns: 1 if the data was able to be parsed.\n+ *           0 if the sequence is invalid (e.g. does not represnt a valid public key).\n+ *\n+ *  Args:        ctx: pointer to a context object.\n+ *  Out: public_data: pointer to a silentpayments_public_data object. If 1 is returned, it is set to a\n+ *                    parsed version of input33.\n+ *  In:      input33: pointer to a serialized silentpayments_public_data.\n+ */\n+\n+SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipient_public_data_parse(\n+    const secp256k1_context *ctx,\n+    secp256k1_silentpayments_public_data *public_data,\n+    const unsigned char *input33\n+) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);\n+\n+/** Serialize a silentpayments_public_data object into a 33-byte sequence.\n+ *\n+ *  Returns: 1 always.\n+ *\n+ *  Args:       ctx: pointer to a context object.\n+ *  Out:   output33: pointer to a 32-byte array to place the serialized key in.",
      "path": "include/secp256k1_silentpayments.h",
      "position": null,
      "original_position": 38,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "41cd97dea39f10a9f537b206b8e3b6a6ab015f35",
      "in_reply_to_id": 1581993315,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fixed.",
      "created_at": "2024-05-03T08:21:36Z",
      "updated_at": "2024-05-03T08:21:36Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1588895904",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588895904"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 175,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588905125",
      "pull_request_review_id": 2037657732,
      "id": 1588905125,
      "node_id": "PRRC_kwDOAP4Jqs5etMSl",
      "diff_hunk": "@@ -433,4 +433,137 @@ int secp256k1_silentpayments_recipient_public_data_parse(const secp256k1_context\n     return 1;\n }\n \n+int secp256k1_silentpayments_recipient_scan_outputs(\n+    const secp256k1_context *ctx,\n+    secp256k1_silentpayments_found_output **found_outputs, size_t *n_found_outputs,\n+    const secp256k1_xonly_pubkey * const *tx_outputs, size_t n_tx_outputs,\n+    const unsigned char *scan_key,\n+    const secp256k1_silentpayments_public_data *public_data,\n+    const secp256k1_pubkey *receiver_spend_pubkey,\n+    const secp256k1_silentpayments_label_lookup label_lookup,\n+    const void *label_context\n+) {\n+    secp256k1_scalar t_k_scalar;\n+    secp256k1_ge receiver_spend_pubkey_ge;\n+    secp256k1_xonly_pubkey P_output_xonly;\n+    secp256k1_pubkey A_sum;\n+    unsigned char shared_secret[33];\n+    size_t i, k, n_found;\n+    int found, combined;\n+\n+    /* Sanity check inputs */\n+    VERIFY_CHECK(ctx != NULL);\n+    ARG_CHECK(found_outputs != NULL);\n+    ARG_CHECK(tx_outputs != NULL);\n+    ARG_CHECK(scan_key != NULL);\n+    ARG_CHECK(public_data != NULL);\n+    combined = (int)public_data->data[0];\n+    {\n+        unsigned char input_hash[32];\n+        unsigned char *input_hash_ptr;\n+        if (combined) {\n+            input_hash_ptr = NULL;\n+        } else {\n+            memset(input_hash, 0, 32);\n+            input_hash_ptr = input_hash;\n+        }\n+        if (!secp256k1_silentpayments_recipient_public_data_load(ctx, &A_sum, input_hash_ptr, public_data)) {\n+            return 0;\n+        }\n+        secp256k1_pubkey_load(ctx, &receiver_spend_pubkey_ge, receiver_spend_pubkey);\n+        if (!secp256k1_silentpayments_create_shared_secret(ctx, shared_secret, scan_key, &A_sum, input_hash_ptr)) {\n+            return 0;\n+        }\n+    }\n+\n+    n_found = 0;\n+    k = 0;\n+    while (1) {\n+        secp256k1_ge P_output_ge = receiver_spend_pubkey_ge;\n+        /* Calculate t_k = hash(shared_secret || ser_32(k)) */\n+        secp256k1_silentpayments_create_t_k(&t_k_scalar, shared_secret, k);\n+\n+        /* Calculate P_output = B_spend + t_k * G */\n+        if (!secp256k1_eckey_pubkey_tweak_add(&P_output_ge, &t_k_scalar)) {\n+            return 0;\n+        }\n+\n+        /* If the calculated output matches the one from the tx, we have a direct match and can\n+         * return without labels calculation (one of the two would result in point of infinity) */\n+        secp256k1_xonly_pubkey_save(&P_output_xonly, &P_output_ge);\n+        found = 0;\n+        for (i = 0; i < n_tx_outputs; i++) {\n+            if (secp256k1_xonly_pubkey_cmp(ctx, &P_output_xonly, tx_outputs[i]) == 0) {\n+                found_outputs[n_found]->output = *tx_outputs[i];\n+                secp256k1_scalar_get_b32(found_outputs[n_found]->tweak, &t_k_scalar);\n+                found = 1;\n+                n_found++;\n+                k++;\n+                break;\n+            }\n+\n+            /* If desired, also calculate label candidates */\n+            if (label_lookup != NULL) {",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": null,
      "original_position": 74,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "f113564298e8e76813289fdcefa6968462dc3fda",
      "in_reply_to_id": 1575010116,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Coming back to this, I tried a few variations but found with the benchmark that comparing the generated output to the tx outputs as serialized bytes is marginally faster than the alternatives, so there wasn't much opportunity for minimizing conversions. I was able to clean up this code a bit, but will likely take a second pass at it.",
      "created_at": "2024-05-03T08:30:50Z",
      "updated_at": "2024-05-03T08:30:50Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1588905125",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1588905125"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": 505,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 509,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1616957538",
      "pull_request_review_id": 2082332210,
      "id": 1616957538,
      "node_id": "PRRC_kwDOAP4Jqs5gYNBi",
      "diff_hunk": "@@ -24,6 +24,21 @@ extern \"C\" {\n  * implementation without requiring any further elliptic-curve operations from the wallet.\n  */\n \n+/* This struct serves as an In param for passing the silent payment address data.\n+ * The index field is for when more than one address is being sent to in a transaction. Index is\n+ * set based on the original ordering of the addresses and used to return the generated outputs\n+ * matching the original ordering. When more than one recipient is used the recipient array\n+ * will be sorted in place as part of generating the outputs, but the generated outputs will be\n+ * outputs will be returned original ordering specified by the index to ensure the caller is able",
      "path": "include/secp256k1_silentpayments.h",
      "position": null,
      "original_position": 9,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "ac97828119f39b3fc3f32e00a60e8cc026004306",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit, duplicated \"outputs will be\":\r\n```suggestion\r\n * returned in original ordering specified by the index to ensure the caller is able\r\n```",
      "created_at": "2024-05-28T10:08:36Z",
      "updated_at": "2024-05-28T18:19:37Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1616957538",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1616957538"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 33,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1616958118",
      "pull_request_review_id": 2082332210,
      "id": 1616958118,
      "node_id": "PRRC_kwDOAP4Jqs5gYNKm",
      "diff_hunk": "@@ -24,6 +24,21 @@ extern \"C\" {\n  * implementation without requiring any further elliptic-curve operations from the wallet.\n  */\n \n+/* This struct serves as an In param for passing the silent payment address data.\n+ * The index field is for when more than one address is being sent to in a transaction. Index is\n+ * set based on the original ordering of the addresses and used to return the generated outputs\n+ * matching the original ordering. When more than one recipient is used the recipient array\n+ * will be sorted in place as part of generating the outputs, but the generated outputs will be\n+ * outputs will be returned original ordering specified by the index to ensure the caller is able\n+ * to match up the generated outputs to the correct silent payment address (e.g. to be able to\n+ * assign the correct amounts to the correct generatetd outputs in the final transaction).",
      "path": "include/secp256k1_silentpayments.h",
      "position": null,
      "original_position": 11,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "ac97828119f39b3fc3f32e00a60e8cc026004306",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n * assign the correct amounts to the correct generated outputs in the final transaction).\r\n```",
      "created_at": "2024-05-28T10:08:59Z",
      "updated_at": "2024-05-28T18:19:37Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1616958118",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1616958118"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 35,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1617682290",
      "pull_request_review_id": 2082332210,
      "id": 1617682290,
      "node_id": "PRRC_kwDOAP4Jqs5ga99y",
      "diff_hunk": "@@ -173,4 +173,90 @@ int secp256k1_silentpayments_create_output_pubkey(const secp256k1_context *ctx,\n     return 1;\n }\n \n+int secp256k1_silentpayments_sender_create_outputs(\n+    const secp256k1_context *ctx,\n+    secp256k1_xonly_pubkey **generated_outputs,\n+    const secp256k1_silentpayments_recipient **recipients,\n+    size_t n_recipients,\n+    const unsigned char *outpoint_smallest36,\n+    const secp256k1_keypair * const *taproot_seckeys,\n+    size_t n_taproot_seckeys,\n+    const unsigned char * const *plain_seckeys,\n+    size_t n_plain_seckeys\n+) {\n+    size_t i, k;\n+    secp256k1_scalar a_sum_scalar, addend;\n+    secp256k1_ge A_sum_ge;\n+    secp256k1_gej A_sum_gej;\n+    unsigned char input_hash[32];\n+    unsigned char a_sum[32];\n+    unsigned char shared_secret[33];\n+    secp256k1_silentpayments_recipient last_recipient;\n+\n+    /* Sanity check inputs. */\n+    VERIFY_CHECK(ctx != NULL);\n+    ARG_CHECK(recipients != NULL);",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": 198,
      "original_position": 26,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "50dcc1aeddfc2d522ebe02b9709f8c1c119c6027",
      "in_reply_to_id": 1581992522,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Sorry for the late reply, missed this comment. To my understanding, the differences are: `VERIFY_CHECK`s are not included in production builds (i.e. only done for tests), while `ARG_CHECK`s are always done. The latter call an illegal callback if the check fails, but need a `ctx` object for that, so the `ctx != NULL` condition can't be checked via `ARG_CHECK` (if it failed, `ctx->illegal_callback` would be a null pointer dereference). I don't think there is usually a good reason to do an argument check with `VERIFY_CHECK` though, as users wouldn't notice immediately if they pass something wrong. I guess you saw `VERIFY_CHECK`s for argument checks that are not for public API functions?\r\n\r\nnit: could also add `ARG_CHECK(generated_outputs != NULL)` here",
      "created_at": "2024-05-28T17:43:42Z",
      "updated_at": "2024-05-28T18:19:37Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1617682290",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1617682290"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 198,
      "original_line": 198,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1617695781",
      "pull_request_review_id": 2082332210,
      "id": 1617695781,
      "node_id": "PRRC_kwDOAP4Jqs5gbBQl",
      "diff_hunk": "@@ -37,4 +38,84 @@ int secp256k1_silentpayments_recipient_sort(const secp256k1_context* ctx, const\n     return 1;\n }\n \n+/** Set hash state to the BIP340 tagged hash midstate for \"BIP0352/Inputs\". */\n+static void secp256k1_silentpayments_sha256_init_inputs(secp256k1_sha256* hash) {\n+    secp256k1_sha256_initialize(hash);\n+    hash->s[0] = 0xd4143ffcul;\n+    hash->s[1] = 0x012ea4b5ul;\n+    hash->s[2] = 0x36e21c8ful;\n+    hash->s[3] = 0xf7ec7b54ul;\n+    hash->s[4] = 0x4dd4e2acul;\n+    hash->s[5] = 0x9bcaa0a4ul;\n+    hash->s[6] = 0xe244899bul;\n+    hash->s[7] = 0xcd06903eul;\n+\n+    hash->bytes = 64;\n+}\n+\n+static void secp256k1_silentpayments_calculate_input_hash(unsigned char *input_hash, const unsigned char *outpoint_smallest36, secp256k1_ge *pubkey_sum) {\n+    secp256k1_sha256 hash;\n+    unsigned char pubkey_sum_ser[33];\n+    size_t ser_size;\n+    int ser_ret;\n+\n+    secp256k1_silentpayments_sha256_init_inputs(&hash);\n+    secp256k1_sha256_write(&hash, outpoint_smallest36, 36);\n+    ser_ret = secp256k1_eckey_pubkey_serialize(pubkey_sum, pubkey_sum_ser, &ser_size, 1);\n+    VERIFY_CHECK(ser_ret && ser_size == sizeof(pubkey_sum_ser));\n+    (void)ser_ret;\n+    secp256k1_sha256_write(&hash, pubkey_sum_ser, sizeof(pubkey_sum_ser));\n+    secp256k1_sha256_finalize(&hash, input_hash);\n+}\n+\n+/* secp256k1_ecdh expects a hash function to be passed in or uses its default\n+ * hashing function. We don't want to hash the ECDH result yet (it will be\n+ * hashed later with a counter `k`), so we define a custom function which simply\n+ * returns the pubkey without hashing.\n+ */\n+static int secp256k1_silentpayments_ecdh_return_pubkey(unsigned char *output, const unsigned char *x32, const unsigned char *y32, void *data) {\n+    secp256k1_ge point;\n+    secp256k1_fe x, y;\n+    size_t ser_size;\n+    int ser_ret;\n+\n+    (void)data;\n+    /* Parse point as group element */\n+    if (!secp256k1_fe_set_b32_limit(&x, x32) || !secp256k1_fe_set_b32_limit(&y, y32)) {\n+        return 0;\n+    }\n+    secp256k1_ge_set_xy(&point, &x, &y);\n+\n+    /* Serialize as compressed pubkey */\n+    ser_ret = secp256k1_eckey_pubkey_serialize(&point, output, &ser_size, 1);\n+    VERIFY_CHECK(ser_ret && ser_size == 33);\n+    (void)ser_ret;\n+\n+    return 1;\n+}\n+\n+int secp256k1_silentpayments_create_shared_secret(const secp256k1_context *ctx, unsigned char *shared_secret33, const unsigned char *secret_component, const secp256k1_pubkey *public_component, unsigned char *input_hash) {",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": null,
      "original_position": 68,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "f35ab7daa4aa598923e3e3774c14f97bf1e522c9",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: can be made static, as it's not part of the public API (I was slightly confused as I wondered why the API description isn't added in the same commit, but the API function in a later commit calls this function rather than directly exposing it).",
      "created_at": "2024-05-28T17:56:09Z",
      "updated_at": "2024-05-28T18:19:37Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1617695781",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1617695781"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 98,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1617696482",
      "pull_request_review_id": 2082332210,
      "id": 1617696482,
      "node_id": "PRRC_kwDOAP4Jqs5gbBbi",
      "diff_hunk": "@@ -118,4 +119,54 @@ int secp256k1_silentpayments_create_shared_secret(const secp256k1_context *ctx,\n     return 1;\n }\n \n+/** Set hash state to the BIP340 tagged hash midstate for \"BIP0352/SharedSecret\". */\n+static void secp256k1_silentpayments_sha256_init_sharedsecret(secp256k1_sha256* hash) {\n+    secp256k1_sha256_initialize(hash);\n+    hash->s[0] = 0x88831537ul;\n+    hash->s[1] = 0x5127079bul;\n+    hash->s[2] = 0x69c2137bul;\n+    hash->s[3] = 0xab0303e6ul;\n+    hash->s[4] = 0x98fa21faul;\n+    hash->s[5] = 0x4a888523ul;\n+    hash->s[6] = 0xbd99daabul;\n+    hash->s[7] = 0xf25e5e0aul;\n+\n+    hash->bytes = 64;\n+}\n+\n+static void secp256k1_silentpayments_create_t_k(secp256k1_scalar *t_k_scalar, const unsigned char *shared_secret33, unsigned int k) {\n+    secp256k1_sha256 hash;\n+    unsigned char hash_ser[32];\n+    unsigned char k_serialized[4];\n+\n+    /* Compute t_k = hash(shared_secret || ser_32(k))  [sha256 with tag \"BIP0352/SharedSecret\"] */\n+    secp256k1_silentpayments_sha256_init_sharedsecret(&hash);\n+    secp256k1_sha256_write(&hash, shared_secret33, 33);\n+    secp256k1_write_be32(k_serialized, k);\n+    secp256k1_sha256_write(&hash, k_serialized, sizeof(k_serialized));\n+    secp256k1_sha256_finalize(&hash, hash_ser);\n+    secp256k1_scalar_set_b32(t_k_scalar, hash_ser, NULL);\n+}\n+\n+int secp256k1_silentpayments_create_output_pubkey(const secp256k1_context *ctx, secp256k1_xonly_pubkey *P_output_xonly, const unsigned char *shared_secret33, const secp256k1_pubkey *recipient_spend_pubkey, unsigned int k) {",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": null,
      "original_position": 41,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "a4f35830914cde97de0082e8d695df51e0de1b8b",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: can also be made static",
      "created_at": "2024-05-28T17:56:44Z",
      "updated_at": "2024-05-28T18:19:37Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1617696482",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1617696482"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 151,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1617700300",
      "pull_request_review_id": 2082332210,
      "id": 1617700300,
      "node_id": "PRRC_kwDOAP4Jqs5gbCXM",
      "diff_hunk": "@@ -139,6 +139,139 @@ SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipien\n     const secp256k1_pubkey *label\n ) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4);\n \n+/** Opaque data structure that holds silent payments public input data.\n+ *\n+ *  This structure does not contain secret data. Guaranteed to be 98 bytes in size. It can be safely\n+ *  copied/moved. Created with `secp256k1_silentpayments_public_data_create`. Can be serialized as\n+ *  a compressed public key using `secp256k1_silentpayments_public_data_serialize`. The serialization\n+ *  is intended for sending the public input data to light clients. Light clients can use this\n+ *  serialization with `secp256k1_silentpayments_public_data_parse`.\n+ */\n+typedef struct {\n+    unsigned char data[98];\n+} secp256k1_silentpayments_public_data;\n+\n+/** Compute Silent Payment public data from input public keys and transaction inputs.\n+ *\n+ * Given a list of n public keys A_1...A_n (one for each silent payment\n+ * eligible input to spend) and a serialized outpoint_smallest, compute\n+ * the corresponding input public tweak data:\n+ *\n+ * A_sum = A_1 + A_2 + ... + A_n\n+ * input_hash = hash(outpoint_lowest || A_sum)\n+ *\n+ * The public keys have to be passed in via two different parameter pairs,\n+ * one for regular and one for x-only public keys, in order to avoid the need\n+ * of users converting to a common pubkey format before calling this function.\n+ * The resulting data is can be used for scanning on the recipient side, or stored\n+ * in an index for late use (e.g. wallet rescanning, vending data to light clients).\n+ *\n+ * If calling this function for scanning, the reciever must provide an output param\n+ * for the `input_hash`. If calling this function for simply aggregating the inputs\n+ * for later use, the caller can save the result with `silentpayments_public_data_serialize`.\n+ *\n+ *  Returns: 1 if tweak data creation was successful. 0 if an error occured.\n+ *  Args:                  ctx: pointer to a context object\n+ *  Out:           public_data: pointer to public_data object containing the summed public key and\n+ *                              input_hash.\n+ *  In:    outpoint_smallest36: serialized smallest outpoint\n+ *               xonly_pubkeys: pointer to an array of pointers to taproot x-only\n+ *                              public keys (can be NULL if no taproot inputs are used)\n+ *             n_xonly_pubkeys: the number of taproot input public keys\n+ *               plain_pubkeys: pointer to an array of pointers to non-taproot\n+ *                              public keys (can be NULL if no non-taproot inputs are used)\n+ *             n_plain_pubkeys: the number of non-taproot input public keys\n+ */\n+SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipient_public_data_create(\n+    const secp256k1_context *ctx,\n+    secp256k1_silentpayments_public_data *public_data,\n+    const unsigned char *outpoint_smallest36,\n+    const secp256k1_xonly_pubkey * const *xonly_pubkeys,\n+    size_t n_xonly_pubkeys,\n+    const secp256k1_pubkey * const *plain_pubkeys,\n+    size_t n_plain_pubkeys\n+) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);\n+\n+/** Serialize a silentpayments_public_data object into a 33-byte sequence.\n+ *\n+ *  Returns: 1 always.\n+ *\n+ *  Args:       ctx: pointer to a context object.\n+ *  Out:   output33: pointer to a 33-byte array to place the serialized `silentpayments_public_data` in.\n+ *  In: public_data: pointer to an initialized silentpayments_public_data object.\n+ */\n+SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipient_public_data_serialize(\n+    const secp256k1_context *ctx,\n+    unsigned char *output33,\n+    const secp256k1_silentpayments_public_data *public_data\n+) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);\n+\n+/** Parse a 33-byte sequence into a silent_payments_public_data object.\n+ *\n+ *  Returns: 1 if the data was able to be parsed.\n+ *           0 if the sequence is invalid (e.g. does not represent a valid public key).\n+ *\n+ *  Args:        ctx: pointer to a context object.\n+ *  Out: public_data: pointer to a silentpayments_public_data object. If 1 is returned, it is set to a\n+ *                    parsed version of input33.\n+ *  In:      input33: pointer to a serialized silentpayments_public_data.\n+ */\n+\n+SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipient_public_data_parse(\n+    const secp256k1_context *ctx,\n+    secp256k1_silentpayments_public_data *public_data,\n+    const unsigned char *input33\n+) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);\n+\n+/** Scan for Silent Payment transaction outputs.\n+ *\n+ *  Given a input public sum, an input_hash, a recipient's spend public key B_spend, and the relevant transaction\n+ *  outputs, scan for outputs belong to the recipient and return the tweak(s) needed for spending\n+ *  the output(s). An optional label_lookup callback function and label_context can be passed if the\n+ *  recipient uses labels. This allows for checking if a label exists in the recipients label cache\n+ *  and retrieving the label tweak during scanning.\n+ *\n+ *  Returns: 1 if output scanning was successful. 0 if an error occured.\n+ *  Args:                  ctx: pointer to a context object\n+ *  Out:         found_outputs: pointer to an array of pointers to found output objects. The found outputs\n+ *                              array MUST be initialized to be the same length as the tx_outputs array\n+ *             n_found_outputs: pointer to an integer indicating the final size of the found outputs array.\n+ *                              This number represents the number of outputs found while scanning (0 if\n+ *                              none are found)\n+ *  In:             tx_outputs: pointer to the tx's x-only public key outputs\n+ *                n_tx_outputs: the number of tx_outputs being scanned\n+ *                    scan_key: pointer to the recipient's scan key\n+ *                 public_data: pointer to the input public key sum (optionaly, with the `input_hash`\n+ *                              multiplied in, see `_recipient_compute_public_data`).",
      "path": "include/secp256k1_silentpayments.h",
      "position": null,
      "original_position": 107,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "d43636b96d359b4ba5e7af5c12c7833e116ecc26",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n *                              multiplied in, see `_recipient_public_data_create`).\r\n```",
      "created_at": "2024-05-28T18:00:12Z",
      "updated_at": "2024-05-28T18:19:37Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1617700300",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1617700300"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 245,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1617702291",
      "pull_request_review_id": 2082332210,
      "id": 1617702291,
      "node_id": "PRRC_kwDOAP4Jqs5gbC2T",
      "diff_hunk": "@@ -272,6 +272,58 @@ SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipien\n ) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4)\n     SECP256K1_ARG_NONNULL(6) SECP256K1_ARG_NONNULL(7) SECP256K1_ARG_NONNULL(8);\n \n+/** Create Silent Payment shared secret.\n+ *\n+ * Given the public input data (A_tweaked = input_hash * A_sum), calculate the shared secret using ECDH:\n+ *\n+ * shared_secret = b_scan * A_tweaked   [Recipient, Light client scenario]\n+ *\n+ * The resulting shared secret is needed as input for creating silent payments\n+ * outputs belonging to the same recipient scan public key.\n+ *\n+ *  Returns: 1 if shared secret creation was successful. 0 if an error occured.\n+ *  Args:                  ctx: pointer to a context object\n+ *  Out:       shared_secret33: pointer to the resulting 33-byte shared secret\n+ *  In:     recipient_scan_key: pointer to the recipient's scan key\n+ *                 public_data: pointer to the input public key sum, tweaked with the input_hash\n+ *                              (see `_recipient_compute_public_data`)",
      "path": "include/secp256k1_silentpayments.h",
      "position": null,
      "original_position": 18,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "b58f89117e0765759a2f3c2a3f1782d9c30eb776",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n *                              (see `_recipient_public_data_create`)\r\n```",
      "created_at": "2024-05-28T18:01:56Z",
      "updated_at": "2024-05-28T18:19:37Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1617702291",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1617702291"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 289,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1617706659",
      "pull_request_review_id": 2082332210,
      "id": 1617706659,
      "node_id": "PRRC_kwDOAP4Jqs5gbD6j",
      "diff_hunk": "@@ -179,7 +183,7 @@ int main(int argc, char** argv) {\n     char* valid_args[] = {\"ecdsa\", \"verify\", \"ecdsa_verify\", \"sign\", \"ecdsa_sign\", \"ecdh\", \"recover\",\n                          \"ecdsa_recover\", \"schnorrsig\", \"schnorrsig_verify\", \"schnorrsig_sign\", \"ec\",\n                          \"keygen\", \"ec_keygen\", \"ellswift\", \"encode\", \"ellswift_encode\", \"decode\",\n-                         \"ellswift_decode\", \"ellswift_keygen\", \"ellswift_ecdh\"};\n+                         \"ellswift_decode\", \"ellswift_keygen\", \"ellswift_ecdh\", \"silentpayments\"};",
      "path": "src/bench.c",
      "position": 27,
      "original_position": 16,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "baafed004cdf3580659e0a475b91564efef837fb",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: should also add this on the `help` function on top of the file",
      "created_at": "2024-05-28T18:04:47Z",
      "updated_at": "2024-05-28T18:19:37Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1617706659",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1617706659"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 190,
      "original_line": 190,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1617720108",
      "pull_request_review_id": 2082332210,
      "id": 1617720108,
      "node_id": "PRRC_kwDOAP4Jqs5gbHMs",
      "diff_hunk": "@@ -320,4 +320,109 @@ int secp256k1_silentpayments_recipient_create_labelled_spend_pubkey(const secp25\n     return 1;\n }\n \n+int secp256k1_silentpayments_recipient_public_data_create(\n+    const secp256k1_context *ctx,\n+    secp256k1_silentpayments_public_data *public_data,\n+    const unsigned char *outpoint_smallest36,\n+    const secp256k1_xonly_pubkey * const *xonly_pubkeys,\n+    size_t n_xonly_pubkeys,\n+    const secp256k1_pubkey * const *plain_pubkeys,\n+    size_t n_plain_pubkeys\n+) {\n+    size_t i;\n+    size_t pubkeylen = 65;\n+    secp256k1_pubkey A_sum;\n+    secp256k1_ge A_sum_ge, addend;\n+    secp256k1_gej A_sum_gej;\n+    unsigned char input_hash_local[32];\n+\n+    /* Sanity check inputs */\n+    VERIFY_CHECK(ctx != NULL);\n+    ARG_CHECK(public_data != NULL);\n+    ARG_CHECK(plain_pubkeys == NULL || n_plain_pubkeys >= 1);\n+    ARG_CHECK(xonly_pubkeys == NULL || n_xonly_pubkeys >= 1);\n+    ARG_CHECK((plain_pubkeys != NULL) || (xonly_pubkeys != NULL));\n+    ARG_CHECK((n_plain_pubkeys + n_xonly_pubkeys) >= 1);\n+    ARG_CHECK(outpoint_smallest36 != NULL);\n+    memset(input_hash_local, 0, 32);\n+\n+    /* Compute input public keys sum: A_sum = A_1 + A_2 + ... + A_n */\n+    secp256k1_gej_set_infinity(&A_sum_gej);\n+    for (i = 0; i < n_plain_pubkeys; i++) {\n+        secp256k1_pubkey_load(ctx, &addend, plain_pubkeys[i]);\n+        secp256k1_gej_add_ge_var(&A_sum_gej, &A_sum_gej, &addend, NULL);\n+    }\n+    for (i = 0; i < n_xonly_pubkeys; i++) {\n+        secp256k1_xonly_pubkey_load(ctx, &addend, xonly_pubkeys[i]);\n+        secp256k1_gej_add_ge_var(&A_sum_gej, &A_sum_gej, &addend, NULL);\n+    }\n+    if (secp256k1_gej_is_infinity(&A_sum_gej)) {\n+        /* TODO: do we need a special error return code for this case? */\n+        return 0;\n+    }",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": null,
      "original_position": 43,
      "commit_id": "ac591050262d9d00b629943d598f62b47e1ca7ae",
      "original_commit_id": "d43636b96d359b4ba5e7af5c12c7833e116ecc26",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I'd say the answer to this open TODO question is \"yes\". If a user scans a tx where the silent payments eligible input's public keys cancel each other out, this probably deserves its own return code to differentiate between the cases \"user misuses API / passed in wrong data\" and \"passed in data could be legit, but we can't continue\" (as discussed before in the earlier PR, e.g. https://github.com/bitcoin-core/secp256k1/pull/1471#issuecomment-1913695251). Would be interesting to hear maintainers opinions on API design here; to my knowledge, currently there is no public API functions that returns anything different than 0 or 1. If the successful return value is still 1, having two errors codes would be e.g. 0 and 2, which seems kind of strange.",
      "created_at": "2024-05-28T18:17:35Z",
      "updated_at": "2024-05-28T18:19:37Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1617720108",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1617720108"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": 359,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 372,
      "side": "RIGHT"
    }
  ]
}