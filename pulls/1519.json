{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519",
    "id": 1831748262,
    "node_id": "PR_kwDOAP4Jqs5tLkKm",
    "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519",
    "diff_url": "https://github.com/bitcoin-core/secp256k1/pull/1519.diff",
    "patch_url": "https://github.com/bitcoin-core/secp256k1/pull/1519.patch",
    "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1519",
    "commits_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1519/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin-core/secp256k1/statuses/8b48bf19c3c020e653734f6c9d9364e6a47a30d1",
    "number": 1519,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "Add BIP352 `silentpayments` module",
    "user": {
      "login": "josibake",
      "id": 7444140,
      "node_id": "MDQ6VXNlcjc0NDQxNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/josibake",
      "html_url": "https://github.com/josibake",
      "followers_url": "https://api.github.com/users/josibake/followers",
      "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
      "organizations_url": "https://api.github.com/users/josibake/orgs",
      "repos_url": "https://api.github.com/users/josibake/repos",
      "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/josibake/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Depends on https://github.com/bitcoin-core/secp256k1/pull/1518\r\n\r\n---\r\n\r\nThis PR adds a new Silent Payments ([BIP352](https://github.com/bitcoin/bips/pull/1458)) module to secp256k1. It is a continuation of the work started in https://github.com/bitcoin-core/secp256k1/pull/1471.\r\n\r\nThe module implements the full protocol, except for transaction input filtering and silent payment address encoding / decoding as those will be the responsibility of the wallet software. It is organized with functions for sending (prefixed with `_sender`) and receiving (prefixed by `_recipient`).\r\n\r\n#### For sending\r\n\r\n1. Collect private keys into two lists: `taproot_seckeys` and `plain_seckeys`\r\n    Two lists are used since the `taproot_seckeys` may need negation. `taproot_seckeys` are passed as keypairs to avoid the function needing to compute the public key to determine parity. `plain_seckeys` are passed as just secret keys\r\n2. Create the `_silentpayment_recipient` objects\r\n    These structs hold the scan and spend public key and an index for remembering the original ordering. It is expected that a caller will start with a list of silent payment addresses (with the desired amounts), convert these into an array of `recipients` and then match the generated outputs back to the original silent payment addresses. The index is used to return the generated outputs in the original order\r\n3. Call `silentpayments_sender_create_outputs` to generate the xonly public keys for the recipients\r\n    This function can be called with one or more recipients. The same recipient may be repeated to generate multiple outputs for the same recipient\r\n    \r\n#### For scanning\r\n\r\n1. Collect the public keys into two lists `taproot_pubkeys` and `plain_pubeys`\r\n    This avoids the caller needing to convert taproot public keys into compressed public keys (and vice versa)\r\n2. Compute the input data needed, i.e. sum the public keys and compute the `input_hash`\r\n    This is done as a separate step to allow the caller to reuse this output if scanning for multiple scan keys. It also allows a caller to use this function for aggregating the transaction inputs and storing them in an index to vend to light clients later (or for faster rescans when recovering a wallet)\r\n4. Call `silentpayments_recipient_scan_outputs` to scan the transaction outputs and return the tweak data (and optionally label information) needed for spending later\r\n\r\nIn addition, a few utility functions for labels are provided for the recipient for creating a label tweak and tweaked spend public key for their address. Finally, two functions are exposed in the API for supporting light clients, `_recipient_created_shared_secret` and `_recipient_create_output_pubkey`. These functions enable incremental scanning for scenarios where the caller does not have access to the transaction outputs:\r\n\r\n1. Calculating a shared secret\r\n    This is done as a separate step to allow the caller to reuse the shared secret result when creating outputs and avoid needing to do a costly ECDH every time they need to check for an additional output\r\n3. Generate an output (with `k = 0`)\r\n5. Check if the output exists in the UTXO set (using their preferred light client protocol)\r\n6. If the output exists, proceed by generating a new output from the shared secret with `k++`\r\n\r\nSee `examples/silentpayments.c` for a demonstration of how the API is expected to be used.\r\n\r\n### Note for reviewers\r\n\r\nMy immediate goal is to get feedback on the API so that I can pull this module into https://github.com/bitcoin/bitcoin/pull/28122 (silent payments in the bitcoin core wallet). That unblocks from finishing the bitcoin core PRs while work continues on this module.\r\n\r\n#### Notable differences between this PR and the previous version\r\n\r\nSee https://github.com/bitcoin-core/secp256k1/issues/1427 and https://github.com/bitcoin-core/secp256k1/pull/1471 for discussions on the API design. This iteration of the module attempts to be much more high level and incorporate the feedback from #1471. I also added a `secp256k1_silentpayments_public_data` opaque data type, which contains the summed public key and the input_hash. My motivation here was:\r\n\r\n1. I caught myself mixing up the order of arguments between `A_sum` and `recipient_spend_key`, which was impossible to catch with `ARG_CHECKS` and would result in the scanning process finishing without errors, but not finding any outputs\r\n2. Combining public key and input_hash into the same data type allows for completely hiding `input_hash` from the caller, which makes for an overall simpler API IMO\r\n\r\nI also removed the need for the recipient to generate a shared secret before using the `secp256k1_silentpayments_recipient_scan_outputs` function and instead create the shared secret inside the function.\r\n\r\n### Outstanding work\r\n\r\n- [ ] clean up the testing code\r\n- [ ] improve test coverage (currently only using the BIP352 test vectors)\r\n- [ ] optimize the implementation, where possible",
    "labels": [
      {
        "id": 4975353639,
        "node_id": "LA_kwDOAP4Jqs8AAAABKI3fJw",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/labels/feature",
        "name": "feature",
        "description": "",
        "color": "731E95",
        "default": false
      }
    ],
    "created_at": "2024-04-19T14:21:15Z",
    "updated_at": "2024-04-24T08:59:58Z",
    "mergeable": true,
    "mergeable_state": "blocked",
    "merge_commit_sha": "2cde03433434d7d0b8899d624f65c4cd2dfd6d02",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "josibake:bip352-silentpayments-module",
      "ref": "bip352-silentpayments-module",
      "sha": "8b48bf19c3c020e653734f6c9d9364e6a47a30d1",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 751433786,
        "node_id": "R_kgDOLMn4Og",
        "name": "secp256k1",
        "full_name": "josibake/secp256k1",
        "owner": {
          "login": "josibake",
          "id": 7444140,
          "node_id": "MDQ6VXNlcjc0NDQxNDA=",
          "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/josibake",
          "html_url": "https://github.com/josibake",
          "followers_url": "https://api.github.com/users/josibake/followers",
          "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
          "organizations_url": "https://api.github.com/users/josibake/orgs",
          "repos_url": "https://api.github.com/users/josibake/repos",
          "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/josibake/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/josibake/secp256k1",
        "description": "Optimized C library for EC operations on curve secp256k1",
        "fork": true,
        "url": "https://api.github.com/repos/josibake/secp256k1",
        "archive_url": "https://api.github.com/repos/josibake/secp256k1/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/josibake/secp256k1/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/josibake/secp256k1/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/josibake/secp256k1/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/josibake/secp256k1/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/josibake/secp256k1/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/josibake/secp256k1/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/josibake/secp256k1/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/josibake/secp256k1/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/josibake/secp256k1/contributors",
        "deployments_url": "https://api.github.com/repos/josibake/secp256k1/deployments",
        "downloads_url": "https://api.github.com/repos/josibake/secp256k1/downloads",
        "events_url": "https://api.github.com/repos/josibake/secp256k1/events",
        "forks_url": "https://api.github.com/repos/josibake/secp256k1/forks",
        "git_commits_url": "https://api.github.com/repos/josibake/secp256k1/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/josibake/secp256k1/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/josibake/secp256k1/git/tags%7B/sha%7D",
        "git_url": "git://github.com/josibake/secp256k1.git",
        "issue_comment_url": "https://api.github.com/repos/josibake/secp256k1/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/josibake/secp256k1/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/josibake/secp256k1/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/josibake/secp256k1/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/josibake/secp256k1/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/josibake/secp256k1/languages",
        "merges_url": "https://api.github.com/repos/josibake/secp256k1/merges",
        "milestones_url": "https://api.github.com/repos/josibake/secp256k1/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/josibake/secp256k1/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/josibake/secp256k1/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/josibake/secp256k1/releases%7B/id%7D",
        "ssh_url": "git@github.com:josibake/secp256k1.git",
        "stargazers_url": "https://api.github.com/repos/josibake/secp256k1/stargazers",
        "statuses_url": "https://api.github.com/repos/josibake/secp256k1/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/josibake/secp256k1/subscribers",
        "subscription_url": "https://api.github.com/repos/josibake/secp256k1/subscription",
        "tags_url": "https://api.github.com/repos/josibake/secp256k1/tags",
        "teams_url": "https://api.github.com/repos/josibake/secp256k1/teams",
        "trees_url": "https://api.github.com/repos/josibake/secp256k1/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/josibake/secp256k1.git",
        "hooks_url": "https://api.github.com/repos/josibake/secp256k1/hooks",
        "svn_url": "https://github.com/josibake/secp256k1",
        "language": "C",
        "forks_count": 1,
        "stargazers_count": 0,
        "watchers_count": 0,
        "size": 11099,
        "default_branch": "master",
        "open_issues_count": 1,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-04-24T08:38:19Z",
        "created_at": "2024-02-01T15:52:50Z",
        "updated_at": "2024-04-23T11:56:32Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin-core:master",
      "ref": "master",
      "sha": "da515074e3ebc8abc85a4fff3a31d7694ecf897b",
      "user": {
        "login": "bitcoin-core",
        "id": 13464320,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEzNDY0MzIw",
        "avatar_url": "https://avatars.githubusercontent.com/u/13464320?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin-core",
        "html_url": "https://github.com/bitcoin-core",
        "followers_url": "https://api.github.com/users/bitcoin-core/followers",
        "following_url": "https://api.github.com/users/bitcoin-core/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin-core/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin-core/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin-core/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin-core/orgs",
        "repos_url": "https://api.github.com/users/bitcoin-core/repos",
        "events_url": "https://api.github.com/users/bitcoin-core/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin-core/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 16648618,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNjY0ODYxOA==",
        "name": "secp256k1",
        "full_name": "bitcoin-core/secp256k1",
        "owner": {
          "login": "bitcoin-core",
          "id": 13464320,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjEzNDY0MzIw",
          "avatar_url": "https://avatars.githubusercontent.com/u/13464320?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin-core",
          "html_url": "https://github.com/bitcoin-core",
          "followers_url": "https://api.github.com/users/bitcoin-core/followers",
          "following_url": "https://api.github.com/users/bitcoin-core/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin-core/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin-core/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin-core/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin-core/orgs",
          "repos_url": "https://api.github.com/users/bitcoin-core/repos",
          "events_url": "https://api.github.com/users/bitcoin-core/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin-core/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin-core/secp256k1",
        "description": "Optimized C library for EC operations on curve secp256k1",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1",
        "archive_url": "https://api.github.com/repos/bitcoin-core/secp256k1/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin-core/secp256k1/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin-core/secp256k1/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin-core/secp256k1/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin-core/secp256k1/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin-core/secp256k1/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin-core/secp256k1/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin-core/secp256k1/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin-core/secp256k1/downloads",
        "events_url": "https://api.github.com/repos/bitcoin-core/secp256k1/events",
        "forks_url": "https://api.github.com/repos/bitcoin-core/secp256k1/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin-core/secp256k1.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin-core/secp256k1/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin-core/secp256k1/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin-core/secp256k1/languages",
        "merges_url": "https://api.github.com/repos/bitcoin-core/secp256k1/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin-core/secp256k1/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin-core/secp256k1/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin-core/secp256k1/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin-core/secp256k1.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin-core/secp256k1/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin-core/secp256k1/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin-core/secp256k1/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin-core/secp256k1/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin-core/secp256k1/tags",
        "teams_url": "https://api.github.com/repos/bitcoin-core/secp256k1/teams",
        "trees_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin-core/secp256k1.git",
        "hooks_url": "https://api.github.com/repos/bitcoin-core/secp256k1/hooks",
        "svn_url": "https://github.com/bitcoin-core/secp256k1",
        "language": "C",
        "forks_count": 958,
        "stargazers_count": 1961,
        "watchers_count": 1961,
        "size": 10880,
        "default_branch": "master",
        "open_issues_count": 137,
        "is_template": false,
        "topics": [],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2024-04-24T08:38:21Z",
        "created_at": "2014-02-08T17:30:06Z",
        "updated_at": "2024-04-22T15:17:49Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 6318,
    "deletions": 11,
    "changed_files": 22,
    "commits": 14,
    "review_comments": 11,
    "comments": 1
  },
  "events": [
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-19T14:25:06Z",
      "updated_at": "2024-04-19T14:25:06Z",
      "source": {
        "issue": {
          "id": 2054852916,
          "node_id": "PR_kwDOAP4Jqs5is1PD",
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1471",
          "repository_url": "https://api.github.com/repos/bitcoin-core/secp256k1",
          "labels_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1471/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1471/comments",
          "events_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1471/events",
          "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1471",
          "number": 1471,
          "state": "closed",
          "state_reason": null,
          "title": "Add silentpayments (BIP352) module",
          "body": "This PR adds a new Silent Payments ([BIP352](https://github.com/bitcoin/bips/pull/1458)) module to secp256k1. The following routines are provided ($a_i$ are input private keys, $A_i$ are input public keys, $b$ and $B$ denote recipient privkeys/pubkeys that would be encoded in silent payment addresses, $d$ and $P$ the keypair for the actual transaction taproot x-only output):\r\n\r\n| Side     | Function                        | Inputs                           | Outputs                                                                   |\r\n|----------|---------------------------------|----------------------------------|---------------------------------------------------------------------------|\r\n|  Sender  | `_create_private_tweak_data`    | $a_1...a_n$, $outpoint_L$        | $a_{sum} = (a_1 + a_2 + ... + a_n)$<br>$inputhash =  hash_I(outpoint_L \\|\\| (a_{sum} * G))$ |\r\n| Receiver | `_create_public_tweak_data`     | $A_1...A_n$, $outpoint_L$        | $A_{sum} = (A_1 + A_2 + ... + A_n)$<br>$inputhash = hash_I(outpoint_L \\|\\| A_{sum})$ |\r\n| Receiver | `_create_tweaked_pubkey`       |  $A_{sum}, inputhash$       |  $A_{tweaked} = inputhash * A_{sum}$\r\n|  Both  | `_create_shared_secret`    | $Pub$, $sec$<br>(Sender: $B_{scan}, a_{sum}$<br>Receiver: $A_{sum}, b_{scan}$<br>Lightclient: $A_{tweaked}, b_{scan}$)        | $SS = (inputhash * sec) * Pub$ (ECDH)                                      |\r\n| Receiver | `_create_label_tweak`           | $b_{scan}, m$                    | $labeltweak = hash_L(b_{scan} \\|\\| m)$<br>$label = labeltweak * G$                                    |\r\n| Receiver | `_create_address_spend_pubkey`  | $B_{spend}, label$          | $B_m = B_{spend} + label$                                        |\r\n| Sender   | `_sender_create_output_pubkey`         | $SS, B_m, k$ | $P_{xonly} = B_m + hash_S(SS \\|\\| k) * G$        |\r\n| Receiver | `_receiver_scan_output`               | $SS, B_m, k, tx_{output}$        | $t_k = hash_S(SS \\|\\| k)$<br>$P_{xonly} = B_m + t_k * G$  [not returned]<br>$directmatch = P_{xonly} == tx_{output}$<br>if $directmatch == 0$:<br>$\\quad label1 = tx_{output} - P$<br>$\\quad label2 = -tx_{output} - P$\r\n| Receiver | `_create_output_seckey`         | $b_{spend}, t_k, (labeltweak)$ | $d = (b_{spend} + labeltweak) + t_k$                        |\r\n\r\nwhere\r\n* $hash_I$ denotes a SHA256 tagged hash with tag \"BIP0352/Inputs\"\r\n* $hash_L$ denotes a SHA256 tagged hash with tag \"BIP0352/Label\"\r\n* $hash_S$ denotes a SHA256 tagged hash with tag \"BIP0352/SharedSecret\"\r\n\r\nFor ending up with output key material used for sending to / scanning for / spending from, both sides would follow the chain of `tweak_data -> shared_secret -> output key`. The public tweak data can be useful for faster scanning of output transactions by storing them in an index, see e.g. Bitcoin Core PR https://github.com/bitcoin/bitcoin/pull/28241. Private tweak data is arguably less useful, so in theory one could collapse the tweak data and shared secret creation functions into a single one, but IMHO it's nicer if the API is symmetric.\r\n\r\nAs discussed in https://github.com/bitcoin-core/secp256k1/issues/1427#issuecomment-1757675172, the approach of passing in two separate key pairs for taproot and non-taproot inputs is followed here. This may seem a bit confusing at first, but has the advantage that the caller doesn't have to deal with enforcing even y-parity for key material manually (e.g. negating private keys of taproot outputs if they would end up in an odd point), which seems error-prone.\r\n\r\nThe last commit contains the BIP352 test vectors, converted to C code with a Python script. An earlier version of the tests, directly written in Python (by calling in to the secp256k1 shared library using ctypes) can still be found here: https://github.com/theStack/secp256k1/tree/silentpayments-module-demo_old5",
          "user": {
            "login": "theStack",
            "id": 91535,
            "node_id": "MDQ6VXNlcjkxNTM1",
            "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/theStack",
            "html_url": "https://github.com/theStack",
            "followers_url": "https://api.github.com/users/theStack/followers",
            "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
            "organizations_url": "https://api.github.com/users/theStack/orgs",
            "repos_url": "https://api.github.com/users/theStack/repos",
            "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/theStack/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 4975353639,
              "node_id": "LA_kwDOAP4Jqs8AAAABKI3fJw",
              "url": "https://api.github.com/repos/bitcoin-core/secp256k1/labels/feature",
              "name": "feature",
              "description": "",
              "color": "731E95",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 44,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1471",
            "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1471",
            "diff_url": "https://github.com/bitcoin-core/secp256k1/pull/1471.diff",
            "patch_url": "https://github.com/bitcoin-core/secp256k1/pull/1471.patch"
          },
          "closed_at": "2024-04-19T16:17:41Z",
          "created_at": "2023-12-23T17:39:21Z",
          "updated_at": "2024-04-19T16:17:41Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "labeled",
      "id": 12541859026,
      "node_id": "LE_lADOAP4Jqs6GTERUzwAAAALrjZTS",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/12541859026",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-19T16:18:02Z",
      "label": {
        "name": "feature",
        "color": "731E95"
      }
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKGI3NjRjYTg0Zjk4Y2VlNjMxNGIwZjU4OTEwNTFjODdjMWUzM2M4MmM",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/b764ca84f98cee6314b0f5891051c87c1e33c82c",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/b764ca84f98cee6314b0f5891051c87c1e33c82c",
      "tree": {
        "sha": "3be5530a77efe712582520eaf740c51f2c61ff79",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/3be5530a77efe712582520eaf740c51f2c61ff79"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 3be5530a77efe712582520eaf740c51f2c61ff79\nparent da515074e3ebc8abc85a4fff3a31d7694ecf897b\nauthor Jonas Nick <jonasd.nick@gmail.com> 1713375231 +0000\ncommitter Jonas Nick <jonasd.nick@gmail.com> 1713799346 +0000\n\nAdd secp256k1_pubkey_sort\n\nCo-authored-by: Tim Ruffing <crypto@timruffing.de>\nCo-authored-by: Russell O'Connor <roconnor@blockstream.io>\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEES7uEWm9aZaad+uwjSGHb8mISNgUFAmYmgLQACgkQSGHb8mIS\nNgUKJg//a+yRprEqQK2synmG8XpB7bQT0DfIW0tCd9a1Ld61PsbffwvLhsHhEtOZ\n6Y2C7XzAPKqwaNv7dGN2sfu+1LJjP8McwbQHzyAbbFhP/JGx1oL55gm7wdohsdUT\n05O7Z6SY89ZruMCFQnbhX+wNzzqT0dqUpxxYJgGtwquwFJFWHlKX7+DeiuN0jalU\nfO6QeO3H01WltoujpbJvdAx0xmJ0xDR7ZEndkvH8zA+3UdZ6aH/6iCxO0fk7wkXD\n124MxkmL9vC3QjtWf++ifnk14iJee3EuA5v1V1u2v6gdK0NSK5dMLSzN6o49MsLL\nkn3Zhf1xVx/rcxqE7pM3JDvBh3Nr11KiaSldDx8yaslMgLFlBxh31FjKth82M3I8\ntfCESrwKg7jKRq/MiXS/APSQ5GZZLBb5mx5MyvcA2P4ugxJE7tAUsoShS9zfZpz0\nCmthFBZOYCOi8fSsR04TdQ3tD7b/T//SK+JsrrZPAwm+z81wxkUHa1JgRJUf1Lcr\nNzAEAU3YW69LVaWIDAIbNP32GC9/UU9hDiz+gKUUM09gp3A7+yqg6dNlDCXDq7j3\n1sxScAzDpGo7vywRnq48dKtVi00qYwKAr+roIxma8rEFltYD84sL2qBuiyhAi3yB\nbNbCsBSBYlMK4cJO3XIors4ZnpKzFD9g9eUGl6h65yAh6Uyd9Jc=\n=8qeg\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/da515074e3ebc8abc85a4fff3a31d7694ecf897b",
          "sha": "da515074e3ebc8abc85a4fff3a31d7694ecf897b",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/da515074e3ebc8abc85a4fff3a31d7694ecf897b"
        }
      ],
      "message": "Add secp256k1_pubkey_sort\n\nCo-authored-by: Tim Ruffing <crypto@timruffing.de>\nCo-authored-by: Russell O'Connor <roconnor@blockstream.io>",
      "committer": {
        "name": "Jonas Nick",
        "email": "jonasd.nick@gmail.com",
        "date": "2024-04-22T15:22:26Z"
      },
      "author": {
        "name": "Jonas Nick",
        "email": "jonasd.nick@gmail.com",
        "date": "2024-04-17T17:33:51Z"
      },
      "sha": "b764ca84f98cee6314b0f5891051c87c1e33c82c"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-22T16:09:36Z",
      "updated_at": "2024-04-22T16:09:36Z",
      "source": {
        "issue": {
          "id": 1913356976,
          "node_id": "I_kwDOABII585yC4Kw",
          "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28536",
          "repository_url": "https://api.github.com/repos/bitcoin/bitcoin",
          "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28536/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28536/comments",
          "events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/28536/events",
          "html_url": "https://github.com/bitcoin/bitcoin/issues/28536",
          "number": 28536,
          "state": "open",
          "state_reason": null,
          "title": "BIP352 tracking issue",
          "body": "This issue will be updated to reflect the current state of [BIP352](https://github.com/bitcoin/bips/pull/1458) integration.\r\n\r\nPRs ready for review:\r\n\r\n* https://github.com/bitcoin/bips/pull/1458\r\n* https://github.com/bitcoin-core/secp256k1/pull/1519\r\n* https://github.com/bitcoin/bitcoin/pull/28122\r\n\r\nTesting:\r\n* For a wallet with send and receive support, compile https://github.com/bitcoin/bitcoin/pull/28453\r\n* Post your signet / testnet silent payment address in the comments!\r\n\r\nOverall plan:\r\n\r\n* Send and receive support in the Bitcoin Core wallet:\r\n  - [x] Code cleanup / refactor: https://github.com/bitcoin/bitcoin/pull/28244\r\n  - [x] Dependency: https://github.com/bitcoin/bitcoin/pull/28246\r\n  - [x] Dependency: https://github.com/bitcoin/bitcoin/pull/25273\r\n  - [x] Dependency: https://github.com/bitcoin/bitcoin/pull/28560\r\n  - [ ] Implement silent payments as a `libsecp` module: https://github.com/bitcoin-core/secp256k1/pull/1519\r\n  - [ ] Base protocol: https://github.com/bitcoin/bitcoin/pull/28122\r\n  - [ ] Sending (depends on 28122, 25273, 28560): https://github.com/bitcoin/bitcoin/pull/28201\r\n  - [ ] Receiving (depends on 28122, 28201): https://github.com/bitcoin/bitcoin/pull/28453\r\n  - [ ] Send and receive functional tests (depends on 28453) (not started)\r\n\r\n* Light client support:\r\n  - [ ] Index for silent payment tweaks (depends on 28122): https://github.com/bitcoin/bitcoin/pull/28241\r\n  - [ ] New BIP157 filter type for tweak data (not started)\r\n  - [ ] Serve new filter type (not started)\r\n\r\n<details>\r\n  <summary>Older stuff</summary>\r\n\r\n\r\n  <ul>\r\n  <li>Closed / Superseded:\r\n     <ul>\r\n     <li>Tracking PR (superseded by this issue): #27827</li>\r\n     <li>Receiving (superseded by 28453): #28202</li>\r\n      <li>Original draft implementation: #24897</li>\r\n     <li>Original libsecp256k1 module (superseded by 1519): bitcoin-core/secp256k1/pull/1471\r\n      </ul>\r\n  </li>\r\n  </ul>\r\n</details>\r\n",
          "user": {
            "login": "josibake",
            "id": 7444140,
            "node_id": "MDQ6VXNlcjc0NDQxNDA=",
            "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/josibake",
            "html_url": "https://github.com/josibake",
            "followers_url": "https://api.github.com/users/josibake/followers",
            "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
            "organizations_url": "https://api.github.com/users/josibake/orgs",
            "repos_url": "https://api.github.com/users/josibake/repos",
            "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/josibake/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 64583,
              "node_id": "MDU6TGFiZWw2NDU4Mw==",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Feature",
              "name": "Feature",
              "color": "7cf575",
              "default": false
            },
            {
              "id": 149424,
              "node_id": "MDU6TGFiZWwxNDk0MjQ=",
              "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet",
              "name": "Wallet",
              "color": "08a781",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "MEMBER",
          "locked": false,
          "comments": 5,
          "created_at": "2023-09-26T11:59:59Z",
          "updated_at": "2024-04-22T16:10:22Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "reviewed",
      "id": 2015096769,
      "node_id": "PRR_kwDOAP4Jqs54G-_B",
      "url": null,
      "actor": null,
      "commit_id": "3d080277895655e8274ee73aacd154c4ead143e3",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK\r\n\r\nLeft some initial feedback, especially around the scanning routine, will do an in-depth review round soon. Didn't look closer at the `public_data` type routines and the examples yet.",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#pullrequestreview-2015096769",
      "submitted_at": "2024-04-22T16:26:35Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDQxMmIyMGQwNjZiZDZiZWY1ZDU3ZWQxYWMwNTljYTJjYjE5MDc4NDI",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/412b20d066bd6bef5d57ed1ac059ca2cb1907842",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/412b20d066bd6bef5d57ed1ac059ca2cb1907842",
      "tree": {
        "sha": "d74a298e53349231f90be42769e0b09ed2c640b5",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/d74a298e53349231f90be42769e0b09ed2c640b5"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree d74a298e53349231f90be42769e0b09ed2c640b5\nparent b764ca84f98cee6314b0f5891051c87c1e33c82c\nauthor Sebastian Falbesoner <sebastian.falbesoner@gmail.com> 1695828134 +0200\ncommitter josibake <josibake@protonmail.com> 1713946020 +0200\n\nbuild: add skeleton for new silentpayments (BIP352) module\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmYovaQACgkQity1WMTz\nPWX48w//Q1ZcWXerO0XhMyqB5UW6A5xs5sZh63din2NtKxSEU0uXiBHXuqQcVWuF\nRFJX/GHrB9LEStL+ViVD0GsFDHj/E0DwPaqV16OnnhVjwMbekyy/ahS9R6ItqLDz\n5ZIx7YqXzUzwzLCnKcNV9A9ZduDXz4L7+tnuQT1LhPPhghRdGiodIdQqyY7dDCPt\nMkCWdF3XZpPE0Zoiz92DKRchiaDwNYbELaYPmAqLvxu7NxTaJfLBt+W5gTyEJ3Z6\nkR2IR7uWkl9gyaL8XNTtEKRWYPrLaEhdLGMlp5Tes8fDZDXq9tEqaznjXTPbQ+bW\nw45DAqhi/5tWjYtwV1XG+5q7bTz9Z5YCRr5M2WmyocLsURT+VfQrq8HKZaOP1U20\ndcXFycMCaGG+Ew1lqQG3xcRX8B/qrZ7r5M8Gp7nw0SPCNI2h/l9lwp7DW7AKlyJm\n+svsSh9oy/9G5v6+7eRHaAUPj8+tsdjYOClvtnLpBd8ZA8qKLi2jSUndxkG7TeoP\ngAQghbzYdazrCKRehF0Kzq77tmogQOz4z3LxwAZqr7nKo6uBnDr0M0F2sgcH3YFn\nxAjGr7h4sVUquy16AhsYP04cUteQkG2uWaHF6zo4rcag4aZ3rgR6Z/v3YISpSJ0D\n9Ymnzh9k22RCzDUllNSNCOTQzKrknyZXZuI4NsVtZwLOzBv07fg=\n=u+5b\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/b764ca84f98cee6314b0f5891051c87c1e33c82c",
          "sha": "b764ca84f98cee6314b0f5891051c87c1e33c82c",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/b764ca84f98cee6314b0f5891051c87c1e33c82c"
        }
      ],
      "message": "build: add skeleton for new silentpayments (BIP352) module",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-04-24T08:07:00Z"
      },
      "author": {
        "name": "Sebastian Falbesoner",
        "email": "sebastian.falbesoner@gmail.com",
        "date": "2023-09-27T15:22:14Z"
      },
      "sha": "412b20d066bd6bef5d57ed1ac059ca2cb1907842"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDgwNzNhMTNmZDY2NzEwNDA4YTZkNjYyNTAwN2JmMjRjZTQ5M2QyYzM",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/8073a13fd66710408a6d6625007bf24ce493d2c3",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/8073a13fd66710408a6d6625007bf24ce493d2c3",
      "tree": {
        "sha": "4d9dce3624817bf027ebfb721c17240a68c1bca2",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/4d9dce3624817bf027ebfb721c17240a68c1bca2"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 4d9dce3624817bf027ebfb721c17240a68c1bca2\nparent 412b20d066bd6bef5d57ed1ac059ca2cb1907842\nauthor Sebastian Falbesoner <sebastian.falbesoner@gmail.com> 1703345298 +0100\ncommitter josibake <josibake@protonmail.com> 1713946025 +0200\n\ndoc: add module description for silentpayments\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmYovakACgkQity1WMTz\nPWUVfw/9Ffp73+NrR6TOld3Mo2oGU68YS+0ivMzZ7IWsaexlDMx2kZp/QOv1za0O\n5PosPzJMNpphzSuoQa72MdWpA7P1cNTEkRUOGoeqZbG8Aqdc9OSLRfkpY/8s3IkH\ncJO8sviiUyeLVrZPgHJI5hi43pNZnjaAUW72QjdzunQ13gPVh3tIav7ZUztlMNMm\nFPOgC1+rxd/IixN9zNodskyiSUDX3n4lSUFC+lEHtVViZU9IoNlQ+y9X8mxEi0Fd\neS3PNR5toNje1F/vzyLE0OBpYxzG4Lg3q2a1aIhemIB8ViSB3AshtfEKUHgB8X75\nyqqcJnqAzOEEKCMW2iFTSqfihTqh8DM3QZfDJHtLKBNfsBdxS4AztAZLt/10aWeA\nxlm10pkD0TGIX2rKW1rswPZXP+iXwrdjcWTqfawdQLDpLS4AHXa5hNKWV1+0M6hu\nP16T2Ek1+xuFRUZKdHch9JT9Ursexq9YjGSVQTn5zv3Sk8BEQzMkFxjIrIr8ldH0\ns4+VZ3SShlx3PqJ/2uukdZ7Hu2RBo4GBJx3LEccvV7uTDIWavQDVH+w8iHu8ar0u\nNuMnqfu6xPkNuuuK3PKbSgYTtafAEe6U1ZZCFuZCHxFyYmMdMJsJ5UFN7vSQYwW+\nkSGUYuxujrG5IRefWr/TQMGtqUUHuPIvp49AJsNf/+K3mxjbWkI=\n=UDgl\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/412b20d066bd6bef5d57ed1ac059ca2cb1907842",
          "sha": "412b20d066bd6bef5d57ed1ac059ca2cb1907842",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/412b20d066bd6bef5d57ed1ac059ca2cb1907842"
        }
      ],
      "message": "doc: add module description for silentpayments",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-04-24T08:07:05Z"
      },
      "author": {
        "name": "Sebastian Falbesoner",
        "email": "sebastian.falbesoner@gmail.com",
        "date": "2023-12-23T15:28:18Z"
      },
      "sha": "8073a13fd66710408a6d6625007bf24ce493d2c3"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDYyYjZjZDAxOWViMmM4ZmFkOGUxMjc1ZDYwZWQ2MzY5ZjgzYjRhYjU",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/62b6cd019eb2c8fad8e1275d60ed6369f83b4ab5",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/62b6cd019eb2c8fad8e1275d60ed6369f83b4ab5",
      "tree": {
        "sha": "e25fcaa88ecb117d013b162c00555e062e180d0b",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/e25fcaa88ecb117d013b162c00555e062e180d0b"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree e25fcaa88ecb117d013b162c00555e062e180d0b\nparent 8073a13fd66710408a6d6625007bf24ce493d2c3\nauthor josibake <josibake@protonmail.com> 1711383817 +0100\ncommitter josibake <josibake@protonmail.com> 1713946025 +0200\n\nsilentpayments: add sortable recipient struct\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmYovakACgkQity1WMTz\nPWVZ3hAAxxw/ZP1guBClLM7WDXZRLChESnL8JCcj4Uzop1MFmvwhGZK5KTBMuDIf\nlEAo6YFgUtuwUmthZWNQXm2fG2TEilF1pcvWHHNW+7xjE0fDS9NRFFjMqwnVxXmQ\ncShxj/CmGWS+bgHXSvb6OeZE4IV4aqBSYJSihT3B6ZEqNWbCY1jJBzdldcFDyLpm\n2diyUZmigTg7XW+fgfQOLUZ6due/ewNSEdFjfGHJ/R/ammvi3M5EjdN74P6PGTIu\nzBrLxIYCDOXZWAleyuVJZhQNIFKM/W3eyAGec6auMXTSkFMk0M2XLFXyoiiHfFC5\n4Sn8rHF07WAHN+AQeXXe9YenAvnNnlTykxI62ZkyJ4Hf+TfXmZiW4Cp/Dg1lgT8I\nu33xB//pS1mqgkhN4KRNFcAX8T2gk8RuP6/VdfAU4aMe+O4NrEy9Q4Y6qG2k8vrt\nTibuBuxEFQOgQvw4pHDf9YW0feI9z2S684TIl8Tj5XMtDoX/QERwi5rJ302oUb48\nO3njeNF5I+YvSZ006D9yYp1iRBqRzxrzGykrlPIbnj1XueAlGYvf9ZU7aHmNetr+\nQZkmkjAgM1XdXN6qNuoeBi80V2t4UXFKD9r3rvZ1jaQeSzI/4kGQqF/+r/hnABKE\nAlERDSyb8iQ7p1DO6rcuoamNMly35irfVLl7HE6QXFhk+shkTt4=\n=TwRv\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/8073a13fd66710408a6d6625007bf24ce493d2c3",
          "sha": "8073a13fd66710408a6d6625007bf24ce493d2c3",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/8073a13fd66710408a6d6625007bf24ce493d2c3"
        }
      ],
      "message": "silentpayments: add sortable recipient struct",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-04-24T08:07:05Z"
      },
      "author": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-03-25T16:23:37Z"
      },
      "sha": "62b6cd019eb2c8fad8e1275d60ed6369f83b4ab5"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDM5YzA5MzkwMjMwODU2ZmExMjczOTcyMjFlYzllZDI4YTA1MWI1N2Q",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/39c09390230856fa127397221ec9ed28a051b57d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/39c09390230856fa127397221ec9ed28a051b57d",
      "tree": {
        "sha": "e3afd58c2f9211099deddb7f855e30461f04c097",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/e3afd58c2f9211099deddb7f855e30461f04c097"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree e3afd58c2f9211099deddb7f855e30461f04c097\nparent 62b6cd019eb2c8fad8e1275d60ed6369f83b4ab5\nauthor Sebastian Falbesoner <sebastian.falbesoner@gmail.com> 1696468440 +0200\ncommitter josibake <josibake@protonmail.com> 1713946026 +0200\n\nsilentpayments: implement shared secret creation\n\nAdd function for calculating either a*B or A*b. This function is used by both\nthe sender and the recipient (i.e. a*B == A*b).\n\nAdd functions for generating the tagged input hash, as this is used when\ncreating the shared secret.\n\nIn a later commit, `create_shared_secret` will be exposed in the API for\nthe receiver to use when scanning as a light client.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmYovaoACgkQity1WMTz\nPWVCnBAAsnBTgTKpknmrIfgFDR1DxTz0Rfdra2RDHZCJgw9gqEMfEz0yxhM1nsMe\nhMpBSL4CLHuR2K2HXdbc8on7eZ/6ywBo2WUTjv/Wj/Z8HupnrVv7gmg/W2Tio/a5\nK1rzSFeVo0MMexQHV4nuiP8tXNzGmVipY8dl8oxOhbX/FDUHbu8fk6CChlGLT2PC\nLKD4cgSPra2pJw/6swg3JvbSLIwxM1KUswkAFfvfdCVZvDVKDvT4UH/Ec9QevVTv\nxESIlJGvy+0/mVEjJ7DkNrHiWqECL/K+MAN39EmpzM+lhJtbufCt2AtDB4u8VWGb\nI8UX2PouH7lbfZjSj9biH+ErkqQGRra3QZiHNGgP5i67a+j6qtFFWghr71q21BDA\nMQEQwk64ksL5Mx1I3vycT7X+ZRkDr/soh38dJdgBfXuHAmXDtIbg9DjKPB2G0J+Z\nX6IITNFjrqSce0O1STGfAlUVeJYIoHWV4pOdA+aG/fr/tc5U9VZVOIxlHVR1AauS\nHzH7G3BN2c8FcgCGemiMAYgAELv5ZFN5k+y42kCoMSHeaGwBCe/d77BrEbJ+n/oR\nC7vSteIF75POVzn+1mGGOj5PMHB5VDQ7TS0jauWgyOi1trFYvkKBGL1IVdCXdIlJ\npiZUHeA8slVXzCYAtn1dQ3L9Wq7OQv3WLVuNpMwuKxYV2BV6p6k=\n=aoN8\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/62b6cd019eb2c8fad8e1275d60ed6369f83b4ab5",
          "sha": "62b6cd019eb2c8fad8e1275d60ed6369f83b4ab5",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/62b6cd019eb2c8fad8e1275d60ed6369f83b4ab5"
        }
      ],
      "message": "silentpayments: implement shared secret creation\n\nAdd function for calculating either a*B or A*b. This function is used by both\nthe sender and the recipient (i.e. a*B == A*b).\n\nAdd functions for generating the tagged input hash, as this is used when\ncreating the shared secret.\n\nIn a later commit, `create_shared_secret` will be exposed in the API for\nthe receiver to use when scanning as a light client.",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-04-24T08:07:06Z"
      },
      "author": {
        "name": "Sebastian Falbesoner",
        "email": "sebastian.falbesoner@gmail.com",
        "date": "2023-10-05T01:14:00Z"
      },
      "sha": "39c09390230856fa127397221ec9ed28a051b57d"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDBiMDdjZTBjOTc2YTllZmM1Mzg2NjI2NjA2MzFiY2Q3NDc3N2MyMmI",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/0b07ce0c976a9efc538662660631bcd74777c22b",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/0b07ce0c976a9efc538662660631bcd74777c22b",
      "tree": {
        "sha": "47b923d42d2d6ad5c13a6b700f17b4fa662b573f",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/47b923d42d2d6ad5c13a6b700f17b4fa662b573f"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 47b923d42d2d6ad5c13a6b700f17b4fa662b573f\nparent 39c09390230856fa127397221ec9ed28a051b57d\nauthor Sebastian Falbesoner <sebastian.falbesoner@gmail.com> 1695853820 +0200\ncommitter josibake <josibake@protonmail.com> 1713946026 +0200\n\nsilentpayments: implement output pubkey creation\n\nAdd methods for creating an xonly output from a shared secret. This\ninvolves adding a tagged hash for creating the output.\n\nThis function will be exposed in the API in a later commit for the\nreceiver to use when scanning as a light client.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmYovaoACgkQity1WMTz\nPWVHAg//eza9Wvofx0uI/obUF1ocy3OSdpMj0vGF0bIVr4TCd6iVulFw8r55Y2da\nx4Blr+gRUaWQwPxkNF9pnvgk+3w0CGf1QVFjF1GcY8/ZBYZY8BIrVmKFojLPE9PO\novNA2FP7zhXKsxPyqClhT8HI1czKi93cfOrIEtnHkWwP6113jc6TU1HqsemRiWa1\nMEVin+e4mAOgJYJdPoKIVE7AFimlwRBxI4Gw0yBo3nVeteTE0kzRi7AG20kB+iP8\nNDj4Khy8Y+V5NoD7hPKHX+TFiulRk92FN+/wNUQGOZiPHuDiS9IvITTGJP2/Twri\nmTMFGtfCmJ9DcPMfXMzH6Sz4/Tvq6RQxtx+pMPN/HOV68XmxYeJINv06/3eZqihW\njZ9yFiRM+BEqgfdWvmKJi2jr1TdTgbSauCtGrBztuHB3abkE7fpzA+Ke40iJXvbj\n5zJq+BMd6lPDLw9KUnQaLMUkidV9/xDwm6UzoBM0Zs5/Otp9oqP5yTlj+1di3HB6\nn32jT/SrqBUlETZPxEwKtDYb94SyVdyuczI3TqPNBgnjHQPmtXAE/R4zGcWYRiyJ\ncg+83ham4UnjnaZapehw5KvoRj5r6xM+GrFlhBiTPjDkP1eKUGB5JWCPuNnF2Ndr\ndaui1ugwJ4ADcuOEwbj7+iEdC9yr8dD7jcTV+4wjD7FCnMfdyDY=\n=KVsk\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/39c09390230856fa127397221ec9ed28a051b57d",
          "sha": "39c09390230856fa127397221ec9ed28a051b57d",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/39c09390230856fa127397221ec9ed28a051b57d"
        }
      ],
      "message": "silentpayments: implement output pubkey creation\n\nAdd methods for creating an xonly output from a shared secret. This\ninvolves adding a tagged hash for creating the output.\n\nThis function will be exposed in the API in a later commit for the\nreceiver to use when scanning as a light client.",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-04-24T08:07:06Z"
      },
      "author": {
        "name": "Sebastian Falbesoner",
        "email": "sebastian.falbesoner@gmail.com",
        "date": "2023-09-27T22:30:20Z"
      },
      "sha": "0b07ce0c976a9efc538662660631bcd74777c22b"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDcxNDk1ZGNkZmE2Njg0Nzk5Y2NhM2JjMThkNTA4NDBlN2I2YTc1NGU",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/71495dcdfa6684799cca3bc18d50840e7b6a754e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/71495dcdfa6684799cca3bc18d50840e7b6a754e",
      "tree": {
        "sha": "2df0e2462fd2a303127997c763262883a532bb81",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/2df0e2462fd2a303127997c763262883a532bb81"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 2df0e2462fd2a303127997c763262883a532bb81\nparent 0b07ce0c976a9efc538662660631bcd74777c22b\nauthor josibake <josibake@protonmail.com> 1711391150 +0100\ncommitter josibake <josibake@protonmail.com> 1713946026 +0200\n\nsilentpayments: add sender routine\n\nGiven a set of private keys, the smallest outpoint, and list of recipients this\nfunction handles the entire sender flow:\n\n1. Sum up the private keys\n2. Calculate the input_hash\n3. For each recipient:\n    3a. Calculate a shared secret\n    3b. Create the requested number of outputs\n\nThis function assumes a single sender context in that it requires the\nsender to have access to all of the private keys. In the future, this\nAPI may be expanded to allow for a multiple senders or for a single\nsender who does not have access to all private keys at any given time,\nbut for now these modes are considered out of scope / unsafe.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmYovaoACgkQity1WMTz\nPWXCQxAArJSftmig2xtpijgKBpihNZe7XUS8F8OAMUrD/iA2yidpdybcQcwj9Gse\naNWDJNHMDprMnleKe+Zr3J/0fO4aMO1M+Bubv/kReA+z4TjutCko3FwwHVhmX13D\nDkVHRZlg6HHFF2KzruaC39YmBlehLEEoL/K2T6jAeg2yK8aoHZqi92sGELD6VdCD\nG6j6Ak494kvoQGTeYmPiwZqQFBdI+UybVgcYgmCKX79oL8xs+ZGwHt3D5G9rR5+W\nb1TDsFURXXEB/8Z8EClYcM+H3XCj/j3TD0WR/NaVMdT6URPqg/oSWMfB4vYI4AmI\ni0sJMo56/hfd6yXb1apRBy1NahO0G/J4+ofaiLRwzC0eM1hYmAMNmGHZxYcLeKh3\nPZgUlX8kgU4uA8dZlmcYBcNl22wKu5ILSfAEfmwVKVSqpWryopC9unk2NBgavpJN\ns/Ze2ec/JAo6fKuuyMSvsCYEgY5ep/cikv3SkAIACcL/pS9iJalqk45Ba4oKkr9e\nDyVGUDWY1hJ3WmjZQDnI0onv0jJUZbHJwnkUOELZt3+E9nNmeSQX00Mp92Tzt/TN\nBCZVysOlKR8PapkKUthD9Mmp5oI7AWB6D+SW1F18moGiqNx/CRPtGY8KoQSabOhT\nYxrL/87CA6Vv+eBMDip+ViWD0qU54IZXXil0Bb/ziWxD3A31DHc=\n=IZjo\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/0b07ce0c976a9efc538662660631bcd74777c22b",
          "sha": "0b07ce0c976a9efc538662660631bcd74777c22b",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/0b07ce0c976a9efc538662660631bcd74777c22b"
        }
      ],
      "message": "silentpayments: add sender routine\n\nGiven a set of private keys, the smallest outpoint, and list of recipients this\nfunction handles the entire sender flow:\n\n1. Sum up the private keys\n2. Calculate the input_hash\n3. For each recipient:\n    3a. Calculate a shared secret\n    3b. Create the requested number of outputs\n\nThis function assumes a single sender context in that it requires the\nsender to have access to all of the private keys. In the future, this\nAPI may be expanded to allow for a multiple senders or for a single\nsender who does not have access to all private keys at any given time,\nbut for now these modes are considered out of scope / unsafe.",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-04-24T08:07:06Z"
      },
      "author": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-03-25T18:25:50Z"
      },
      "sha": "71495dcdfa6684799cca3bc18d50840e7b6a754e"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDQ1NjUzMzRmYWI2Y2IyZGRjNGI4NTU5ODkzNTNkOGNiZWU0NTJjNDI",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/4565334fab6cb2ddc4b855989353d8cbee452c42",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/4565334fab6cb2ddc4b855989353d8cbee452c42",
      "tree": {
        "sha": "571e5e909555440cae9bfd3733d3be361035c3df",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/571e5e909555440cae9bfd3733d3be361035c3df"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 571e5e909555440cae9bfd3733d3be361035c3df\nparent 71495dcdfa6684799cca3bc18d50840e7b6a754e\nauthor Sebastian Falbesoner <sebastian.falbesoner@gmail.com> 1705946165 +0100\ncommitter josibake <josibake@protonmail.com> 1713946026 +0200\n\nsilentpayments: add recipient label support\n\nAdd function for creating a label tweak. This requires a tagged hash\nfunction for labels. This function is used by the receiver for creating\nlabels to be used for a) creating labelled addresses and b) to populate\na labels cache when scanning.\n\nAdd function for creating a labelled spend pubkey. This involves taking\na label tweak, turning it into a public key and adding it to the spend\npublic key. This function is used by the receiver to create a labelled\nsilent payment address.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmYovaoACgkQity1WMTz\nPWWIhxAA2hLROOEPIeq5B2rkpiBE1h6iLW53rBUagE0nL3uh1dh8T6oqm/i8Q9QM\nCSq93a3AU3Rqpo3ZJVt0sAFhN6GTxmLnnWmM+sxYKcJ9xie7q5FxLxLFe2zIs0bF\niZJdAQMP/mK/zMwhTTVdHEtpC1iF8Eop7MFFudhKs7w/r7jA9niie7j+qRs/+U2n\nWqrqyG/GDTsKGJ0+5Qk5IUsVFBhauigL2tdVZMO95HovEgnRM9N1ur5p4XDCQVxx\n/sHC9fob4wmLofCsP9aRe44/PoyJKd81yoBMkS1hUK9Mcn1ImkXJdsB9GyihoocH\nGfIriS+GA79yuTBOBWAGZWJndW4RQTrud/UeIrd12J6lkzo8nILmdrn0jZPV7IMV\nijO8JNA7xbmRw/CGibn9d/2fH5DL88/hOjCRqwHC7IRp1Lh6VqVBjnwVhLjXrN33\n08fPqrcD/KDwvWbAiZ/akr3biOQpmBr2jBes2YUNY2iXCUO8wMZHA2ECRjtnJYWR\narWUEXOk/JITIJ71fo8Dh7l+uHR1J7zlH+QV//8ZAXzbK1LF/MQXrdIZXYVWyNrP\neEeOh8PvGyorrXZlFMWinlURTjVCgasfpT6j58l+L05sfJK7pVn07ogUSpwYocOJ\nsGVYFvQcpSA5pLCPb2S2C81eKrJDQCfCy20PypR2XY1LSIFPn6o=\n=ocrN\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/71495dcdfa6684799cca3bc18d50840e7b6a754e",
          "sha": "71495dcdfa6684799cca3bc18d50840e7b6a754e",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/71495dcdfa6684799cca3bc18d50840e7b6a754e"
        }
      ],
      "message": "silentpayments: add recipient label support\n\nAdd function for creating a label tweak. This requires a tagged hash\nfunction for labels. This function is used by the receiver for creating\nlabels to be used for a) creating labelled addresses and b) to populate\na labels cache when scanning.\n\nAdd function for creating a labelled spend pubkey. This involves taking\na label tweak, turning it into a public key and adding it to the spend\npublic key. This function is used by the receiver to create a labelled\nsilent payment address.",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-04-24T08:07:06Z"
      },
      "author": {
        "name": "Sebastian Falbesoner",
        "email": "sebastian.falbesoner@gmail.com",
        "date": "2024-01-22T17:56:05Z"
      },
      "sha": "4565334fab6cb2ddc4b855989353d8cbee452c42"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDc1ZDZmNWJlN2NhOWZmZjQ4ZTViMmFlYTk3YzQ1ZWQ4YmNjYWM0YjA",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/75d6f5be7ca9fff48e5b2aea97c45ed8bccac4b0",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/75d6f5be7ca9fff48e5b2aea97c45ed8bccac4b0",
      "tree": {
        "sha": "6fa27c35b925c52d7e0ca7f179fec505c45a7e2d",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/6fa27c35b925c52d7e0ca7f179fec505c45a7e2d"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 6fa27c35b925c52d7e0ca7f179fec505c45a7e2d\nparent 4565334fab6cb2ddc4b855989353d8cbee452c42\nauthor josibake <josibake@protonmail.com> 1713516040 +0200\ncommitter josibake <josibake@protonmail.com> 1713946026 +0200\n\nsilentpayments: add opaque data type `public_data`\n\nAdd data type for passing around the summed input public key (A_sum) and\nthe input hash tweak (input_hash). This data is passed to the scanner\nbefore the ECDH step as two separate elements so that the scanner can\nmultiply b_scan * input_hash before doing ECDH.\n\nAdd functions for deserializing / serializing a public_data object to\nand from a public key. When serializing a public_data object, the\ninput_hash is multplied into A_sum. This is so the object can be stored\nas public key for wallet rescanning later, or to vend to light clients.\nFor the light client, a `_parse` function is added which parses the\ncompressed public key serialization into a `public_data` object.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmYovaoACgkQity1WMTz\nPWVVjA//b4eF7qwX10GPHRHeAfZdcYAfNnCT5b5nvXisVUoO5/gY0EuCP/ED2/6p\ng8O6JS45Y0Mmn8XS1OocgntxBCx+1WSk1qk/ByBCzwjwwtJyCFzHJNwYs8GhIzt7\ngyswjo1dY1idqhhqH5i4GXDT1NKkFl4Cav0rFkE83XIdjqyjZTPBiRtXE4KeTQ0u\nDPPAWBacRybODvUeUzTZBzHt65U1ef++S63WjhdC1Of1YmDeC93ohQoYYPmTqBfS\nqgRRaWCVDtBEIZejrnvOZMqVPj48EinFm9sDuvSyXLMjQtoucXC0E7LVxoXxDcg4\n9+3luYLN51ajTANoOPsTPYI56RfxsmG1NK+2jj/sE7lUUbqw6n0TwaxDGKNpy7wz\njr76ctKW0QtIOH+7w4SYO3xrNQVHRD8VeY/jOLuw7pdWzYtfW8uyuuNa0+im5g8c\nEuyCy6y9KT7uRP8Vaqo8OekVgA9hSetxv/YN1RPH21YgpMiDfIa7x/p5JPlY0Dho\nlRoxU7RgWdmbMG6sudVHABYwjWnkhgH/7DSyhTj7cVqe7WQBw6OSJOaYlkqUqSAb\nzYwp1Wp/y+ovr8fDKkDlpcXxwZeup2bJ1WoeZvCWNBW7VoTQuxvkBZMT3abvdRo9\nj+HCWE3j5/i2LJzQ4xURQEW2u8o+LDFRJgHW1vXq/yui3KdBqwg=\n=WlZD\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/4565334fab6cb2ddc4b855989353d8cbee452c42",
          "sha": "4565334fab6cb2ddc4b855989353d8cbee452c42",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/4565334fab6cb2ddc4b855989353d8cbee452c42"
        }
      ],
      "message": "silentpayments: add opaque data type `public_data`\n\nAdd data type for passing around the summed input public key (A_sum) and\nthe input hash tweak (input_hash). This data is passed to the scanner\nbefore the ECDH step as two separate elements so that the scanner can\nmultiply b_scan * input_hash before doing ECDH.\n\nAdd functions for deserializing / serializing a public_data object to\nand from a public key. When serializing a public_data object, the\ninput_hash is multplied into A_sum. This is so the object can be stored\nas public key for wallet rescanning later, or to vend to light clients.\nFor the light client, a `_parse` function is added which parses the\ncompressed public key serialization into a `public_data` object.",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-04-24T08:07:06Z"
      },
      "author": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-04-19T08:40:40Z"
      },
      "sha": "75d6f5be7ca9fff48e5b2aea97c45ed8bccac4b0"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKGEwZWU3ODlhM2EwYzIwYjk1OGMyODZjYmQzZGQ4OWI2ZDY4ZmE1MmQ",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/a0ee789a3a0c20b958c286cbd3dd89b6d68fa52d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/a0ee789a3a0c20b958c286cbd3dd89b6d68fa52d",
      "tree": {
        "sha": "a7fb23e7bdaa6c9c729e7cfdb52c6387400e3109",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/a7fb23e7bdaa6c9c729e7cfdb52c6387400e3109"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree a7fb23e7bdaa6c9c729e7cfdb52c6387400e3109\nparent 75d6f5be7ca9fff48e5b2aea97c45ed8bccac4b0\nauthor josibake <josibake@protonmail.com> 1713516088 +0200\ncommitter josibake <josibake@protonmail.com> 1713946026 +0200\n\nsilentpayments: add recipient scanning routine\n\nAdd routine for scanning a transaction and returning the necessary\nspending data for any found outputs. This function works with labels via\na lookup callback and requires access to the transaction outputs.\nRequiring access to the transaction outputs is not suitable for light\nclients, but light client support is enabled in followup commits.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmYovaoACgkQity1WMTz\nPWV45Q//d55EK2cMkAuw84oo7ANQoOrrUpA7htMDjg9Fx7kPUM36DwHjxQ2S8wzK\nzim8TNLh9lyL/ym5+nG+GvcCSH0I2bhkpp6pdBlEkVi6akMPrXsrex8JofpOx2Ta\nzp3c174U2PS2m5d1f6teMFF+BP6XnrWopmKaNz7o4M9PnM+oXm4aI5296pK/Hp2W\nRlNwANAbpVOeOXgXmz40cnEyubMErhKjhHmLXo6MiKPb9Z6se3xGmOaStJKh+P8+\n9rmjyKmvMxpwR56Er0ngKMwtuIuet/QrrxhldtMeUhlqZqTfjd0rBHwXDypQWXEa\n0Dw/rxlUPM1R7rba40csXPWSgfa51gp4VW0JS16vVEWafqorjpKMhGofO6GlWoRZ\nCmWub2rOT6DtCv1OpzP4lcXu/yWKVBNRLnNxxdMHewIdIBq68jLLgvpCh9p7rRZa\naltnqQwvjsruvlbXEtfM+FCUVvbD/FjdDOt5kM+hYwokFNLy4DUngqOWuG3fHf5k\n9KnJSBI8cbv/+t1Dq8X6DDC6k+DRizrFdrAtOSul6+/rx6sV5CX1PmsCI2ze3L3M\ng5ebV+lX9TwV84lrD7i1/ilkXXtiXdJMl1Mm/cMZSj0+k8o6vFzMEjjLDweq4q5q\n7Q7/nBrc8J2viO1T/7Oq/cms0b88RCgbmYf0+ILHHRNLy3A/rd4=\n=prK5\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/75d6f5be7ca9fff48e5b2aea97c45ed8bccac4b0",
          "sha": "75d6f5be7ca9fff48e5b2aea97c45ed8bccac4b0",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/75d6f5be7ca9fff48e5b2aea97c45ed8bccac4b0"
        }
      ],
      "message": "silentpayments: add recipient scanning routine\n\nAdd routine for scanning a transaction and returning the necessary\nspending data for any found outputs. This function works with labels via\na lookup callback and requires access to the transaction outputs.\nRequiring access to the transaction outputs is not suitable for light\nclients, but light client support is enabled in followup commits.",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-04-24T08:07:06Z"
      },
      "author": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-04-19T08:41:28Z"
      },
      "sha": "a0ee789a3a0c20b958c286cbd3dd89b6d68fa52d"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDg3N2EyMzE3Yjg5NjAxZTYzMGYxOTkyZTBhNDRiOGQ4N2NmNGI4NzM",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/877a2317b89601e630f1992e0a44b8d87cf4b873",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/877a2317b89601e630f1992e0a44b8d87cf4b873",
      "tree": {
        "sha": "4941dde91049d99ba64bc99f9f9c227e98257f2d",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/4941dde91049d99ba64bc99f9f9c227e98257f2d"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 4941dde91049d99ba64bc99f9f9c227e98257f2d\nparent a0ee789a3a0c20b958c286cbd3dd89b6d68fa52d\nauthor josibake <josibake@protonmail.com> 1713516138 +0200\ncommitter josibake <josibake@protonmail.com> 1713946026 +0200\n\nsilentpayments: add recipient light client support\n\nExpose a shared secret routine in the public API and a output_pubkey\ncreation routine. These are simple wrappers around the same functions\nthe module is using under the hood. They are exposed for the light\nclient as the minimal set of operations they need to do scanning without\naccess to the transaction outputs.\n\nThis means the light client will need to manage their own scanning\nstate, so wherever possible it is preferrable to use the\n`_recipient_scan_ouputs` function.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmYovaoACgkQity1WMTz\nPWXEkg/+P8k0iUZw1lEQkD6tLoKHpd4YJkFvh3yjdfTuv594f3ov7xE8WJKF3UNd\nXKPj6qvEtlFCPadaTpNDLNl7fQFdLVaj0Hg1n5RjpoZlevSXx0R1ZFelBkAWj5TS\nCBuz1f7I6Ep6aY5s5Qd+4UL7OcHelRrk344cwOeCBW/roBuOn/z3o3T/8upJqz3z\n5ETIkyNvd80RozufFWgfHII+sIlCZmwe+Gc+aVLaISDYavJWOweHlK80WZ1fc/Fi\nerkZaaeqqTiB5NIoxEuq5MZ74ri4Mj+Pn4LYFcgbT6daBkjh/LdQe3XxoFpP5HwQ\nuFCKprCe3SzlK6OUZbvOGRMNQFLHzJiA2Xk7jWMCWUKru6FcNER6WTtt5TsaC2RB\nVQnp/+hP9ZijeowKrIC4obZYhG/1BjqwA0rbnS5sBJMXMmV9NCqEDmiLjLhrrVHs\nInYVdFrHh5pxFjg6P/vLCkOs5MgmA7Uel/uVYLUpK9C6vdgvLnch2alcvC2DdJBI\nyxhvJf7BzdYuxZeecDDuiWrGv9zmXWUK/BOHOPnoc1PBgqA2OFoLVQkjfQsgmS68\nl2Ojj8jkVjZODYSuSdPSC4O5P2vVRYa92OLiJ+1Rd4xVmpQdkTrEPmdsszqy8CYl\n5GrKVbaFVsElkBhueYrzifhNZJu0ADMh3UVUnPiAu0PNpnZEWPw=\n=IGrH\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/a0ee789a3a0c20b958c286cbd3dd89b6d68fa52d",
          "sha": "a0ee789a3a0c20b958c286cbd3dd89b6d68fa52d",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/a0ee789a3a0c20b958c286cbd3dd89b6d68fa52d"
        }
      ],
      "message": "silentpayments: add recipient light client support\n\nExpose a shared secret routine in the public API and a output_pubkey\ncreation routine. These are simple wrappers around the same functions\nthe module is using under the hood. They are exposed for the light\nclient as the minimal set of operations they need to do scanning without\naccess to the transaction outputs.\n\nThis means the light client will need to manage their own scanning\nstate, so wherever possible it is preferrable to use the\n`_recipient_scan_ouputs` function.",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-04-24T08:07:06Z"
      },
      "author": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-04-19T08:42:18Z"
      },
      "sha": "877a2317b89601e630f1992e0a44b8d87cf4b873"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDNlZTk4NTc3ZWEwYzMwMzNhNTJkNmQwOTI5M2MyYzJhZjRkMjI2ZmU",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/3ee98577ea0c3033a52d6d09293c2c2af4d226fe",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/3ee98577ea0c3033a52d6d09293c2c2af4d226fe",
      "tree": {
        "sha": "98aaa35dc46c3e2916a70d49d6afd489b7b72304",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/98aaa35dc46c3e2916a70d49d6afd489b7b72304"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 98aaa35dc46c3e2916a70d49d6afd489b7b72304\nparent 877a2317b89601e630f1992e0a44b8d87cf4b873\nauthor josibake <josibake@protonmail.com> 1713202589 +0200\ncommitter josibake <josibake@protonmail.com> 1713946026 +0200\n\nsilentpayments: add examples/silentpayments.c\n\nDemonstrate sending, scanning, and light client scanning.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmYovaoACgkQity1WMTz\nPWW+4hAAr34ZGTGI9/2gDtZJi6/X/9uIEA4PCPyKUyZa/wbKzPKD3ooj3t8IylCq\nxknfoC1A3k870oCcI6UPePRpTQdoZg7vMtx2n7ILNiXl3KjFA5iNTA3Y8+28tebv\n3TSR+4MbBZSY4S05jpQgMy/u6Z36kHh6G1erBmWjQvcOGhsanXMrGO2olRWr/2Dh\nNEoEqmZQ/3SSLdXsqWGgZgu4eCYqoybUXcDZmWmMUIfr9Vr/6FbQFgH/5wfXRB7a\nOAhM3yFGYyl35vOC/sv7EtFZi9vs3bnHfri6SlzfSnd7MFtST6a2sC05GiU1IlOQ\nJ5f8QIJk17NiD8jMWS0l+sjIWmdoeVzy5dv/DuhHtN5QYBnRDZ6/JPx3ftE7ZBVw\n+brNDU4umhCtQnQ9+S+Fwj6roOH+ahvdkWBVmuKiNTF1DbVf7GotdxiUKOVZ9kqr\nlIUpkV3fTih8eQtHeWInXQH69P1rjthXzsQXt6Urx7mKCkYuoRFg+Ow3ES0xboPJ\np5ZbDophT6nPj/+njGR44VibWWeyaZSTlKOrLkY/elViEkMI+cNufGOvHu/ApFCJ\n1nqkeC+E3OcR8Bn9Rl+9FN5iHVSBpoH8A0yJSQaYCyFKal88PYTmiLTparth2ynL\no9bCoE54ZUp5hx2nrpUudtmSxKOyophTDC25hXGXI67w/J86Khs=\n=aAcz\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/877a2317b89601e630f1992e0a44b8d87cf4b873",
          "sha": "877a2317b89601e630f1992e0a44b8d87cf4b873",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/877a2317b89601e630f1992e0a44b8d87cf4b873"
        }
      ],
      "message": "silentpayments: add examples/silentpayments.c\n\nDemonstrate sending, scanning, and light client scanning.",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-04-24T08:07:06Z"
      },
      "author": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-04-15T17:36:29Z"
      },
      "sha": "3ee98577ea0c3033a52d6d09293c2c2af4d226fe"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDc2ZDA3MTY0ODExMmQ0YjYwZWQ1NTgzNmE3ZTQ2NzUyYzljNmE3ZTA",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/76d071648112d4b60ed55836a7e46752c9c6a7e0",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/76d071648112d4b60ed55836a7e46752c9c6a7e0",
      "tree": {
        "sha": "248735c753bd43f940f5aee30b84a8e36527b14d",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/248735c753bd43f940f5aee30b84a8e36527b14d"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 248735c753bd43f940f5aee30b84a8e36527b14d\nparent 3ee98577ea0c3033a52d6d09293c2c2af4d226fe\nauthor Sebastian Falbesoner <sebastian.falbesoner@gmail.com> 1708642163 +0100\ncommitter josibake <josibake@protonmail.com> 1713946026 +0200\n\ntests: add BIP-352 test vectors\n\nThe vectors are generated with a Python script that converts the .json\nfile from the BIP to C code:\n\n$ ./tools/tests_silentpayments_generate.py test_vectors.json > ./src/modules/silentpayments/vectors.h\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmYovaoACgkQity1WMTz\nPWWwhA/+LyUOPLjugvknUBR0wjtvKqFCjmbRGXdJEgrSA2BgeFjycgZ/61/brdJM\nJPK5O6WZ5z0XM8o40gV1HbG/fs5qzwNcA1ByUi4IYw3++OPJkNezMwf3/ZzXEnB7\nAKDCmD8Nuv7BWrQ3S3uZGrTzAmsbdujkbNvBKcjQf2JwJ2WKJ4qqbtQXh1CBaC4o\n7vOeF0QWbah4LP7MeYKKEhvj6i98Boze9f++vU8UBLN7MTdk21zL8pYbAf2XwrYR\nE6dWBfC+vZD5a3muhaAseKZdr39qrMwOYYQl8V73eotaPNTY0JUgR2dh8IiPA9zP\nDlwcwjrKFXR+RR5bPWswNG6g/kXD8JqueDAb6WBjpoN/DAdjKeh/I/7a7RoywRDx\n+Qgzza56vBAZyMJ282bhypEXmA2kOKJHkEVyHshf2+Uam4aB2BqSccjZYZxGL474\nLHlA152qqGKZwAYhlfJscok2KEll1THKKyXFMaM1oxpSKZ3lsBMJHEIsq1DycAl9\ntZkRpl/b6uxJNhOlGdn84f+oeg23KtHfqrD0VsGTXPQ6XVEUpLGA0wArEsFWO9z+\nWO4F/ErIL/uz7HBx91M5GfMm/k9/bwwCyzbfxtNNU6c08lvgLn7XZ1UQMwf388IP\ndwFP9pVzhpXQVvVxFp2lNzoO6RAYWeZZE+TCq76ny1fmbyKKvFY=\n=/WCd\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/3ee98577ea0c3033a52d6d09293c2c2af4d226fe",
          "sha": "3ee98577ea0c3033a52d6d09293c2c2af4d226fe",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/3ee98577ea0c3033a52d6d09293c2c2af4d226fe"
        }
      ],
      "message": "tests: add BIP-352 test vectors\n\nThe vectors are generated with a Python script that converts the .json\nfile from the BIP to C code:\n\n$ ./tools/tests_silentpayments_generate.py test_vectors.json > ./src/modules/silentpayments/vectors.h",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-04-24T08:07:06Z"
      },
      "author": {
        "name": "Sebastian Falbesoner",
        "email": "sebastian.falbesoner@gmail.com",
        "date": "2024-02-22T22:49:23Z"
      },
      "sha": "76d071648112d4b60ed55836a7e46752c9c6a7e0"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDhiNDhiZjE5YzNjMDIwZTY1MzczNGY2YzlkOTM2NGU2YTQ3YTMwZDE",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/8b48bf19c3c020e653734f6c9d9364e6a47a30d1",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/8b48bf19c3c020e653734f6c9d9364e6a47a30d1",
      "tree": {
        "sha": "045f7754524cc6a4592b45dcc55d4c863bb7b8ba",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/045f7754524cc6a4592b45dcc55d4c863bb7b8ba"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 045f7754524cc6a4592b45dcc55d4c863bb7b8ba\nparent 76d071648112d4b60ed55836a7e46752c9c6a7e0\nauthor Sebastian Falbesoner <sebastian.falbesoner@gmail.com> 1708644341 +0100\ncommitter josibake <josibake@protonmail.com> 1713946175 +0200\n\nci: enable silentpayments module\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEYWUWuOtu0CiC/Ep6ity1WMTzPWUFAmYovkIACgkQity1WMTz\nPWWHfg//Wt1cq4FgnVWoifXP9aKD5DtUmGcbAFGK/wfBzi1WODXD+LGe/C4zcNeI\n+umTzQ0mbPEtiK3lKX23WDecJebxkr5SfzqEi1iO1AYvglVtI+9jUkNj/8HN09++\n1xPKYjzBey0rQMSHqtBGINR4jc1YHOerg72exAvXLoEXh34AX2MypVzEi85uIB45\nu6skCQm7Zx49c7vypfclP89Eto1+kjgLdiVE5OhIEkOOlrylSHsv+vdQFsndcLkv\nIJE2ZfyQr0cK/v70zBQWbcq2jR22e1vwjcc52SU8G3W5FCMB/3Y61gRsfUi+WBG4\nYYs5vsj7RVcR/RDjJ1inIpIk/6hJXU7js2BhZdIUgSD7l3mdgP2hbYaCRmhdrWIk\nczvKE7O/9GXyAyPgJgfmtB4JjDrh6F7HLSiyoNOtRecFkgLFLSON2gyPtKuRfBOA\nJzIDnxhdaUmOM8D+hasBvsDFSu1rlyucNUJesWkbuxK0sV4wv+DHL1C/wIWaf/5y\nsrpeJIyzSUFolccRsiyRq208CXLdbsce+guKgULBwM8LgAd/ZQ85tHq7gafUJXwW\ne1irjehSbs22dcd15PfGjupChUEX9w+MLnJ40un47AEL7USgO+W8MCF8JY3HdKtz\no1JAeAlHN3Ao4Blh3UDqGZe7Ctx0z6E7qbkR4AQmg+e1E2xGZk4=\n=L5ak\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/76d071648112d4b60ed55836a7e46752c9c6a7e0",
          "sha": "76d071648112d4b60ed55836a7e46752c9c6a7e0",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/76d071648112d4b60ed55836a7e46752c9c6a7e0"
        }
      ],
      "message": "ci: enable silentpayments module",
      "committer": {
        "name": "josibake",
        "email": "josibake@protonmail.com",
        "date": "2024-04-24T08:09:35Z"
      },
      "author": {
        "name": "Sebastian Falbesoner",
        "email": "sebastian.falbesoner@gmail.com",
        "date": "2024-02-22T23:25:41Z"
      },
      "sha": "8b48bf19c3c020e653734f6c9d9364e6a47a30d1"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 12588114369,
      "node_id": "HRFPE_lADOAP4Jqs6GTERUzwAAAALuT2HB",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/12588114369",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-24T08:38:21Z"
    },
    {
      "event": "commented",
      "id": 2074419309,
      "node_id": "IC_kwDOAP4Jqs57pSBt",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/2074419309",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-04-24T08:45:36Z",
      "updated_at": "2024-04-24T08:45:36Z",
      "author_association": "MEMBER",
      "body": "Rebased on #1518 (https://github.com/bitcoin-core/secp256k1/commit/3d080277895655e8274ee73aacd154c4ead143e3 -> https://github.com/bitcoin-core/secp256k1/commit/8b48bf19c3c020e653734f6c9d9364e6a47a30d1, [compare](https://github.com/josibake/secp256k1/compare/bip352-silentpayments-module-01..josibake:secp256k1:bip352-silentpayments-module-rebase))",
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#issuecomment-2074419309",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1519"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1574947042",
      "pull_request_review_id": 2015096769,
      "id": 1574947042,
      "node_id": "PRRC_kwDOAP4Jqs5d38ji",
      "diff_hunk": "@@ -433,4 +433,137 @@ int secp256k1_silentpayments_recipient_public_data_parse(const secp256k1_context\n     return 1;\n }\n \n+int secp256k1_silentpayments_recipient_scan_outputs(\n+    const secp256k1_context *ctx,\n+    secp256k1_silentpayments_found_output **found_outputs, size_t *n_found_outputs,\n+    const secp256k1_xonly_pubkey * const *tx_outputs, size_t n_tx_outputs,\n+    const unsigned char *scan_key,\n+    const secp256k1_silentpayments_public_data *public_data,\n+    const secp256k1_pubkey *receiver_spend_pubkey,\n+    const secp256k1_silentpayments_label_lookup label_lookup,\n+    const void *label_context\n+) {\n+    secp256k1_scalar t_k_scalar;\n+    secp256k1_ge receiver_spend_pubkey_ge;\n+    secp256k1_xonly_pubkey P_output_xonly;\n+    secp256k1_pubkey A_sum;\n+    unsigned char shared_secret[33];\n+    size_t i, k, n_found;\n+    int found, combined;\n+\n+    /* Sanity check inputs */\n+    VERIFY_CHECK(ctx != NULL);\n+    ARG_CHECK(found_outputs != NULL);\n+    ARG_CHECK(tx_outputs != NULL);\n+    ARG_CHECK(scan_key != NULL);\n+    ARG_CHECK(public_data != NULL);\n+    combined = (int)public_data->data[0];\n+    {\n+        unsigned char input_hash[32];\n+        unsigned char *input_hash_ptr;\n+        if (combined) {\n+            input_hash_ptr = NULL;\n+        } else {\n+            memset(input_hash, 0, 32);\n+            input_hash_ptr = input_hash;\n+        }\n+        if (!secp256k1_silentpayments_recipient_public_data_load(ctx, &A_sum, input_hash_ptr, public_data)) {\n+            return 0;\n+        }\n+        secp256k1_pubkey_load(ctx, &receiver_spend_pubkey_ge, receiver_spend_pubkey);\n+        if (!secp256k1_silentpayments_create_shared_secret(ctx, shared_secret, scan_key, &A_sum, input_hash_ptr)) {\n+            return 0;\n+        }\n+    }\n+\n+    n_found = 0;\n+    k = 0;\n+    while (1) {\n+        secp256k1_ge P_output_ge = receiver_spend_pubkey_ge;\n+        /* Calculate t_k = hash(shared_secret || ser_32(k)) */\n+        secp256k1_silentpayments_create_t_k(&t_k_scalar, shared_secret, k);\n+\n+        /* Calculate P_output = B_spend + t_k * G */\n+        if (!secp256k1_eckey_pubkey_tweak_add(&P_output_ge, &t_k_scalar)) {\n+            return 0;\n+        }\n+\n+        /* If the calculated output matches the one from the tx, we have a direct match and can\n+         * return without labels calculation (one of the two would result in point of infinity) */\n+        secp256k1_xonly_pubkey_save(&P_output_xonly, &P_output_ge);\n+        found = 0;\n+        for (i = 0; i < n_tx_outputs; i++) {\n+            if (secp256k1_xonly_pubkey_cmp(ctx, &P_output_xonly, tx_outputs[i]) == 0) {\n+                found_outputs[n_found]->output = *tx_outputs[i];",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": 497,
      "original_position": 65,
      "commit_id": "8b48bf19c3c020e653734f6c9d9364e6a47a30d1",
      "original_commit_id": "f113564298e8e76813289fdcefa6968462dc3fda",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The `found_with_label` boolean needs to be set here, to not leave it uninitialized (I guess we don't want to rely on the user zeroing the `_found_output` struct instances before scanning):\r\n```suggestion\r\n                found_outputs[n_found]->output = *tx_outputs[i];\r\n                found_outputs[n_found]->found_with_label = 0;\r\n```\r\nShould we also set `label` here to something invalid for consistency, e.g. all-zero-bytes, even though the user wouldn't evaluate it anyways? Not sure what the best practices are in cases like this and if returning uninitialized data is acceptable.\r\n\r\nMight be nice to update the tests to also check for the `found_with_label` flag. ",
      "created_at": "2024-04-22T15:21:20Z",
      "updated_at": "2024-04-22T16:26:35Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1574947042",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1574947042"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 497,
      "original_line": 497,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1574962225",
      "pull_request_review_id": 2015096769,
      "id": 1574962225,
      "node_id": "PRRC_kwDOAP4Jqs5d4AQx",
      "diff_hunk": "@@ -222,6 +222,57 @@ SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipien\n     size_t n_plain_pubkeys\n ) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);\n \n+/** Scan for Silent Payment transaction outputs.\n+ *\n+ *  Given a input public sum, an input_hash, a recipient's spend public key B_spend, and the relevant transaction\n+ *  outputs, scan for outputs belong to the recipient and return the tweak(s) needed for spending\n+ *  the output(s). An optional label_lookup callback function and label_context can be passed if the\n+ *  recipient uses labels. This allows for checking if a label exists in the recipients label cache\n+ *  and retrieving the label tweak during scanning.\n+ *\n+ *  Returns: 1 if output scanning was successful. 0 if an error occured.\n+ *  Args:                  ctx: pointer to a context object\n+ *  Out:         found_outputs: pointer to an array of pointers to found output objects. The found outputs\n+ *                              array MUST be initialized to be the same length as the tx_outputs array\n+ *             n_found_outputs: pointer to an integer indicating the final size of the found outputs array.\n+ *                              This number represents the number of outputs found while scanning (0 if\n+ *                              none are found)\n+ *  In:             tx_outputs: pointer to the tx's x-only public key outputs\n+ *                n_tx_outputs: the number of tx_outputs being scanned\n+ *                    scan_key: pointer to the recipient's scan key\n+ *           public_tweak_data: pointer to the input public key sum (optionaly, with the `input_hash`",
      "path": "include/secp256k1_silentpayments.h",
      "position": 243,
      "original_position": 22,
      "commit_id": "8b48bf19c3c020e653734f6c9d9364e6a47a30d1",
      "original_commit_id": "f113564298e8e76813289fdcefa6968462dc3fda",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n *                 public_data: pointer to the input public key sum (optionaly, with the `input_hash`\r\n```",
      "created_at": "2024-04-22T15:30:04Z",
      "updated_at": "2024-04-22T16:26:35Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1574962225",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1574962225"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 243,
      "original_line": 243,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1574963125",
      "pull_request_review_id": 2015096769,
      "id": 1574963125,
      "node_id": "PRRC_kwDOAP4Jqs5d4Ae1",
      "diff_hunk": "@@ -222,6 +222,57 @@ SECP256K1_API SECP256K1_WARN_UNUSED_RESULT int secp256k1_silentpayments_recipien\n     size_t n_plain_pubkeys\n ) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3);\n \n+/** Scan for Silent Payment transaction outputs.\n+ *\n+ *  Given a input public sum, an input_hash, a recipient's spend public key B_spend, and the relevant transaction\n+ *  outputs, scan for outputs belong to the recipient and return the tweak(s) needed for spending\n+ *  the output(s). An optional label_lookup callback function and label_context can be passed if the\n+ *  recipient uses labels. This allows for checking if a label exists in the recipients label cache\n+ *  and retrieving the label tweak during scanning.\n+ *\n+ *  Returns: 1 if output scanning was successful. 0 if an error occured.\n+ *  Args:                  ctx: pointer to a context object\n+ *  Out:         found_outputs: pointer to an array of pointers to found output objects. The found outputs\n+ *                              array MUST be initialized to be the same length as the tx_outputs array\n+ *             n_found_outputs: pointer to an integer indicating the final size of the found outputs array.\n+ *                              This number represents the number of outputs found while scanning (0 if\n+ *                              none are found)\n+ *  In:             tx_outputs: pointer to the tx's x-only public key outputs\n+ *                n_tx_outputs: the number of tx_outputs being scanned\n+ *                    scan_key: pointer to the recipient's scan key\n+ *           public_tweak_data: pointer to the input public key sum (optionaly, with the `input_hash`\n+ *                              multiplied in, see `_recipient_compute_public_data`).\n+ *      recipient_spend_pubkey: pointer to the receiver's spend pubkey\n+ *                  input_hash: pointer to the input_hash. MUST be NULL if the input_hash is already\n+ *                              multipled into the input public key sum (see `_recipient_compute_public_data`)",
      "path": "include/secp256k1_silentpayments.h",
      "position": 247,
      "original_position": 26,
      "commit_id": "8b48bf19c3c020e653734f6c9d9364e6a47a30d1",
      "original_commit_id": "f113564298e8e76813289fdcefa6968462dc3fda",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "```suggestion\r\n```\r\n(parameter doesn't exist anymore)",
      "created_at": "2024-04-22T15:30:22Z",
      "updated_at": "2024-04-22T16:26:35Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1574963125",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1574963125"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": 246,
      "original_start_line": 246,
      "start_side": "RIGHT",
      "line": 247,
      "original_line": 247,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1574976504",
      "pull_request_review_id": 2015096769,
      "id": 1574976504,
      "node_id": "PRRC_kwDOAP4Jqs5d4Dv4",
      "diff_hunk": "@@ -328,4 +328,109 @@ int secp256k1_silentpayments_recipient_create_labelled_spend_pubkey(const secp25\n     return 1;\n }\n \n+int secp256k1_silentpayments_recipient_public_data_create(\n+    const secp256k1_context *ctx,\n+    secp256k1_silentpayments_public_data *public_data,\n+    const unsigned char *outpoint_smallest36,\n+    const secp256k1_xonly_pubkey * const *xonly_pubkeys,\n+    size_t n_xonly_pubkeys,\n+    const secp256k1_pubkey * const *plain_pubkeys,\n+    size_t n_plain_pubkeys\n+) {\n+    size_t i;\n+    size_t pubkeylen = 65;\n+    secp256k1_pubkey A_sum;\n+    secp256k1_ge A_sum_ge, addend;\n+    secp256k1_gej A_sum_gej;\n+    unsigned char input_hash_local[32];\n+\n+    /* Sanity check inputs */\n+    VERIFY_CHECK(ctx != NULL);\n+    ARG_CHECK(public_data != NULL);\n+    ARG_CHECK(plain_pubkeys == NULL || n_plain_pubkeys >= 1);\n+    ARG_CHECK(xonly_pubkeys == NULL || n_xonly_pubkeys >= 1);\n+    ARG_CHECK((plain_pubkeys != NULL) || (xonly_pubkeys != NULL));\n+    ARG_CHECK((n_plain_pubkeys + n_xonly_pubkeys) >= 1);\n+    ARG_CHECK(outpoint_smallest36 != NULL);\n+    memset(input_hash_local, 0, 32);\n+\n+    /* Compute input public keys sum: A_sum = A_1 + A_2 + ... + A_n */\n+    secp256k1_gej_set_infinity(&A_sum_gej);\n+    for (i = 0; i < n_plain_pubkeys; i++) {\n+        secp256k1_pubkey_load(ctx, &addend, plain_pubkeys[i]);\n+        secp256k1_gej_add_ge(&A_sum_gej, &A_sum_gej, &addend);",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": 361,
      "original_position": 34,
      "commit_id": "8b48bf19c3c020e653734f6c9d9364e6a47a30d1",
      "original_commit_id": "4fb8716f4f1f6b10757f53024eb22263829fe888",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Not sure why I chose the constant-time point addition routines back then in #1471 (probably was inspired by `_ec_pubkey_combine`), but I strongly suspect that they are not needed for summing up public data:\r\n```suggestion\r\n        secp256k1_gej_add_ge_var(&A_sum_gej, &A_sum_gej, &addend, NULL);\r\n```\r\n(also for second summing loop a few lines below)",
      "created_at": "2024-04-22T15:39:48Z",
      "updated_at": "2024-04-22T16:26:35Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1574976504",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1574976504"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 361,
      "original_line": 361,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1574990516",
      "pull_request_review_id": 2015096769,
      "id": 1574990516,
      "node_id": "PRRC_kwDOAP4Jqs5d4HK0",
      "diff_hunk": "@@ -0,0 +1,264 @@\n+/***********************************************************************\n+ * Distributed under the MIT software license, see the accompanying    *\n+ * file COPYING or https://www.opensource.org/licenses/mit-license.php.*\n+ ***********************************************************************/\n+\n+#ifndef SECP256K1_MODULE_SILENTPAYMENTS_TESTS_H\n+#define SECP256K1_MODULE_SILENTPAYMENTS_TESTS_H\n+\n+#include \"../../../include/secp256k1_silentpayments.h\"\n+#include \"../../../src/modules/silentpayments/vectors.h\"\n+#include \"../../../examples/examples_util.h\"\n+#include \"assert.h\"\n+\n+struct label_cache_entry {\n+    secp256k1_pubkey label;\n+    unsigned char label_tweak[32];\n+};\n+struct labels_cache {\n+    const secp256k1_context *ctx;\n+    size_t entries_used;\n+    struct label_cache_entry entries[10];\n+};\n+struct labels_cache labels_cache;\n+const unsigned char* label_lookup(const secp256k1_pubkey* key, const void* cache_ptr) {\n+    const struct labels_cache* cache = (const struct labels_cache*)cache_ptr;\n+    size_t i;\n+    for (i = 0; i < cache->entries_used; i++) {\n+        if (secp256k1_ec_pubkey_cmp(cache->ctx, &cache->entries[i].label, key) == 0) {\n+            return cache->entries[i].label_tweak;\n+        }\n+    }\n+    return NULL;\n+}\n+\n+void run_silentpayments_test_vector_send(const struct bip352_test_vector *test) {\n+    secp256k1_silentpayments_recipient recipients[MAX_OUTPUTS_PER_TEST_CASE];\n+    const secp256k1_silentpayments_recipient *recipient_ptrs[MAX_OUTPUTS_PER_TEST_CASE];\n+    secp256k1_xonly_pubkey generated_outputs[MAX_OUTPUTS_PER_TEST_CASE];\n+    secp256k1_xonly_pubkey *generated_output_ptrs[MAX_OUTPUTS_PER_TEST_CASE];\n+    secp256k1_keypair taproot_keypairs[MAX_INPUTS_PER_TEST_CASE];\n+    secp256k1_keypair const *taproot_keypair_ptrs[MAX_INPUTS_PER_TEST_CASE];\n+    unsigned char const *plain_seckeys[MAX_INPUTS_PER_TEST_CASE];\n+    unsigned char created_output[32];\n+    size_t i, j;\n+    int match;\n+\n+    /* Check that sender creates expected outputs */\n+    for (i = 0; i < test->num_outputs; i++) {\n+        CHECK(secp256k1_ec_pubkey_parse(CTX, &recipients[i].scan_pubkey, test->recipient_pubkeys[i].scan_pubkey, 33));\n+        CHECK(secp256k1_ec_pubkey_parse(CTX, &recipients[i].spend_pubkey, test->recipient_pubkeys[i].spend_pubkey, 33));\n+        recipients[i].index = i;\n+        recipient_ptrs[i] = &recipients[i];\n+        generated_output_ptrs[i] = &generated_outputs[i];\n+    }\n+    for (i = 0; i < test->num_plain_inputs; i++) {\n+        plain_seckeys[i] = test->plain_seckeys[i];\n+    }\n+    for (i = 0; i < test->num_taproot_inputs; i++) {\n+        int ret = secp256k1_keypair_create(CTX, &taproot_keypairs[i], test->taproot_seckeys[i]);\n+        assert(ret);\n+        taproot_keypair_ptrs[i] = &taproot_keypairs[i];\n+    }\n+    CHECK(secp256k1_silentpayments_sender_create_outputs(CTX,\n+                generated_output_ptrs,\n+                recipient_ptrs,\n+                test->num_outputs,\n+                test->outpoint_smallest,\n+                test->num_taproot_inputs > 0 ? taproot_keypair_ptrs : NULL, test->num_taproot_inputs,\n+                test->num_plain_inputs > 0 ? plain_seckeys : NULL, test->num_plain_inputs\n+    ));\n+    for (i = 0; i < test->num_outputs; i++) {\n+        CHECK(secp256k1_xonly_pubkey_serialize(CTX, created_output, &generated_outputs[i]));\n+        match = 0;\n+        /* Loop over both lists to ensure tests don't fail due to different orderings of outputs */\n+        for (j = 0; j < test->num_recipient_outputs; j++) {\n+            if (secp256k1_memcmp_var(created_output, test->recipient_outputs[j], 32) == 0) {\n+                match = 1;\n+                break;\n+            }\n+        }\n+        CHECK(match);\n+    }\n+}\n+\n+void run_silentpayments_test_vector_receive(const struct bip352_test_vector *test) {\n+    secp256k1_pubkey plain_pubkeys_objs[MAX_INPUTS_PER_TEST_CASE];\n+    secp256k1_xonly_pubkey xonly_pubkeys_objs[MAX_INPUTS_PER_TEST_CASE];\n+    secp256k1_xonly_pubkey tx_output_objs[MAX_OUTPUTS_PER_TEST_CASE];\n+    secp256k1_silentpayments_found_output found_output_objs[MAX_OUTPUTS_PER_TEST_CASE];\n+    secp256k1_pubkey const *plain_pubkeys[MAX_INPUTS_PER_TEST_CASE];\n+    secp256k1_xonly_pubkey const *xonly_pubkeys[MAX_INPUTS_PER_TEST_CASE];\n+    secp256k1_xonly_pubkey const *tx_outputs[MAX_OUTPUTS_PER_TEST_CASE];\n+    secp256k1_silentpayments_found_output *found_outputs[MAX_OUTPUTS_PER_TEST_CASE];\n+    unsigned char found_outputs_light_client[MAX_OUTPUTS_PER_TEST_CASE][32];\n+    secp256k1_pubkey receiver_scan_pubkey;\n+    secp256k1_pubkey receiver_spend_pubkey;\n+    size_t i,j;\n+    int match;\n+    size_t n_found = 0;\n+    unsigned char found_output[32];\n+    unsigned char found_signatures[10][64];\n+    secp256k1_silentpayments_public_data public_data, public_data_index;\n+    unsigned char shared_secret_lightclient[33];\n+    unsigned char light_client_data[33];\n+\n+\n+    /* prepare the inputs */\n+    {\n+        for (i = 0; i < test->num_plain_inputs; i++) {\n+            CHECK(secp256k1_ec_pubkey_parse(CTX, &plain_pubkeys_objs[i], test->plain_pubkeys[i], 33));\n+            plain_pubkeys[i] = &plain_pubkeys_objs[i];\n+        }\n+        for (i = 0; i < test->num_taproot_inputs; i++) {\n+            CHECK(secp256k1_xonly_pubkey_parse(CTX, &xonly_pubkeys_objs[i], test->xonly_pubkeys[i]));\n+            xonly_pubkeys[i] = &xonly_pubkeys_objs[i];\n+        }\n+        CHECK(secp256k1_silentpayments_recipient_public_data_create(CTX, &public_data,\n+            test->outpoint_smallest,\n+            test->num_taproot_inputs > 0 ? xonly_pubkeys : NULL, test->num_taproot_inputs,\n+            test->num_plain_inputs > 0 ? plain_pubkeys : NULL, test->num_plain_inputs\n+        ));\n+    }\n+    /* prepare the outputs */\n+    {\n+        for (i = 0; i < test->num_to_scan_outputs; i++) {\n+            CHECK(secp256k1_xonly_pubkey_parse(CTX, &tx_output_objs[i], test->to_scan_outputs[i]));\n+            tx_outputs[i] = &tx_output_objs[i];\n+        }\n+        for (i = 0; i < test->num_found_output_pubkeys; i++) {\n+            found_outputs[i] = &found_output_objs[i];\n+        }\n+    }\n+\n+    /* scan / spend pubkeys are not in the given data of the receiver part, so let's compute them */\n+    CHECK(secp256k1_ec_pubkey_create(CTX, &receiver_scan_pubkey, test->scan_seckey));\n+    CHECK(secp256k1_ec_pubkey_create(CTX, &receiver_spend_pubkey, test->spend_seckey));\n+\n+    /* create labels cache */\n+    labels_cache.ctx = CTX;\n+    labels_cache.entries_used = 0;\n+    for (i = 0; i < test->num_labels; i++) {\n+        unsigned int m = test->label_integers[i];\n+        struct label_cache_entry *cache_entry = &labels_cache.entries[labels_cache.entries_used];\n+        CHECK(secp256k1_silentpayments_recipient_create_label_tweak(CTX, &cache_entry->label, cache_entry->label_tweak, test->scan_seckey, m));\n+        labels_cache.entries_used++;\n+    }\n+    CHECK(secp256k1_silentpayments_recipient_scan_outputs(CTX,\n+        found_outputs, &n_found,\n+        tx_outputs, test->num_to_scan_outputs,\n+        test->scan_seckey,\n+        &public_data,\n+        &receiver_spend_pubkey,\n+        label_lookup, &labels_cache)\n+    );\n+    for (i = 0; i < n_found; i++) {\n+        unsigned char full_seckey[32];\n+        secp256k1_keypair keypair;\n+        unsigned char signature[64];\n+        const unsigned char msg32[32] = /* sha256(\"message\") */\n+            {0xab,0x53,0x0a,0x13,0xe4,0x59,0x14,0x98,0x2b,0x79,0xf9,0xb7,0xe3,0xfb,0xa9,0x94,\n+             0xcf,0xd1,0xf3,0xfb,0x22,0xf7,0x1c,0xea,0x1a,0xfb,0xf0,0x2b,0x46,0x0c,0x6d,0x1d};\n+        const unsigned char aux32[32] = /* sha256(\"random auxiliary data\") */\n+            {0x0b,0x3f,0xdd,0xfd,0x67,0xbf,0x76,0xae,0x76,0x39,0xee,0x73,0x5b,0x70,0xff,0x15,\n+             0x83,0xfd,0x92,0x48,0xc0,0x57,0xd2,0x86,0x07,0xa2,0x15,0xf4,0x0b,0x0a,0x3e,0xcc};\n+        memcpy(&full_seckey, test->spend_seckey, 32);\n+        CHECK(secp256k1_ec_seckey_tweak_add(CTX, full_seckey, found_outputs[i]->tweak));\n+        CHECK(secp256k1_keypair_create(CTX, &keypair, full_seckey));\n+        CHECK(secp256k1_schnorrsig_sign32(CTX, signature, msg32, &keypair, aux32));\n+        memcpy(found_signatures[i], signature, 64);\n+    }\n+\n+    /* compare expected and scanned outputs (including calculated seckey tweaks and signatures) */\n+    for (i = 0; i < n_found; i++) {\n+        CHECK(secp256k1_xonly_pubkey_serialize(CTX, found_output, &found_outputs[i]->output));\n+        match = 0;\n+        for (j = 0; j < test->num_found_output_pubkeys; j++) {\n+            if (secp256k1_memcmp_var(&found_output, test->found_output_pubkeys[j], 32) == 0) {\n+                match = 1;\n+                CHECK(secp256k1_memcmp_var(found_outputs[i]->tweak, test->found_seckey_tweaks[j], 32) == 0);\n+                CHECK(secp256k1_memcmp_var(found_signatures[i], test->found_signatures[j], 64) == 0);\n+                break;\n+            }\n+        }\n+        CHECK(match);\n+    }\n+    CHECK(n_found == test->num_found_output_pubkeys);\n+    /* Scan as a light client\n+     * it is not recommended to use labels as a light client so here we are only\n+     * running this on tests that do not involve labels. Primarily, this test is to\n+     * ensure that _recipient_created_shared_secret and _create_shared_secret are the same\n+     */\n+    if (test->num_labels == 0) {\n+        CHECK(secp256k1_silentpayments_recipient_public_data_serialize(CTX, light_client_data, &public_data));\n+        CHECK(secp256k1_silentpayments_recipient_public_data_parse(CTX, &public_data_index, light_client_data));\n+        CHECK(secp256k1_silentpayments_recipient_create_shared_secret(CTX, shared_secret_lightclient, test->scan_seckey, &public_data_index));\n+        n_found = 0;\n+        {\n+            int found = 0;\n+            size_t k = 0;\n+            secp256k1_xonly_pubkey potential_output;\n+            unsigned char xonly_print[32];\n+\n+            while(1) {\n+\n+                CHECK(secp256k1_silentpayments_recipient_create_output_pubkey(CTX,\n+                    &potential_output,\n+                    shared_secret_lightclient,\n+                    &receiver_spend_pubkey,\n+                    k\n+                ));\n+                /* At this point, we check that the utxo exists with a light client protocol.\n+                 * For this example, we'll just iterate through the list of pubkeys */\n+                found = 0;\n+                secp256k1_xonly_pubkey_serialize(CTX, xonly_print, &potential_output);\n+                printf(\"what we generated :\");\n+                print_hex(xonly_print, 32);",
      "path": "src/modules/silentpayments/tests_impl.h",
      "position": 216,
      "original_position": 216,
      "commit_id": "8b48bf19c3c020e653734f6c9d9364e6a47a30d1",
      "original_commit_id": "85946762a59c39dfe21ac899359bcac443ab8d20",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Tests are usually silent, so this should be removed (or maybe put in some verbose/debug #if block, though I'm not sure if this is considered a good idea due to increased maintenance burden):\r\n```suggestion\r\n```",
      "created_at": "2024-04-22T15:49:34Z",
      "updated_at": "2024-04-22T16:26:35Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1574990516",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1574990516"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": 215,
      "original_start_line": 215,
      "start_side": "RIGHT",
      "line": 216,
      "original_line": 216,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1575010116",
      "pull_request_review_id": 2015096769,
      "id": 1575010116,
      "node_id": "PRRC_kwDOAP4Jqs5d4L9E",
      "diff_hunk": "@@ -433,4 +433,137 @@ int secp256k1_silentpayments_recipient_public_data_parse(const secp256k1_context\n     return 1;\n }\n \n+int secp256k1_silentpayments_recipient_scan_outputs(\n+    const secp256k1_context *ctx,\n+    secp256k1_silentpayments_found_output **found_outputs, size_t *n_found_outputs,\n+    const secp256k1_xonly_pubkey * const *tx_outputs, size_t n_tx_outputs,\n+    const unsigned char *scan_key,\n+    const secp256k1_silentpayments_public_data *public_data,\n+    const secp256k1_pubkey *receiver_spend_pubkey,\n+    const secp256k1_silentpayments_label_lookup label_lookup,\n+    const void *label_context\n+) {\n+    secp256k1_scalar t_k_scalar;\n+    secp256k1_ge receiver_spend_pubkey_ge;\n+    secp256k1_xonly_pubkey P_output_xonly;\n+    secp256k1_pubkey A_sum;\n+    unsigned char shared_secret[33];\n+    size_t i, k, n_found;\n+    int found, combined;\n+\n+    /* Sanity check inputs */\n+    VERIFY_CHECK(ctx != NULL);\n+    ARG_CHECK(found_outputs != NULL);\n+    ARG_CHECK(tx_outputs != NULL);\n+    ARG_CHECK(scan_key != NULL);\n+    ARG_CHECK(public_data != NULL);\n+    combined = (int)public_data->data[0];\n+    {\n+        unsigned char input_hash[32];\n+        unsigned char *input_hash_ptr;\n+        if (combined) {\n+            input_hash_ptr = NULL;\n+        } else {\n+            memset(input_hash, 0, 32);\n+            input_hash_ptr = input_hash;\n+        }\n+        if (!secp256k1_silentpayments_recipient_public_data_load(ctx, &A_sum, input_hash_ptr, public_data)) {\n+            return 0;\n+        }\n+        secp256k1_pubkey_load(ctx, &receiver_spend_pubkey_ge, receiver_spend_pubkey);\n+        if (!secp256k1_silentpayments_create_shared_secret(ctx, shared_secret, scan_key, &A_sum, input_hash_ptr)) {\n+            return 0;\n+        }\n+    }\n+\n+    n_found = 0;\n+    k = 0;\n+    while (1) {\n+        secp256k1_ge P_output_ge = receiver_spend_pubkey_ge;\n+        /* Calculate t_k = hash(shared_secret || ser_32(k)) */\n+        secp256k1_silentpayments_create_t_k(&t_k_scalar, shared_secret, k);\n+\n+        /* Calculate P_output = B_spend + t_k * G */\n+        if (!secp256k1_eckey_pubkey_tweak_add(&P_output_ge, &t_k_scalar)) {\n+            return 0;\n+        }\n+\n+        /* If the calculated output matches the one from the tx, we have a direct match and can\n+         * return without labels calculation (one of the two would result in point of infinity) */\n+        secp256k1_xonly_pubkey_save(&P_output_xonly, &P_output_ge);\n+        found = 0;\n+        for (i = 0; i < n_tx_outputs; i++) {\n+            if (secp256k1_xonly_pubkey_cmp(ctx, &P_output_xonly, tx_outputs[i]) == 0) {\n+                found_outputs[n_found]->output = *tx_outputs[i];\n+                secp256k1_scalar_get_b32(found_outputs[n_found]->tweak, &t_k_scalar);\n+                found = 1;\n+                n_found++;\n+                k++;\n+                break;\n+            }\n+\n+            /* If desired, also calculate label candidates */\n+            if (label_lookup != NULL) {",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": 506,
      "original_position": 74,
      "commit_id": "8b48bf19c3c020e653734f6c9d9364e6a47a30d1",
      "original_commit_id": "f113564298e8e76813289fdcefa6968462dc3fda",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The handling of the first and second scan label candidate look quite similar (both their calculation and the setting of the found output / advancing the counters if the label lookup in the cache was successful), seems like quite a bit of code could be duplicated here.",
      "created_at": "2024-04-22T16:01:32Z",
      "updated_at": "2024-04-22T16:26:35Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1575010116",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1575010116"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": 505,
      "original_start_line": 505,
      "start_side": "RIGHT",
      "line": 506,
      "original_line": 506,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1575023482",
      "pull_request_review_id": 2015096769,
      "id": 1575023482,
      "node_id": "PRRC_kwDOAP4Jqs5d4PN6",
      "diff_hunk": "@@ -40,6 +40,59 @@ typedef struct {\n     size_t index;\n } secp256k1_silentpayments_recipient;\n \n+/** Create Silent Payment outputs for recipient(s).\n+ *\n+ * Given a list of n private keys a_1...a_n (one for each silent payment\n+ * eligible input to spend), a serialized outpoint, and a list of recipients,\n+ * create the taproot outputs:\n+ *\n+ * a_sum = a_1 + a_2 + ... + a_n\n+ * input_hash = hash(outpoint_smallest || (a_sum * G))\n+ * taproot_output = B_spend + hash(a_sum * input_hash * B_scan || k) * G\n+ *\n+ * If necessary, the private keys are negated to enforce the right y-parity.\n+ * For that reason, the private keys have to be passed in via two different parameter\n+ * pairs, depending on whether they seckeys correspond to x-only outputs or not.\n+ *\n+ *  Returns: 1 if shared secret creation was successful. 0 if an error occured.\n+ *   Args:                 ctx: pointer to a context object\n+ *    Out:   generated_outputs: pointer to an array of pointers to xonly pubkeys, one per recipient.\n+ *                              The order of outputs here matches the original ordering of the\n+ *                              recipients array.\n+ *     In:          recipients: pointer to an array of pointers to silent payment recipients,",
      "path": "include/secp256k1_silentpayments.h",
      "position": 62,
      "original_position": 23,
      "commit_id": "8b48bf19c3c020e653734f6c9d9364e6a47a30d1",
      "original_commit_id": "14ca7545780a1a60a5039a677546c066988654c0",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Considering that the array is sorted in-place, is this in the category \"In/Out\"?",
      "created_at": "2024-04-22T16:10:37Z",
      "updated_at": "2024-04-22T16:26:35Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1575023482",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1575023482"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 62,
      "original_line": 62,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1575037779",
      "pull_request_review_id": 2015096769,
      "id": 1575037779,
      "node_id": "PRRC_kwDOAP4Jqs5d4StT",
      "diff_hunk": "@@ -173,4 +173,94 @@ int secp256k1_silentpayments_create_output_pubkey(const secp256k1_context *ctx,\n     return 1;\n }\n \n+int secp256k1_silentpayments_sender_create_outputs(\n+    const secp256k1_context *ctx,\n+    secp256k1_xonly_pubkey **generated_outputs,\n+    const secp256k1_silentpayments_recipient **recipients,\n+    size_t n_recipients,\n+    const unsigned char *outpoint_smallest36,\n+    const secp256k1_keypair * const *taproot_seckeys,\n+    size_t n_taproot_seckeys,\n+    const unsigned char * const *plain_seckeys,\n+    size_t n_plain_seckeys\n+) {\n+    size_t i, k;\n+    secp256k1_scalar a_sum_scalar, addend;\n+    secp256k1_ge A_sum_ge;\n+    secp256k1_gej A_sum_gej;\n+    unsigned char input_hash[32];\n+    unsigned char a_sum[32];\n+    unsigned char shared_secret[33];\n+    secp256k1_silentpayments_recipient last_recipient;\n+\n+    /* Sanity check inputs. */\n+    VERIFY_CHECK(ctx != NULL);\n+    ARG_CHECK(recipients != NULL);\n+    ARG_CHECK(secp256k1_ecmult_gen_context_is_built(&ctx->ecmult_gen_ctx));\n+    ARG_CHECK(plain_seckeys == NULL || n_plain_seckeys >= 1);\n+    ARG_CHECK(taproot_seckeys == NULL || n_taproot_seckeys >= 1);\n+    ARG_CHECK((plain_seckeys != NULL) || (taproot_seckeys != NULL));\n+    ARG_CHECK((n_plain_seckeys + n_taproot_seckeys) >= 1);\n+    ARG_CHECK(outpoint_smallest36 != NULL);\n+    /* ensure the index field is set correctly */\n+    for (i = 0; i < n_recipients; i++) {\n+        ARG_CHECK(recipients[i]->index == i);\n+    }\n+\n+    /* Compute input private keys sum: a_sum = a_1 + a_2 + ... + a_n */\n+    a_sum_scalar = secp256k1_scalar_zero;\n+    for (i = 0; i < n_plain_seckeys; i++) {\n+        int ret = secp256k1_scalar_set_b32_seckey(&addend, plain_seckeys[i]);\n+        VERIFY_CHECK(ret);\n+        (void)ret;\n+\n+        secp256k1_scalar_add(&a_sum_scalar, &a_sum_scalar, &addend);\n+        VERIFY_CHECK(!secp256k1_scalar_is_zero(&a_sum_scalar));\n+    }\n+    /* private keys used for taproot outputs have to be negated if they resulted in an odd point */\n+    for (i = 0; i < n_taproot_seckeys; i++) {\n+        secp256k1_ge addend_point;\n+        int ret = secp256k1_keypair_load(ctx, &addend, &addend_point, taproot_seckeys[i]);\n+        VERIFY_CHECK(ret);\n+        (void)ret;\n+        /* declassify addend_point to allow using it as a branch point (this is fine because addend_point is not a secret) */\n+        secp256k1_declassify(ctx, &addend_point, sizeof(addend_point));\n+        secp256k1_fe_normalize_var(&addend_point.y);",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": 228,
      "original_position": 56,
      "commit_id": "8b48bf19c3c020e653734f6c9d9364e6a47a30d1",
      "original_commit_id": "14ca7545780a1a60a5039a677546c066988654c0",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Now that we get the point from a keypair instance, I think these lines are not needed anymore (see e.g. [a similar secret key negation code part in the schnorrsig module](https://github.com/bitcoin-core/secp256k1/blob/da515074e3ebc8abc85a4fff3a31d7694ecf897b/src/modules/schnorrsig/main_impl.h#L154-L160)):\r\n```suggestion\r\n```",
      "created_at": "2024-04-22T16:22:16Z",
      "updated_at": "2024-04-22T16:26:35Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1575037779",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1575037779"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": 226,
      "original_start_line": 226,
      "start_side": "RIGHT",
      "line": 228,
      "original_line": 228,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1575039817",
      "pull_request_review_id": 2015096769,
      "id": 1575039817,
      "node_id": "PRRC_kwDOAP4Jqs5d4TNJ",
      "diff_hunk": "@@ -173,4 +173,94 @@ int secp256k1_silentpayments_create_output_pubkey(const secp256k1_context *ctx,\n     return 1;\n }\n \n+int secp256k1_silentpayments_sender_create_outputs(\n+    const secp256k1_context *ctx,\n+    secp256k1_xonly_pubkey **generated_outputs,\n+    const secp256k1_silentpayments_recipient **recipients,\n+    size_t n_recipients,\n+    const unsigned char *outpoint_smallest36,\n+    const secp256k1_keypair * const *taproot_seckeys,\n+    size_t n_taproot_seckeys,\n+    const unsigned char * const *plain_seckeys,\n+    size_t n_plain_seckeys\n+) {\n+    size_t i, k;\n+    secp256k1_scalar a_sum_scalar, addend;\n+    secp256k1_ge A_sum_ge;\n+    secp256k1_gej A_sum_gej;\n+    unsigned char input_hash[32];\n+    unsigned char a_sum[32];\n+    unsigned char shared_secret[33];\n+    secp256k1_silentpayments_recipient last_recipient;\n+\n+    /* Sanity check inputs. */\n+    VERIFY_CHECK(ctx != NULL);\n+    ARG_CHECK(recipients != NULL);\n+    ARG_CHECK(secp256k1_ecmult_gen_context_is_built(&ctx->ecmult_gen_ctx));\n+    ARG_CHECK(plain_seckeys == NULL || n_plain_seckeys >= 1);\n+    ARG_CHECK(taproot_seckeys == NULL || n_taproot_seckeys >= 1);\n+    ARG_CHECK((plain_seckeys != NULL) || (taproot_seckeys != NULL));\n+    ARG_CHECK((n_plain_seckeys + n_taproot_seckeys) >= 1);\n+    ARG_CHECK(outpoint_smallest36 != NULL);\n+    /* ensure the index field is set correctly */\n+    for (i = 0; i < n_recipients; i++) {\n+        ARG_CHECK(recipients[i]->index == i);\n+    }\n+\n+    /* Compute input private keys sum: a_sum = a_1 + a_2 + ... + a_n */\n+    a_sum_scalar = secp256k1_scalar_zero;\n+    for (i = 0; i < n_plain_seckeys; i++) {\n+        int ret = secp256k1_scalar_set_b32_seckey(&addend, plain_seckeys[i]);\n+        VERIFY_CHECK(ret);\n+        (void)ret;\n+\n+        secp256k1_scalar_add(&a_sum_scalar, &a_sum_scalar, &addend);\n+        VERIFY_CHECK(!secp256k1_scalar_is_zero(&a_sum_scalar));\n+    }\n+    /* private keys used for taproot outputs have to be negated if they resulted in an odd point */\n+    for (i = 0; i < n_taproot_seckeys; i++) {\n+        secp256k1_ge addend_point;\n+        int ret = secp256k1_keypair_load(ctx, &addend, &addend_point, taproot_seckeys[i]);\n+        VERIFY_CHECK(ret);",
      "path": "src/modules/silentpayments/main_impl.h",
      "position": 224,
      "original_position": 52,
      "commit_id": "8b48bf19c3c020e653734f6c9d9364e6a47a30d1",
      "original_commit_id": "14ca7545780a1a60a5039a677546c066988654c0",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Should we return an error (i.e. `return 0`) here if the user passes in an invalid keypair?",
      "created_at": "2024-04-22T16:24:01Z",
      "updated_at": "2024-04-22T16:26:35Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1575039817",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1575039817"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": 223,
      "original_start_line": 223,
      "start_side": "RIGHT",
      "line": 224,
      "original_line": 224,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1577437389",
      "pull_request_review_id": 2019121206,
      "id": 1577437389,
      "node_id": "PRRC_kwDOAP4Jqs5eBcjN",
      "diff_hunk": "@@ -40,6 +40,59 @@ typedef struct {\n     size_t index;\n } secp256k1_silentpayments_recipient;\n \n+/** Create Silent Payment outputs for recipient(s).\n+ *\n+ * Given a list of n private keys a_1...a_n (one for each silent payment\n+ * eligible input to spend), a serialized outpoint, and a list of recipients,\n+ * create the taproot outputs:\n+ *\n+ * a_sum = a_1 + a_2 + ... + a_n\n+ * input_hash = hash(outpoint_smallest || (a_sum * G))\n+ * taproot_output = B_spend + hash(a_sum * input_hash * B_scan || k) * G\n+ *\n+ * If necessary, the private keys are negated to enforce the right y-parity.\n+ * For that reason, the private keys have to be passed in via two different parameter\n+ * pairs, depending on whether they seckeys correspond to x-only outputs or not.\n+ *\n+ *  Returns: 1 if shared secret creation was successful. 0 if an error occured.\n+ *   Args:                 ctx: pointer to a context object\n+ *    Out:   generated_outputs: pointer to an array of pointers to xonly pubkeys, one per recipient.\n+ *                              The order of outputs here matches the original ordering of the\n+ *                              recipients array.\n+ *     In:          recipients: pointer to an array of pointers to silent payment recipients,",
      "path": "include/secp256k1_silentpayments.h",
      "position": 62,
      "original_position": 23,
      "commit_id": "8b48bf19c3c020e653734f6c9d9364e6a47a30d1",
      "original_commit_id": "14ca7545780a1a60a5039a677546c066988654c0",
      "in_reply_to_id": 1575023482,
      "user": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Good question. I would argue no, since the caller is passing the array in and then never using it again. The fact that the array is sorted in place is irrelevant to the caller since they shouldn't be reading those values again, anyways. But maybe there is a more strict definition of In/Out, that if the function can modify the parameter it is an Out param?",
      "created_at": "2024-04-24T07:46:38Z",
      "updated_at": "2024-04-24T07:46:38Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1577437389",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1577437389"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 62,
      "original_line": 62,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1577545322",
      "pull_request_review_id": 2019306258,
      "id": 1577545322,
      "node_id": "PRRC_kwDOAP4Jqs5eB25q",
      "diff_hunk": "@@ -40,6 +40,59 @@ typedef struct {\n     size_t index;\n } secp256k1_silentpayments_recipient;\n \n+/** Create Silent Payment outputs for recipient(s).\n+ *\n+ * Given a list of n private keys a_1...a_n (one for each silent payment\n+ * eligible input to spend), a serialized outpoint, and a list of recipients,\n+ * create the taproot outputs:\n+ *\n+ * a_sum = a_1 + a_2 + ... + a_n\n+ * input_hash = hash(outpoint_smallest || (a_sum * G))\n+ * taproot_output = B_spend + hash(a_sum * input_hash * B_scan || k) * G\n+ *\n+ * If necessary, the private keys are negated to enforce the right y-parity.\n+ * For that reason, the private keys have to be passed in via two different parameter\n+ * pairs, depending on whether they seckeys correspond to x-only outputs or not.\n+ *\n+ *  Returns: 1 if shared secret creation was successful. 0 if an error occured.\n+ *   Args:                 ctx: pointer to a context object\n+ *    Out:   generated_outputs: pointer to an array of pointers to xonly pubkeys, one per recipient.\n+ *                              The order of outputs here matches the original ordering of the\n+ *                              recipients array.\n+ *     In:          recipients: pointer to an array of pointers to silent payment recipients,",
      "path": "include/secp256k1_silentpayments.h",
      "position": 62,
      "original_position": 23,
      "commit_id": "8b48bf19c3c020e653734f6c9d9364e6a47a30d1",
      "original_commit_id": "14ca7545780a1a60a5039a677546c066988654c0",
      "in_reply_to_id": 1575023482,
      "user": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I don't think there's a definition for this case and I don't remember a precedent. \"In\" seems fine to me if the modified argument is not supposed to be read again. The doc also mentions already that the array is modified (\"The recipient array will be sorted in place\").",
      "created_at": "2024-04-24T08:59:58Z",
      "updated_at": "2024-04-24T08:59:58Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1519#discussion_r1577545322",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1577545322"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1519"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 62,
      "original_line": 62,
      "side": "RIGHT"
    }
  ]
}