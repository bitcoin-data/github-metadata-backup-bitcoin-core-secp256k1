{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777",
    "id": 3052569091,
    "node_id": "PR_kwDOAP4Jqs618oID",
    "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777",
    "diff_url": "https://github.com/bitcoin-core/secp256k1/pull/1777.diff",
    "patch_url": "https://github.com/bitcoin-core/secp256k1/pull/1777.patch",
    "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1777",
    "commits_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1777/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin-core/secp256k1/statuses/b892a33f553a8a6d356d7919fe2e5123323b341a",
    "number": 1777,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "Make SHA256 compression runtime pluggable",
    "user": {
      "login": "furszy",
      "id": 5377650,
      "node_id": "MDQ6VXNlcjUzNzc2NTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/furszy",
      "html_url": "https://github.com/furszy",
      "followers_url": "https://api.github.com/users/furszy/followers",
      "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
      "organizations_url": "https://api.github.com/users/furszy/orgs",
      "repos_url": "https://api.github.com/users/furszy/repos",
      "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/furszy/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "body": "Tackling the long-standing request #702.\r\n\r\nRight now we ship our own SHA256 implementation, a standard baseline version that does not take advantage of any hardware-optimized instruction, and it cannot be accessed by the embedding application - it is for internal usage only.\r\n\r\nThis means embedding applications often have to implement or include a different version for their use cases, wasting space on constrained environments, and in performance-sensitive setups it forces them to use a slower path than what the platform provides. Many projects already rely on tuned SHA-NI / ARMv8 / or other hardware-optimized code, so always using the baseline implementation we ship within the library is not ideal.\r\n\r\nThese changes allow users to supply their own SHA256 compression function at runtime, while preserving the existing default behavior for everyone else. This is primarily intended for environments where the available SHA256 implementation is detected dynamically and recompiling the library with a different implementation is not feasible (equivalent build-time functionality will come in a follow-up PR).\r\n\r\nIt introduces a new API:\r\n\r\n```C89\r\nsecp256k1_context_set_sha256_transform_callback(ctx, fn_transform)\r\n```\r\n\r\nThis function installs the optimized SHA256 compression into the `secp256k1_context`, which is then used by all internal computations. Important: The provided function is verified to be output-equivalent to the original one.\r\n\r\nAs a quick example, using this functionality in Bitcoin-Core will be very straightforward: https://github.com/furszy/bitcoin-core/commit/f68bef06d95a589859f98fc898dd80ab2e35eb39",
    "labels": [
      {
        "id": 4975353639,
        "node_id": "LA_kwDOAP4Jqs8AAAABKI3fJw",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/labels/feature",
        "name": "feature",
        "description": "",
        "color": "731E95",
        "default": false
      },
      {
        "id": 4975362431,
        "node_id": "LA_kwDOAP4Jqs8AAAABKI4Bfw",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/labels/build",
        "name": "build",
        "description": "",
        "color": "2F66C4",
        "default": false
      },
      {
        "id": 4975389731,
        "node_id": "LA_kwDOAP4Jqs8AAAABKI5sIw",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/labels/performance",
        "name": "performance",
        "description": "",
        "color": "DE3CCC",
        "default": false
      },
      {
        "id": 5492210333,
        "node_id": "LA_kwDOAP4Jqs8AAAABR1x6nQ",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/labels/needs-changelog",
        "name": "needs-changelog",
        "description": "",
        "color": "DBD8F4",
        "default": false
      }
    ],
    "created_at": "2025-11-27T23:18:33Z",
    "updated_at": "2026-02-02T18:23:31Z",
    "mergeable": true,
    "mergeable_state": "unstable",
    "merged": false,
    "merge_commit_sha": "1cb43cde455279d4c1af0c2b711a2dbe4466024f",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "furszy:2025_pluggable_sha256_transform",
      "ref": "2025_pluggable_sha256_transform",
      "sha": "b892a33f553a8a6d356d7919fe2e5123323b341a",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 1049838831,
        "node_id": "R_kgDOPpNE7w",
        "name": "secp256k1",
        "full_name": "furszy/secp256k1",
        "owner": {
          "login": "furszy",
          "id": 5377650,
          "node_id": "MDQ6VXNlcjUzNzc2NTA=",
          "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/furszy",
          "html_url": "https://github.com/furszy",
          "followers_url": "https://api.github.com/users/furszy/followers",
          "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
          "organizations_url": "https://api.github.com/users/furszy/orgs",
          "repos_url": "https://api.github.com/users/furszy/repos",
          "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/furszy/received_events",
          "type": "User",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/furszy/secp256k1",
        "description": "Optimized C library for EC operations on curve secp256k1",
        "fork": true,
        "url": "https://api.github.com/repos/furszy/secp256k1",
        "archive_url": "https://api.github.com/repos/furszy/secp256k1/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/furszy/secp256k1/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/furszy/secp256k1/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/furszy/secp256k1/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/furszy/secp256k1/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/furszy/secp256k1/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/furszy/secp256k1/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/furszy/secp256k1/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/furszy/secp256k1/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/furszy/secp256k1/contributors",
        "deployments_url": "https://api.github.com/repos/furszy/secp256k1/deployments",
        "downloads_url": "https://api.github.com/repos/furszy/secp256k1/downloads",
        "events_url": "https://api.github.com/repos/furszy/secp256k1/events",
        "forks_url": "https://api.github.com/repos/furszy/secp256k1/forks",
        "git_commits_url": "https://api.github.com/repos/furszy/secp256k1/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/furszy/secp256k1/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/furszy/secp256k1/git/tags%7B/sha%7D",
        "git_url": "git://github.com/furszy/secp256k1.git",
        "issue_comment_url": "https://api.github.com/repos/furszy/secp256k1/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/furszy/secp256k1/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/furszy/secp256k1/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/furszy/secp256k1/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/furszy/secp256k1/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/furszy/secp256k1/languages",
        "merges_url": "https://api.github.com/repos/furszy/secp256k1/merges",
        "milestones_url": "https://api.github.com/repos/furszy/secp256k1/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/furszy/secp256k1/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/furszy/secp256k1/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/furszy/secp256k1/releases%7B/id%7D",
        "ssh_url": "git@github.com:furszy/secp256k1.git",
        "stargazers_url": "https://api.github.com/repos/furszy/secp256k1/stargazers",
        "statuses_url": "https://api.github.com/repos/furszy/secp256k1/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/furszy/secp256k1/subscribers",
        "subscription_url": "https://api.github.com/repos/furszy/secp256k1/subscription",
        "tags_url": "https://api.github.com/repos/furszy/secp256k1/tags",
        "teams_url": "https://api.github.com/repos/furszy/secp256k1/teams",
        "trees_url": "https://api.github.com/repos/furszy/secp256k1/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/furszy/secp256k1.git",
        "hooks_url": "https://api.github.com/repos/furszy/secp256k1/hooks",
        "svn_url": "https://github.com/furszy/secp256k1",
        "language": "C",
        "forks_count": 0,
        "stargazers_count": 0,
        "watchers_count": 0,
        "size": 12999,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-02-02T18:23:17Z",
        "created_at": "2025-09-03T15:10:42Z",
        "updated_at": "2025-12-31T18:22:11Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin-core:master",
      "ref": "master",
      "sha": "57315a69853c9bd4765fccf20b541d47f1b45ca9",
      "user": {
        "login": "bitcoin-core",
        "id": 13464320,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEzNDY0MzIw",
        "avatar_url": "https://avatars.githubusercontent.com/u/13464320?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin-core",
        "html_url": "https://github.com/bitcoin-core",
        "followers_url": "https://api.github.com/users/bitcoin-core/followers",
        "following_url": "https://api.github.com/users/bitcoin-core/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin-core/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin-core/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin-core/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin-core/orgs",
        "repos_url": "https://api.github.com/users/bitcoin-core/repos",
        "events_url": "https://api.github.com/users/bitcoin-core/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin-core/received_events",
        "type": "Organization",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "repo": {
        "id": 16648618,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNjY0ODYxOA==",
        "name": "secp256k1",
        "full_name": "bitcoin-core/secp256k1",
        "owner": {
          "login": "bitcoin-core",
          "id": 13464320,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjEzNDY0MzIw",
          "avatar_url": "https://avatars.githubusercontent.com/u/13464320?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin-core",
          "html_url": "https://github.com/bitcoin-core",
          "followers_url": "https://api.github.com/users/bitcoin-core/followers",
          "following_url": "https://api.github.com/users/bitcoin-core/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin-core/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin-core/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin-core/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin-core/orgs",
          "repos_url": "https://api.github.com/users/bitcoin-core/repos",
          "events_url": "https://api.github.com/users/bitcoin-core/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin-core/received_events",
          "type": "Organization",
          "site_admin": false,
          "name": null,
          "patch_url": null
        },
        "private": false,
        "html_url": "https://github.com/bitcoin-core/secp256k1",
        "description": "Optimized C library for EC operations on curve secp256k1",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1",
        "archive_url": "https://api.github.com/repos/bitcoin-core/secp256k1/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin-core/secp256k1/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin-core/secp256k1/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin-core/secp256k1/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin-core/secp256k1/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin-core/secp256k1/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin-core/secp256k1/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin-core/secp256k1/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin-core/secp256k1/downloads",
        "events_url": "https://api.github.com/repos/bitcoin-core/secp256k1/events",
        "forks_url": "https://api.github.com/repos/bitcoin-core/secp256k1/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin-core/secp256k1.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin-core/secp256k1/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin-core/secp256k1/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin-core/secp256k1/languages",
        "merges_url": "https://api.github.com/repos/bitcoin-core/secp256k1/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin-core/secp256k1/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin-core/secp256k1/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin-core/secp256k1/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin-core/secp256k1.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin-core/secp256k1/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin-core/secp256k1/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin-core/secp256k1/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin-core/secp256k1/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin-core/secp256k1/tags",
        "teams_url": "https://api.github.com/repos/bitcoin-core/secp256k1/teams",
        "trees_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin-core/secp256k1.git",
        "hooks_url": "https://api.github.com/repos/bitcoin-core/secp256k1/hooks",
        "svn_url": "https://github.com/bitcoin-core/secp256k1",
        "language": "C",
        "forks_count": 1119,
        "stargazers_count": 2397,
        "watchers_count": 2397,
        "size": 14056,
        "default_branch": "master",
        "open_issues_count": 169,
        "is_template": false,
        "topics": [],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2026-02-02T15:20:08Z",
        "created_at": "2014-02-08T17:30:06Z",
        "updated_at": "2026-02-02T15:23:25Z",
        "allow_forking": true,
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
      }
    },
    "author_association": "MEMBER",
    "draft": false,
    "additions": 667,
    "deletions": 260,
    "changed_files": 23,
    "commits": 3,
    "review_comments": 80,
    "comments": 11
  },
  "events": [
    {
      "event": "head_ref_force_pushed",
      "id": 21245030602,
      "node_id": "HRFPE_lADOAP4Jqs7a8JDRzwAAAATyTXDK",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/21245030602",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "commit_url": "https://api.github.com/repos/furszy/secp256k1/commits/7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "created_at": "2025-11-28T15:54:47Z"
    },
    {
      "event": "commented",
      "id": 3597451370,
      "node_id": "IC_kwDOAP4Jqs7WbMBq",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3597451370",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-01T16:16:11Z",
      "updated_at": "2025-12-01T16:16:11Z",
      "author_association": "CONTRIBUTOR",
      "body": "I guess this is more of a draft for initial review but I will spell it out anyway: It's currently missing some CI coverage for building with an external library as well as some docs. Curious what people think in terms of docs for something like this: Should there be extensive guidance in which context this is safe to use or would users be left on their own to try it out? Or are we assuming all users that go to this length are competent enough to judge if it's a good idea to bring their own sha256 or use the systems one?",
      "user": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#issuecomment-3597451370",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1777"
    },
    {
      "event": "commented",
      "id": 3598403333,
      "node_id": "IC_kwDOAP4Jqs7We0cF",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3598403333",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-01T19:03:53Z",
      "updated_at": "2025-12-01T21:16:51Z",
      "author_association": "MEMBER",
      "body": "Thanks for the feedback fjahr!\r\n\r\n> I guess this is more of a draft for initial review but I will spell it out anyway: It's currently missing some CI coverage for building with an external library as well as some docs. \r\n\r\nYeah, can create a CI job testing the compile-time pluggable compression function very easily. Thanks for reminding that.\r\n\r\nAnd about the missing docs; yeah. I didn't add it because we currently don't have much documentation outside `configure.ac` / `CMakeLists.txt`. Happy to create a file for it.\r\n\r\n> Curious what people think in terms of docs for something like this: Should there be extensive guidance in which context this is safe to use or would users be left on their own to try it out? Or are we assuming all users that go to this length are competent enough to judge if it's a good idea to bring their own sha256 or use the systems one?\r\n\r\nIt’s not that we’re letting people plug in whatever they want. Both introduced features have guardrails:\r\n\r\n1) Compile-time: we run all current tests against the provided implementation, plus a runtime self-test.\r\n2) Runtime: besides the runtime self-test, have introduced an \"equivalence check\" that hashes known inputs and compares them against the library’s internal implementation before accepting the external function.\r\n\r\nSo you can bring your own compression function, but it still has to prove it behaves exactly like ours bit-for-bit.\r\n\r\nAlso, the target user here is someone who's actually written a hardware-optimized SHA256. It’s not like they stumbled into this by accident.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#issuecomment-3598403333",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1777"
    },
    {
      "event": "reviewed",
      "id": 3550658761,
      "node_id": "PRR_kwDOAP4Jqs7TosDJ",
      "url": null,
      "actor": null,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-12-08T09:26:48Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#pullrequestreview-3550658761",
      "submitted_at": "2025-12-08T09:26:48Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
    },
    {
      "event": "reviewed",
      "id": 3551060764,
      "node_id": "PRR_kwDOAP4Jqs7TqOMc",
      "url": null,
      "actor": null,
      "commit_id": "75ccf99a0751d84e098aab7c4a13170e825c0496",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-12-08T09:34:10Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#pullrequestreview-3551060764",
      "submitted_at": "2025-12-08T09:34:10Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
    },
    {
      "event": "reviewed",
      "id": 3551077587,
      "node_id": "PRR_kwDOAP4Jqs7TqSTT",
      "url": null,
      "actor": null,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-12-08T09:38:57Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#pullrequestreview-3551077587",
      "submitted_at": "2025-12-08T09:38:57Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
    },
    {
      "event": "reviewed",
      "id": 3551090512,
      "node_id": "PRR_kwDOAP4Jqs7TqVdQ",
      "url": null,
      "actor": null,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-12-08T09:42:32Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#pullrequestreview-3551090512",
      "submitted_at": "2025-12-08T09:42:32Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
    },
    {
      "event": "reviewed",
      "id": 3551364928,
      "node_id": "PRR_kwDOAP4Jqs7TrYdA",
      "url": null,
      "actor": null,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-12-08T10:44:27Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK, great to see a PR for this!",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#pullrequestreview-3551364928",
      "submitted_at": "2025-12-08T10:44:27Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
    },
    {
      "event": "labeled",
      "id": 21423282080,
      "node_id": "LE_lADOAP4Jqs7a8JDRzwAAAAT87Veg",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/21423282080",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-08T10:45:09Z",
      "label": {
        "name": "feature",
        "color": "731E95"
      }
    },
    {
      "event": "labeled",
      "id": 21423282096,
      "node_id": "LE_lADOAP4Jqs7a8JDRzwAAAAT87Vew",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/21423282096",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-08T10:45:09Z",
      "label": {
        "name": "build",
        "color": "2F66C4"
      }
    },
    {
      "event": "labeled",
      "id": 21423282108,
      "node_id": "LE_lADOAP4Jqs7a8JDRzwAAAAT87Ve8",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/21423282108",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-08T10:45:09Z",
      "label": {
        "name": "performance",
        "color": "DE3CCC"
      }
    },
    {
      "event": "labeled",
      "id": 21423282123,
      "node_id": "LE_lADOAP4Jqs7a8JDRzwAAAAT87VfL",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/21423282123",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-08T10:45:09Z",
      "label": {
        "name": "needs-changelog",
        "color": "DBD8F4"
      }
    },
    {
      "event": "reviewed",
      "id": 3579081214,
      "node_id": "PRR_kwDOAP4Jqs7VVHH-",
      "url": null,
      "actor": null,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-12-15T16:24:32Z",
      "author_association": "MEMBER",
      "body": "Concept ACK.",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#pullrequestreview-3579081214",
      "submitted_at": "2025-12-15T16:24:32Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21603012377,
      "node_id": "HRFPE_lADOAP4Jqs7a8JDRzwAAAAUHo88Z",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/21603012377",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "3683e07ef4b6a062eec1776220eeeec0c30bc2ec",
      "commit_url": "https://api.github.com/repos/furszy/secp256k1/commits/3683e07ef4b6a062eec1776220eeeec0c30bc2ec",
      "created_at": "2025-12-16T21:45:40Z"
    },
    {
      "event": "reviewed",
      "id": 3563595127,
      "node_id": "PRR_kwDOAP4Jqs7UaCV3",
      "url": null,
      "actor": null,
      "commit_id": "3683e07ef4b6a062eec1776220eeeec0c30bc2ec",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-12-16T21:48:22Z",
      "author_association": "MEMBER",
      "body": "Update pushed, thanks for the deep review real_or_random!\r\nI haven’t fully finished addressing all the comments yet, but I'll hopefully finish tomorrow. So many good topics.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#pullrequestreview-3563595127",
      "submitted_at": "2025-12-16T21:48:22Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
    },
    {
      "event": "commented",
      "id": 3666883503,
      "node_id": "IC_kwDOAP4Jqs7akDOv",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3666883503",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-17T19:44:17Z",
      "updated_at": "2025-12-17T19:45:30Z",
      "author_association": "CONTRIBUTOR",
      "body": "A few high-level comments:\r\n* I don't think we should do link-time plugging in the same PR as runtime plugging, and when we do, I don't think it should be done through the \"module\" abstractions. We use modules for exporting functionality from the library, not for offering replacement of internal dependencies (I find it strange to have base functionality depend on a module!).\r\n* \"round\" is a term of art in cipher design, and SHA-256 has exactly 64 rounds. Using the same term with another meaning is confusing.\r\n* I would try hard to avoid storing the transformation function pointer inside the `secp256k1_sha256` struct. Reviewing many lines that just add an extra parameter being pass through is not hard.",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#issuecomment-3666883503",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1777"
    },
    {
      "event": "reviewed",
      "id": 3594435763,
      "node_id": "PRR_kwDOAP4Jqs7WPryz",
      "url": null,
      "actor": null,
      "commit_id": "3683e07ef4b6a062eec1776220eeeec0c30bc2ec",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-12-18T18:31:46Z",
      "author_association": "MEMBER",
      "body": "Per feedback, this is how it would look if we pass the function everywhere https://github.com/furszy/secp256k1/commit/8149fc119071c532e9d2d6c3b633af7a37e5a0b8 vs how it looks when the function lives in the `sha256` struct (an updated version of what we currently have here): https://github.com/furszy/secp256k1/commit/eb570826371f42a5bd320f8e43800281b1f63b0a\r\n\r\nLet me know what you guys think.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#pullrequestreview-3594435763",
      "submitted_at": "2025-12-18T18:31:46Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
    },
    {
      "event": "commented",
      "id": 3672373890,
      "node_id": "IC_kwDOAP4Jqs7a4_qC",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3672373890",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-18T21:41:32Z",
      "updated_at": "2025-12-18T21:41:32Z",
      "author_association": "CONTRIBUTOR",
      "body": "@furszy From a quick glance, the passing of the function everywhere is fine I think.\r\n\r\nI'd suggest passing a pointer to `secp256k1_hash_context` to the sha256 functions rather than the function pointer itself. That makes it easier to (if ever) add additional fields to that context.",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#issuecomment-3672373890",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1777"
    },
    {
      "event": "mentioned",
      "id": 21655030794,
      "node_id": "MEE_lADOAP4Jqs7a8JDRzwAAAAUKvYwK",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/21655030794",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-18T21:41:33Z"
    },
    {
      "event": "subscribed",
      "id": 21655030819,
      "node_id": "SE_lADOAP4Jqs7a8JDRzwAAAAUKvYwj",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/21655030819",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-18T21:41:33Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21675548366,
      "node_id": "HRFPE_lADOAP4Jqs7a8JDRzwAAAAUL9p7O",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/21675548366",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "2413e92be5313abb477accb5effbb3121a06167b",
      "commit_url": "https://api.github.com/repos/furszy/secp256k1/commits/2413e92be5313abb477accb5effbb3121a06167b",
      "created_at": "2025-12-19T17:52:48Z"
    },
    {
      "event": "reviewed",
      "id": 3599532221,
      "node_id": "PRR_kwDOAP4Jqs7WjIC9",
      "url": null,
      "actor": null,
      "commit_id": "2413e92be5313abb477accb5effbb3121a06167b",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2025-12-19T18:02:24Z",
      "author_association": "MEMBER",
      "body": "Updated per feedback. We now pass the hash context to all functions that need it, without storing any state inside the `sha256` struct. The API arg \"rounds\" has also been renamed to \"blocks\" to prevent confusion with existing terms. Also, the commit introducing the compile-time feature has been removed for inclusion at a later stage (see https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2598064155 for more details).",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#pullrequestreview-3599532221",
      "submitted_at": "2025-12-19T17:58:48Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
    },
    {
      "event": "commented",
      "id": 3676328319,
      "node_id": "IC_kwDOAP4Jqs7bIFF_",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3676328319",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-19T19:49:19Z",
      "updated_at": "2026-01-06T13:46:30Z",
      "author_association": "CONTRIBUTOR",
      "body": "Nice, I hope I'll find the time have another look soon ",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#issuecomment-3676328319",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1777"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 21677728644,
      "node_id": "HRFPE_lADOAP4Jqs7a8JDRzwAAAAUMF-OE",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/21677728644",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "commit_url": "https://api.github.com/repos/furszy/secp256k1/commits/041a6217fa709b17ae869a75ac2bba0d217f49db",
      "created_at": "2025-12-19T20:08:55Z"
    },
    {
      "event": "commented",
      "id": 3685648420,
      "node_id": "IC_kwDOAP4Jqs7brogk",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3685648420",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2025-12-23T08:08:58Z",
      "updated_at": "2026-01-06T13:46:35Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Nice, I hope I'll find the time have another look soon\r\n\r\nSorry, I didn't manage to find the time before the holidays...",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#issuecomment-3685648420",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1777"
    },
    {
      "event": "reviewed",
      "id": 3630308699,
      "node_id": "PRR_kwDOAP4Jqs7YYh1b",
      "url": null,
      "actor": null,
      "commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-01-06T13:46:08Z",
      "author_association": "CONTRIBUTOR",
      "body": "Approach ACK",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#pullrequestreview-3630308699",
      "submitted_at": "2026-01-06T13:46:08Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22026344152,
      "node_id": "HRFPE_lADOAP4Jqs7a8JDRzwAAAAUg31bY",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22026344152",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "commit_url": "https://api.github.com/repos/furszy/secp256k1/commits/fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "created_at": "2026-01-13T20:01:39Z"
    },
    {
      "event": "commented",
      "id": 3746344933,
      "node_id": "IC_kwDOAP4Jqs7fTK_l",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3746344933",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-13T20:04:35Z",
      "updated_at": "2026-01-13T20:04:35Z",
      "author_association": "MEMBER",
      "body": "Updated per feedback. Thanks @real-or-random!",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#issuecomment-3746344933",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1777"
    },
    {
      "event": "mentioned",
      "id": 22026412286,
      "node_id": "MEE_lADOAP4Jqs7a8JDRzwAAAAUg4GD-",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22026412286",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-13T20:04:37Z"
    },
    {
      "event": "subscribed",
      "id": 22026412322,
      "node_id": "SE_lADOAP4Jqs7a8JDRzwAAAAUg4GEi",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22026412322",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-13T20:04:37Z"
    },
    {
      "event": "reviewed",
      "id": 3657760411,
      "node_id": "PRR_kwDOAP4Jqs7aBP6b",
      "url": null,
      "actor": null,
      "commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-01-13T20:48:12Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#pullrequestreview-3657760411",
      "submitted_at": "2026-01-13T20:48:12Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22049002237,
      "node_id": "HRFPE_lADOAP4Jqs7a8JDRzwAAAAUiORL9",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22049002237",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "8b45a8ff589560350ed8918d258b303adf990019",
      "commit_url": "https://api.github.com/repos/furszy/secp256k1/commits/8b45a8ff589560350ed8918d258b303adf990019",
      "created_at": "2026-01-14T17:19:24Z"
    },
    {
      "event": "reviewed",
      "id": 3691189188,
      "node_id": "PRR_kwDOAP4Jqs7cAxPE",
      "url": null,
      "actor": null,
      "commit_id": "8b45a8ff589560350ed8918d258b303adf990019",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-01-22T08:31:22Z",
      "author_association": "CONTRIBUTOR",
      "body": "two nits on the last commit (I like that one!)",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#pullrequestreview-3691189188",
      "submitted_at": "2026-01-22T08:31:22Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
    },
    {
      "event": "reviewed",
      "id": 3691631622,
      "node_id": "PRR_kwDOAP4Jqs7cCdQG",
      "url": null,
      "actor": null,
      "commit_id": "8b45a8ff589560350ed8918d258b303adf990019",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-01-22T10:07:05Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#pullrequestreview-3691631622",
      "submitted_at": "2026-01-22T10:07:05Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22225280572,
      "node_id": "HRFPE_lADOAP4Jqs7a8JDRzwAAAAUsut48",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22225280572",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "82519578a640eafeebe65c4ea72e4839d397e0c7",
      "commit_url": "https://api.github.com/repos/furszy/secp256k1/commits/82519578a640eafeebe65c4ea72e4839d397e0c7",
      "created_at": "2026-01-22T19:49:37Z"
    },
    {
      "event": "renamed",
      "id": 22225621196,
      "node_id": "RTE_lADOAP4Jqs7a8JDRzwAAAAUswBDM",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22225621196",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T20:06:45Z",
      "rename": {
        "from": "Make SHA256 compression pluggable",
        "to": "Make SHA256 compression runtime pluggable"
      }
    },
    {
      "event": "reviewed",
      "id": 3694569639,
      "node_id": "PRR_kwDOAP4Jqs7cNqin",
      "url": null,
      "actor": null,
      "commit_id": "82519578a640eafeebe65c4ea72e4839d397e0c7",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-01-22T20:58:55Z",
      "author_association": "CONTRIBUTOR",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#pullrequestreview-3694569639",
      "submitted_at": "2026-01-22T20:58:55Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22250418851,
      "node_id": "HRFPE_lADOAP4Jqs7a8JDRzwAAAAUuOnKj",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22250418851",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "0182e3d61f77909c01923d7e269ff8fde9381234",
      "commit_url": "https://api.github.com/repos/furszy/secp256k1/commits/0182e3d61f77909c01923d7e269ff8fde9381234",
      "created_at": "2026-01-23T18:55:25Z"
    },
    {
      "event": "commented",
      "id": 3791835989,
      "node_id": "IC_kwDOAP4Jqs7iAtNV",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3791835989",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-23T19:02:42Z",
      "updated_at": "2026-01-23T19:02:42Z",
      "author_association": "MEMBER",
      "body": "Updated per feedback regarding the tests. Thanks, real-or-random!\r\n\r\nI also ended up reorganizing the PR slightly differently:\r\n* The first commit introduces the hash context with all the mechanical changes.\r\n* The second commit adds the API to allow supplying the compression function (and new tests).\r\n* And the third commit implements the multi-block compression speedup.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#issuecomment-3791835989",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1777"
    },
    {
      "event": "commented",
      "id": 3792125024,
      "node_id": "IC_kwDOAP4Jqs7iBzxg",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3792125024",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-23T19:57:59Z",
      "updated_at": "2026-01-23T19:57:59Z",
      "author_association": "CONTRIBUTOR",
      "body": "CI has some segfaults unfortunately. Here's the relevant snippet from valgrind:\r\n\r\n```\r\n  ==3305== Invalid read of size 4\r\n  ==3305==    at 0x1237F7: secp256k1_read_be32 (util.h:419)\r\n  ==3305==    by 0x1237F7: secp256k1_sha256_transform_impl (hash_impl.h:48)\r\n  ==3305==    by 0x1237F7: secp256k1_sha256_transform (hash_impl.h:128)\r\n  ==3305==    by 0x110EA9: secp256k1_sha256_write (hash_impl.h:160)\r\n  ==3305==    by 0x11CE35: ellswift_xdh_hash_function_prefix_impl (main_impl.h:501)\r\n  ==3305==    by 0x11CE35: secp256k1_ellswift_xdh (main_impl.h:587)\r\n  ==3305==    by 0x1222D6: ellswift_xdh_ctx_sha256_tests (tests_impl.h:450)\r\n  ==3305==    by 0x122ECE: run_sequential (unit_test.c:275)\r\n  ==3305==    by 0x122ECE: tf_run (unit_test.c:464)\r\n  ==3305==    by 0x122ECE: main (???:8016)\r\n  ==3305==  Address 0x0 is not stack'd, malloc'd or (recently) free'd\r\n```",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#issuecomment-3792125024",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1777"
    },
    {
      "event": "commented",
      "id": 3792208198,
      "node_id": "IC_kwDOAP4Jqs7iCIFG",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3792208198",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-23T20:16:41Z",
      "updated_at": "2026-01-23T20:16:41Z",
      "author_association": "MEMBER",
      "body": "> CI has some segfaults unfortunately. Here's the relevant snippet from valgrind:\r\n> \r\n> ```\r\n>   ==3305== Invalid read of size 4\r\n>   ==3305==    at 0x1237F7: secp256k1_read_be32 (util.h:419)\r\n>   ==3305==    by 0x1237F7: secp256k1_sha256_transform_impl (hash_impl.h:48)\r\n>   ==3305==    by 0x1237F7: secp256k1_sha256_transform (hash_impl.h:128)\r\n>   ==3305==    by 0x110EA9: secp256k1_sha256_write (hash_impl.h:160)\r\n>   ==3305==    by 0x11CE35: ellswift_xdh_hash_function_prefix_impl (main_impl.h:501)\r\n>   ==3305==    by 0x11CE35: secp256k1_ellswift_xdh (main_impl.h:587)\r\n>   ==3305==    by 0x1222D6: ellswift_xdh_ctx_sha256_tests (tests_impl.h:450)\r\n>   ==3305==    by 0x122ECE: run_sequential (unit_test.c:275)\r\n>   ==3305==    by 0x122ECE: tf_run (unit_test.c:464)\r\n>   ==3305==    by 0x122ECE: main (???:8016)\r\n>   ==3305==  Address 0x0 is not stack'd, malloc'd or (recently) free'd\r\n> ```\r\n\r\nyep, was working on it. Nothing serious. See https://github.com/bitcoin-core/secp256k1/pull/1806.\r\nWill push the small fix here shortly.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#issuecomment-3792208198",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1777"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22251970191,
      "node_id": "HRFPE_lADOAP4Jqs7a8JDRzwAAAAUuUh6P",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22251970191",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "406d9058acf52b861479a0ca9991f7a75712216e",
      "commit_url": "https://api.github.com/repos/furszy/secp256k1/commits/406d9058acf52b861479a0ca9991f7a75712216e",
      "created_at": "2026-01-23T20:22:36Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22252625680,
      "node_id": "HRFPE_lADOAP4Jqs7a8JDRzwAAAAUuXB8Q",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22252625680",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "4c0b80e9923f6290b42cec9ba4958a9d885f201e",
      "commit_url": "https://api.github.com/repos/furszy/secp256k1/commits/4c0b80e9923f6290b42cec9ba4958a9d885f201e",
      "created_at": "2026-01-23T20:56:25Z"
    },
    {
      "event": "commented",
      "id": 3792930137,
      "node_id": "IC_kwDOAP4Jqs7iE4VZ",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3792930137",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-23T22:54:18Z",
      "updated_at": "2026-01-23T22:54:18Z",
      "author_association": "MEMBER",
      "body": "CI green again. Ready to go.",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#issuecomment-3792930137",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1777"
    },
    {
      "event": "reviewed",
      "id": 3740886096,
      "node_id": "PRR_kwDOAP4Jqs7e-WRQ",
      "url": null,
      "actor": null,
      "commit_id": "4c0b80e9923f6290b42cec9ba4958a9d885f201e",
      "commit_url": null,
      "created_at": null,
      "updated_at": "2026-02-02T17:39:44Z",
      "author_association": "CONTRIBUTOR",
      "body": "Concept ACK\n\nI extended your example usage commit in Bitcoin Core to use the SHA256 HW acceleration also for signature verification functions (currently they wouldn't used it since we pass the static context) and based in on the new P2TR schnorr verification benchmark PR https://github.com/bitcoin/bitcoin/pull/34472: https://github.com/theStack/bitcoin/commit/296ec21c0e9b3612f07295e54b7ca2b2c1b10a19\n\nThe relevant benchmarks can be executed via:\n```\n$ ./build/bin/bench_bitcoin -filter=SignTransaction.*\\|VerifyScript.*\\|ConnectBlock.*\n```\n\nUnfortunately the benchmarks results fluctuate too much on the machine I'm currently working on, so posting the results wouldn't have much meaning yet. Will try to establish a stable environment and come back to that later. Maybe it is useful for other reviewers already.",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#pullrequestreview-3740886096",
      "submitted_at": "2026-02-02T17:39:44Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDQyYTk3M2Y3MjZjYTQ1OGFhMzVlY2VlMjI1MWIzZjhkNTg2YWM4NGI",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/42a973f726ca458aa35ecee2251b3f8d586ac84b",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/42a973f726ca458aa35ecee2251b3f8d586ac84b",
      "tree": {
        "sha": "52715ed911ac7fc2de4d332afb6e527e3a2af221",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/52715ed911ac7fc2de4d332afb6e527e3a2af221"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 52715ed911ac7fc2de4d332afb6e527e3a2af221\nparent 8d445730ec79a9fa722eea59b6b697c3b9b1d501\nauthor furszy <matiasfurszyfer@protonmail.com> 1765988133 -0500\ncommitter furszy <matiasfurszyfer@protonmail.com> 1770056565 -0500\n\nIntroduce hash context to support pluggable SHA256 compression\n\nThis is purely a mechanical change with no behavior change.\n\nIt introduces a secp256k1_hash_ctx struct inside secp256k1_context\nand propagates it to all SHA256-related operations.\n\nThis sets up the ability to provide a hardware-optimized SHA256\ncompression function at runtime in a follow-up commit.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA++0fqwRHQpmlZfQXdI8zGhqpiMFAmmA63UACgkQXdI8zGhq\npiMYag/8DORp62S/HwiaS6Pssw9bpY9Q5xVUGWkPjYJhhIA9wl+q86RSEr+CvxTw\n+fcYNWX3fWQpiILA5n2z3K/NOAeftos2Rq8zbTTpbDqgtPmlqZwif18cQo0e7oy4\nkUMgWylMIhYkHcOE7zWGhqraM/GHQti9YFW5leHDMjseZGyKWUDelXjw/4ymTC+m\n7ofnlozLI//aEK355VLnL1oOw754UyN0/dLMV9lt2jd5fAAyQoLT5yZW9+9cUR9c\nOP7MD/bwpv1hzANL3YWmUl4MHj261x6LAJI7iOzAbjjZ5dBCW4FOZTE9bN5xZdEy\nRB5f48cNOOSpskP+4SZP6d95H8aG3dTXCe0a2qcopQEl4FK/DPvo5DRHYkJq6XRI\nyJE4Gy7o9+3CN+ke66z29sqNeWP1Y3UZfTgqc4toUWkRU/AWvWOqFpqgYOo6maJY\nX0gCa36j9XgDr7QJCNy7uekenL15zaFY9fenV9G+N0ykG6kP9/SMeSFrrVtrr49B\nyHqT65x5aYTLGfkhIQM8/1IcE3A8srNkCkh7OSUDPKvDY6H+zP88gnNvLGzazEg+\nfpwj+BpKgDkjv7YQkjKfUJbqz6hg92TZGt2dXEUS0+k1nc8IvApaYcZ81UbuDC6K\n8tjx0ZyWfOwQ7YuK1nkyGkZ7m5g86STDLnLLPADkVUA1uqwxKp0=\n=p73b\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/8d445730ec79a9fa722eea59b6b697c3b9b1d501",
          "sha": "8d445730ec79a9fa722eea59b6b697c3b9b1d501",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/8d445730ec79a9fa722eea59b6b697c3b9b1d501"
        }
      ],
      "message": "Introduce hash context to support pluggable SHA256 compression\n\nThis is purely a mechanical change with no behavior change.\n\nIt introduces a secp256k1_hash_ctx struct inside secp256k1_context\nand propagates it to all SHA256-related operations.\n\nThis sets up the ability to provide a hardware-optimized SHA256\ncompression function at runtime in a follow-up commit.",
      "committer": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2026-02-02T18:22:45Z"
      },
      "author": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2025-12-17T16:15:33Z"
      },
      "sha": "42a973f726ca458aa35ecee2251b3f8d586ac84b"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKGZmMjFlZmQ1YzMzODg4MjJmM2E5ZWQ3NTYyMGFkNjAzYTFlMjM2OGI",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/ff21efd5c3388822f3a9ed75620ad603a1e2368b",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/ff21efd5c3388822f3a9ed75620ad603a1e2368b",
      "tree": {
        "sha": "c3ef157b7b65863e34c54d1785a9ad80fb1d3c2b",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/c3ef157b7b65863e34c54d1785a9ad80fb1d3c2b"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree c3ef157b7b65863e34c54d1785a9ad80fb1d3c2b\nparent 42a973f726ca458aa35ecee2251b3f8d586ac84b\nauthor furszy <matiasfurszyfer@protonmail.com> 1769193715 -0500\ncommitter furszy <matiasfurszyfer@protonmail.com> 1770056565 -0500\n\nAdd API to override SHA256 compression at runtime\n\nThis introduces `secp256k1_context_set_sha256_compression()`,\nwhich allows users to provide their own SHA256 block-compression\nfunction at runtime.\n\nThis is useful in setups where the optimal implementation is detected\ndynamically, where rebuilding the library is not possible, or when\nthe compression function is not written in bare C89.\n\nThe callback is installed on the `secp256k1_context` and is then used\nby all operations that compute SHA256 hashes. As part of the setup,\nthe library performs sanity checks to ensure that the supplied\nfunction is equivalent to the default transform.\n\nPassing NULL to the callback setter restores the built-in\nimplementation.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA++0fqwRHQpmlZfQXdI8zGhqpiMFAmmA63UACgkQXdI8zGhq\npiOtSg/+LMIwyWaGduazXfZ32pExOQDOZ56pJVrTnWrNCTJFBymTXQf3u6Pzew0+\nTCGoHuwlQR1pC64sLHdmAXCN42lfXzxHnJBgcQfynn918Z+aQ7mJvnVTBOyyEZI5\nMWCTPrZ6fgbDdBl4jXcGWr3TdRMUlt5luehv9ZawjeJHyc3BCS2LvMdnthCmJgQ5\nFT1rVLi9dOZfSq+zFgz0IW4glb2wF/hxjn4NXN3LigUu4ctwqMe997drORbVYSfP\nwKdR+AuXmoxmqxs15O133vk925TfMeIbP9suMBwu3uxSur4lxvQk1ihQ3KXLaH5c\ndpy5jpr1YnGrb0VjwsGGWsKbMlTLz/aS8GFL3EBW0iItOe/5l7CIxHNpzQio/kF0\n7+4BmtDS18eBQvPm5+awNtIks977CQ8i8DoRb1KAqyZe9lIaXDprEoMTR48tu8oO\nF94aCbHTUXtKSLvvaXD2VpVGyXlbeOJBwKgKkwlfRoK2vDOcgx2+LfDYB0D7b4uh\nQWpvtDYZ7xi5Vtm0U1cRnhQ6iDFv0NNBEHg67NF5Lg/x0XY0kPwinbonwYXBDVM5\nKs4Nbi2YS3XmzctN99k72TdTIymdwVMN+uNMffEG5GfF2lNJo70CimFKSTFerBrw\nBMaIFZd070Ma9W5SD0FBiFz1k0xtG+FB4zxCvDm8FTHjwK/44RM=\n=zdxJ\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/42a973f726ca458aa35ecee2251b3f8d586ac84b",
          "sha": "42a973f726ca458aa35ecee2251b3f8d586ac84b",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/42a973f726ca458aa35ecee2251b3f8d586ac84b"
        }
      ],
      "message": "Add API to override SHA256 compression at runtime\n\nThis introduces `secp256k1_context_set_sha256_compression()`,\nwhich allows users to provide their own SHA256 block-compression\nfunction at runtime.\n\nThis is useful in setups where the optimal implementation is detected\ndynamically, where rebuilding the library is not possible, or when\nthe compression function is not written in bare C89.\n\nThe callback is installed on the `secp256k1_context` and is then used\nby all operations that compute SHA256 hashes. As part of the setup,\nthe library performs sanity checks to ensure that the supplied\nfunction is equivalent to the default transform.\n\nPassing NULL to the callback setter restores the built-in\nimplementation.",
      "committer": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2026-02-02T18:22:45Z"
      },
      "author": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2026-01-23T18:41:55Z"
      },
      "sha": "ff21efd5c3388822f3a9ed75620ad603a1e2368b"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKGI4OTJhMzNmNTUzYThhNmQzNTZkNzkxOWZlMmU1MTIzMzIzYjM0MWE",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/b892a33f553a8a6d356d7919fe2e5123323b341a",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/b892a33f553a8a6d356d7919fe2e5123323b341a",
      "tree": {
        "sha": "c2c7dc7115303f7415fc73786e80d1697b1b3716",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/c2c7dc7115303f7415fc73786e80d1697b1b3716"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree c2c7dc7115303f7415fc73786e80d1697b1b3716\nparent ff21efd5c3388822f3a9ed75620ad603a1e2368b\nauthor furszy <matiasfurszyfer@protonmail.com> 1768411001 -0500\ncommitter furszy <matiasfurszyfer@protonmail.com> 1770056565 -0500\n\nsha256: speed up writes using multi-block compression\n\nMultiple 64-byte blocks can now be compressed directly\nfrom the input buffer, without copying them into the\ninternal buffer.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA++0fqwRHQpmlZfQXdI8zGhqpiMFAmmA63UACgkQXdI8zGhq\npiNbjxAAy+9pTqJcox6DHSkWuhdDGbQf8P5eOInl+imEfXDwXEL5ha5kdPzWDHs9\nqaaNgYEFP+JK1iimHk5bmGM45gkN5xq1eBVF5W8mewJrMLqVRX4Pn3YUvhog30Xs\n74i+9oGR+WakjySddpsdjAyEWkNmYkAe3q7zCn/+X2cLXq9iu2tb4/FAitaMbpW1\n0vwmHSDmSaYxk+sl4DC0cFxgefG1v/d1m6L/D2PZ0MENDpG40Vf7qE+dZ8S74HJF\npSPUOeuivpoPjN38yeuoWYAI8rl9uXG85OYBMpsnIDtvv7+Gu1DZNzKPzbFxON/r\nWo580sR1bHiK/6A+rCau4SvkB019YJdnBlBPLgHIUd1APfRr+0pcmF9gMg7kRTiG\nbBWgsfy+6T3JsFNXrF0qmz+g65ncuBcNbq6wiidlOck2n94Eb+bZdKnCPKpJEgPK\nFszpBBohVmqgKNG+g9q6lileDoLApcFiKsJiPdRbThabHnCVldQScDECXcpy89rR\nsbjeHPPeeW5J04WaYmBtxIezNNjnMY2HGdthz1HBU36aqjDwE0srkUrn6gomgJkw\nB1MUJNZfeOWG9+Yj5Y9S8HbMuORFPlR7DT4STEq3hd9jsqGTwwoDxYYJf/QU2Mhs\nFw2zi2B9XNjxB+grZ1/nwvwHZ6sFvU47mI0yBSACFbP271QBajs=\n=NOm7\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/ff21efd5c3388822f3a9ed75620ad603a1e2368b",
          "sha": "ff21efd5c3388822f3a9ed75620ad603a1e2368b",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/ff21efd5c3388822f3a9ed75620ad603a1e2368b"
        }
      ],
      "message": "sha256: speed up writes using multi-block compression\n\nMultiple 64-byte blocks can now be compressed directly\nfrom the input buffer, without copying them into the\ninternal buffer.",
      "committer": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2026-02-02T18:22:45Z"
      },
      "author": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2026-01-14T17:16:41Z"
      },
      "sha": "b892a33f553a8a6d356d7919fe2e5123323b341a"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 22474397292,
      "node_id": "HRFPE_lADOAP4Jqs7a8JDRzwAAAAU7lBZs",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22474397292",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": "b892a33f553a8a6d356d7919fe2e5123323b341a",
      "commit_url": "https://api.github.com/repos/furszy/secp256k1/commits/b892a33f553a8a6d356d7919fe2e5123323b341a",
      "created_at": "2026-02-02T18:23:19Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2597483802",
      "pull_request_review_id": 3550658761,
      "id": 2597483802,
      "node_id": "PRRC_kwDOAP4Jqs6a0nUa",
      "diff_hunk": "@@ -92,6 +93,7 @@ typedef struct secp256k1_ecdsa_signature {\n  * the message, the algorithm, the key and the attempt.\n  */\n typedef int (*secp256k1_nonce_function)(\n+    const secp256k1_context *ctx,",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 12,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": null,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Argh, that's a breaking change. I didn't see that coming.\n\nBut I think it can be avoided. If the user wants to pass a custom nonce function, they anyway have no way of calling our internal function (whether it uses a custom SHA256 transform or not).\n\nSo we can keep the struct here and add the context arg only to our built-in nonce function. Our ECDSA signing function (and Schnorr signing, and ECDH, etc.) will need to special-case the built-in nonce function because it has a different function signature. Not elegant but it will do the job.\n\n~Maybe we can come up with something nicer if we (ever) add a modern ECDSA module and deprecate the ECDSA stuff in the main secp256k1.h file.~ edit: Probably no because this affects not just ECDSA.",
      "created_at": "2025-12-08T08:11:32Z",
      "updated_at": "2025-12-08T09:40:29Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2597483802",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2597483802"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": 94,
      "start_side": "LEFT",
      "line": null,
      "original_line": 96,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2597519740",
      "pull_request_review_id": 3550658761,
      "id": 2597519740,
      "node_id": "PRRC_kwDOAP4Jqs6a0wF8",
      "diff_hunk": "@@ -10,13 +10,20 @@\n #include <stdlib.h>\n #include <stdint.h>\n \n+typedef void (*sha256_transform_callback)(uint32_t *state, const unsigned char *block, size_t rounds);\n+\n+/* Validate user-supplied SHA-256 transform by comparing its output against\n+ * the library's linked implementation */\n+static int secp256k1_sha256_check_transform(sha256_transform_callback fn_transform);",
      "path": "src/hash.h",
      "position": 1,
      "original_position": 8,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": null,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Do we need this function given that there's already `secp256k1_selftest_sha256(void)`, which is run when a context is created? The existing one seems a bit simpler than your function and it's already there, so using that will make the diff smaller (but it will need to be modified to obtain an optional context). And perhaps the existing one is a bit slower than yours. I'd say either function is fine but keeping both seems overkill.\r\n\r\n(The existing selftest is currently in `selftest.h`. That's already wrong; it *should* have been put in a `selftest_impl.h`. But your approach is better: the SHA256 test function should be exposed from the internal hash module and then called from selftest.)\r\n\r\n\r\nedit: Okay, I see now. It's annoying than I thought. We expose `secp256k1_selftest(void)` which doesn't get a context object... The reason it's exposed is that you can use it when using the static context. \r\n\r\nSo I believe it makes sense to check the SHA256 at two places: \r\n - In `secp256k1_selftest(void)` because this will catch bugs in the built-in SHA256. This is particularly important with this PR given that it makes possible overriding the built-in implementation it at build time. \r\n - When setting a custom SHA256 transform. \r\n\r\nThis means we may perform two checks in the worst case, but that won't be the end of the world. You get the overhead only at library initialization time. But the question remains: How should the test look like? And I still think what I said above is true: It's okay to have a single `secp256k1_sha256_selftest` function in the hash module, and this can be called from the selftest module and from `secp256k1_context_set_sha256_transform_callback`.",
      "created_at": "2025-12-08T08:22:06Z",
      "updated_at": "2025-12-08T09:26:48Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2597519740",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2597519740"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": 15,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 17,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2597556267",
      "pull_request_review_id": 3550658761,
      "id": 2597556267,
      "node_id": "PRRC_kwDOAP4Jqs6a05Ar",
      "diff_hunk": "@@ -10,13 +10,20 @@\n #include <stdlib.h>\n #include <stdint.h>\n \n+typedef void (*sha256_transform_callback)(uint32_t *state, const unsigned char *block, size_t rounds);\n+\n+/* Validate user-supplied SHA-256 transform by comparing its output against\n+ * the library's linked implementation */\n+static int secp256k1_sha256_check_transform(sha256_transform_callback fn_transform);\n+\n typedef struct {\n     uint32_t s[8];\n     unsigned char buf[64];\n     uint64_t bytes;\n+    sha256_transform_callback fn_transform;\n } secp256k1_sha256;\n \n-static void secp256k1_sha256_initialize(secp256k1_sha256 *hash);\n+static void secp256k1_sha256_initialize(secp256k1_sha256 *hash, sha256_transform_callback fn_transform);\n static void secp256k1_sha256_write(secp256k1_sha256 *hash, const unsigned char *data, size_t size);\n static void secp256k1_sha256_finalize(secp256k1_sha256 *hash, unsigned char *out32);",
      "path": "src/hash.h",
      "position": 1,
      "original_position": 20,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": null,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "A potential problem with storing the callback in the `secp256k1_sha256` struct is that you could have this series of events:\r\n - User sets callback to `cb1`.\r\n - User calls API function that calls `secp256k1_sha256_initialize`, which outputs some opaque object that contains the `secp256k1_sha256` struct.\r\n - User sets callback go `cb2`.\r\n - Users passes the opaque object to another API function, which calls `secp256k1_sha256_write`, which calls `cb1`. UB.  \r\n\r\n(I believe) this cannot happen in the current code because there's no pair of API functions that behaves in this way, but it's a potential footgun for the future.\r\n\r\nMy suggestion is just passing the context object to every internal function that needs the SHA256 callback. (Another angle: State is annoying. We have state already in the context, so let's try to keep it there.)\r\n\r\n\r\n",
      "created_at": "2025-12-08T08:31:08Z",
      "updated_at": "2025-12-08T09:26:48Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2597556267",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2597556267"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": 25,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 28,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2597581215",
      "pull_request_review_id": 3550658761,
      "id": 2597581215,
      "node_id": "PRRC_kwDOAP4Jqs6a0_Gf",
      "diff_hunk": "@@ -56,20 +57,27 @@\n     } \\\n } while(0)\n \n+struct secp256k1_hash_context {\n+    sha256_transform_callback fn_sha256_transform;\n+};",
      "path": "src/secp256k1.c",
      "position": 1,
      "original_position": 14,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": null,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I think it will be nice to define this in the internal hash module, just like `secp256k1_ecmult_gen_context` is defined in the ecmult_gen module. ",
      "created_at": "2025-12-08T08:37:00Z",
      "updated_at": "2025-12-08T09:26:48Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2597581215",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2597581215"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": 60,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 62,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2597615324",
      "pull_request_review_id": 3550658761,
      "id": 2597615324,
      "node_id": "PRRC_kwDOAP4Jqs6a1Hbc",
      "diff_hunk": "@@ -403,6 +405,29 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/**\n+ * Set a callback function to override the internal SHA-256 transform.\n+ *\n+ * This installs a function to replace the built-in block-compression\n+ * step used by the library's internal SHA-256 implementation.\n+ * The provided callback must be functionally identical (bit-for-bit)\n+ * to the default transform. Any deviation  will cause incorrect results\n+ * and undefined behaviour.\n+ *\n+ * This API exists to support environments that wish to route the\n+ * SHA-256 compression step through a hardware-accelerated or otherwise\n+ * specialized implementation. It is not meant for modifying the\n+ * semantics of SHA-256.\n+ *\n+ * Args: ctx:    pointer to a context object.\n+ * In: callback: pointer to a function implementing the transform step.\n+ *               (passing NULL restores the default implementation)\n+ */\n+SECP256K1_API void secp256k1_context_set_sha256_transform_callback(\n+        secp256k1_context *ctx,\n+        void (*sha256_transform_callback)(uint32_t *state, const unsigned char *block, size_t rounds)",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 40,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": null,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I was wondering whether it makes sense to allow for a real return value here to make it possible for the callback to indicate some kind of failure (e.g., couldn't access external hardware, or malloc failed). We could then fall back to our implementation or simply call the error callback in order to crash.\r\n\r\nMy current conclusion is no: I can't imagine this being useful in practice. (If you call external hardware, this will be super slow anyway. If you use malloc for SHA256, you're doing it wrong.) Even if there's some failure, the callback will still have the possibility to crash the process.",
      "created_at": "2025-12-08T08:45:33Z",
      "updated_at": "2025-12-08T09:26:48Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2597615324",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2597615324"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 428,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2597654756",
      "pull_request_review_id": 3550658761,
      "id": 2597654756,
      "node_id": "PRRC_kwDOAP4Jqs6a1RDk",
      "diff_hunk": "@@ -403,6 +405,29 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/**\n+ * Set a callback function to override the internal SHA-256 transform.\n+ *\n+ * This installs a function to replace the built-in block-compression\n+ * step used by the library's internal SHA-256 implementation.\n+ * The provided callback must be functionally identical (bit-for-bit)\n+ * to the default transform. Any deviation  will cause incorrect results\n+ * and undefined behaviour.\n+ *\n+ * This API exists to support environments that wish to route the\n+ * SHA-256 compression step through a hardware-accelerated or otherwise\n+ * specialized implementation. It is not meant for modifying the\n+ * semantics of SHA-256.\n+ *\n+ * Args: ctx:    pointer to a context object.\n+ * In: callback: pointer to a function implementing the transform step.\n+ *               (passing NULL restores the default implementation)\n+ */\n+SECP256K1_API void secp256k1_context_set_sha256_transform_callback(\n+        secp256k1_context *ctx,\n+        void (*sha256_transform_callback)(uint32_t *state, const unsigned char *block, size_t rounds)",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 40,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": null,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "What's the motivation for the rounds arg? (Do you think we'll ever call this with any other value than 1?)",
      "created_at": "2025-12-08T08:55:14Z",
      "updated_at": "2025-12-08T09:26:48Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2597654756",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2597654756"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 428,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2597815721",
      "pull_request_review_id": 3551060764,
      "id": 2597815721,
      "node_id": "PRRC_kwDOAP4Jqs6a14Wp",
      "diff_hunk": "",
      "path": "include/secp256k1_sha.h",
      "position": 1,
      "original_position": 1,
      "commit_id": "3683e07ef4b6a062eec1776220eeeec0c30bc2ec",
      "original_commit_id": "75ccf99a0751d84e098aab7c4a13170e825c0496",
      "in_reply_to_id": null,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "What's the motivation for exposing the SHA256 compression?\r\n\r\nUnless I'm missing something, then if anything, I think we'd want to expose the high-level SHA256 function. I'm not sure how useful it is, and we tried to keep the library focused on ECC. On the other hand, we'll have it anyway in the code base, and it's required for Schnorr sigs (and we anyway expose a tagged hash for Schnorr sigs). So if you ask me, it's fine to expose SHA256 as long as we add a comment that says that users shouldn't expect a highly performant implementation. \r\n\r\nBut perhaps it's better to debate the exposing in a separate PR.",
      "created_at": "2025-12-08T09:34:10Z",
      "updated_at": "2025-12-08T09:34:48Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2597815721",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2597815721"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1,
      "original_line": 1,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2597829742",
      "pull_request_review_id": 3551077587,
      "id": 2597829742,
      "node_id": "PRRC_kwDOAP4Jqs6a17xu",
      "diff_hunk": "@@ -403,6 +405,29 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/**\n+ * Set a callback function to override the internal SHA-256 transform.\n+ *\n+ * This installs a function to replace the built-in block-compression\n+ * step used by the library's internal SHA-256 implementation.\n+ * The provided callback must be functionally identical (bit-for-bit)\n+ * to the default transform. Any deviation  will cause incorrect results\n+ * and undefined behaviour.\n+ *\n+ * This API exists to support environments that wish to route the\n+ * SHA-256 compression step through a hardware-accelerated or otherwise\n+ * specialized implementation. It is not meant for modifying the\n+ * semantics of SHA-256.\n+ *\n+ * Args: ctx:    pointer to a context object.\n+ * In: callback: pointer to a function implementing the transform step.\n+ *               (passing NULL restores the default implementation)\n+ */\n+SECP256K1_API void secp256k1_context_set_sha256_transform_callback(",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 38,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": null,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Naming: I wonder whether it makes sense to avoid the word callback here. Sure, it's a callback, but whenever we said callback in the past 10 years of this library, it was about error handling. We even have type `secp256k1_callback` (which probably should have been called `secp256k1_error_callback` but it's too late now.)\n\nMaybe we can just call it \"function \" and \"function pointer\", like we do in the bring-your-own-nonce-function interfaces. ",
      "created_at": "2025-12-08T09:38:57Z",
      "updated_at": "2025-12-08T09:38:57Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2597829742",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2597829742"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 426,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2597841305",
      "pull_request_review_id": 3551090512,
      "id": 2597841305,
      "node_id": "PRRC_kwDOAP4Jqs6a1-mZ",
      "diff_hunk": "@@ -220,6 +229,18 @@ void secp256k1_context_set_error_callback(secp256k1_context* ctx, void (*fun)(co\n     ctx->error_callback.data = data;\n }\n \n+void secp256k1_context_set_sha256_transform_callback(secp256k1_context *ctx, void (*sha256_transform_callback_)(uint32_t *state, const unsigned char *block, size_t rounds)) {",
      "path": "src/secp256k1.c",
      "position": 1,
      "original_position": 49,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": null,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "It will be nice to have a typedef for the function type in the public header.",
      "created_at": "2025-12-08T09:42:32Z",
      "updated_at": "2025-12-08T09:42:32Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2597841305",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2597841305"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 232,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2598064155",
      "pull_request_review_id": 3551364928,
      "id": 2598064155,
      "node_id": "PRRC_kwDOAP4Jqs6a21Ab",
      "diff_hunk": "@@ -134,6 +134,12 @@ SECP_TRY_APPEND_DEFAULT_CFLAGS(SECP_CFLAGS)\n ### Define config arguments\n ###\n \n+AC_ARG_WITH([external-sha256],\n+  AS_HELP_STRING([--with-external-sha256=PATH], [use external SHA256 compression implementation]),\n+  [external_sha256_path=\"$withval\"],\n+  [external_sha256_path=\"\"]\n+)",
      "path": "configure.ac",
      "position": 1,
      "original_position": 8,
      "commit_id": "3683e07ef4b6a062eec1776220eeeec0c30bc2ec",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": null,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Regarding the build stuff for the build-time override: We already have the possibility to have build-time overrides for the error callbacks, e.g., see `AC_ARG_ENABLE(external_default_callbacks,` below.\n\nWhen it comes to the implementation of how the new override is configured and performed, I think it's similar to the existing overrides for the callback. (Except that these don't allow configuring the header to be included, which makes them rather useless... https://github.com/bitcoin-core/secp256k1/pull/1461)\n\nSo this will need a rework anyway [1]. This belongs to a different PR, of course, but I think the SHA override here is a good opportunity to think about a better design of a compile-time override, so we may want to iterate on this a bit more than expected. No matter how it's designed, I think we should, in the long run, have only one (non-deprecated) mechanism for a build-time override of a function. \n\n[1] I don't think what I did for the error callbacks great, and I guess it would be okay to change it (I doubt that many users rely on this). Or even better, we could deprecate it and simply provide ways to provide build-time overrides for standard library symbols like `printf`, `stderr`, and `abort`.  See for example the approach taken by mbedTLS (in the past ?) which is built with embedded systems in mind: https://github.com/Mbed-TLS/mbedtls/blob/550a18d4d6b29e62b6824201d8a49b8224e61c97/tf-psa-crypto%2Fdrivers%2Fbuiltin%2Finclude%2Fmbedtls%2Fplatform.h They provide macros for overriding standard library functions. So you have full flexibility as a user: if you've implemented a function that aborts, but it's not called `abort()` (perhaps because that is a reserved name) then you can link it to the library also with a different name. ",
      "created_at": "2025-12-08T10:43:14Z",
      "updated_at": "2025-12-08T10:44:27Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2598064155",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2598064155"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": 137,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 141,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2598066046",
      "pull_request_review_id": 3551364928,
      "id": 2598066046,
      "node_id": "PRRC_kwDOAP4Jqs6a21d-",
      "diff_hunk": "@@ -134,6 +134,12 @@ SECP_TRY_APPEND_DEFAULT_CFLAGS(SECP_CFLAGS)\n ### Define config arguments\n ###\n \n+AC_ARG_WITH([external-sha256],",
      "path": "configure.ac",
      "position": 1,
      "original_position": 4,
      "commit_id": "3683e07ef4b6a062eec1776220eeeec0c30bc2ec",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": null,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit: I think this one should also be an `enable`-style configure option instead of a `with`-style configure options; `with` is for compiling with external *packages* e.g., `with-libxyz`. And what the user provides here is not a package. ",
      "created_at": "2025-12-08T10:43:53Z",
      "updated_at": "2025-12-08T10:44:27Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2598066046",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2598066046"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 137,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2620897504",
      "pull_request_review_id": 3563595127,
      "id": 2620897504,
      "node_id": "PRRC_kwDOAP4Jqs6cN7jg",
      "diff_hunk": "@@ -92,6 +93,7 @@ typedef struct secp256k1_ecdsa_signature {\n  * the message, the algorithm, the key and the attempt.\n  */\n typedef int (*secp256k1_nonce_function)(\n+    const secp256k1_context *ctx,",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 12,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": 2597483802,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> So we can keep the struct here and add the context arg only to our built-in nonce function. Our ECDSA signing function (and Schnorr signing, and ECDH, etc.) will need to special-case the built-in nonce function because it has a different function signature. Not elegant but it will do the job.\r\n\r\nDone. Spent quite a bit of time thinking about this, mainly because the so-called \"default\" function (the one exposed in the public header [here](https://github.com/bitcoin-core/secp256k1/blob/8d445730ec79a9fa722eea59b6b697c3b9b1d501/include/secp256k1.h#L641)) is not the one will be used when a custom sha256 transform is provided.., which somewhat defeats the purpose of calling it \"default\".\r\nStill, after a few rounds of thought and discussions with theStack and sipa, I think this is fine. It’s expected that a \"different\" function is used when the user provides own sha transform.",
      "created_at": "2025-12-15T21:23:10Z",
      "updated_at": "2025-12-16T21:48:22Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2620897504",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2620897504"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": 94,
      "start_side": "LEFT",
      "line": null,
      "original_line": 96,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2623847529",
      "pull_request_review_id": 3563595127,
      "id": 2623847529,
      "node_id": "PRRC_kwDOAP4Jqs6cZLxp",
      "diff_hunk": "@@ -10,13 +10,20 @@\n #include <stdlib.h>\n #include <stdint.h>\n \n+typedef void (*sha256_transform_callback)(uint32_t *state, const unsigned char *block, size_t rounds);\n+\n+/* Validate user-supplied SHA-256 transform by comparing its output against\n+ * the library's linked implementation */\n+static int secp256k1_sha256_check_transform(sha256_transform_callback fn_transform);",
      "path": "src/hash.h",
      "position": 1,
      "original_position": 8,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": 2597519740,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> So I believe it makes sense to check the SHA256 at two places:\r\n> \r\n> * In `secp256k1_selftest(void)` because this will catch bugs in the built-in SHA256. This is particularly important with this PR given that it makes possible overriding the built-in implementation it at build time.\r\n> * When setting a custom SHA256 transform.\r\n> \r\n> This means we may perform two checks in the worst case, but that won't be the end of the world. You get the overhead only at library initialization time. But the question remains: How should the test look like? And I still think what I said above is true: It's okay to have a single `secp256k1_sha256_selftest` function in the hash module, and this can be called from the selftest module and from `secp256k1_context_set_sha256_transform_callback`.\r\n\r\nYeah, I did start from that idea originally (that’s essentially why we also call to `secp256k1_selftest_sha256` inside `secp256k1_context_set_sha256_transform` first), but I ended up feeling that the existing selftest is a bit too weak for what we want to validate here.\r\n\r\nIt only checks a single 64-byte message, so it exercises exactly one compression round and never goes through the padding path or the buffering across multiple writes. Which felt insufficient to me. Validating the transform against the internal implementation also seemed like a reasonable extra safety net to ensure parity without adding more hardcoded values.\r\n\r\nStructurally, I agree that having a single `secp256k1_sha256_selftest` living in the hash module, makes sense.\r\n\r\nThe thing now is that neither test alone fully covers both aspects: we still want a check against hardcoded outputs, but we also want to verify more realistic usage patterns. That’s why I thought having both was useful.\r\nThat said, we could get similar coverage by extending the existing selftest with more hardcoded values too.. (this comes from a nice talk I had with @theStack). So.. probably we could re-use the existing one for now, and extend its coverage in a follow-up.\r\nHappy to hear your thoughts",
      "created_at": "2025-12-16T15:54:00Z",
      "updated_at": "2025-12-16T21:48:22Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2623847529",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2623847529"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": 15,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 17,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2624739553",
      "pull_request_review_id": 3563595127,
      "id": 2624739553,
      "node_id": "PRRC_kwDOAP4Jqs6ccljh",
      "diff_hunk": "@@ -10,13 +10,20 @@\n #include <stdlib.h>\n #include <stdint.h>\n \n+typedef void (*sha256_transform_callback)(uint32_t *state, const unsigned char *block, size_t rounds);\n+\n+/* Validate user-supplied SHA-256 transform by comparing its output against\n+ * the library's linked implementation */\n+static int secp256k1_sha256_check_transform(sha256_transform_callback fn_transform);\n+\n typedef struct {\n     uint32_t s[8];\n     unsigned char buf[64];\n     uint64_t bytes;\n+    sha256_transform_callback fn_transform;\n } secp256k1_sha256;\n \n-static void secp256k1_sha256_initialize(secp256k1_sha256 *hash);\n+static void secp256k1_sha256_initialize(secp256k1_sha256 *hash, sha256_transform_callback fn_transform);\n static void secp256k1_sha256_write(secp256k1_sha256 *hash, const unsigned char *data, size_t size);\n static void secp256k1_sha256_finalize(secp256k1_sha256 *hash, unsigned char *out32);",
      "path": "src/hash.h",
      "position": 1,
      "original_position": 20,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": 2597556267,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> My suggestion is just passing the context object to every internal function that needs the SHA256 callback.\r\n\r\nI did started there, but didn’t really like where it was leading me. Mainly because going down that path will be significantly more invasive than the current changes: It requires changing every `secp256k1_sha256_write` call to receive the function arg, every hmac, tagged hash etc.\r\nIt also includes changing `secp256k1_sha256_finalize`! which will also require the function arg because we call write during finalization too.\r\nOverall, I think the end result would be quite ugly for what we gain here (see below for more rationale).\r\n\r\n> A potential problem with storing the callback in the `secp256k1_sha256` struct is that you could have this series of events:\r\n> \r\n> * User sets callback to `cb1`.\r\n> * User calls API function that calls `secp256k1_sha256_initialize`, which outputs some opaque object that contains the `secp256k1_sha256` struct.\r\n> * User sets callback go `cb2`.\r\n> * Users passes the opaque object to another API function, which calls `secp256k1_sha256_write`, which calls `cb1`. UB.\r\n> \r\n> (I believe) this cannot happen in the current code because there's no pair of API functions that behaves in this way, but it's a potential footgun for the future.\r\n\r\nI'm not fully convinced it's a realistic scenario. Changing the sha256 transform callback in the middle of an ongoing procedure doesn’t really make sense in any intended usage. If someone does that, they should already be well outside the model we expect the API to be used under.\r\nTo me, this is similar to deleting the callback function from another thread while a libsecp operation is executing.\r\n\r\nAlso, exposing an in-use sha256 object across API boundaries is something we should simply never do right?. That feels really ugly. These structs are only valid under the assumption that they were initialized via `secp256k1_sha256_initialize`; otherwise, the internal fields would already be invalid, independently of the transform callback. And we cannot ensure that the struct has been initialized properly (or not corrupted) if we share it externally.\r\nI mean, if we ever want to share an existing sha256, I would say we should share the state and buffer directly as bytes and then re-initialize the struct on the receiving side.\r\n\r\nSo overall, I think it worth documenting the expectation clearly for sure: like sha256 structs must not be shared externally, and the provided sha256 callback, must be provided during app's init, and must remain active for the entire app lifecycle once provided (because it doesn't make sense to change it). But I'm not sure this is a problem we need to design around. It would add other complications without a clear benefit. But let me know what you think.",
      "created_at": "2025-12-16T21:05:43Z",
      "updated_at": "2025-12-17T18:35:07Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2624739553",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2624739553"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": 25,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 28,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2624770643",
      "pull_request_review_id": 3563595127,
      "id": 2624770643,
      "node_id": "PRRC_kwDOAP4Jqs6cctJT",
      "diff_hunk": "@@ -56,20 +57,27 @@\n     } \\\n } while(0)\n \n+struct secp256k1_hash_context {\n+    sha256_transform_callback fn_sha256_transform;\n+};",
      "path": "src/secp256k1.c",
      "position": 1,
      "original_position": 14,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": 2597581215,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> I think it will be nice to define this in the internal hash module, just like secp256k1_ecmult_gen_context is defined in the ecmult_gen module.\r\n\r\nSure. Done as suggested.",
      "created_at": "2025-12-16T21:18:07Z",
      "updated_at": "2025-12-16T21:48:22Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2624770643",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2624770643"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": 60,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 62,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2624774694",
      "pull_request_review_id": 3563595127,
      "id": 2624774694,
      "node_id": "PRRC_kwDOAP4Jqs6ccuIm",
      "diff_hunk": "@@ -403,6 +405,29 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/**\n+ * Set a callback function to override the internal SHA-256 transform.\n+ *\n+ * This installs a function to replace the built-in block-compression\n+ * step used by the library's internal SHA-256 implementation.\n+ * The provided callback must be functionally identical (bit-for-bit)\n+ * to the default transform. Any deviation  will cause incorrect results\n+ * and undefined behaviour.\n+ *\n+ * This API exists to support environments that wish to route the\n+ * SHA-256 compression step through a hardware-accelerated or otherwise\n+ * specialized implementation. It is not meant for modifying the\n+ * semantics of SHA-256.\n+ *\n+ * Args: ctx:    pointer to a context object.\n+ * In: callback: pointer to a function implementing the transform step.\n+ *               (passing NULL restores the default implementation)\n+ */\n+SECP256K1_API void secp256k1_context_set_sha256_transform_callback(",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 38,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": 2597829742,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> Naming: I wonder whether it makes sense to avoid the word callback here. Sure, it's a callback, but whenever we said callback in the past 10 years of this library, it was about error handling. We even have type secp256k1_callback (which probably should have been called secp256k1_error_callback but it's too late now.)\r\n\r\nSure. Renamed to `secp256k1_context_set_sha256_transform` 👍🏼 .",
      "created_at": "2025-12-16T21:19:49Z",
      "updated_at": "2025-12-16T21:48:22Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2624774694",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2624774694"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 426,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2624802953",
      "pull_request_review_id": 3563595127,
      "id": 2624802953,
      "node_id": "PRRC_kwDOAP4Jqs6cc1CJ",
      "diff_hunk": "@@ -403,6 +405,29 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/**\n+ * Set a callback function to override the internal SHA-256 transform.\n+ *\n+ * This installs a function to replace the built-in block-compression\n+ * step used by the library's internal SHA-256 implementation.\n+ * The provided callback must be functionally identical (bit-for-bit)\n+ * to the default transform. Any deviation  will cause incorrect results\n+ * and undefined behaviour.\n+ *\n+ * This API exists to support environments that wish to route the\n+ * SHA-256 compression step through a hardware-accelerated or otherwise\n+ * specialized implementation. It is not meant for modifying the\n+ * semantics of SHA-256.\n+ *\n+ * Args: ctx:    pointer to a context object.\n+ * In: callback: pointer to a function implementing the transform step.\n+ *               (passing NULL restores the default implementation)\n+ */\n+SECP256K1_API void secp256k1_context_set_sha256_transform_callback(\n+        secp256k1_context *ctx,\n+        void (*sha256_transform_callback)(uint32_t *state, const unsigned char *block, size_t rounds)",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 40,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": 2597654756,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> What's the motivation for the rounds arg? (Do you think we'll ever call this with any other value than 1?)\r\n\r\nI think it's better to introduce it now, even if it's currently always set to 1, so we don’t end up breaking the API later if we ever need it. But can remove it if you are strongly opposed to it.",
      "created_at": "2025-12-16T21:29:52Z",
      "updated_at": "2025-12-16T21:48:22Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2624802953",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2624802953"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 428,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2624838425",
      "pull_request_review_id": 3563595127,
      "id": 2624838425,
      "node_id": "PRRC_kwDOAP4Jqs6cc9sZ",
      "diff_hunk": "",
      "path": "include/secp256k1_sha.h",
      "position": 1,
      "original_position": 1,
      "commit_id": "3683e07ef4b6a062eec1776220eeeec0c30bc2ec",
      "original_commit_id": "75ccf99a0751d84e098aab7c4a13170e825c0496",
      "in_reply_to_id": 2597815721,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> What's the motivation for exposing the SHA256 compression?\r\n>\r\n> Unless I'm missing something, then if anything, I think we'd want to expose the high-level SHA256 function. I'm not sure how useful it is, and we tried to keep the library focused on ECC. On the other hand, we'll have it anyway in the code base, and it's required for Schnorr sigs (and we anyway expose a tagged hash for Schnorr sigs). So if you ask me, it's fine to expose SHA256 as long as we add a comment that says that users shouldn't expect a highly performant implementation.\r\n\r\nActually, the motivation wasn't so much that I expect people to use it directly. It's more about making an explicit statement in the API: the sha256 transform is something that can be replaced or disabled if you want to (thus I thought it could be a new module). Exposing it makes that contract clear, instead of it being an internal detail that people can obscurely replace.\r\n\r\nThat said, I agree this is somewhat orthogonal topic.",
      "created_at": "2025-12-16T21:42:02Z",
      "updated_at": "2025-12-16T21:48:22Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2624838425",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2624838425"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1,
      "original_line": 1,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2626204368",
      "pull_request_review_id": 3586724011,
      "id": 2626204368,
      "node_id": "PRRC_kwDOAP4Jqs6ciLLQ",
      "diff_hunk": "",
      "path": "include/secp256k1_sha.h",
      "position": 1,
      "original_position": 1,
      "commit_id": "3683e07ef4b6a062eec1776220eeeec0c30bc2ec",
      "original_commit_id": "75ccf99a0751d84e098aab7c4a13170e825c0496",
      "in_reply_to_id": 2597815721,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> It's more about making an explicit statement in the API: the sha256 transform is something that can be replaced or disabled if you want to (thus I thought it could be a new module). Exposing it makes that contract clear, instead of it being an internal detail that people can obscurely replace.\r\n\r\nMaybe my thinking is just too simplistic, but the only thing that exposing makes clear to me (as a user) is that I can call it, (and that there's some kind of guarantee that future releases will contain a function with the same signature and behavior).\r\n\r\n> That said, I agree this is somewhat orthogonal topic.\r\n\r\nI think so, yes.\r\n\r\n\r\nWhat could be done to make the API docs more explicit is to point out in the docs for `secp256k1_context_set_sha256_transform_callback` where this is used by the library without being an implementation detail (namely Schnorr sigs, ECDH, IIRC also ellswift). Would probably suffice to say something like \"e.g., Schnorr signatures and the default key derivation function for ECDH\". \r\n",
      "created_at": "2025-12-17T09:11:05Z",
      "updated_at": "2025-12-17T09:11:20Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2626204368",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2626204368"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1,
      "original_line": 1,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2626237384",
      "pull_request_review_id": 3586763754,
      "id": 2626237384,
      "node_id": "PRRC_kwDOAP4Jqs6ciTPI",
      "diff_hunk": "@@ -403,6 +405,29 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/**\n+ * Set a callback function to override the internal SHA-256 transform.\n+ *\n+ * This installs a function to replace the built-in block-compression\n+ * step used by the library's internal SHA-256 implementation.\n+ * The provided callback must be functionally identical (bit-for-bit)\n+ * to the default transform. Any deviation  will cause incorrect results\n+ * and undefined behaviour.\n+ *\n+ * This API exists to support environments that wish to route the\n+ * SHA-256 compression step through a hardware-accelerated or otherwise\n+ * specialized implementation. It is not meant for modifying the\n+ * semantics of SHA-256.\n+ *\n+ * Args: ctx:    pointer to a context object.\n+ * In: callback: pointer to a function implementing the transform step.\n+ *               (passing NULL restores the default implementation)\n+ */\n+SECP256K1_API void secp256k1_context_set_sha256_transform_callback(\n+        secp256k1_context *ctx,\n+        void (*sha256_transform_callback)(uint32_t *state, const unsigned char *block, size_t rounds)",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 40,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": 2597654756,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> so we don’t end up breaking the API later if we ever need it.\r\n\r\nI might be missing something but I really tend to think that is too obscure.\r\n\r\n - I can't imagine a reason why we would ever need it. Applying the transform more than once to the same data is not done within SHA256. So we'll need this if we ever implement our own hardened hash function SHA256+ based on SHA256?\r\n - Even if it turns out that we need this functionality, we can simply call the transform in a loop. Perhaps that will come with a tiny performance disadvantage due to the overhead of the function call, but that will be acceptable.\r\n\r\n",
      "created_at": "2025-12-17T09:20:03Z",
      "updated_at": "2025-12-17T09:20:04Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2626237384",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2626237384"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 428,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2627621245",
      "pull_request_review_id": 3588420328,
      "id": 2627621245,
      "node_id": "PRRC_kwDOAP4Jqs6cnlF9",
      "diff_hunk": "@@ -10,13 +10,20 @@\n #include <stdlib.h>\n #include <stdint.h>\n \n+typedef void (*sha256_transform_callback)(uint32_t *state, const unsigned char *block, size_t rounds);\n+\n+/* Validate user-supplied SHA-256 transform by comparing its output against\n+ * the library's linked implementation */\n+static int secp256k1_sha256_check_transform(sha256_transform_callback fn_transform);",
      "path": "src/hash.h",
      "position": 1,
      "original_position": 8,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": 2597519740,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I missed to update this one. The latest push uses only `secp256k1_sha256_selftest`. Calling it twice as suggested.",
      "created_at": "2025-12-17T15:56:02Z",
      "updated_at": "2025-12-17T16:49:57Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2627621245",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2627621245"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": 15,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 17,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2627719101",
      "pull_request_review_id": 3588536503,
      "id": 2627719101,
      "node_id": "PRRC_kwDOAP4Jqs6cn8-9",
      "diff_hunk": "@@ -134,6 +134,12 @@ SECP_TRY_APPEND_DEFAULT_CFLAGS(SECP_CFLAGS)\n ### Define config arguments\n ###\n \n+AC_ARG_WITH([external-sha256],\n+  AS_HELP_STRING([--with-external-sha256=PATH], [use external SHA256 compression implementation]),\n+  [external_sha256_path=\"$withval\"],\n+  [external_sha256_path=\"\"]\n+)",
      "path": "configure.ac",
      "position": 1,
      "original_position": 8,
      "commit_id": "3683e07ef4b6a062eec1776220eeeec0c30bc2ec",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": 2598064155,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Hmm, I see. Those are very good points. Agree this worth a deeper discussion.\r\n\r\nNo problem splitting the changes. We can keep this PR focused on the runtime feature and handle the build-time override design separately. The only change we need from the build-time commit for this PR is exposing the transform function in `hash.h`, so we can initialize the context default function.",
      "created_at": "2025-12-17T16:21:52Z",
      "updated_at": "2025-12-17T16:21:52Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2627719101",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2627719101"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": 137,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 141,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2628299244",
      "pull_request_review_id": 3589239735,
      "id": 2628299244,
      "node_id": "PRRC_kwDOAP4Jqs6cqKns",
      "diff_hunk": "@@ -10,13 +10,20 @@\n #include <stdlib.h>\n #include <stdint.h>\n \n+typedef void (*sha256_transform_callback)(uint32_t *state, const unsigned char *block, size_t rounds);\n+\n+/* Validate user-supplied SHA-256 transform by comparing its output against\n+ * the library's linked implementation */\n+static int secp256k1_sha256_check_transform(sha256_transform_callback fn_transform);\n+\n typedef struct {\n     uint32_t s[8];\n     unsigned char buf[64];\n     uint64_t bytes;\n+    sha256_transform_callback fn_transform;\n } secp256k1_sha256;\n \n-static void secp256k1_sha256_initialize(secp256k1_sha256 *hash);\n+static void secp256k1_sha256_initialize(secp256k1_sha256 *hash, sha256_transform_callback fn_transform);\n static void secp256k1_sha256_write(secp256k1_sha256 *hash, const unsigned char *data, size_t size);\n static void secp256k1_sha256_finalize(secp256k1_sha256 *hash, unsigned char *out32);",
      "path": "src/hash.h",
      "position": 1,
      "original_position": 20,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": 2597556267,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Maybe I should give the \"pass the function to every `write` call\" patch-set another try and compare the resulting changes. I did it early on so maybe it is not as bad as I remember it. Let me see..",
      "created_at": "2025-12-17T19:04:32Z",
      "updated_at": "2025-12-17T19:04:32Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2628299244",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2628299244"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": 25,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 28,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2628385281",
      "pull_request_review_id": 3589344182,
      "id": 2628385281,
      "node_id": "PRRC_kwDOAP4Jqs6cqfoB",
      "diff_hunk": "@@ -403,6 +405,29 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/**\n+ * Set a callback function to override the internal SHA-256 transform.\n+ *\n+ * This installs a function to replace the built-in block-compression\n+ * step used by the library's internal SHA-256 implementation.\n+ * The provided callback must be functionally identical (bit-for-bit)\n+ * to the default transform. Any deviation  will cause incorrect results\n+ * and undefined behaviour.\n+ *\n+ * This API exists to support environments that wish to route the\n+ * SHA-256 compression step through a hardware-accelerated or otherwise\n+ * specialized implementation. It is not meant for modifying the\n+ * semantics of SHA-256.\n+ *\n+ * Args: ctx:    pointer to a context object.\n+ * In: callback: pointer to a function implementing the transform step.\n+ *               (passing NULL restores the default implementation)\n+ */\n+SECP256K1_API void secp256k1_context_set_sha256_transform_callback(\n+        secp256k1_context *ctx,\n+        void (*sha256_transform_callback)(uint32_t *state, const unsigned char *block, size_t rounds)",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 40,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": 2597615324,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> I was wondering whether it makes sense to allow for a real return value here to make it possible for the callback to indicate some kind of failure (e.g., couldn't access external hardware, or malloc failed). We could then fall back to our implementation or simply call the error callback in order to crash.\r\n\r\nhmm, how would we actually call the error callback from inside `hash_impl.h`? That would require passing the context all the way down into the sha256 `sha_write` and `sha_finalize` functions (hmac, tagged hashes, etc), which would introduce a `hash_impl.h` dependency on `secp256k1.h` (unless we move the context definition elsewhere). But this seems to be a low-level primitive file that shouldn't receive the context.",
      "created_at": "2025-12-17T19:33:11Z",
      "updated_at": "2025-12-17T19:33:11Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2628385281",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2628385281"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 428,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2628521300",
      "pull_request_review_id": 3589502788,
      "id": 2628521300,
      "node_id": "PRRC_kwDOAP4Jqs6crA1U",
      "diff_hunk": "@@ -134,6 +134,12 @@ SECP_TRY_APPEND_DEFAULT_CFLAGS(SECP_CFLAGS)\n ### Define config arguments\n ###\n \n+AC_ARG_WITH([external-sha256],\n+  AS_HELP_STRING([--with-external-sha256=PATH], [use external SHA256 compression implementation]),\n+  [external_sha256_path=\"$withval\"],\n+  [external_sha256_path=\"\"]\n+)",
      "path": "configure.ac",
      "position": 1,
      "original_position": 8,
      "commit_id": "3683e07ef4b6a062eec1776220eeeec0c30bc2ec",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": 2598064155,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> We can keep this PR focused on the runtime feature and handle the build-time override design separately\r\n\r\nRight, I hadn't considered this option. That's a good idea. (And I see that sipa suggested the same below.)",
      "created_at": "2025-12-17T20:23:33Z",
      "updated_at": "2025-12-17T20:23:34Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2628521300",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2628521300"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": 137,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 141,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2628529481",
      "pull_request_review_id": 3589514196,
      "id": 2628529481,
      "node_id": "PRRC_kwDOAP4Jqs6crC1J",
      "diff_hunk": "@@ -403,6 +405,29 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/**\n+ * Set a callback function to override the internal SHA-256 transform.\n+ *\n+ * This installs a function to replace the built-in block-compression\n+ * step used by the library's internal SHA-256 implementation.\n+ * The provided callback must be functionally identical (bit-for-bit)\n+ * to the default transform. Any deviation  will cause incorrect results\n+ * and undefined behaviour.\n+ *\n+ * This API exists to support environments that wish to route the\n+ * SHA-256 compression step through a hardware-accelerated or otherwise\n+ * specialized implementation. It is not meant for modifying the\n+ * semantics of SHA-256.\n+ *\n+ * Args: ctx:    pointer to a context object.\n+ * In: callback: pointer to a function implementing the transform step.\n+ *               (passing NULL restores the default implementation)\n+ */\n+SECP256K1_API void secp256k1_context_set_sha256_transform_callback(\n+        secp256k1_context *ctx,\n+        void (*sha256_transform_callback)(uint32_t *state, const unsigned char *block, size_t rounds)",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 40,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": 2597615324,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> But this seems to be a low-level primitive file that shouldn't receive the context.\r\n\r\nHm, I don't think there is (or should be) a rule that says low-level primitives shouldn't receive the error callback. It doesn't need to be the full context.\r\n\r\nBut let me just resolve this conversation. As I already wrote above, I doubt that my suggestion was useful in the first place.",
      "created_at": "2025-12-17T20:26:39Z",
      "updated_at": "2025-12-17T20:26:39Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2628529481",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2628529481"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 428,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2628554409",
      "pull_request_review_id": 3589544017,
      "id": 2628554409,
      "node_id": "PRRC_kwDOAP4Jqs6crI6p",
      "diff_hunk": "@@ -10,13 +10,20 @@\n #include <stdlib.h>\n #include <stdint.h>\n \n+typedef void (*sha256_transform_callback)(uint32_t *state, const unsigned char *block, size_t rounds);\n+\n+/* Validate user-supplied SHA-256 transform by comparing its output against\n+ * the library's linked implementation */\n+static int secp256k1_sha256_check_transform(sha256_transform_callback fn_transform);\n+\n typedef struct {\n     uint32_t s[8];\n     unsigned char buf[64];\n     uint64_t bytes;\n+    sha256_transform_callback fn_transform;\n } secp256k1_sha256;\n \n-static void secp256k1_sha256_initialize(secp256k1_sha256 *hash);\n+static void secp256k1_sha256_initialize(secp256k1_sha256 *hash, sha256_transform_callback fn_transform);\n static void secp256k1_sha256_write(secp256k1_sha256 *hash, const unsigned char *data, size_t size);\n static void secp256k1_sha256_finalize(secp256k1_sha256 *hash, unsigned char *out32);",
      "path": "src/hash.h",
      "position": 1,
      "original_position": 20,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": 2597556267,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> Also, exposing an in-use sha256 object across API boundaries is something we should simply never do right?. That feels really ugly.\r\n\r\nIt doesn't feel ugly to me. Of course, we wouldn't share it standalone but inside some other object. For example, like we expose an `secp256k1_scalar` inside an opaque `secp256k1_musig_keyagg_cache`. \r\n\r\nAnd I don't think the use case would be unrealistic. Having a \"hash builder\" is common, and it could very well be part of a high-level function. Just imagine an advanced schnorrsig signing object that lets you append to the message multiple times before finalizing the signatures (e.g., for cases in which you want to sign a long message whose parts you receive step by step).\r\n",
      "created_at": "2025-12-17T20:35:52Z",
      "updated_at": "2025-12-17T20:35:52Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2628554409",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2628554409"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": 25,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 28,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2628563203",
      "pull_request_review_id": 3589555773,
      "id": 2628563203,
      "node_id": "PRRC_kwDOAP4Jqs6crLED",
      "diff_hunk": "@@ -10,13 +10,20 @@\n #include <stdlib.h>\n #include <stdint.h>\n \n+typedef void (*sha256_transform_callback)(uint32_t *state, const unsigned char *block, size_t rounds);\n+\n+/* Validate user-supplied SHA-256 transform by comparing its output against\n+ * the library's linked implementation */\n+static int secp256k1_sha256_check_transform(sha256_transform_callback fn_transform);\n+\n typedef struct {\n     uint32_t s[8];\n     unsigned char buf[64];\n     uint64_t bytes;\n+    sha256_transform_callback fn_transform;\n } secp256k1_sha256;\n \n-static void secp256k1_sha256_initialize(secp256k1_sha256 *hash);\n+static void secp256k1_sha256_initialize(secp256k1_sha256 *hash, sha256_transform_callback fn_transform);\n static void secp256k1_sha256_write(secp256k1_sha256 *hash, const unsigned char *data, size_t size);\n static void secp256k1_sha256_finalize(secp256k1_sha256 *hash, unsigned char *out32);",
      "path": "src/hash.h",
      "position": 1,
      "original_position": 20,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": 2597556267,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> Maybe I should give the \"pass the function to every `write` call\" patch-set another try and compare the resulting changes. I did it early on so maybe it is not as bad as I remember it. Let me see..\r\n\r\nYes, I see that passing the function down is annoying and that it has a non-zero readability and maintenance cost.  But I imagine it's not too bad. (I tend to agree with sipa here: reviewing many obvious diff lines is not an issue.) Seeing the resulting diff would certainly help to see how bad it is. ",
      "created_at": "2025-12-17T20:39:12Z",
      "updated_at": "2025-12-17T20:39:12Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2628563203",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2628563203"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": 25,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 28,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2632227231",
      "pull_request_review_id": 3594501006,
      "id": 2632227231,
      "node_id": "PRRC_kwDOAP4Jqs6c5Jmf",
      "diff_hunk": "@@ -10,13 +10,20 @@\n #include <stdlib.h>\n #include <stdint.h>\n \n+typedef void (*sha256_transform_callback)(uint32_t *state, const unsigned char *block, size_t rounds);\n+\n+/* Validate user-supplied SHA-256 transform by comparing its output against\n+ * the library's linked implementation */\n+static int secp256k1_sha256_check_transform(sha256_transform_callback fn_transform);\n+\n typedef struct {\n     uint32_t s[8];\n     unsigned char buf[64];\n     uint64_t bytes;\n+    sha256_transform_callback fn_transform;\n } secp256k1_sha256;\n \n-static void secp256k1_sha256_initialize(secp256k1_sha256 *hash);\n+static void secp256k1_sha256_initialize(secp256k1_sha256 *hash, sha256_transform_callback fn_transform);\n static void secp256k1_sha256_write(secp256k1_sha256 *hash, const unsigned char *data, size_t size);\n static void secp256k1_sha256_finalize(secp256k1_sha256 *hash, unsigned char *out32);",
      "path": "src/hash.h",
      "position": 1,
      "original_position": 20,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": 2597556267,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> > Maybe I should give the \"pass the function to every `write` call\" patch-set another try and compare the resulting changes. I did it early on so maybe it is not as bad as I remember it. Let me see..\r\n> \r\n> Yes, I see that passing the function down is annoying and that it has a non-zero readability and maintenance cost. But I imagine it's not too bad. (I tend to agree with sipa here: reviewing many obvious diff lines is not an issue.) Seeing the resulting diff would certainly help to see how bad it is.\r\n\r\nOk done, both options available https://github.com/bitcoin-core/secp256k1/pull/1777#pullrequestreview-3594435763 ",
      "created_at": "2025-12-18T18:41:21Z",
      "updated_at": "2025-12-18T18:41:21Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2632227231",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2632227231"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": 25,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 28,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2632315854",
      "pull_request_review_id": 3594621649,
      "id": 2632315854,
      "node_id": "PRRC_kwDOAP4Jqs6c5fPO",
      "diff_hunk": "@@ -403,6 +405,29 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/**\n+ * Set a callback function to override the internal SHA-256 transform.\n+ *\n+ * This installs a function to replace the built-in block-compression\n+ * step used by the library's internal SHA-256 implementation.\n+ * The provided callback must be functionally identical (bit-for-bit)\n+ * to the default transform. Any deviation  will cause incorrect results\n+ * and undefined behaviour.\n+ *\n+ * This API exists to support environments that wish to route the\n+ * SHA-256 compression step through a hardware-accelerated or otherwise\n+ * specialized implementation. It is not meant for modifying the\n+ * semantics of SHA-256.\n+ *\n+ * Args: ctx:    pointer to a context object.\n+ * In: callback: pointer to a function implementing the transform step.\n+ *               (passing NULL restores the default implementation)\n+ */\n+SECP256K1_API void secp256k1_context_set_sha256_transform_callback(\n+        secp256k1_context *ctx,\n+        void (*sha256_transform_callback)(uint32_t *state, const unsigned char *block, size_t rounds)",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 40,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": 2597654756,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Ok yeah, agree. Adding this just to repeat the compression on the same block doesn’t make much sense, but (idea) what about processing multiple blocks in a row?\r\nAn API for that could be useful since implementations would be able to skip per-block-compression variables initialization, cleanups, etc.",
      "created_at": "2025-12-18T19:05:13Z",
      "updated_at": "2025-12-18T19:05:13Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2632315854",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2632315854"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 428,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2632730416",
      "pull_request_review_id": 3595170219,
      "id": 2632730416,
      "node_id": "PRRC_kwDOAP4Jqs6c7Ecw",
      "diff_hunk": "@@ -403,6 +405,29 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/**\n+ * Set a callback function to override the internal SHA-256 transform.\n+ *\n+ * This installs a function to replace the built-in block-compression\n+ * step used by the library's internal SHA-256 implementation.\n+ * The provided callback must be functionally identical (bit-for-bit)\n+ * to the default transform. Any deviation  will cause incorrect results\n+ * and undefined behaviour.\n+ *\n+ * This API exists to support environments that wish to route the\n+ * SHA-256 compression step through a hardware-accelerated or otherwise\n+ * specialized implementation. It is not meant for modifying the\n+ * semantics of SHA-256.\n+ *\n+ * Args: ctx:    pointer to a context object.\n+ * In: callback: pointer to a function implementing the transform step.\n+ *               (passing NULL restores the default implementation)\n+ */\n+SECP256K1_API void secp256k1_context_set_sha256_transform_callback(\n+        secp256k1_context *ctx,\n+        void (*sha256_transform_callback)(uint32_t *state, const unsigned char *block, size_t rounds)",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 40,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": 2597654756,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "@furszy That makes more sense - and it's apparently also how the Bitcoin Core transform implementations work (but call it `blocks`, not `rounds`).",
      "created_at": "2025-12-18T21:38:20Z",
      "updated_at": "2025-12-18T21:38:39Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2632730416",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2632730416"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 428,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2635598257",
      "pull_request_review_id": 3599191793,
      "id": 2635598257,
      "node_id": "PRRC_kwDOAP4Jqs6dGAmx",
      "diff_hunk": "@@ -403,6 +405,29 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/**\n+ * Set a callback function to override the internal SHA-256 transform.\n+ *\n+ * This installs a function to replace the built-in block-compression\n+ * step used by the library's internal SHA-256 implementation.\n+ * The provided callback must be functionally identical (bit-for-bit)\n+ * to the default transform. Any deviation  will cause incorrect results\n+ * and undefined behaviour.\n+ *\n+ * This API exists to support environments that wish to route the\n+ * SHA-256 compression step through a hardware-accelerated or otherwise\n+ * specialized implementation. It is not meant for modifying the\n+ * semantics of SHA-256.\n+ *\n+ * Args: ctx:    pointer to a context object.\n+ * In: callback: pointer to a function implementing the transform step.\n+ *               (passing NULL restores the default implementation)\n+ */\n+SECP256K1_API void secp256k1_context_set_sha256_transform_callback(\n+        secp256k1_context *ctx,\n+        void (*sha256_transform_callback)(uint32_t *state, const unsigned char *block, size_t rounds)",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 40,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": 2597654756,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> @furszy That makes more sense - and it's apparently also how the Bitcoin Core transform implementations work (but call it `blocks`, not `rounds`).\r\n\r\nha, that explains where the idea came from. It must have been in the back of my mind.",
      "created_at": "2025-12-19T16:20:16Z",
      "updated_at": "2025-12-19T16:20:16Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2635598257",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2635598257"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 428,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2636117458",
      "pull_request_review_id": 3599853419,
      "id": 2636117458,
      "node_id": "PRRC_kwDOAP4Jqs6dH_XS",
      "diff_hunk": "@@ -220,6 +229,18 @@ void secp256k1_context_set_error_callback(secp256k1_context* ctx, void (*fun)(co\n     ctx->error_callback.data = data;\n }\n \n+void secp256k1_context_set_sha256_transform_callback(secp256k1_context *ctx, void (*sha256_transform_callback_)(uint32_t *state, const unsigned char *block, size_t rounds)) {",
      "path": "src/secp256k1.c",
      "position": 1,
      "original_position": 49,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": 2597841305,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "If I'm not mistaken, this comment is still unaddressed.\r\n\r\nLet me add that the typedef is a good place to document the behavior of the function (e.g., the `blocks` arg). The naming of the args should be reconsidered because now `block` may point to more than one block. Maybe `(..., const unsigned char *blocks64, size_t n_blocks)`.",
      "created_at": "2025-12-19T19:48:38Z",
      "updated_at": "2025-12-19T19:48:38Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2636117458",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2636117458"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 232,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2636182550",
      "pull_request_review_id": 3599945418,
      "id": 2636182550,
      "node_id": "PRRC_kwDOAP4Jqs6dIPQW",
      "diff_hunk": "@@ -220,6 +229,18 @@ void secp256k1_context_set_error_callback(secp256k1_context* ctx, void (*fun)(co\n     ctx->error_callback.data = data;\n }\n \n+void secp256k1_context_set_sha256_transform_callback(secp256k1_context *ctx, void (*sha256_transform_callback_)(uint32_t *state, const unsigned char *block, size_t rounds)) {",
      "path": "src/secp256k1.c",
      "position": 1,
      "original_position": 49,
      "commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "original_commit_id": "7fefa9c851d36214a4a03aeae36b59aee9d08263",
      "in_reply_to_id": 2597841305,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> If I'm not mistaken, this comment is still unaddressed.\r\n> \r\n> Let me add that the typedef is a good place to document the behavior of the function (e.g., the `blocks` arg). The naming of the args should be reconsidered because now `block` may point to more than one block. Maybe `(..., const unsigned char *blocks64, size_t n_blocks)`.\r\n\r\nDone, pushed. Sorry for missing this one. Most of the function docs were inside the build-time feature commit. In the module definition; Moved what had here and renamed the args.",
      "created_at": "2025-12-19T20:12:37Z",
      "updated_at": "2025-12-19T20:20:53Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2636182550",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2636182550"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 232,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2664388966",
      "pull_request_review_id": 3630308699,
      "id": 2664388966,
      "node_id": "PRRC_kwDOAP4Jqs6ez1lm",
      "diff_hunk": "@@ -404,6 +404,49 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/**\n+ * SHA256 block compression raw primitive.",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 23,
      "commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "original_commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "in_reply_to_id": null,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "```suggestion\n * A pointer to a function that  implementation of SHA256's internal compression function\n```\n\n - \"A pointer to\" is a bit more in line with the other function pointer types. (\" * A pointer to a function that implements SHA256's internal compression function\" would be even more in line, but it's > 80 chars and duplicates \"function\") \n - I'd call it \"internal\" rather than \"raw\" because that's more precise (to me, at least).\n - The typical name of the thing is \"(one-way) compression function\", see https://en.wikipedia.org/wiki/One-way_compression_function\n\n",
      "created_at": "2026-01-06T10:10:54Z",
      "updated_at": "2026-01-06T13:46:08Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2664388966",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2664388966"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 408,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2664419592",
      "pull_request_review_id": 3630308699,
      "id": 2664419592,
      "node_id": "PRRC_kwDOAP4Jqs6ez9EI",
      "diff_hunk": "@@ -404,6 +404,49 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/**\n+ * SHA256 block compression raw primitive.\n+ *\n+ * This function performs the SHA256 compression on one or more contiguous\n+ * 64-byte message blocks. It does **not** perform padding, message scheduling\n+ * across blocks, or length encoding.",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 27,
      "commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "original_commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "in_reply_to_id": null,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "The function pointed to consumes one or more contiguous 64-byte message blocks and updates the internal SHA256 state accordingly. The function is not responsible for counting consumed blocks or bytes, and it is not responsible for performing padding.\n\n - What is \"message scheduling across blocks\"?\n - \"length encoding\" is part of padding, no?",
      "created_at": "2026-01-06T10:21:34Z",
      "updated_at": "2026-01-06T13:46:08Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2664419592",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2664419592"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": 410,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 412,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2664427626",
      "pull_request_review_id": 3630308699,
      "id": 2664427626,
      "node_id": "PRRC_kwDOAP4Jqs6ez_Bq",
      "diff_hunk": "@@ -404,6 +404,49 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/**\n+ * SHA256 block compression raw primitive.\n+ *\n+ * This function performs the SHA256 compression on one or more contiguous\n+ * 64-byte message blocks. It does **not** perform padding, message scheduling\n+ * across blocks, or length encoding.\n+ *\n+ * Parameters:\n+ * - `state`    Pointer to eight 32-bit words representing the current state.\n+ *              The state is updated in place.\n+ * - `blocks64` Pointer to the first 64-byte block; additional blocks must be\n+ *              contiguous in memory.\n+ * - `n_blocks` Number of contiguous 64-byte blocks to process.",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 34,
      "commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "original_commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "in_reply_to_id": null,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nits: \n - Formatting should be consistent with other docs for function pointer types, see for example `secp256k1_nonce_function`. That includes `s/Parameters/Args`\n - `s/current state/current internal state`",
      "created_at": "2026-01-06T10:23:46Z",
      "updated_at": "2026-01-06T13:46:08Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2664427626",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2664427626"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": 414,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 419,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2664917482",
      "pull_request_review_id": 3630308699,
      "id": 2664917482,
      "node_id": "PRRC_kwDOAP4Jqs6e12nq",
      "diff_hunk": "@@ -404,6 +404,49 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/**\n+ * SHA256 block compression raw primitive.\n+ *\n+ * This function performs the SHA256 compression on one or more contiguous\n+ * 64-byte message blocks. It does **not** perform padding, message scheduling\n+ * across blocks, or length encoding.\n+ *\n+ * Parameters:\n+ * - `state`    Pointer to eight 32-bit words representing the current state.\n+ *              The state is updated in place.\n+ * - `blocks64` Pointer to the first 64-byte block; additional blocks must be\n+ *              contiguous in memory.\n+ * - `n_blocks` Number of contiguous 64-byte blocks to process.\n+ */\n+typedef void (*secp256k1_sha256_transform_fn)(\n+    uint32_t* state,\n+    const unsigned char* blocks64,\n+    size_t n_blocks\n+);\n+\n+/**\n+ * Set a callback function to override the internal SHA256 transform.\n+ *\n+ * This installs a function to replace the built-in block-compression\n+ * step used by the library's internal SHA256 implementation.\n+ * The provided callback must be functionally identical (bit-for-bit)\n+ * to the default transform. Any deviation  will cause incorrect results\n+ * and undefined behaviour.\n+ *\n+ * This API exists to support environments that wish to route the\n+ * SHA256 compression step through a hardware-accelerated or otherwise\n+ * specialized implementation. It is not meant for modifying the\n+ * semantics of SHA256.\n+ *\n+ * Args: ctx:    pointer to a context object.\n+ * In: callback: pointer to a function implementing the compression step.\n+ *               (passing NULL restores the default implementation)\n+ */\n+SECP256K1_API void secp256k1_context_set_sha256_transform(\n+        secp256k1_context *ctx,\n+        secp256k1_sha256_transform_fn fn_transform\n+) SECP256K1_ARG_NONNULL(1);",
      "path": "include/secp256k1.h",
      "position": 60,
      "original_position": 63,
      "commit_id": "b892a33f553a8a6d356d7919fe2e5123323b341a",
      "original_commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "in_reply_to_id": null,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "We should use the same terminology here, too. \n\nI'd vote for \"compression function\" instead of \"transform\". It's the term you'd find in the cryptographic literature. Some APIs call the state update \"update\", some call it \"transform\". But in either case, they refer to updating the entire internal state *including the byte/block count*, which is not what we're doing here. Moreover, \"SHA256 transform\" could be misread as (the whole) \"SHA256 function\". So I believe \"compression function\" is the most precise term for our purposes.",
      "created_at": "2026-01-06T13:24:29Z",
      "updated_at": "2026-01-06T13:46:08Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2664917482",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2664917482"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": 425,
      "original_start_line": 427,
      "start_side": "RIGHT",
      "line": 445,
      "original_line": 445,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2664931828",
      "pull_request_review_id": 3630308699,
      "id": 2664931828,
      "node_id": "PRRC_kwDOAP4Jqs6e16H0",
      "diff_hunk": "@@ -60,7 +60,12 @@ int secp256k1_ecdh(const secp256k1_context* ctx, unsigned char *output, const se\n     secp256k1_fe_get_b32(x, &pt.x);\n     secp256k1_fe_get_b32(y, &pt.y);\n \n-    ret = hashfp(output, x, y, data);\n+    if (hashfp == NULL) {\n+        /* Use context-aware function by default */",
      "path": "src/modules/ecdh/main_impl.h",
      "position": 1,
      "original_position": 46,
      "commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "original_commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "in_reply_to_id": null,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit (multiple times):\n```suggestion\n        /* Use ctx-aware function by default */\n```\n\nOr \"secp256k1_context-aware\". This makes it clear that the comment refers to the context object. I was confused first because \"context-aware\" is an ordinary English word used in many contexts in which \"context\" has a much less specific meaning.",
      "created_at": "2026-01-06T13:29:23Z",
      "updated_at": "2026-01-06T13:46:08Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2664931828",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2664931828"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 64,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2664937951",
      "pull_request_review_id": 3630308699,
      "id": 2664937951,
      "node_id": "PRRC_kwDOAP4Jqs6e17nf",
      "diff_hunk": "@@ -572,8 +580,15 @@ int secp256k1_ellswift_xdh(const secp256k1_context *ctx, unsigned char *output,\n     secp256k1_fe_normalize(&px);\n     secp256k1_fe_get_b32(sx, &px);\n \n-    /* Invoke hasher */\n-    ret = hashfp(output, sx, ell_a64, ell_b64, data);\n+    /* Invoke hasher.\n+     * Use context-aware function when custom SHA256 is provided */",
      "path": "src/modules/ellswift/main_impl.h",
      "position": 1,
      "original_position": 159,
      "commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "original_commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "in_reply_to_id": null,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "```suggestion\n     * Use ctx-aware function by default\n```\nThis may use the context-aware function even if no custom SHA256 (transform) is provided.",
      "created_at": "2026-01-06T13:31:39Z",
      "updated_at": "2026-01-06T13:46:08Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2664937951",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2664937951"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 584,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2664978535",
      "pull_request_review_id": 3630308699,
      "id": 2664978535,
      "node_id": "PRRC_kwDOAP4Jqs6e2Fhn",
      "diff_hunk": "@@ -11,6 +11,14 @@\n #include \"testrand.h\"\n #include \"util.h\"\n \n+/* Helper for when we need to check that the custom sha256 transform was called */\n+#define DEFINE_SHA256_TRANSFORM_PROBE(name)                                     \\\n+    static int name##_called = 0;                                               \\\n+    static void name(uint32_t *s, const unsigned char *msg, size_t rounds) {    \\\n+        name##_called = 1;                                                      \\\n+        secp256k1_sha256_transform(s, msg, rounds);                             \\\n+    }",
      "path": "src/testutil.h",
      "position": 1,
      "original_position": 10,
      "commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "original_commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "in_reply_to_id": null,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I believe what we actually want to test here is not that the custom SHA256 was called but that the ctx-aware function was called. If I'm right, this may be simpler to test: The ctx-aware function will always be the \"default\" function, e.g., the default ECDH hash function. So shouldn't it suffice to check correctness of ECDH once with the default function (NULL) and once with a custom hash function (*not* custom SHA256 transform)? \n",
      "created_at": "2026-01-06T13:45:31Z",
      "updated_at": "2026-01-06T13:46:08Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2664978535",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2664978535"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": 14,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 20,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2687220606",
      "pull_request_review_id": 3648679735,
      "id": 2687220606,
      "node_id": "PRRC_kwDOAP4Jqs6gK7t-",
      "diff_hunk": "@@ -404,6 +404,49 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/**\n+ * SHA256 block compression raw primitive.\n+ *\n+ * This function performs the SHA256 compression on one or more contiguous\n+ * 64-byte message blocks. It does **not** perform padding, message scheduling\n+ * across blocks, or length encoding.",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 27,
      "commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "original_commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "in_reply_to_id": 2664419592,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> What is \"message scheduling across blocks\"?\r\n\r\nTried to state that the function operates only on complete 64-byte blocks and does not retain or combine leftover data between calls. E.g. calling it twice with two 32-byte inputs will not buffer them into a single 64-byte block; the function expects fully formed blocks and anything else is caller misuse.\r\nProbably just saying that the function only accepts 64-byte **finalized** blocks is enough and better.\r\n\r\n> \"length encoding\" is part of padding, no?\r\n\r\nYeah, I tend to think of padding as just the zero fill.., but specs wise this is wrong. The msg length is officially part of the padding.",
      "created_at": "2026-01-13T16:42:46Z",
      "updated_at": "2026-01-13T17:21:45Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2687220606",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2687220606"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": 410,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 412,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2687890597",
      "pull_request_review_id": 3657651805,
      "id": 2687890597,
      "node_id": "PRRC_kwDOAP4Jqs6gNfSl",
      "diff_hunk": "@@ -11,6 +11,14 @@\n #include \"testrand.h\"\n #include \"util.h\"\n \n+/* Helper for when we need to check that the custom sha256 transform was called */\n+#define DEFINE_SHA256_TRANSFORM_PROBE(name)                                     \\\n+    static int name##_called = 0;                                               \\\n+    static void name(uint32_t *s, const unsigned char *msg, size_t rounds) {    \\\n+        name##_called = 1;                                                      \\\n+        secp256k1_sha256_transform(s, msg, rounds);                             \\\n+    }",
      "path": "src/testutil.h",
      "position": 1,
      "original_position": 10,
      "commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "original_commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "in_reply_to_id": 2664978535,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "what you mean with \"custom hash function (not custom SHA256 transform)\"?\r\n\r\nThe idea of the test was to verify that:\r\n1) Default behavior remains unchanged when the ctx compression function is not set.\r\n2) The custom compression function is actually called when provided. And because such function is correct, the complete ECDH test passes (and the same holds for the other processes that rely on the ctx-provided compression function)\r\n\r\n---------------------------\r\n\r\n\r\nUpdate:\r\nI think I understand your point now.. changing the compression function to something that isn’t SHA256 shouldn’t break the test. So this could be simplified. However, it still wouldn't pass the `secp256k1_selftest_sha256` check during the callback set.",
      "created_at": "2026-01-13T19:48:20Z",
      "updated_at": "2026-01-13T20:17:30Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2687890597",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2687890597"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": 14,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 20,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2687950100",
      "pull_request_review_id": 3657732049,
      "id": 2687950100,
      "node_id": "PRRC_kwDOAP4Jqs6gNt0U",
      "diff_hunk": "@@ -404,6 +404,49 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/**\n+ * SHA256 block compression raw primitive.",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 23,
      "commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "original_commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "in_reply_to_id": 2664388966,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Agree. Done as suggested. Thanks",
      "created_at": "2026-01-13T20:02:01Z",
      "updated_at": "2026-01-13T20:02:01Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2687950100",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2687950100"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 408,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2687950674",
      "pull_request_review_id": 3657732850,
      "id": 2687950674,
      "node_id": "PRRC_kwDOAP4Jqs6gNt9S",
      "diff_hunk": "@@ -404,6 +404,49 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/**\n+ * SHA256 block compression raw primitive.\n+ *\n+ * This function performs the SHA256 compression on one or more contiguous\n+ * 64-byte message blocks. It does **not** perform padding, message scheduling\n+ * across blocks, or length encoding.",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 27,
      "commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "original_commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "in_reply_to_id": 2664419592,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done, updated per suggestion.",
      "created_at": "2026-01-13T20:02:13Z",
      "updated_at": "2026-01-13T20:02:13Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2687950674",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2687950674"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": 410,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 412,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2687951280",
      "pull_request_review_id": 3657733928,
      "id": 2687951280,
      "node_id": "PRRC_kwDOAP4Jqs6gNuGw",
      "diff_hunk": "@@ -404,6 +404,49 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/**\n+ * SHA256 block compression raw primitive.\n+ *\n+ * This function performs the SHA256 compression on one or more contiguous\n+ * 64-byte message blocks. It does **not** perform padding, message scheduling\n+ * across blocks, or length encoding.\n+ *\n+ * Parameters:\n+ * - `state`    Pointer to eight 32-bit words representing the current state.\n+ *              The state is updated in place.\n+ * - `blocks64` Pointer to the first 64-byte block; additional blocks must be\n+ *              contiguous in memory.\n+ * - `n_blocks` Number of contiguous 64-byte blocks to process.",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 34,
      "commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "original_commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "in_reply_to_id": 2664427626,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done as suggested. Thanks",
      "created_at": "2026-01-13T20:02:21Z",
      "updated_at": "2026-01-13T20:02:21Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2687951280",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2687951280"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": 414,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 419,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2687956977",
      "pull_request_review_id": 3657741503,
      "id": 2687956977,
      "node_id": "PRRC_kwDOAP4Jqs6gNvfx",
      "diff_hunk": "@@ -404,6 +404,49 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/**\n+ * SHA256 block compression raw primitive.\n+ *\n+ * This function performs the SHA256 compression on one or more contiguous\n+ * 64-byte message blocks. It does **not** perform padding, message scheduling\n+ * across blocks, or length encoding.\n+ *\n+ * Parameters:\n+ * - `state`    Pointer to eight 32-bit words representing the current state.\n+ *              The state is updated in place.\n+ * - `blocks64` Pointer to the first 64-byte block; additional blocks must be\n+ *              contiguous in memory.\n+ * - `n_blocks` Number of contiguous 64-byte blocks to process.\n+ */\n+typedef void (*secp256k1_sha256_transform_fn)(\n+    uint32_t* state,\n+    const unsigned char* blocks64,\n+    size_t n_blocks\n+);\n+\n+/**\n+ * Set a callback function to override the internal SHA256 transform.\n+ *\n+ * This installs a function to replace the built-in block-compression\n+ * step used by the library's internal SHA256 implementation.\n+ * The provided callback must be functionally identical (bit-for-bit)\n+ * to the default transform. Any deviation  will cause incorrect results\n+ * and undefined behaviour.\n+ *\n+ * This API exists to support environments that wish to route the\n+ * SHA256 compression step through a hardware-accelerated or otherwise\n+ * specialized implementation. It is not meant for modifying the\n+ * semantics of SHA256.\n+ *\n+ * Args: ctx:    pointer to a context object.\n+ * In: callback: pointer to a function implementing the compression step.\n+ *               (passing NULL restores the default implementation)\n+ */\n+SECP256K1_API void secp256k1_context_set_sha256_transform(\n+        secp256k1_context *ctx,\n+        secp256k1_sha256_transform_fn fn_transform\n+) SECP256K1_ARG_NONNULL(1);",
      "path": "include/secp256k1.h",
      "position": 60,
      "original_position": 63,
      "commit_id": "b892a33f553a8a6d356d7919fe2e5123323b341a",
      "original_commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "in_reply_to_id": 2664917482,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Yeah sure, updated to use \"compression function\" everywhere.",
      "created_at": "2026-01-13T20:03:43Z",
      "updated_at": "2026-01-13T20:03:43Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2687956977",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2687956977"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": 425,
      "original_start_line": 427,
      "start_side": "RIGHT",
      "line": 445,
      "original_line": 445,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2687957578",
      "pull_request_review_id": 3657742292,
      "id": 2687957578,
      "node_id": "PRRC_kwDOAP4Jqs6gNvpK",
      "diff_hunk": "@@ -60,7 +60,12 @@ int secp256k1_ecdh(const secp256k1_context* ctx, unsigned char *output, const se\n     secp256k1_fe_get_b32(x, &pt.x);\n     secp256k1_fe_get_b32(y, &pt.y);\n \n-    ret = hashfp(output, x, y, data);\n+    if (hashfp == NULL) {\n+        /* Use context-aware function by default */",
      "path": "src/modules/ecdh/main_impl.h",
      "position": 1,
      "original_position": 46,
      "commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "original_commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "in_reply_to_id": 2664931828,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Sure, done as suggested.",
      "created_at": "2026-01-13T20:03:56Z",
      "updated_at": "2026-01-13T20:03:56Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2687957578",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2687957578"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 64,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2687959235",
      "pull_request_review_id": 3657744203,
      "id": 2687959235,
      "node_id": "PRRC_kwDOAP4Jqs6gNwDD",
      "diff_hunk": "@@ -572,8 +580,15 @@ int secp256k1_ellswift_xdh(const secp256k1_context *ctx, unsigned char *output,\n     secp256k1_fe_normalize(&px);\n     secp256k1_fe_get_b32(sx, &px);\n \n-    /* Invoke hasher */\n-    ret = hashfp(output, sx, ell_a64, ell_b64, data);\n+    /* Invoke hasher.\n+     * Use context-aware function when custom SHA256 is provided */",
      "path": "src/modules/ellswift/main_impl.h",
      "position": 1,
      "original_position": 159,
      "commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "original_commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "in_reply_to_id": 2664937951,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done as suggested.",
      "created_at": "2026-01-13T20:04:28Z",
      "updated_at": "2026-01-13T20:04:29Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2687959235",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2687959235"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 584,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2687971187",
      "pull_request_review_id": 3657760411,
      "id": 2687971187,
      "node_id": "PRRC_kwDOAP4Jqs6gNy9z",
      "diff_hunk": "@@ -403,6 +404,47 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/** A pointer to a function implementing SHA256's internal compression function.\n+ *\n+ * This function processes one or more contiguous 64-byte message blocks and\n+ * updates the internal SHA256 state accordingly. The function is not responsible\n+ * for counting consumed blocks or bytes, nor for performing padding.\n+ *\n+ * Out:     state:     pointer to eight 32-bit words representing the current internal state;",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 18,
      "commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "original_commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "This should probably be labelled \"In/Out\".",
      "created_at": "2026-01-13T20:09:05Z",
      "updated_at": "2026-01-13T20:48:12Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2687971187",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2687971187"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 413,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2687979274",
      "pull_request_review_id": 3657760411,
      "id": 2687979274,
      "node_id": "PRRC_kwDOAP4Jqs6gN08K",
      "diff_hunk": "@@ -403,6 +404,47 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/** A pointer to a function implementing SHA256's internal compression function.\n+ *\n+ * This function processes one or more contiguous 64-byte message blocks and\n+ * updates the internal SHA256 state accordingly. The function is not responsible\n+ * for counting consumed blocks or bytes, nor for performing padding.\n+ *\n+ * Out:     state:     pointer to eight 32-bit words representing the current internal state;\n+ *                     the state is updated in place.\n+ * In:      blocks64:  pointer to the first 64-byte block; additional blocks must",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 20,
      "commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "original_commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "\"Pointer to concatenation of n_blocks blocks, of 64 bytes each\". Maybe also worth mentioning that there is no alignment guarantee on the input?",
      "created_at": "2026-01-13T20:11:58Z",
      "updated_at": "2026-01-13T20:48:12Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2687979274",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2687979274"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 415,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2687985330",
      "pull_request_review_id": 3657760411,
      "id": 2687985330,
      "node_id": "PRRC_kwDOAP4Jqs6gN2ay",
      "diff_hunk": "@@ -403,6 +404,47 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/** A pointer to a function implementing SHA256's internal compression function.\n+ *\n+ * This function processes one or more contiguous 64-byte message blocks and\n+ * updates the internal SHA256 state accordingly. The function is not responsible\n+ * for counting consumed blocks or bytes, nor for performing padding.\n+ *\n+ * Out:     state:     pointer to eight 32-bit words representing the current internal state;\n+ *                     the state is updated in place.\n+ * In:      blocks64:  pointer to the first 64-byte block; additional blocks must\n+ *                     be contiguous in memory.\n+ *          n_blocks:  number of contiguous 64-byte blocks to process.\n+ */\n+typedef void (*secp256k1_sha256_compression_fn)(\n+    uint32_t* state,\n+    const unsigned char* blocks64,\n+    size_t n_blocks\n+);\n+\n+/**\n+ * Set a callback function to override the internal SHA256 compression function.\n+ *\n+ * This installs a function to replace the built-in block-compression\n+ * step used by the library's internal SHA256 implementation.\n+ * The provided callback must be functionally identical (bit-for-bit)\n+ * to the default compression function. Any deviation will cause incorrect",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 36,
      "commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "original_commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "It seems hard to a reader of this file to guess what the exact behavior of the default compression function is without specifying it.\n\nHow about \"The provided callback must exactly implement the effect of n_blocks repeated applications of the SHA-256 compression function.\"",
      "created_at": "2026-01-13T20:14:03Z",
      "updated_at": "2026-01-13T20:48:12Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2687985330",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2687985330"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 431,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2687991506",
      "pull_request_review_id": 3657760411,
      "id": 2687991506,
      "node_id": "PRRC_kwDOAP4Jqs6gN37S",
      "diff_hunk": "@@ -403,6 +404,47 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/** A pointer to a function implementing SHA256's internal compression function.\n+ *\n+ * This function processes one or more contiguous 64-byte message blocks and\n+ * updates the internal SHA256 state accordingly. The function is not responsible\n+ * for counting consumed blocks or bytes, nor for performing padding.\n+ *\n+ * Out:     state:     pointer to eight 32-bit words representing the current internal state;\n+ *                     the state is updated in place.\n+ * In:      blocks64:  pointer to the first 64-byte block; additional blocks must\n+ *                     be contiguous in memory.\n+ *          n_blocks:  number of contiguous 64-byte blocks to process.\n+ */\n+typedef void (*secp256k1_sha256_compression_fn)(\n+    uint32_t* state,\n+    const unsigned char* blocks64,\n+    size_t n_blocks\n+);\n+\n+/**\n+ * Set a callback function to override the internal SHA256 compression function.\n+ *\n+ * This installs a function to replace the built-in block-compression\n+ * step used by the library's internal SHA256 implementation.\n+ * The provided callback must be functionally identical (bit-for-bit)\n+ * to the default compression function. Any deviation will cause incorrect\n+ * results and undefined behavior.\n+ *\n+ * This API exists to support environments that wish to route the\n+ * SHA256 compression step through a hardware-accelerated or otherwise\n+ * specialized implementation. It is not meant for modifying the\n+ * semantics of SHA256.",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 42,
      "commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "original_commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Maybe \"It is not meant for replacing the use of SHA-256 in this library with a modified hash function\"?\n\nModifying the semantics of SHA-256 sounds hard, as it may involve $5 wrench attacks on a few NIST officials.",
      "created_at": "2026-01-13T20:16:04Z",
      "updated_at": "2026-01-13T20:48:12Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2687991506",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2687991506"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 437,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2688042779",
      "pull_request_review_id": 3657760411,
      "id": 2688042779,
      "node_id": "PRRC_kwDOAP4Jqs6gOEcb",
      "diff_hunk": "@@ -49,7 +49,7 @@ static const unsigned char bip340_algo[] = {'B', 'I', 'P', '0', '3', '4', '0', '\n \n static const unsigned char schnorrsig_extraparams_magic[4] = SECP256K1_SCHNORRSIG_EXTRAPARAMS_MAGIC;\n \n-static int nonce_function_bip340(unsigned char *nonce32, const unsigned char *msg, size_t msglen, const unsigned char *key32, const unsigned char *xonly_pk32, const unsigned char *algo, size_t algolen, void *data) {\n+static int nonce_function_bip340_impl(const secp256k1_context *ctx, unsigned char *nonce32, const unsigned char *msg, size_t msglen, const unsigned char *key32, const unsigned char *xonly_pk32, const unsigned char *algo, size_t algolen, void *data) {",
      "path": "src/modules/schnorrsig/main_impl.h",
      "position": 1,
      "original_position": 5,
      "commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "original_commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "In these calls (and many similar ones in other parts of the codebase), I think it would be better to have them take a `const secp256k1_sha256_context *ctx` argument. That would:\n* Make it clear they're not actually dependent on other context data.\n* Avoid the many `secp256k1_get_hash_context(ctx)` calls in their implementation.\n* Maybe provide better inlining opportunities for the compiler when invoked with the default transform context as argument, rather than needing to reason through `secp256k1_context_static` (unsure).\n\nIf somehow there is need later for them to access more context information, the argument can always be changed to `secp256k1_context` as they're internal only.\n",
      "created_at": "2026-01-13T20:35:00Z",
      "updated_at": "2026-01-13T20:48:12Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2688042779",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2688042779"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 52,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2688069217",
      "pull_request_review_id": 3657760411,
      "id": 2688069217,
      "node_id": "PRRC_kwDOAP4Jqs6gOK5h",
      "diff_hunk": "@@ -123,17 +123,31 @@ static void secp256k1_sha256_transform(uint32_t* s, const unsigned char* buf) {\n     s[7] += h;\n }\n \n-static void secp256k1_sha256_write(secp256k1_sha256 *hash, const unsigned char *data, size_t len) {\n+static void secp256k1_sha256_transform(uint32_t *state, const unsigned char *blocks64, size_t n_blocks) {\n+    while (n_blocks--) {\n+        secp256k1_sha256_transform_impl(state, blocks64);\n+        blocks64 += 64;\n+    }\n+}\n+\n+static void secp256k1_hash_context_init(secp256k1_hash_context* hash_ctx) {\n+    VERIFY_CHECK(hash_ctx != NULL);\n+    hash_ctx->fn_sha256_compression = secp256k1_sha256_transform;\n+}\n+\n+static void secp256k1_sha256_write(secp256k1_sha256 *hash, const unsigned char *data, size_t len, const secp256k1_hash_context *ctx) {\n     size_t bufsize = hash->bytes & 0x3F;\n     hash->bytes += len;\n     VERIFY_CHECK(hash->bytes >= len);\n+    VERIFY_CHECK(ctx != NULL);\n+    VERIFY_CHECK(ctx->fn_sha256_compression != NULL);\n     while (len >= 64 - bufsize) {",
      "path": "src/hash_impl.h",
      "position": 1,
      "original_position": 32,
      "commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "original_commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "There is an easy way to take advantage of the fact that the compression function can deal with multiple blocks now, by splitting the processing in 3 steps:\n* `if (bufsize && len >= 64 - bufsize)`: fill the buffer, and invoke compression function on the buffer, wipe the buffer.\n* `if (len >= 64)`: invoke the compression function directly on the input, with `len / 64` blocks.\n* `if (len >= 0)`: append to the buffer, don't invoke.\n\nFeel free to do here or in a follow-up.",
      "created_at": "2026-01-13T20:45:16Z",
      "updated_at": "2026-01-13T20:48:12Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2688069217",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2688069217"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 144,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2688209025",
      "pull_request_review_id": 3658043786,
      "id": 2688209025,
      "node_id": "PRRC_kwDOAP4Jqs6gOtCB",
      "diff_hunk": "@@ -403,6 +404,47 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/** A pointer to a function implementing SHA256's internal compression function.\n+ *\n+ * This function processes one or more contiguous 64-byte message blocks and\n+ * updates the internal SHA256 state accordingly. The function is not responsible\n+ * for counting consumed blocks or bytes, nor for performing padding.\n+ *\n+ * Out:     state:     pointer to eight 32-bit words representing the current internal state;",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 18,
      "commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "original_commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "in_reply_to_id": 2687971187,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "upps, yeah. Thanks.",
      "created_at": "2026-01-13T21:39:30Z",
      "updated_at": "2026-01-14T17:21:21Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2688209025",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2688209025"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 413,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2688209108",
      "pull_request_review_id": 3658043786,
      "id": 2688209108,
      "node_id": "PRRC_kwDOAP4Jqs6gOtDU",
      "diff_hunk": "@@ -403,6 +404,47 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/** A pointer to a function implementing SHA256's internal compression function.\n+ *\n+ * This function processes one or more contiguous 64-byte message blocks and\n+ * updates the internal SHA256 state accordingly. The function is not responsible\n+ * for counting consumed blocks or bytes, nor for performing padding.\n+ *\n+ * Out:     state:     pointer to eight 32-bit words representing the current internal state;\n+ *                     the state is updated in place.\n+ * In:      blocks64:  pointer to the first 64-byte block; additional blocks must",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 20,
      "commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "original_commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "in_reply_to_id": 2687979274,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "sure, added.",
      "created_at": "2026-01-13T21:39:33Z",
      "updated_at": "2026-01-14T17:21:21Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2688209108",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2688209108"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 415,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2688215547",
      "pull_request_review_id": 3658043786,
      "id": 2688215547,
      "node_id": "PRRC_kwDOAP4Jqs6gOun7",
      "diff_hunk": "@@ -403,6 +404,47 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/** A pointer to a function implementing SHA256's internal compression function.\n+ *\n+ * This function processes one or more contiguous 64-byte message blocks and\n+ * updates the internal SHA256 state accordingly. The function is not responsible\n+ * for counting consumed blocks or bytes, nor for performing padding.\n+ *\n+ * Out:     state:     pointer to eight 32-bit words representing the current internal state;\n+ *                     the state is updated in place.\n+ * In:      blocks64:  pointer to the first 64-byte block; additional blocks must\n+ *                     be contiguous in memory.\n+ *          n_blocks:  number of contiguous 64-byte blocks to process.\n+ */\n+typedef void (*secp256k1_sha256_compression_fn)(\n+    uint32_t* state,\n+    const unsigned char* blocks64,\n+    size_t n_blocks\n+);\n+\n+/**\n+ * Set a callback function to override the internal SHA256 compression function.\n+ *\n+ * This installs a function to replace the built-in block-compression\n+ * step used by the library's internal SHA256 implementation.\n+ * The provided callback must be functionally identical (bit-for-bit)\n+ * to the default compression function. Any deviation will cause incorrect",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 36,
      "commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "original_commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "in_reply_to_id": 2687985330,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "sure. Done as suggested.",
      "created_at": "2026-01-13T21:42:05Z",
      "updated_at": "2026-01-14T17:21:21Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2688215547",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2688215547"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 431,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2688218679",
      "pull_request_review_id": 3658043786,
      "id": 2688218679,
      "node_id": "PRRC_kwDOAP4Jqs6gOvY3",
      "diff_hunk": "@@ -403,6 +404,47 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/** A pointer to a function implementing SHA256's internal compression function.\n+ *\n+ * This function processes one or more contiguous 64-byte message blocks and\n+ * updates the internal SHA256 state accordingly. The function is not responsible\n+ * for counting consumed blocks or bytes, nor for performing padding.\n+ *\n+ * Out:     state:     pointer to eight 32-bit words representing the current internal state;\n+ *                     the state is updated in place.\n+ * In:      blocks64:  pointer to the first 64-byte block; additional blocks must\n+ *                     be contiguous in memory.\n+ *          n_blocks:  number of contiguous 64-byte blocks to process.\n+ */\n+typedef void (*secp256k1_sha256_compression_fn)(\n+    uint32_t* state,\n+    const unsigned char* blocks64,\n+    size_t n_blocks\n+);\n+\n+/**\n+ * Set a callback function to override the internal SHA256 compression function.\n+ *\n+ * This installs a function to replace the built-in block-compression\n+ * step used by the library's internal SHA256 implementation.\n+ * The provided callback must be functionally identical (bit-for-bit)\n+ * to the default compression function. Any deviation will cause incorrect\n+ * results and undefined behavior.\n+ *\n+ * This API exists to support environments that wish to route the\n+ * SHA256 compression step through a hardware-accelerated or otherwise\n+ * specialized implementation. It is not meant for modifying the\n+ * semantics of SHA256.",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 42,
      "commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "original_commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "in_reply_to_id": 2687991506,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "hehe sure, thanks.",
      "created_at": "2026-01-13T21:43:22Z",
      "updated_at": "2026-01-14T17:21:21Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2688218679",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2688218679"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 437,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2690488778",
      "pull_request_review_id": 3660812792,
      "id": 2690488778,
      "node_id": "PRRC_kwDOAP4Jqs6gXZnK",
      "diff_hunk": "@@ -403,6 +404,47 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/** A pointer to a function implementing SHA256's internal compression function.\n+ *\n+ * This function processes one or more contiguous 64-byte message blocks and\n+ * updates the internal SHA256 state accordingly. The function is not responsible\n+ * for counting consumed blocks or bytes, nor for performing padding.\n+ *\n+ * Out:     state:     pointer to eight 32-bit words representing the current internal state;\n+ *                     the state is updated in place.\n+ * In:      blocks64:  pointer to the first 64-byte block; additional blocks must\n+ *                     be contiguous in memory.\n+ *          n_blocks:  number of contiguous 64-byte blocks to process.\n+ */\n+typedef void (*secp256k1_sha256_compression_fn)(\n+    uint32_t* state,\n+    const unsigned char* blocks64,\n+    size_t n_blocks\n+);\n+\n+/**\n+ * Set a callback function to override the internal SHA256 compression function.\n+ *\n+ * This installs a function to replace the built-in block-compression\n+ * step used by the library's internal SHA256 implementation.\n+ * The provided callback must be functionally identical (bit-for-bit)\n+ * to the default compression function. Any deviation will cause incorrect\n+ * results and undefined behavior.\n+ *\n+ * This API exists to support environments that wish to route the\n+ * SHA256 compression step through a hardware-accelerated or otherwise\n+ * specialized implementation. It is not meant for modifying the\n+ * semantics of SHA256.",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 42,
      "commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "original_commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "in_reply_to_id": 2687991506,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Good point. A bit simpler even: \"It is not meant for replacing SHA-256 with a different hash function\".",
      "created_at": "2026-01-14T13:46:13Z",
      "updated_at": "2026-01-14T13:46:13Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2690488778",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2690488778"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 437,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2690909726",
      "pull_request_review_id": 3658043786,
      "id": 2690909726,
      "node_id": "PRRC_kwDOAP4Jqs6gZAYe",
      "diff_hunk": "@@ -123,17 +123,31 @@ static void secp256k1_sha256_transform(uint32_t* s, const unsigned char* buf) {\n     s[7] += h;\n }\n \n-static void secp256k1_sha256_write(secp256k1_sha256 *hash, const unsigned char *data, size_t len) {\n+static void secp256k1_sha256_transform(uint32_t *state, const unsigned char *blocks64, size_t n_blocks) {\n+    while (n_blocks--) {\n+        secp256k1_sha256_transform_impl(state, blocks64);\n+        blocks64 += 64;\n+    }\n+}\n+\n+static void secp256k1_hash_context_init(secp256k1_hash_context* hash_ctx) {\n+    VERIFY_CHECK(hash_ctx != NULL);\n+    hash_ctx->fn_sha256_compression = secp256k1_sha256_transform;\n+}\n+\n+static void secp256k1_sha256_write(secp256k1_sha256 *hash, const unsigned char *data, size_t len, const secp256k1_hash_context *ctx) {\n     size_t bufsize = hash->bytes & 0x3F;\n     hash->bytes += len;\n     VERIFY_CHECK(hash->bytes >= len);\n+    VERIFY_CHECK(ctx != NULL);\n+    VERIFY_CHECK(ctx->fn_sha256_compression != NULL);\n     while (len >= 64 - bufsize) {",
      "path": "src/hash_impl.h",
      "position": 1,
      "original_position": 32,
      "commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "original_commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "in_reply_to_id": 2688069217,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nice idea!\r\nThe last `if (len >= 0)` should be `if (len > 0)` but rest looks great. Applied.\r\nAlso added test coverage for it.",
      "created_at": "2026-01-14T15:24:14Z",
      "updated_at": "2026-01-14T18:55:10Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2690909726",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2690909726"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 144,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2691351202",
      "pull_request_review_id": 3658043786,
      "id": 2691351202,
      "node_id": "PRRC_kwDOAP4Jqs6gasKi",
      "diff_hunk": "@@ -49,7 +49,7 @@ static const unsigned char bip340_algo[] = {'B', 'I', 'P', '0', '3', '4', '0', '\n \n static const unsigned char schnorrsig_extraparams_magic[4] = SECP256K1_SCHNORRSIG_EXTRAPARAMS_MAGIC;\n \n-static int nonce_function_bip340(unsigned char *nonce32, const unsigned char *msg, size_t msglen, const unsigned char *key32, const unsigned char *xonly_pk32, const unsigned char *algo, size_t algolen, void *data) {\n+static int nonce_function_bip340_impl(const secp256k1_context *ctx, unsigned char *nonce32, const unsigned char *msg, size_t msglen, const unsigned char *key32, const unsigned char *xonly_pk32, const unsigned char *algo, size_t algolen, void *data) {",
      "path": "src/modules/schnorrsig/main_impl.h",
      "position": 1,
      "original_position": 5,
      "commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "original_commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "in_reply_to_id": 2688042779,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "I actually went back and forth with this topic a few times. But sure. Done as suggested.",
      "created_at": "2026-01-14T17:20:36Z",
      "updated_at": "2026-01-14T17:21:21Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2691351202",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2691351202"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 52,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2715818734",
      "pull_request_review_id": 3691189188,
      "id": 2715818734,
      "node_id": "PRRC_kwDOAP4Jqs6h4Bru",
      "diff_hunk": "@@ -479,6 +479,99 @@ static void run_plug_sha256_compression_tests(void) {\n     secp256k1_context_destroy(ctx_cloned);\n }\n \n+static void run_sha256_multi_block_compression_tests(void) {\n+    secp256k1_hash_context hash_ctx;\n+    secp256k1_sha256 sha256_one;\n+    secp256k1_sha256 sha256_two;\n+    unsigned char out_one[32], out_two[32];\n+\n+    hash_ctx.fn_sha256_compression = secp256k1_sha256_transform;\n+\n+    {   /* 1) Writing one 64-byte full block vs two 32-byte blocks */\n+        const unsigned char data[64] = \"totally serious test message to hash, definitely no random data\";\n+        unsigned char data32[32];\n+\n+        secp256k1_sha256_initialize(&sha256_one);\n+        secp256k1_sha256_initialize(&sha256_two);\n+\n+        /* Write the 64-byte block */\n+        secp256k1_sha256_write(&sha256_one, data, 64, &hash_ctx);\n+        secp256k1_sha256_finalize(&sha256_one, out_one, &hash_ctx);\n+\n+        /* Write the two 32-byte blocks */\n+        memcpy(data32, data, 32);\n+        secp256k1_sha256_write(&sha256_two, data32, 32, &hash_ctx);\n+        memcpy(data32, data + 32, 32);\n+        secp256k1_sha256_write(&sha256_two, data32, 32, &hash_ctx);\n+        secp256k1_sha256_finalize(&sha256_two, out_two, &hash_ctx);\n+\n+        CHECK(memcmp(out_one, out_two, 32) == 0);",
      "path": "src/tests.c",
      "position": 1,
      "original_position": 30,
      "commit_id": "8b45a8ff589560350ed8918d258b303adf990019",
      "original_commit_id": "8b45a8ff589560350ed8918d258b303adf990019",
      "in_reply_to_id": null,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "It's probably debatable now (somewhere else), but CONTRIBUTING.md says you should use `secp256k1_memcmp_var` instead of `memcmp`.\n\n(4 times in this function.)",
      "created_at": "2026-01-22T08:26:41Z",
      "updated_at": "2026-01-22T08:31:22Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2715818734",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2715818734"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 508,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2715826972",
      "pull_request_review_id": 3691189188,
      "id": 2715826972,
      "node_id": "PRRC_kwDOAP4Jqs6h4Dsc",
      "diff_hunk": "@@ -136,22 +136,34 @@ static void secp256k1_hash_context_init(secp256k1_hash_context *hash_ctx) {\n }\n \n static void secp256k1_sha256_write(secp256k1_sha256 *hash, const unsigned char *data, size_t len, const secp256k1_hash_context *ctx) {\n+    size_t chunk_len;\n     size_t bufsize = hash->bytes & 0x3F;\n     hash->bytes += len;\n     VERIFY_CHECK(hash->bytes >= len);\n     VERIFY_CHECK(ctx != NULL);\n     VERIFY_CHECK(ctx->fn_sha256_compression != NULL);\n-    while (len >= 64 - bufsize) {\n-        /* Fill the buffer, and process it. */\n-        size_t chunk_len = 64 - bufsize;\n+\n+    /* If we exceed the 64-byte block size with this input, process it and wipe the buffer */\n+    chunk_len = 64 - bufsize;\n+    if (bufsize && len >= chunk_len) {\n         memcpy(hash->buf + bufsize, data, chunk_len);\n         data += chunk_len;\n         len -= chunk_len;\n         ctx->fn_sha256_compression(hash->s, hash->buf, 1);\n         bufsize = 0;\n     }\n+\n+    /* If we still have data to process; Invoke compression directly on the input */",
      "path": "src/hash_impl.h",
      "position": 1,
      "original_position": 24,
      "commit_id": "8b45a8ff589560350ed8918d258b303adf990019",
      "original_commit_id": "8b45a8ff589560350ed8918d258b303adf990019",
      "in_reply_to_id": null,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "nit: \"If we still have data to process, invoke compression directly on the input\" (why a semi-colon?)",
      "created_at": "2026-01-22T08:29:23Z",
      "updated_at": "2026-01-22T08:31:22Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2715826972",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2715826972"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 156,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2716156358",
      "pull_request_review_id": 3691584844,
      "id": 2716156358,
      "node_id": "PRRC_kwDOAP4Jqs6h5UHG",
      "diff_hunk": "@@ -49,7 +49,7 @@ static const unsigned char bip340_algo[] = {'B', 'I', 'P', '0', '3', '4', '0', '\n \n static const unsigned char schnorrsig_extraparams_magic[4] = SECP256K1_SCHNORRSIG_EXTRAPARAMS_MAGIC;\n \n-static int nonce_function_bip340(unsigned char *nonce32, const unsigned char *msg, size_t msglen, const unsigned char *key32, const unsigned char *xonly_pk32, const unsigned char *algo, size_t algolen, void *data) {\n+static int nonce_function_bip340_impl(const secp256k1_context *ctx, unsigned char *nonce32, const unsigned char *msg, size_t msglen, const unsigned char *key32, const unsigned char *xonly_pk32, const unsigned char *algo, size_t algolen, void *data) {",
      "path": "src/modules/schnorrsig/main_impl.h",
      "position": 1,
      "original_position": 5,
      "commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "original_commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "in_reply_to_id": 2688042779,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "All of these comments are related to style, so take these as suggestions but not \"hard\" requests:\r\n\r\n - It's probably a bit arbitrary to draw a line between functions that get the full context and functions that get only the hash context. My feeling is that it should be the hash context when the primary purpose of the function is hashing, and this roughly seems to match what you've done, but we could go a bit further even and include functions like `secp256k1_schnorrsig_challenge`, `secp256k1_ellswift_prng`, `secp256k1_nonce_function_musig`/`secp256k1_nonce_function_musig_helper`, `secp256k1_musig_compute_noncehash`, `nonce_function_rfc6979_impl`.\r\n - The argument is now sometimes called `hash_ctx` and sometimes `ctx`. I prefer the former to distinguish it clearly from the \"full\" context. It could also be `hctx` for brevity. \r\n- If we feel that `secp256k1_get_hash_context(ctx)` is a bit long, we could also rename it to `secp256k1_get_hash_ctx(ctx)` or `_get_hctx` depending on the previous point. I'd also be fine with `&ctx->hash_ctx` or `&ctx->hctx`. Given that we use it many times, it will be an idiom already once this PR is merged. (Also fine with keeping as-is if you like the long name!)\r\n- Argument order: We usually have the ctx first. This is a rule for API calls, and we typically follow it internally, too. So it would make sense to have the hash context also first, I think. If I'm not mistaken, you followed this rule for all functions except for the `secp256k1_sha256_` functions. (Was this intentional?)",
      "created_at": "2026-01-22T09:55:30Z",
      "updated_at": "2026-01-22T09:55:30Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2716156358",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2716156358"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 52,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2716196991",
      "pull_request_review_id": 3691631622,
      "id": 2716196991,
      "node_id": "PRRC_kwDOAP4Jqs6h5eB_",
      "diff_hunk": "@@ -63,13 +63,16 @@ struct secp256k1_context_struct {\n     secp256k1_callback illegal_callback;\n     secp256k1_callback error_callback;\n     int declassify;\n+\n+    secp256k1_hash_context hash_context;\n };",
      "path": "src/secp256k1.c",
      "position": 1,
      "original_position": 6,
      "commit_id": "8b45a8ff589560350ed8918d258b303adf990019",
      "original_commit_id": "8b45a8ff589560350ed8918d258b303adf990019",
      "in_reply_to_id": null,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": " - You overlooked the comment. :)\n - The naming should probably be `hash_ctx` (or even `hctx` you prefer this) for consistency with the other member `ecmult_gen_ctx`.\n - And I believe we could use a more natural order and move `hash_context` after `ecmult_gen_ctx`. (I hate to think about ABI compatibility, but this shouldn't be a problem here at all because contexts are entirely opaque)?  ",
      "created_at": "2026-01-22T10:07:05Z",
      "updated_at": "2026-01-22T10:07:05Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2716196991",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2716196991"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": 59,
      "original_start_line": 59,
      "start_side": "RIGHT",
      "line": 67,
      "original_line": 67,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2717592876",
      "pull_request_review_id": 3693294417,
      "id": 2717592876,
      "node_id": "PRRC_kwDOAP4Jqs6h-y0s",
      "diff_hunk": "@@ -49,7 +49,7 @@ static const unsigned char bip340_algo[] = {'B', 'I', 'P', '0', '3', '4', '0', '\n \n static const unsigned char schnorrsig_extraparams_magic[4] = SECP256K1_SCHNORRSIG_EXTRAPARAMS_MAGIC;\n \n-static int nonce_function_bip340(unsigned char *nonce32, const unsigned char *msg, size_t msglen, const unsigned char *key32, const unsigned char *xonly_pk32, const unsigned char *algo, size_t algolen, void *data) {\n+static int nonce_function_bip340_impl(const secp256k1_context *ctx, unsigned char *nonce32, const unsigned char *msg, size_t msglen, const unsigned char *key32, const unsigned char *xonly_pk32, const unsigned char *algo, size_t algolen, void *data) {",
      "path": "src/modules/schnorrsig/main_impl.h",
      "position": 1,
      "original_position": 5,
      "commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "original_commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "in_reply_to_id": 2688042779,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> If we feel that secp256k1_get_hash_context(ctx) is a bit long, we could also rename it to secp256k1_get_hash_ctx(ctx) or _get_hctx depending on the previous point. I'd also be fine with &ctx->hash_ctx or &ctx->hctx. Given that we use it many times, it will be an idiom already once this PR is merged. (Also fine with keeping as-is if you like the long name!)\r\n\r\nI considered renaming it as well, but wanted to keep consistency with the setter naming. All existing callback setters are named `secp256k1_context_set_<something>`, so the getters \"should\" be `secp256k1_context_get_<something>`.\r\n\r\nThat was my conclusion, though I'm fine shortening the getter name if consistency over this two functions isn't a concern.",
      "created_at": "2026-01-22T16:11:07Z",
      "updated_at": "2026-01-22T16:11:08Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2717592876",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2717592876"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 52,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2718398952",
      "pull_request_review_id": 3694286650,
      "id": 2718398952,
      "node_id": "PRRC_kwDOAP4Jqs6iB3no",
      "diff_hunk": "@@ -49,7 +49,7 @@ static const unsigned char bip340_algo[] = {'B', 'I', 'P', '0', '3', '4', '0', '\n \n static const unsigned char schnorrsig_extraparams_magic[4] = SECP256K1_SCHNORRSIG_EXTRAPARAMS_MAGIC;\n \n-static int nonce_function_bip340(unsigned char *nonce32, const unsigned char *msg, size_t msglen, const unsigned char *key32, const unsigned char *xonly_pk32, const unsigned char *algo, size_t algolen, void *data) {\n+static int nonce_function_bip340_impl(const secp256k1_context *ctx, unsigned char *nonce32, const unsigned char *msg, size_t msglen, const unsigned char *key32, const unsigned char *xonly_pk32, const unsigned char *algo, size_t algolen, void *data) {",
      "path": "src/modules/schnorrsig/main_impl.h",
      "position": 1,
      "original_position": 5,
      "commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "original_commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "in_reply_to_id": 2688042779,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "All suggestions applied (except the one above). Even when it was a mechanical change, took me more than what I expected to tackle them 🐜 ",
      "created_at": "2026-01-22T19:55:28Z",
      "updated_at": "2026-01-22T20:06:31Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2718398952",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2718398952"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 52,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2718400529",
      "pull_request_review_id": 3694286650,
      "id": 2718400529,
      "node_id": "PRRC_kwDOAP4Jqs6iB4AR",
      "diff_hunk": "@@ -479,6 +479,99 @@ static void run_plug_sha256_compression_tests(void) {\n     secp256k1_context_destroy(ctx_cloned);\n }\n \n+static void run_sha256_multi_block_compression_tests(void) {\n+    secp256k1_hash_context hash_ctx;\n+    secp256k1_sha256 sha256_one;\n+    secp256k1_sha256 sha256_two;\n+    unsigned char out_one[32], out_two[32];\n+\n+    hash_ctx.fn_sha256_compression = secp256k1_sha256_transform;\n+\n+    {   /* 1) Writing one 64-byte full block vs two 32-byte blocks */\n+        const unsigned char data[64] = \"totally serious test message to hash, definitely no random data\";\n+        unsigned char data32[32];\n+\n+        secp256k1_sha256_initialize(&sha256_one);\n+        secp256k1_sha256_initialize(&sha256_two);\n+\n+        /* Write the 64-byte block */\n+        secp256k1_sha256_write(&sha256_one, data, 64, &hash_ctx);\n+        secp256k1_sha256_finalize(&sha256_one, out_one, &hash_ctx);\n+\n+        /* Write the two 32-byte blocks */\n+        memcpy(data32, data, 32);\n+        secp256k1_sha256_write(&sha256_two, data32, 32, &hash_ctx);\n+        memcpy(data32, data + 32, 32);\n+        secp256k1_sha256_write(&sha256_two, data32, 32, &hash_ctx);\n+        secp256k1_sha256_finalize(&sha256_two, out_two, &hash_ctx);\n+\n+        CHECK(memcmp(out_one, out_two, 32) == 0);",
      "path": "src/tests.c",
      "position": 1,
      "original_position": 30,
      "commit_id": "8b45a8ff589560350ed8918d258b303adf990019",
      "original_commit_id": "8b45a8ff589560350ed8918d258b303adf990019",
      "in_reply_to_id": 2715818734,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Sure, done as suggested.",
      "created_at": "2026-01-22T19:55:54Z",
      "updated_at": "2026-01-22T20:06:31Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2718400529",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2718400529"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 508,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2718425186",
      "pull_request_review_id": 3694339931,
      "id": 2718425186,
      "node_id": "PRRC_kwDOAP4Jqs6iB-Bi",
      "diff_hunk": "@@ -49,7 +49,7 @@ static const unsigned char bip340_algo[] = {'B', 'I', 'P', '0', '3', '4', '0', '\n \n static const unsigned char schnorrsig_extraparams_magic[4] = SECP256K1_SCHNORRSIG_EXTRAPARAMS_MAGIC;\n \n-static int nonce_function_bip340(unsigned char *nonce32, const unsigned char *msg, size_t msglen, const unsigned char *key32, const unsigned char *xonly_pk32, const unsigned char *algo, size_t algolen, void *data) {\n+static int nonce_function_bip340_impl(const secp256k1_context *ctx, unsigned char *nonce32, const unsigned char *msg, size_t msglen, const unsigned char *key32, const unsigned char *xonly_pk32, const unsigned char *algo, size_t algolen, void *data) {",
      "path": "src/modules/schnorrsig/main_impl.h",
      "position": 1,
      "original_position": 5,
      "commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "original_commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "in_reply_to_id": 2688042779,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "That makes perfect sense. If a function seems too cluttered with getter calls, we still have the options to store the hash context in a local variable, or move the getter call into the caller.",
      "created_at": "2026-01-22T20:01:25Z",
      "updated_at": "2026-01-22T20:01:34Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2718425186",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2718425186"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 52,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2718431017",
      "pull_request_review_id": 3694286650,
      "id": 2718431017,
      "node_id": "PRRC_kwDOAP4Jqs6iB_cp",
      "diff_hunk": "@@ -136,22 +136,34 @@ static void secp256k1_hash_context_init(secp256k1_hash_context *hash_ctx) {\n }\n \n static void secp256k1_sha256_write(secp256k1_sha256 *hash, const unsigned char *data, size_t len, const secp256k1_hash_context *ctx) {\n+    size_t chunk_len;\n     size_t bufsize = hash->bytes & 0x3F;\n     hash->bytes += len;\n     VERIFY_CHECK(hash->bytes >= len);\n     VERIFY_CHECK(ctx != NULL);\n     VERIFY_CHECK(ctx->fn_sha256_compression != NULL);\n-    while (len >= 64 - bufsize) {\n-        /* Fill the buffer, and process it. */\n-        size_t chunk_len = 64 - bufsize;\n+\n+    /* If we exceed the 64-byte block size with this input, process it and wipe the buffer */\n+    chunk_len = 64 - bufsize;\n+    if (bufsize && len >= chunk_len) {\n         memcpy(hash->buf + bufsize, data, chunk_len);\n         data += chunk_len;\n         len -= chunk_len;\n         ctx->fn_sha256_compression(hash->s, hash->buf, 1);\n         bufsize = 0;\n     }\n+\n+    /* If we still have data to process; Invoke compression directly on the input */",
      "path": "src/hash_impl.h",
      "position": 1,
      "original_position": 24,
      "commit_id": "8b45a8ff589560350ed8918d258b303adf990019",
      "original_commit_id": "8b45a8ff589560350ed8918d258b303adf990019",
      "in_reply_to_id": 2715826972,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done as suggested. Dunno how the semicolon and the capitalized \"invoke\" got there..\r\nI probably had two different sentences and merged them at the end in the worst possible way.",
      "created_at": "2026-01-22T20:02:37Z",
      "updated_at": "2026-01-22T20:06:31Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2718431017",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2718431017"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 156,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2718431619",
      "pull_request_review_id": 3694347328,
      "id": 2718431619,
      "node_id": "PRRC_kwDOAP4Jqs6iB_mD",
      "diff_hunk": "@@ -11,6 +11,14 @@\n #include \"testrand.h\"\n #include \"util.h\"\n \n+/* Helper for when we need to check that the custom sha256 transform was called */\n+#define DEFINE_SHA256_TRANSFORM_PROBE(name)                                     \\\n+    static int name##_called = 0;                                               \\\n+    static void name(uint32_t *s, const unsigned char *msg, size_t rounds) {    \\\n+        name##_called = 1;                                                      \\\n+        secp256k1_sha256_transform(s, msg, rounds);                             \\\n+    }",
      "path": "src/testutil.h",
      "position": 1,
      "original_position": 10,
      "commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "original_commit_id": "041a6217fa709b17ae869a75ac2bba0d217f49db",
      "in_reply_to_id": 2664978535,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> I think I understand your point now..\r\n\r\nI don't think so, but I also think my point was mistaken. Let me resolve this conversation and start a new one. :D",
      "created_at": "2026-01-22T20:02:46Z",
      "updated_at": "2026-01-22T20:02:46Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2718431619",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2718431619"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": 14,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 20,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2718437194",
      "pull_request_review_id": 3694286650,
      "id": 2718437194,
      "node_id": "PRRC_kwDOAP4Jqs6iCA9K",
      "diff_hunk": "@@ -63,13 +63,16 @@ struct secp256k1_context_struct {\n     secp256k1_callback illegal_callback;\n     secp256k1_callback error_callback;\n     int declassify;\n+\n+    secp256k1_hash_context hash_context;\n };",
      "path": "src/secp256k1.c",
      "position": 1,
      "original_position": 6,
      "commit_id": "8b45a8ff589560350ed8918d258b303adf990019",
      "original_commit_id": "8b45a8ff589560350ed8918d258b303adf990019",
      "in_reply_to_id": 2716196991,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> * You overlooked the comment. :)\r\n\r\nupps, done. Thanks.\r\n\r\n> * The naming should probably be hash_ctx (or even hctx you prefer this) for consistency with the other member ecmult_gen_ctx.\r\n> * And I believe we could use a more natural order and move hash_context after ecmult_gen_ctx. (I hate to think about ABI compatibility, but this shouldn't be a problem here at all because contexts are entirely opaque)?\r\n\r\nSure. Done as suggested.\r\n\r\n",
      "created_at": "2026-01-22T20:04:12Z",
      "updated_at": "2026-01-22T20:06:31Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2718437194",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2718437194"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": 59,
      "original_start_line": 59,
      "start_side": "RIGHT",
      "line": 67,
      "original_line": 67,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2718610110",
      "pull_request_review_id": 3694569639,
      "id": 2718610110,
      "node_id": "PRRC_kwDOAP4Jqs6iCrK-",
      "diff_hunk": "@@ -68,28 +69,41 @@ static void test_ecdh_generator_basepoint(void) {\n         testutil_random_scalar_order(&s);\n         secp256k1_scalar_get_b32(s_b32, &s);\n \n-        CHECK(secp256k1_ec_pubkey_create(CTX, &point[0], s_one) == 1);\n-        CHECK(secp256k1_ec_pubkey_create(CTX, &point[1], s_b32) == 1);\n+        CHECK(secp256k1_ec_pubkey_create(ctx, &point[0], s_one) == 1);\n+        CHECK(secp256k1_ec_pubkey_create(ctx, &point[1], s_b32) == 1);\n \n         /* compute using ECDH function with custom hash function */\n-        CHECK(secp256k1_ecdh(CTX, output_ecdh, &point[0], s_b32, ecdh_hash_function_custom, NULL) == 1);\n+        CHECK(secp256k1_ecdh(ctx, output_ecdh, &point[0], s_b32, ecdh_hash_function_custom, NULL) == 1);\n         /* compute \"explicitly\" */\n-        CHECK(secp256k1_ec_pubkey_serialize(CTX, point_ser, &point_ser_len, &point[1], SECP256K1_EC_UNCOMPRESSED) == 1);\n+        CHECK(secp256k1_ec_pubkey_serialize(ctx, point_ser, &point_ser_len, &point[1], SECP256K1_EC_UNCOMPRESSED) == 1);\n         /* compare */\n         CHECK(secp256k1_memcmp_var(output_ecdh, point_ser, 65) == 0);\n \n         /* compute using ECDH function with default hash function */\n-        CHECK(secp256k1_ecdh(CTX, output_ecdh, &point[0], s_b32, NULL, NULL) == 1);\n+        CHECK(secp256k1_ecdh(ctx, output_ecdh, &point[0], s_b32, NULL, NULL) == 1);\n         /* compute \"explicitly\" */\n-        CHECK(secp256k1_ec_pubkey_serialize(CTX, point_ser, &point_ser_len, &point[1], SECP256K1_EC_COMPRESSED) == 1);\n+        CHECK(secp256k1_ec_pubkey_serialize(ctx, point_ser, &point_ser_len, &point[1], SECP256K1_EC_COMPRESSED) == 1);\n         secp256k1_sha256_initialize(&sha);\n-        secp256k1_sha256_write(&sha, point_ser, point_ser_len);\n-        secp256k1_sha256_finalize(&sha, output_ser);\n+        secp256k1_sha256_write(secp256k1_get_hash_context(ctx), &sha, point_ser, point_ser_len);\n+        secp256k1_sha256_finalize(secp256k1_get_hash_context(ctx), &sha, output_ser);\n         /* compare */\n         CHECK(secp256k1_memcmp_var(output_ecdh, output_ser, 32) == 0);\n     }\n }\n \n+DEFINE_SHA256_TRANSFORM_PROBE(sha256_ecdh)\n+static void test_ecdh_generator_basepoint(void) {\n+    secp256k1_context *ctx = secp256k1_context_clone(CTX);\n+    /* Baseline run using the default SHA256 implementation */\n+    test_ecdh_generator_basepoint_impl(ctx);\n+\n+    /* Re-run using a ctx-provided SHA256 compression */\n+    secp256k1_context_set_sha256_compression(ctx, sha256_ecdh);\n+    test_ecdh_generator_basepoint_impl(ctx);\n+    CHECK(sha256_ecdh_called);\n+    secp256k1_context_destroy(ctx);\n+}",
      "path": "src/modules/ecdh/tests_impl.h",
      "position": 43,
      "original_position": 70,
      "commit_id": "b892a33f553a8a6d356d7919fe2e5123323b341a",
      "original_commit_id": "82519578a640eafeebe65c4ea72e4839d397e0c7",
      "in_reply_to_id": null,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "What is the point of this test? The baseline run makes sense, of course, but it already exists on master.\r\n\r\nFor the re-run, I'm not entirely sure what it is supposed to test. \r\n  1. The first thing it tests is that `test_ecdh_generator_basepoint_impl` still passes when an external SHA256 compression function is set. But that's not very surprising given that the \"external\" function simply delegates to the internal one. I don't think that this is a very meaningful test.\r\n 2. The other thing it tests is that the custom function was actually called. This is not entirely a meaningful test because the test function itself `test_ecdh_generator_basepoint_impl` has `secp256k1_sha256_write` and `secp256k1_finalize` calls. So we're testing the test function here and not `secp256k1_ecdh`.\r\n\r\nI suspect you had the second item in mind, but simply overlooked the internal sha256 calls? \r\n\r\n---\r\n\r\nAnyway, I believe a test that this PR should add is:\r\n1. If an external compression function is set, then `secp256k1_ecdh(..., NULL, ...)` calls the external compression.\r\nWe could also add this:\r\n2. If the external compression function is removed (set to NULL) afterwards, then `secp256k1_ecdh(..., NULL, ...)` won't call the external compression again. Not sure if it adds much.\r\n\r\nAnd I suspect that's enough in the case of ECDH. Another new thing is the branch on `hashfp == NULL` and we want to make sure to test both sides of it. The desired test 1 I described above exercises the \"then\" branch. And the \"else\" branch should already be covered by existing tests (and `hashfp` function won't have access to a ctx, so whether it uses an external or internal compression is not a meaningful question). \r\n\r\nAnd I guess what I said here will apply more or less to the tests in the other modules as well. \r\n\r\n\r\nedit: I still have to look at your most recent updates, but let me say that this one here is my last comment, so everything else is ACK and we're almost ready to go from my side. ",
      "created_at": "2026-01-22T20:58:55Z",
      "updated_at": "2026-01-22T21:01:59Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2718610110",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2718610110"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 116,
      "original_line": 116,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2718613426",
      "pull_request_review_id": 3694573382,
      "id": 2718613426,
      "node_id": "PRRC_kwDOAP4Jqs6iCr-y",
      "diff_hunk": "@@ -49,7 +49,7 @@ static const unsigned char bip340_algo[] = {'B', 'I', 'P', '0', '3', '4', '0', '\n \n static const unsigned char schnorrsig_extraparams_magic[4] = SECP256K1_SCHNORRSIG_EXTRAPARAMS_MAGIC;\n \n-static int nonce_function_bip340(unsigned char *nonce32, const unsigned char *msg, size_t msglen, const unsigned char *key32, const unsigned char *xonly_pk32, const unsigned char *algo, size_t algolen, void *data) {\n+static int nonce_function_bip340_impl(const secp256k1_context *ctx, unsigned char *nonce32, const unsigned char *msg, size_t msglen, const unsigned char *key32, const unsigned char *xonly_pk32, const unsigned char *algo, size_t algolen, void *data) {",
      "path": "src/modules/schnorrsig/main_impl.h",
      "position": 1,
      "original_position": 5,
      "commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "original_commit_id": "fd7bf4950024dfcb835022b42a97ee9ec8c5d3ee",
      "in_reply_to_id": 2688042779,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "> All suggestions applied (except the one above). Even when it was a mechanical change, took me more than what I expected to tackle them 🐜\r\n\r\nthanks for your stamina!",
      "created_at": "2026-01-22T21:00:11Z",
      "updated_at": "2026-01-22T21:00:11Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2718613426",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2718613426"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 52,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2722497838",
      "pull_request_review_id": 3699169438,
      "id": 2722497838,
      "node_id": "PRRC_kwDOAP4Jqs6iRgUu",
      "diff_hunk": "@@ -68,28 +69,41 @@ static void test_ecdh_generator_basepoint(void) {\n         testutil_random_scalar_order(&s);\n         secp256k1_scalar_get_b32(s_b32, &s);\n \n-        CHECK(secp256k1_ec_pubkey_create(CTX, &point[0], s_one) == 1);\n-        CHECK(secp256k1_ec_pubkey_create(CTX, &point[1], s_b32) == 1);\n+        CHECK(secp256k1_ec_pubkey_create(ctx, &point[0], s_one) == 1);\n+        CHECK(secp256k1_ec_pubkey_create(ctx, &point[1], s_b32) == 1);\n \n         /* compute using ECDH function with custom hash function */\n-        CHECK(secp256k1_ecdh(CTX, output_ecdh, &point[0], s_b32, ecdh_hash_function_custom, NULL) == 1);\n+        CHECK(secp256k1_ecdh(ctx, output_ecdh, &point[0], s_b32, ecdh_hash_function_custom, NULL) == 1);\n         /* compute \"explicitly\" */\n-        CHECK(secp256k1_ec_pubkey_serialize(CTX, point_ser, &point_ser_len, &point[1], SECP256K1_EC_UNCOMPRESSED) == 1);\n+        CHECK(secp256k1_ec_pubkey_serialize(ctx, point_ser, &point_ser_len, &point[1], SECP256K1_EC_UNCOMPRESSED) == 1);\n         /* compare */\n         CHECK(secp256k1_memcmp_var(output_ecdh, point_ser, 65) == 0);\n \n         /* compute using ECDH function with default hash function */\n-        CHECK(secp256k1_ecdh(CTX, output_ecdh, &point[0], s_b32, NULL, NULL) == 1);\n+        CHECK(secp256k1_ecdh(ctx, output_ecdh, &point[0], s_b32, NULL, NULL) == 1);\n         /* compute \"explicitly\" */\n-        CHECK(secp256k1_ec_pubkey_serialize(CTX, point_ser, &point_ser_len, &point[1], SECP256K1_EC_COMPRESSED) == 1);\n+        CHECK(secp256k1_ec_pubkey_serialize(ctx, point_ser, &point_ser_len, &point[1], SECP256K1_EC_COMPRESSED) == 1);\n         secp256k1_sha256_initialize(&sha);\n-        secp256k1_sha256_write(&sha, point_ser, point_ser_len);\n-        secp256k1_sha256_finalize(&sha, output_ser);\n+        secp256k1_sha256_write(secp256k1_get_hash_context(ctx), &sha, point_ser, point_ser_len);\n+        secp256k1_sha256_finalize(secp256k1_get_hash_context(ctx), &sha, output_ser);\n         /* compare */\n         CHECK(secp256k1_memcmp_var(output_ecdh, output_ser, 32) == 0);\n     }\n }\n \n+DEFINE_SHA256_TRANSFORM_PROBE(sha256_ecdh)\n+static void test_ecdh_generator_basepoint(void) {\n+    secp256k1_context *ctx = secp256k1_context_clone(CTX);\n+    /* Baseline run using the default SHA256 implementation */\n+    test_ecdh_generator_basepoint_impl(ctx);\n+\n+    /* Re-run using a ctx-provided SHA256 compression */\n+    secp256k1_context_set_sha256_compression(ctx, sha256_ecdh);\n+    test_ecdh_generator_basepoint_impl(ctx);\n+    CHECK(sha256_ecdh_called);\n+    secp256k1_context_destroy(ctx);\n+}",
      "path": "src/modules/ecdh/tests_impl.h",
      "position": 43,
      "original_position": 70,
      "commit_id": "b892a33f553a8a6d356d7919fe2e5123323b341a",
      "original_commit_id": "82519578a640eafeebe65c4ea72e4839d397e0c7",
      "in_reply_to_id": 2718610110,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done. Ended up skipping the SHA256 output sanity check during setup so that we can modify the compression function and assert that the results from the default compression versus the ctx-provided one are different.\r\n\r\nI know I could have simplified `DEFINE_SHA256_TRANSFORM_PROBE` even more by not calling the internal function at all and always returning a random or fixed value, but I think behaving like a real one-way compression function is better for testing.",
      "created_at": "2026-01-23T19:13:08Z",
      "updated_at": "2026-01-23T19:29:28Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2722497838",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2722497838"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 116,
      "original_line": 116,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2755447121",
      "pull_request_review_id": 3740886096,
      "id": 2755447121,
      "node_id": "PRRC_kwDOAP4Jqs6kPMlR",
      "diff_hunk": "@@ -403,6 +404,46 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/** A pointer to a function implementing SHA256's internal compression function.\n+ *\n+ * This function processes one or more contiguous 64-byte message blocks and\n+ * updates the internal SHA256 state accordingly. The function is not responsible\n+ * for counting consumed blocks or bytes, nor for performing padding.\n+ *\n+ * In/Out:  state:     pointer to eight 32-bit words representing the current internal state;\n+ *                     the state is updated in place.\n+ * In:      blocks64:  pointer to concatenation of n_blocks blocks, of 64 bytes each.\n+ *                     no alignment guarantees are made for this pointer.\n+ *          n_blocks:  number of contiguous 64-byte blocks to process.\n+ */\n+typedef void (*secp256k1_sha256_compression_fn)(\n+    uint32_t *state,\n+    const unsigned char *blocks64,\n+    size_t n_blocks\n+);\n+\n+/**\n+ * Set a callback function to override the internal SHA256 compression function.\n+ *\n+ * This installs a function to replace the built-in block-compression\n+ * step used by the library's internal SHA256 implementation.\n+ * The provided callback must exactly implement the effect of n_blocks\n+ * repeated applications of the SHA256 compression function.\n+ *\n+ * This API exists to support environments that wish to route the\n+ * SHA256 compression step through a hardware-accelerated or otherwise\n+ * specialized implementation. It is NOT meant for replacing SHA256\n+ * with a different hash function.\n+ *\n+ * Args:    ctx:       pointer to a context object.\n+ * In:      callback:  pointer to a function implementing the compression function;",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 44,
      "commit_id": "a1d98f2025f30fbae3409e1ad98eed4aeb264d8f",
      "original_commit_id": "a1d98f2025f30fbae3409e1ad98eed4aeb264d8f",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "```suggestion\n * In:      fn_compression:  pointer to a function implementing the compression function;\n```",
      "created_at": "2026-02-02T17:22:11Z",
      "updated_at": "2026-02-02T17:39:44Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2755447121",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2755447121"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 439,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2755461912",
      "pull_request_review_id": 3740886096,
      "id": 2755461912,
      "node_id": "PRRC_kwDOAP4Jqs6kPQMY",
      "diff_hunk": "@@ -7413,6 +7419,7 @@ static void test_ecdsa_wycheproof(void) {\n     #include \"wycheproof/ecdsa_secp256k1_sha256_bitcoin_test.h\"\n \n     int t;\n+    const secp256k1_hash_ctx* hash_ctx = secp256k1_get_hash_context(CTX);",
      "path": "src/tests.c",
      "position": 1,
      "original_position": 219,
      "commit_id": "7ec96fce681a5ef9f3da01800aa82f4d509871c7",
      "original_commit_id": "7ec96fce681a5ef9f3da01800aa82f4d509871c7",
      "in_reply_to_id": null,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "coding style nit (as per [conventions](https://github.com/bitcoin-core/secp256k1/blob/57315a69853c9bd4765fccf20b541d47f1b45ca9/CONTRIBUTING.md?plain=1#L72)):\n```suggestion\n    const secp256k1_hash_ctx *hash_ctx = secp256k1_get_hash_context(CTX);\n```",
      "created_at": "2026-02-02T17:26:06Z",
      "updated_at": "2026-02-02T17:39:44Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2755461912",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2755461912"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 7422,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2755678259",
      "pull_request_review_id": 3741178668,
      "id": 2755678259,
      "node_id": "PRRC_kwDOAP4Jqs6kQFAz",
      "diff_hunk": "@@ -403,6 +404,46 @@ SECP256K1_API void secp256k1_context_set_error_callback(\n     const void *data\n ) SECP256K1_ARG_NONNULL(1);\n \n+/** A pointer to a function implementing SHA256's internal compression function.\n+ *\n+ * This function processes one or more contiguous 64-byte message blocks and\n+ * updates the internal SHA256 state accordingly. The function is not responsible\n+ * for counting consumed blocks or bytes, nor for performing padding.\n+ *\n+ * In/Out:  state:     pointer to eight 32-bit words representing the current internal state;\n+ *                     the state is updated in place.\n+ * In:      blocks64:  pointer to concatenation of n_blocks blocks, of 64 bytes each.\n+ *                     no alignment guarantees are made for this pointer.\n+ *          n_blocks:  number of contiguous 64-byte blocks to process.\n+ */\n+typedef void (*secp256k1_sha256_compression_fn)(\n+    uint32_t *state,\n+    const unsigned char *blocks64,\n+    size_t n_blocks\n+);\n+\n+/**\n+ * Set a callback function to override the internal SHA256 compression function.\n+ *\n+ * This installs a function to replace the built-in block-compression\n+ * step used by the library's internal SHA256 implementation.\n+ * The provided callback must exactly implement the effect of n_blocks\n+ * repeated applications of the SHA256 compression function.\n+ *\n+ * This API exists to support environments that wish to route the\n+ * SHA256 compression step through a hardware-accelerated or otherwise\n+ * specialized implementation. It is NOT meant for replacing SHA256\n+ * with a different hash function.\n+ *\n+ * Args:    ctx:       pointer to a context object.\n+ * In:      callback:  pointer to a function implementing the compression function;",
      "path": "include/secp256k1.h",
      "position": 1,
      "original_position": 44,
      "commit_id": "a1d98f2025f30fbae3409e1ad98eed4aeb264d8f",
      "original_commit_id": "a1d98f2025f30fbae3409e1ad98eed4aeb264d8f",
      "in_reply_to_id": 2755447121,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done. Thanks.",
      "created_at": "2026-02-02T18:23:27Z",
      "updated_at": "2026-02-02T18:23:28Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2755678259",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2755678259"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 439,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2755678430",
      "pull_request_review_id": 3741178867,
      "id": 2755678430,
      "node_id": "PRRC_kwDOAP4Jqs6kQFDe",
      "diff_hunk": "@@ -7413,6 +7419,7 @@ static void test_ecdsa_wycheproof(void) {\n     #include \"wycheproof/ecdsa_secp256k1_sha256_bitcoin_test.h\"\n \n     int t;\n+    const secp256k1_hash_ctx* hash_ctx = secp256k1_get_hash_context(CTX);",
      "path": "src/tests.c",
      "position": 1,
      "original_position": 219,
      "commit_id": "7ec96fce681a5ef9f3da01800aa82f4d509871c7",
      "original_commit_id": "7ec96fce681a5ef9f3da01800aa82f4d509871c7",
      "in_reply_to_id": 2755461912,
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "body": "Done. Thanks.",
      "created_at": "2026-02-02T18:23:31Z",
      "updated_at": "2026-02-02T18:23:31Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1777#discussion_r2755678430",
      "author_association": "MEMBER",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/2755678430"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1777"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 7422,
      "side": "RIGHT"
    }
  ]
}