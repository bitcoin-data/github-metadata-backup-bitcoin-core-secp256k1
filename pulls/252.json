{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/252",
    "id": 35544824,
    "node_id": "MDExOlB1bGxSZXF1ZXN0MzU1NDQ4MjQ=",
    "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252",
    "diff_url": "https://github.com/bitcoin-core/secp256k1/pull/252.diff",
    "patch_url": "https://github.com/bitcoin-core/secp256k1/pull/252.patch",
    "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/252",
    "commits_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/252/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/252/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/252/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin-core/secp256k1/statuses/72ae443afb536221a8523646ea4a88162341c3df",
    "number": 252,
    "state": "closed",
    "locked": false,
    "maintainer_can_modify": false,
    "title": "Add constant-time point multplication for ECDH",
    "user": {
      "login": "apoelstra",
      "id": 1351933,
      "node_id": "MDQ6VXNlcjEzNTE5MzM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/apoelstra",
      "html_url": "https://github.com/apoelstra",
      "followers_url": "https://api.github.com/users/apoelstra/followers",
      "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
      "organizations_url": "https://api.github.com/users/apoelstra/orgs",
      "repos_url": "https://api.github.com/users/apoelstra/repos",
      "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/apoelstra/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Add constant-time `secp256k1_point_multiply` for ECDH\n\nDesigned with clear separation of the wNAF conversion, precomputation\nand exponentiation (since the precomp at least we will probably want\nto separate in the API for users who reuse points a lot).\n\nFuture work:\n- actually separate precomp in the API \n- do multiexp rather than single exponentiation\n",
    "labels": [],
    "created_at": "2015-05-15T19:48:41Z",
    "updated_at": "2017-06-19T13:21:47Z",
    "closed_at": "2015-08-02T17:33:20Z",
    "mergeable_state": "unknown",
    "merged_at": "2015-08-02T17:33:20Z",
    "merge_commit_sha": "0f33e5187dbc289cfa4402888ef523014c527cb7",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "head": {
      "label": "apoelstra:ecdh-mult",
      "ref": "ecdh-mult",
      "sha": "72ae443afb536221a8523646ea4a88162341c3df",
      "user": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 33787691,
        "node_id": "MDEwOlJlcG9zaXRvcnkzMzc4NzY5MQ==",
        "name": "secp256k1",
        "full_name": "apoelstra/secp256k1",
        "owner": {
          "login": "apoelstra",
          "id": 1351933,
          "node_id": "MDQ6VXNlcjEzNTE5MzM=",
          "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/apoelstra",
          "html_url": "https://github.com/apoelstra",
          "followers_url": "https://api.github.com/users/apoelstra/followers",
          "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
          "organizations_url": "https://api.github.com/users/apoelstra/orgs",
          "repos_url": "https://api.github.com/users/apoelstra/repos",
          "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/apoelstra/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/apoelstra/secp256k1",
        "description": "Optimized C library for EC operations on curve secp256k1",
        "fork": true,
        "url": "https://api.github.com/repos/apoelstra/secp256k1",
        "archive_url": "https://api.github.com/repos/apoelstra/secp256k1/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/apoelstra/secp256k1/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/apoelstra/secp256k1/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/apoelstra/secp256k1/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/apoelstra/secp256k1/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/apoelstra/secp256k1/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/apoelstra/secp256k1/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/apoelstra/secp256k1/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/apoelstra/secp256k1/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/apoelstra/secp256k1/contributors",
        "deployments_url": "https://api.github.com/repos/apoelstra/secp256k1/deployments",
        "downloads_url": "https://api.github.com/repos/apoelstra/secp256k1/downloads",
        "events_url": "https://api.github.com/repos/apoelstra/secp256k1/events",
        "forks_url": "https://api.github.com/repos/apoelstra/secp256k1/forks",
        "git_commits_url": "https://api.github.com/repos/apoelstra/secp256k1/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/apoelstra/secp256k1/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/apoelstra/secp256k1/git/tags%7B/sha%7D",
        "git_url": "git://github.com/apoelstra/secp256k1.git",
        "issue_comment_url": "https://api.github.com/repos/apoelstra/secp256k1/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/apoelstra/secp256k1/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/apoelstra/secp256k1/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/apoelstra/secp256k1/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/apoelstra/secp256k1/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/apoelstra/secp256k1/languages",
        "merges_url": "https://api.github.com/repos/apoelstra/secp256k1/merges",
        "milestones_url": "https://api.github.com/repos/apoelstra/secp256k1/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/apoelstra/secp256k1/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/apoelstra/secp256k1/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/apoelstra/secp256k1/releases%7B/id%7D",
        "ssh_url": "git@github.com:apoelstra/secp256k1.git",
        "stargazers_url": "https://api.github.com/repos/apoelstra/secp256k1/stargazers",
        "statuses_url": "https://api.github.com/repos/apoelstra/secp256k1/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/apoelstra/secp256k1/subscribers",
        "subscription_url": "https://api.github.com/repos/apoelstra/secp256k1/subscription",
        "tags_url": "https://api.github.com/repos/apoelstra/secp256k1/tags",
        "teams_url": "https://api.github.com/repos/apoelstra/secp256k1/teams",
        "trees_url": "https://api.github.com/repos/apoelstra/secp256k1/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/apoelstra/secp256k1.git",
        "hooks_url": "https://api.github.com/repos/apoelstra/secp256k1/hooks",
        "svn_url": "https://github.com/apoelstra/secp256k1",
        "language": "C",
        "forks_count": 1,
        "stargazers_count": 0,
        "watchers_count": 0,
        "size": 2888,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": true,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2021-05-06T18:52:16Z",
        "created_at": "2015-04-11T18:42:06Z",
        "updated_at": "2020-04-18T08:27:37Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin-core:master",
      "ref": "master",
      "sha": "ae4f0c6eecd67ee514d6d6ae99ec949c084e300c",
      "user": {
        "login": "bitcoin-core",
        "id": 13464320,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEzNDY0MzIw",
        "avatar_url": "https://avatars.githubusercontent.com/u/13464320?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin-core",
        "html_url": "https://github.com/bitcoin-core",
        "followers_url": "https://api.github.com/users/bitcoin-core/followers",
        "following_url": "https://api.github.com/users/bitcoin-core/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin-core/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin-core/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin-core/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin-core/orgs",
        "repos_url": "https://api.github.com/users/bitcoin-core/repos",
        "events_url": "https://api.github.com/users/bitcoin-core/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin-core/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 16648618,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNjY0ODYxOA==",
        "name": "secp256k1",
        "full_name": "bitcoin-core/secp256k1",
        "owner": {
          "login": "bitcoin-core",
          "id": 13464320,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjEzNDY0MzIw",
          "avatar_url": "https://avatars.githubusercontent.com/u/13464320?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin-core",
          "html_url": "https://github.com/bitcoin-core",
          "followers_url": "https://api.github.com/users/bitcoin-core/followers",
          "following_url": "https://api.github.com/users/bitcoin-core/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin-core/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin-core/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin-core/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin-core/orgs",
          "repos_url": "https://api.github.com/users/bitcoin-core/repos",
          "events_url": "https://api.github.com/users/bitcoin-core/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin-core/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin-core/secp256k1",
        "description": "Optimized C library for EC operations on curve secp256k1",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1",
        "archive_url": "https://api.github.com/repos/bitcoin-core/secp256k1/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin-core/secp256k1/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin-core/secp256k1/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin-core/secp256k1/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin-core/secp256k1/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin-core/secp256k1/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin-core/secp256k1/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin-core/secp256k1/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin-core/secp256k1/downloads",
        "events_url": "https://api.github.com/repos/bitcoin-core/secp256k1/events",
        "forks_url": "https://api.github.com/repos/bitcoin-core/secp256k1/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin-core/secp256k1.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin-core/secp256k1/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin-core/secp256k1/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin-core/secp256k1/languages",
        "merges_url": "https://api.github.com/repos/bitcoin-core/secp256k1/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin-core/secp256k1/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin-core/secp256k1/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin-core/secp256k1/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin-core/secp256k1.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin-core/secp256k1/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin-core/secp256k1/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin-core/secp256k1/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin-core/secp256k1/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin-core/secp256k1/tags",
        "teams_url": "https://api.github.com/repos/bitcoin-core/secp256k1/teams",
        "trees_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin-core/secp256k1.git",
        "hooks_url": "https://api.github.com/repos/bitcoin-core/secp256k1/hooks",
        "svn_url": "https://github.com/bitcoin-core/secp256k1",
        "language": "C",
        "forks_count": 962,
        "stargazers_count": 1802,
        "watchers_count": 1802,
        "size": 10374,
        "default_branch": "master",
        "open_issues_count": 145,
        "is_template": false,
        "topics": [],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-08-01T01:00:35Z",
        "created_at": "2014-02-08T17:30:06Z",
        "updated_at": "2023-08-01T08:52:35Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/252"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 886,
    "deletions": 19,
    "changed_files": 22,
    "commits": 7,
    "review_comments": 15,
    "comments": 28
  },
  "events": [
    {
      "event": "head_ref_force_pushed",
      "id": 306189540,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzA2MTg5NTQw",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/306189540",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-05-15T20:14:03Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 306191538,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzA2MTkxNTM4",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/306191538",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-05-15T20:16:50Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 306236858,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzA2MjM2ODU4",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/306236858",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-05-15T21:18:23Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 306248256,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzA2MjQ4MjU2",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/306248256",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-05-15T21:36:10Z"
    },
    {
      "event": "commented",
      "id": 102750233,
      "node_id": "MDEyOklzc3VlQ29tbWVudDEwMjc1MDIzMw==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/102750233",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-05-17T05:48:01Z",
      "updated_at": "2015-05-17T05:48:01Z",
      "author_association": "CONTRIBUTOR",
      "body": "I'm on vacation until june 1st. I'll review afterwards.\n",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#issuecomment-102750233",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/252"
    },
    {
      "event": "commented",
      "id": 103765469,
      "node_id": "MDEyOklzc3VlQ29tbWVudDEwMzc2NTQ2OQ==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/103765469",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-05-20T05:30:41Z",
      "updated_at": "2015-05-20T05:30:41Z",
      "author_association": "CONTRIBUTOR",
      "body": "\"/*\\* Do an ellitic curve scalar multiplication in constant time.\"\n\nspelling.\n",
      "user": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#issuecomment-103765469",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/252"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 311887266,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzExODg3MjY2",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/311887266",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-05-22T17:10:14Z"
    },
    {
      "event": "commented",
      "id": 104716379,
      "node_id": "MDEyOklzc3VlQ29tbWVudDEwNDcxNjM3OQ==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/104716379",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-05-22T17:10:44Z",
      "updated_at": "2015-05-22T17:54:01Z",
      "author_association": "CONTRIBUTOR",
      "body": "Added endomorphism optimization.\n\nOn my laptop (Lenovo T440p i7-4700MQ 2.4Ghz) I see 85.6us without endomorphism, 107us with. I will need to investigate this..\n\n**Edit:** Oh, I needed to shrink the wNAF input size from 256 bits to 128 when the endomorphism is enabled. When this is done I see 64.4us, a 25% improvement :)\n",
      "user": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#issuecomment-104716379",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/252"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 311898839,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzExODk4ODM5",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/311898839",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-05-22T17:21:12Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 311925357,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzExOTI1MzU3",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/311925357",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-05-22T17:53:48Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 312374231,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzEyMzc0MjMx",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/312374231",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-05-23T16:38:50Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 312374927,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzEyMzc0OTI3",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/312374927",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-05-23T16:44:22Z"
    },
    {
      "event": "commented",
      "id": 104923950,
      "node_id": "MDEyOklzc3VlQ29tbWVudDEwNDkyMzk1MA==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/104923950",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-05-23T16:52:19Z",
      "updated_at": "2015-05-23T16:53:04Z",
      "author_association": "CONTRIBUTOR",
      "body": "Pushed; had to do some algebraic changes to get the endomorphism stuff to work. The pre-endomorphism commits have been changed in some minor ways (the unit tests are a bit cleaner, `secp256k1_scalar_wnaf_force_odd` is replaced by `secp256k1_scalar_wnaf_cond_negate` and `secp256k1_scalar_is_even`, and the return type of `secp256k1_ecdh_wnaf` is now `void` since it used to return a fixed value, which was confusing. This value is now computed by a macro.)\n\nAs for the endomorphism stuff, the wNAF conversion is actually a bit different. We require all wNAF digits to be odd, so to represent even 256-bit numbers, we (a) negate the number, making it odd since our modulus is odd; (b) convert this to wNAF; (c) negate the individual digits, un-negating the number while keeping all digits odd. In this way all 256-bit numbers can be represented. **However**, with the endomorphism optimization, we find ourselves converting 128-bit numbers to wNAF, which cannot be negated this way. (They can, but their negations are 256 bits, so we lose the optimization.) We therefore use a different strategy for handling even numbers when endomorphism optimization is enabled. Specifically, we add 1 to even numbers, add 2 to odd ones, and compensate after the multiplication by subtracting either `P` or `2P` from the result. This is suggested in the Okeya/Tagaki paper.\n\nWith this strategy, the perf numbers are less impressive: with endomorphism optimization on my laptop can do a multiplication in 68.9us.\n",
      "user": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#issuecomment-104923950",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/252"
    },
    {
      "event": "commented",
      "id": 111706570,
      "node_id": "MDEyOklzc3VlQ29tbWVudDExMTcwNjU3MA==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/111706570",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-06-13T12:34:30Z",
      "updated_at": "2015-06-13T12:34:30Z",
      "author_association": "CONTRIBUTOR",
      "body": "I have a few nits regarding naming and a question (see above), but the code looks well-written, well-documented and well-tested. Nice!\n",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#issuecomment-111706570",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/252"
    },
    {
      "event": "commented",
      "id": 111719689,
      "node_id": "MDEyOklzc3VlQ29tbWVudDExMTcxOTY4OQ==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/111719689",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-06-13T15:29:02Z",
      "updated_at": "2015-06-13T16:43:03Z",
      "author_association": "CONTRIBUTOR",
      "body": "When I add a test against `secp256k1_ec_pubkey_create` that runs 100 times with a `random_scalar_order` scalar it fails usually when the endomorphism optimization is enabled. Investigating.\n\n**Edit:** So this occurs specifically with scalars whose lambda-decomposition consists of a positive and a negative number (where \"negative\" means high bit set). Two positives or two negatives are OK, which seems inexplicable ... those numbers are treated totally independently by the point-multiply code, so it is weird that there'd be a problem with their relative sign and not their absolute ones.\n\nI doubt this has anything to do with the basepoint being the generator or not; it happens that the existing test code always uses the same hardcoded scalar whose lambda-decomposition consists of two positive values, hence our not seeing this bug with the existing tests.\n",
      "user": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#issuecomment-111719689",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/252"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-06-16T14:45:26Z",
      "updated_at": "2015-06-16T14:45:26Z",
      "source": {
        "issue": {
          "id": 88748130,
          "node_id": "MDU6SXNzdWU4ODc0ODEzMA==",
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/257",
          "repository_url": "https://api.github.com/repos/bitcoin-core/secp256k1",
          "labels_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/257/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/257/comments",
          "events_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/257/events",
          "html_url": "https://github.com/bitcoin-core/secp256k1/issues/257",
          "number": 257,
          "state": "closed",
          "state_reason": "completed",
          "title": "`secp256k1_gej_add_ge` does the wrong thing with points P, Q with P_y = -Q_y but P-Q",
          "body": "It is possible, by using the value  from the endomorphism optimization, to obtain two points P = x : y : z and Q = x : -y : z which are both on the curve. If you attempt to add these points using `secp256k1_gej_add_ge`, it incorrectly returns infinity, since it sees that the z-coordinates match and the y-coordinates are negative.\n\nSpecifically, it computes the value M = Y_1 \\* Z_2^3 + Y_2 \\* Z_1^3, and sets the returned z-coordinate to 2 \\* M \\* z_1z_2, and of course M will be zero for these two points. So it is not a simple matter of fixing how the infinity flag is set, the algebra actually does not compute the complete group law. This is derived in the paper \"Eric Brier and Marc Joye, Weierstrass Elliptic Curves and Side-Channel Attacks\" in Proposition 1, which explicitly assumes that the points P and Q don't happen.\n\nThe current secp256k1 API does not use this function except in one place, `secp256k1_ecmult_gen`, where it is impossible to get such an input to the function, so right now this bug is harmless. However https://github.com/bitcoin/secp256k1/pull/252 exposes it more directly, since when the endomorphism optimization is turned on roughly half of all scalars produce a bad pair P, Q in the wNAF ladder.\n",
          "user": {
            "login": "apoelstra",
            "id": 1351933,
            "node_id": "MDQ6VXNlcjEzNTE5MzM=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/apoelstra",
            "html_url": "https://github.com/apoelstra",
            "followers_url": "https://api.github.com/users/apoelstra/followers",
            "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
            "organizations_url": "https://api.github.com/users/apoelstra/orgs",
            "repos_url": "https://api.github.com/users/apoelstra/repos",
            "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/apoelstra/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 4,
          "closed_at": "2015-06-29T16:30:44Z",
          "created_at": "2015-06-16T14:45:26Z",
          "updated_at": "2015-06-29T16:30:44Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "head_ref_force_pushed",
      "id": 338240296,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzM4MjQwMjk2",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/338240296",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-06-23T20:19:27Z"
    },
    {
      "event": "commented",
      "id": 114867593,
      "node_id": "MDEyOklzc3VlQ29tbWVudDExNDg2NzU5Mw==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/114867593",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-06-24T13:29:03Z",
      "updated_at": "2015-06-24T13:29:03Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased on https://github.com/bitcoin/secp256k1/pull/261, which fixes the problems I was having earlier with the endomorphism. Also add the additional test @sipa suggested (which didn't pass until #261 :))\n",
      "user": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#issuecomment-114867593",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/252"
    },
    {
      "event": "mentioned",
      "id": 338932272,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzM4OTMyMjcy",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/338932272",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-06-24T13:29:03Z"
    },
    {
      "event": "subscribed",
      "id": 338932273,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDMzODkzMjI3Mw==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/338932273",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-06-24T13:29:03Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "peterdettman",
        "id": 3423981,
        "node_id": "MDQ6VXNlcjM0MjM5ODE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3423981?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/peterdettman",
        "html_url": "https://github.com/peterdettman",
        "followers_url": "https://api.github.com/users/peterdettman/followers",
        "following_url": "https://api.github.com/users/peterdettman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/peterdettman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/peterdettman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/peterdettman/subscriptions",
        "organizations_url": "https://api.github.com/users/peterdettman/orgs",
        "repos_url": "https://api.github.com/users/peterdettman/repos",
        "events_url": "https://api.github.com/users/peterdettman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/peterdettman/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-06-26T01:53:39Z",
      "updated_at": "2015-06-26T01:53:39Z",
      "source": {
        "issue": {
          "id": 91125348,
          "node_id": "MDExOlB1bGxSZXF1ZXN0Mzg2MTEwMDg=",
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/262",
          "repository_url": "https://api.github.com/repos/bitcoin-core/secp256k1",
          "labels_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/262/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/262/comments",
          "events_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/262/events",
          "html_url": "https://github.com/bitcoin-core/secp256k1/pull/262",
          "number": 262,
          "state": "open",
          "state_reason": null,
          "title": "x-only ECDH without sqrt",
          "body": "Builds on #252.\n\nThis is a demo of another isomorphism trick that I originally described here: http://www.ietf.org/mail-archive/web/cfrg/current/msg05770.html .\n\nThis PR adds secp256k1_xo_multiply(), with test and benchmark (bench_ecdh_xo), plus a new group method secp256k1_ge_set_xo_iso_var() to support the central trick of getting a valid point from an x-coord without sqrt.\n\nThere are two main caveats:\n1. A Jacobi symbol test is required to validate the input. GMP has an appropriate method~~, but the call site is just a TODO in this current code. I would appreciate help in wiring that up if anyone wants to volunteer~~.\n2. The output is only an x-coord. The y-coord _could_ be recovered... at the cost of a sqrt! AFAIK there's no cheap way to get even the sign bit. Still, I think needing only the x-coord is a fairly common use case, though I don't know if/how bitcoin uses ECDH.\n\nNOTE: The input is currently also just a field element, but it could perhaps be a point, with this optimization only applied if it is in compressed format.\n\nI measure an 8.5% performance improvement for bench_ecdh_xo vs bench_ecdh. The final numbers will depend mostly on how expensive the Jacobi symbol test is, but it should be considerably cheaper than the sqrt.\n",
          "user": {
            "login": "peterdettman",
            "id": 3423981,
            "node_id": "MDQ6VXNlcjM0MjM5ODE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/3423981?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/peterdettman",
            "html_url": "https://github.com/peterdettman",
            "followers_url": "https://api.github.com/users/peterdettman/followers",
            "following_url": "https://api.github.com/users/peterdettman/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/peterdettman/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/peterdettman/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/peterdettman/subscriptions",
            "organizations_url": "https://api.github.com/users/peterdettman/orgs",
            "repos_url": "https://api.github.com/users/peterdettman/repos",
            "events_url": "https://api.github.com/users/peterdettman/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/peterdettman/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 4975389731,
              "node_id": "LA_kwDOAP4Jqs8AAAABKI5sIw",
              "url": "https://api.github.com/repos/bitcoin-core/secp256k1/labels/performance",
              "name": "performance",
              "description": "",
              "color": "DE3CCC",
              "default": false
            }
          ],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 30,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/262",
            "html_url": "https://github.com/bitcoin-core/secp256k1/pull/262",
            "diff_url": "https://github.com/bitcoin-core/secp256k1/pull/262.diff",
            "patch_url": "https://github.com/bitcoin-core/secp256k1/pull/262.patch"
          },
          "created_at": "2015-06-26T01:53:39Z",
          "updated_at": "2023-05-11T16:23:51Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5MDE2MDk6djI=",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "commented",
      "id": 116035084,
      "node_id": "MDEyOklzc3VlQ29tbWVudDExNjAzNTA4NA==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/116035084",
      "actor": {
        "login": "peterdettman",
        "id": 3423981,
        "node_id": "MDQ6VXNlcjM0MjM5ODE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3423981?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/peterdettman",
        "html_url": "https://github.com/peterdettman",
        "followers_url": "https://api.github.com/users/peterdettman/followers",
        "following_url": "https://api.github.com/users/peterdettman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/peterdettman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/peterdettman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/peterdettman/subscriptions",
        "organizations_url": "https://api.github.com/users/peterdettman/orgs",
        "repos_url": "https://api.github.com/users/peterdettman/repos",
        "events_url": "https://api.github.com/users/peterdettman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/peterdettman/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-06-27T12:32:09Z",
      "updated_at": "2015-06-27T12:54:34Z",
      "author_association": "CONTRIBUTOR",
      "body": "A couple of issues with the documentation for secp256k1_point_multiply:\n- The return code -1 is listed for \"scalar was zero\", but it looks to me like it would actually return 0 in that case (via secp256k1_eckey_pubkey_serialize).\n- Is the scalar actually restricted to not overflow the curve order? In which case, \"a 32-byte scalar\" is a little misleading.\n",
      "user": {
        "login": "peterdettman",
        "id": 3423981,
        "node_id": "MDQ6VXNlcjM0MjM5ODE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3423981?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/peterdettman",
        "html_url": "https://github.com/peterdettman",
        "followers_url": "https://api.github.com/users/peterdettman/followers",
        "following_url": "https://api.github.com/users/peterdettman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/peterdettman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/peterdettman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/peterdettman/subscriptions",
        "organizations_url": "https://api.github.com/users/peterdettman/orgs",
        "repos_url": "https://api.github.com/users/peterdettman/repos",
        "events_url": "https://api.github.com/users/peterdettman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/peterdettman/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#issuecomment-116035084",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/252"
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5MDE2MTM6djI=",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "head_ref_force_pushed",
      "id": 343241459,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzQzMjQxNDU5",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/343241459",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-06-29T16:59:06Z"
    },
    {
      "event": "commented",
      "id": 116761304,
      "node_id": "MDEyOklzc3VlQ29tbWVudDExNjc2MTMwNA==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/116761304",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-06-29T16:59:17Z",
      "updated_at": "2015-06-29T16:59:33Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebase and fix minor comments from Peter. TODO fix serialization timing leak.\n",
      "user": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#issuecomment-116761304",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/252"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 343313650,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzQzMzEzNjUw",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/343313650",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-06-29T18:14:46Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 343433149,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzQzNDMzMTQ5",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/343433149",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-06-29T20:15:00Z"
    },
    {
      "event": "commented",
      "id": 116829221,
      "node_id": "MDEyOklzc3VlQ29tbWVudDExNjgyOTIyMQ==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/116829221",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-06-29T20:19:29Z",
      "updated_at": "2015-06-29T20:19:29Z",
      "author_association": "CONTRIBUTOR",
      "body": "I've pushed a new version which fixes the timing leak. I've changed the API to output the hash of the computed point rather than the point itself. @gmaxwell had suggested early on that giving the user a curvepoint was \"too low level\" and not consistent with our policy of not exposing raw cryptographic objects.\n\nThe concern was that a user who has access to a \"ECDH secret\" which is a curvepoint might try to build his or her own cryptosystem in a fragile or broken way. I think this timing leak is an example of me getting burned by this -- I didn't think to look for this timing leak because I was thinking in terms of \"points\" rather than \"secrets\".\n",
      "user": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#issuecomment-116829221",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/252"
    },
    {
      "event": "mentioned",
      "id": 343437621,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzQzNDM3NjIx",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/343437621",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-06-29T20:19:29Z"
    },
    {
      "event": "subscribed",
      "id": 343437623,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDM0MzQzNzYyMw==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/343437623",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-06-29T20:19:29Z"
    },
    {
      "event": "commented",
      "id": 116834203,
      "node_id": "MDEyOklzc3VlQ29tbWVudDExNjgzNDIwMw==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/116834203",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-06-29T20:30:21Z",
      "updated_at": "2015-06-29T20:30:21Z",
      "author_association": "CONTRIBUTOR",
      "body": "This means that #262 is going to need to be changed to use `secp256k1_point_multiply` rather than `secp256k1_ecdh_point_multiply` since the latter now outputs a hash (which is algebraically useless).\n",
      "user": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#issuecomment-116834203",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/252"
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5MDE2MTc6djI=",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "head_ref_force_pushed",
      "id": 344641773,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzQ0NjQxNzcz",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/344641773",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-06-30T20:04:57Z"
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5MDE2MjM6djI=",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "commented",
      "id": 117403127,
      "node_id": "MDEyOklzc3VlQ29tbWVudDExNzQwMzEyNw==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/117403127",
      "actor": {
        "login": "peterdettman",
        "id": 3423981,
        "node_id": "MDQ6VXNlcjM0MjM5ODE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3423981?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/peterdettman",
        "html_url": "https://github.com/peterdettman",
        "followers_url": "https://api.github.com/users/peterdettman/followers",
        "following_url": "https://api.github.com/users/peterdettman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/peterdettman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/peterdettman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/peterdettman/subscriptions",
        "organizations_url": "https://api.github.com/users/peterdettman/orgs",
        "repos_url": "https://api.github.com/users/peterdettman/repos",
        "events_url": "https://api.github.com/users/peterdettman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/peterdettman/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-01T02:26:26Z",
      "updated_at": "2015-07-01T02:26:26Z",
      "author_association": "CONTRIBUTOR",
      "body": "@apoelstra @gmaxwell Is there somewhere I can review the discussion about exposing low-level cryptographic operations (alluded to above)?\n",
      "user": {
        "login": "peterdettman",
        "id": 3423981,
        "node_id": "MDQ6VXNlcjM0MjM5ODE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3423981?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/peterdettman",
        "html_url": "https://github.com/peterdettman",
        "followers_url": "https://api.github.com/users/peterdettman/followers",
        "following_url": "https://api.github.com/users/peterdettman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/peterdettman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/peterdettman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/peterdettman/subscriptions",
        "organizations_url": "https://api.github.com/users/peterdettman/orgs",
        "repos_url": "https://api.github.com/users/peterdettman/repos",
        "events_url": "https://api.github.com/users/peterdettman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/peterdettman/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#issuecomment-117403127",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/252"
    },
    {
      "event": "mentioned",
      "id": 344884080,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzQ0ODg0MDgw",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/344884080",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-01T02:26:26Z"
    },
    {
      "event": "subscribed",
      "id": 344884081,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDM0NDg4NDA4MQ==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/344884081",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-01T02:26:26Z"
    },
    {
      "event": "mentioned",
      "id": 344884082,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzQ0ODg0MDgy",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/344884082",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-01T02:26:26Z"
    },
    {
      "event": "subscribed",
      "id": 344884083,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDM0NDg4NDA4Mw==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/344884083",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-01T02:26:26Z"
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5MDE2Mjg6djI=",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "commented",
      "id": 118129035,
      "node_id": "MDEyOklzc3VlQ29tbWVudDExODEyOTAzNQ==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/118129035",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-02T19:01:01Z",
      "updated_at": "2015-07-02T19:01:01Z",
      "author_association": "CONTRIBUTOR",
      "body": "@peterdettman, @gmaxwell and I had a private conversation on May 15 with the lines\n\n```\n13:18:19 <gmaxwell> One thing I wonder about is that we've tried to avoid offering users APIs that were raw EC operations... both becaues the users won't use them safely, and because they'll construct less efficient implementations of crypto algorithims (e.g. if we expose add and double they can go write a non-constant time, slow as heck ecdh.).  I wonder if there are any api affordances we can make to make that multiply s\n13:23:47 <andytoshi> there thave been a lot of comments on -dev and -wizards from people who are pretty jacked to have ECDH but who IMHO are probably gonna do something unsafe with it\n```\n\nThis was right before I started working on this PR. Then a few days ago in #secp256k1 on IRC:\n\n```\n10:51:09 <andytoshi> in https://github.com/bitcoin/secp256k1/pull/252#discussion_r33412268 peter dettman notes that pubkey_serialize uses fe_normalize_var which is a timing leak for ECDH\n10:51:23 <andytoshi> what do we do about this? do we need to split serialize into serialize and serialize_var?\n11:02:55 <sipa> i suppose\n11:03:00 <sipa> wait\n11:03:08 <sipa> right\n11:03:28 <sipa> ecdh is weird because it has an EC point which is secret information\n13:12:02 <gmaxwell> well I slightly protested before that returning a point was maybe too low level.\n13:31:22 <andytoshi> i recall that ... this might be a concrete reason to -not- do it\n13:31:50 <andytoshi> i mean, this feels like we got cut by our own sharp corner here..\n14:36:30 <sipa> we could hash it before returning\n16:31:30 <gmaxwell> that was my suggestion.\n```\n\nTo the best of my knowledge this was the entirety of our discussion.\n",
      "user": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#issuecomment-118129035",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/252"
    },
    {
      "event": "mentioned",
      "id": 346764410,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzQ2NzY0NDEw",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/346764410",
      "actor": {
        "login": "peterdettman",
        "id": 3423981,
        "node_id": "MDQ6VXNlcjM0MjM5ODE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3423981?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/peterdettman",
        "html_url": "https://github.com/peterdettman",
        "followers_url": "https://api.github.com/users/peterdettman/followers",
        "following_url": "https://api.github.com/users/peterdettman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/peterdettman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/peterdettman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/peterdettman/subscriptions",
        "organizations_url": "https://api.github.com/users/peterdettman/orgs",
        "repos_url": "https://api.github.com/users/peterdettman/repos",
        "events_url": "https://api.github.com/users/peterdettman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/peterdettman/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-02T19:01:01Z"
    },
    {
      "event": "subscribed",
      "id": 346764411,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDM0Njc2NDQxMQ==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/346764411",
      "actor": {
        "login": "peterdettman",
        "id": 3423981,
        "node_id": "MDQ6VXNlcjM0MjM5ODE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3423981?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/peterdettman",
        "html_url": "https://github.com/peterdettman",
        "followers_url": "https://api.github.com/users/peterdettman/followers",
        "following_url": "https://api.github.com/users/peterdettman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/peterdettman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/peterdettman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/peterdettman/subscriptions",
        "organizations_url": "https://api.github.com/users/peterdettman/orgs",
        "repos_url": "https://api.github.com/users/peterdettman/repos",
        "events_url": "https://api.github.com/users/peterdettman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/peterdettman/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-02T19:01:01Z"
    },
    {
      "event": "mentioned",
      "id": 346764412,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzQ2NzY0NDEy",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/346764412",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-02T19:01:01Z"
    },
    {
      "event": "subscribed",
      "id": 346764413,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDM0Njc2NDQxMw==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/346764413",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-02T19:01:01Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 346931549,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzQ2OTMxNTQ5",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/346931549",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-02T22:22:16Z"
    },
    {
      "event": "commented",
      "id": 118237086,
      "node_id": "MDEyOklzc3VlQ29tbWVudDExODIzNzA4Ng==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/118237086",
      "actor": {
        "login": "peterdettman",
        "id": 3423981,
        "node_id": "MDQ6VXNlcjM0MjM5ODE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3423981?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/peterdettman",
        "html_url": "https://github.com/peterdettman",
        "followers_url": "https://api.github.com/users/peterdettman/followers",
        "following_url": "https://api.github.com/users/peterdettman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/peterdettman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/peterdettman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/peterdettman/subscriptions",
        "organizations_url": "https://api.github.com/users/peterdettman/orgs",
        "repos_url": "https://api.github.com/users/peterdettman/repos",
        "events_url": "https://api.github.com/users/peterdettman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/peterdettman/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-03T05:09:55Z",
      "updated_at": "2015-07-03T05:09:55Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks for chasing that up. Not sure how I feel about the hashing yet, but I would like to try and get agreement that the result be just the x-coordinate (or the hash of it) and not include the y-bit. Of course, this is somewhat with a view to integrating #262 cleanly (as an optimization for compressed input points), but possibly x-only output could be considered sufficient impediment to building adhoc schemes on top of ECDH-as-scalar-mult. In any case, I think taking just the x-coordinate as the shared secret is fairly standard, or at least noncontroversial.\n",
      "user": {
        "login": "peterdettman",
        "id": 3423981,
        "node_id": "MDQ6VXNlcjM0MjM5ODE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3423981?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/peterdettman",
        "html_url": "https://github.com/peterdettman",
        "followers_url": "https://api.github.com/users/peterdettman/followers",
        "following_url": "https://api.github.com/users/peterdettman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/peterdettman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/peterdettman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/peterdettman/subscriptions",
        "organizations_url": "https://api.github.com/users/peterdettman/orgs",
        "repos_url": "https://api.github.com/users/peterdettman/repos",
        "events_url": "https://api.github.com/users/peterdettman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/peterdettman/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#issuecomment-118237086",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/252"
    },
    {
      "event": "commented",
      "id": 118238301,
      "node_id": "MDEyOklzc3VlQ29tbWVudDExODIzODMwMQ==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/118238301",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-03T05:21:53Z",
      "updated_at": "2015-07-03T05:21:53Z",
      "author_association": "CONTRIBUTOR",
      "body": "It depends on the application, I'm sure I can construct a contrived protocol where the 'malleability' of someone flipping the point but still getting the same secret would be bad;  e.g. where it causes you to reuse a key in a stream cipher where you otherwise wouldn't.  \n",
      "user": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#issuecomment-118238301",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/252"
    },
    {
      "event": "commented",
      "id": 118276370,
      "node_id": "MDEyOklzc3VlQ29tbWVudDExODI3NjM3MA==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/118276370",
      "actor": {
        "login": "peterdettman",
        "id": 3423981,
        "node_id": "MDQ6VXNlcjM0MjM5ODE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3423981?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/peterdettman",
        "html_url": "https://github.com/peterdettman",
        "followers_url": "https://api.github.com/users/peterdettman/followers",
        "following_url": "https://api.github.com/users/peterdettman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/peterdettman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/peterdettman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/peterdettman/subscriptions",
        "organizations_url": "https://api.github.com/users/peterdettman/orgs",
        "repos_url": "https://api.github.com/users/peterdettman/repos",
        "events_url": "https://api.github.com/users/peterdettman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/peterdettman/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-03T08:35:15Z",
      "updated_at": "2015-07-03T08:35:15Z",
      "author_association": "CONTRIBUTOR",
      "body": "Yes, I understand this to be \"benign malleability\" per Shoup e.g. http://www.shoup.net/papers/iso-2_1.pdf section 2.3. I would like to simply say that it can be addressed in the outer scheme, but I gather we're trying to foolproof things. I suppose one alternative here is to include the respective public keys under the result hash.\n",
      "user": {
        "login": "peterdettman",
        "id": 3423981,
        "node_id": "MDQ6VXNlcjM0MjM5ODE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3423981?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/peterdettman",
        "html_url": "https://github.com/peterdettman",
        "followers_url": "https://api.github.com/users/peterdettman/followers",
        "following_url": "https://api.github.com/users/peterdettman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/peterdettman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/peterdettman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/peterdettman/subscriptions",
        "organizations_url": "https://api.github.com/users/peterdettman/orgs",
        "repos_url": "https://api.github.com/users/peterdettman/repos",
        "events_url": "https://api.github.com/users/peterdettman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/peterdettman/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#issuecomment-118276370",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/252"
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5MDE2MzI6djI=",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5MDE2MzY6djI=",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5MDE2NDE6djI=",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "commented",
      "id": 121097402,
      "node_id": "MDEyOklzc3VlQ29tbWVudDEyMTA5NzQwMg==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/121097402",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-14T00:22:05Z",
      "updated_at": "2015-07-14T00:51:20Z",
      "author_association": "CONTRIBUTOR",
      "body": "Fixed all of @peterdettman's minor comments. Added a new commit to fix the timing leak in `GET_GE`. The perf hit I measure, using bench_ecdh, is 10%, both with and without endomorphism. :/\n\n**Edit:** Actually I can get this down to 3% without much trouble, updating the PR with that. I can do even better with a multi-cmov but that will be a bit more work..\n",
      "user": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#issuecomment-121097402",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/252"
    },
    {
      "event": "mentioned",
      "id": 354911939,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzU0OTExOTM5",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/354911939",
      "actor": {
        "login": "peterdettman",
        "id": 3423981,
        "node_id": "MDQ6VXNlcjM0MjM5ODE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3423981?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/peterdettman",
        "html_url": "https://github.com/peterdettman",
        "followers_url": "https://api.github.com/users/peterdettman/followers",
        "following_url": "https://api.github.com/users/peterdettman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/peterdettman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/peterdettman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/peterdettman/subscriptions",
        "organizations_url": "https://api.github.com/users/peterdettman/orgs",
        "repos_url": "https://api.github.com/users/peterdettman/repos",
        "events_url": "https://api.github.com/users/peterdettman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/peterdettman/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-14T00:22:05Z"
    },
    {
      "event": "subscribed",
      "id": 354911940,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDM1NDkxMTk0MA==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/354911940",
      "actor": {
        "login": "peterdettman",
        "id": 3423981,
        "node_id": "MDQ6VXNlcjM0MjM5ODE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3423981?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/peterdettman",
        "html_url": "https://github.com/peterdettman",
        "followers_url": "https://api.github.com/users/peterdettman/followers",
        "following_url": "https://api.github.com/users/peterdettman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/peterdettman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/peterdettman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/peterdettman/subscriptions",
        "organizations_url": "https://api.github.com/users/peterdettman/orgs",
        "repos_url": "https://api.github.com/users/peterdettman/repos",
        "events_url": "https://api.github.com/users/peterdettman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/peterdettman/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-14T00:22:05Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 354912082,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzU0OTEyMDgy",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/354912082",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-14T00:22:26Z"
    },
    {
      "event": "commented",
      "id": 121100241,
      "node_id": "MDEyOklzc3VlQ29tbWVudDEyMTEwMDI0MQ==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/121100241",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-14T00:49:17Z",
      "updated_at": "2015-07-14T00:49:17Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebase?\n",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#issuecomment-121100241",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/252"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 354925475,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzU0OTI1NDc1",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/354925475",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-14T00:51:42Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 354928623,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzU0OTI4NjIz",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/354928623",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-14T00:58:21Z"
    },
    {
      "event": "commented",
      "id": 121102243,
      "node_id": "MDEyOklzc3VlQ29tbWVudDEyMTEwMjI0Mw==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/121102243",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-14T00:58:26Z",
      "updated_at": "2015-07-14T00:58:26Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased.\n",
      "user": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#issuecomment-121102243",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/252"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "Gustav-Simonsson",
        "id": 293096,
        "node_id": "MDQ6VXNlcjI5MzA5Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/293096?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Gustav-Simonsson",
        "html_url": "https://github.com/Gustav-Simonsson",
        "followers_url": "https://api.github.com/users/Gustav-Simonsson/followers",
        "following_url": "https://api.github.com/users/Gustav-Simonsson/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Gustav-Simonsson/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Gustav-Simonsson/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Gustav-Simonsson/subscriptions",
        "organizations_url": "https://api.github.com/users/Gustav-Simonsson/orgs",
        "repos_url": "https://api.github.com/users/Gustav-Simonsson/repos",
        "events_url": "https://api.github.com/users/Gustav-Simonsson/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Gustav-Simonsson/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-15T10:22:05Z",
      "updated_at": "2015-07-15T10:22:05Z",
      "source": {
        "issue": {
          "id": 74353348,
          "node_id": "MDU6SXNzdWU3NDM1MzM0OA==",
          "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/883",
          "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
          "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/883/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/883/comments",
          "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/883/events",
          "html_url": "https://github.com/ethereum/go-ethereum/issues/883",
          "number": 883,
          "state": "closed",
          "state_reason": "completed",
          "title": "Use libsecp256k1 for scalar mult in ECDH in ECIES",
          "body": "Profiling of a running Go node shows that we spend a significant amount of CPU time in the EC scalar multiplication used when deriving the shared secret in ECDH in ECIES for the encrypted handshake: https://github.com/ethereum/devp2p/blob/master/rlpx.md#encrypted-handshake\n\nThe idea is that we should be able to replace the Go code for this multiplication with libsecp256k1 which is highly optimized for this operations.\n\nSee: https://github.com/ethereum/go-ethereum/blob/develop/crypto/curve.go#L182\nAnd: https://github.com/bitcoin/secp256k1/blob/master/src/ecmult.h\n\nFirst attempt at integrating this: https://github.com/Gustav-Simonsson/go-ethereum/tree/scalar_mult\n\nWhy the result is different for the same input is unknown - could be we're using the library wrong somehow.\n",
          "user": {
            "login": "Gustav-Simonsson",
            "id": 293096,
            "node_id": "MDQ6VXNlcjI5MzA5Ng==",
            "avatar_url": "https://avatars.githubusercontent.com/u/293096?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Gustav-Simonsson",
            "html_url": "https://github.com/Gustav-Simonsson",
            "followers_url": "https://api.github.com/users/Gustav-Simonsson/followers",
            "following_url": "https://api.github.com/users/Gustav-Simonsson/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/Gustav-Simonsson/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/Gustav-Simonsson/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/Gustav-Simonsson/subscriptions",
            "organizations_url": "https://api.github.com/users/Gustav-Simonsson/orgs",
            "repos_url": "https://api.github.com/users/Gustav-Simonsson/repos",
            "events_url": "https://api.github.com/users/Gustav-Simonsson/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/Gustav-Simonsson/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [
            {
              "id": 72233652,
              "node_id": "MDU6TGFiZWw3MjIzMzY1Mg==",
              "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:feature",
              "name": "type:feature",
              "color": "84b6eb",
              "default": false
            }
          ],
          "assignee": {
            "login": "Gustav-Simonsson",
            "id": 293096,
            "node_id": "MDQ6VXNlcjI5MzA5Ng==",
            "avatar_url": "https://avatars.githubusercontent.com/u/293096?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Gustav-Simonsson",
            "html_url": "https://github.com/Gustav-Simonsson",
            "followers_url": "https://api.github.com/users/Gustav-Simonsson/followers",
            "following_url": "https://api.github.com/users/Gustav-Simonsson/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/Gustav-Simonsson/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/Gustav-Simonsson/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/Gustav-Simonsson/subscriptions",
            "organizations_url": "https://api.github.com/users/Gustav-Simonsson/orgs",
            "repos_url": "https://api.github.com/users/Gustav-Simonsson/repos",
            "events_url": "https://api.github.com/users/Gustav-Simonsson/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/Gustav-Simonsson/received_events",
            "type": "User",
            "site_admin": false
          },
          "assignees": [
            {
              "login": "Gustav-Simonsson",
              "id": 293096,
              "node_id": "MDQ6VXNlcjI5MzA5Ng==",
              "avatar_url": "https://avatars.githubusercontent.com/u/293096?v=4",
              "gravatar_id": "",
              "url": "https://api.github.com/users/Gustav-Simonsson",
              "html_url": "https://github.com/Gustav-Simonsson",
              "followers_url": "https://api.github.com/users/Gustav-Simonsson/followers",
              "following_url": "https://api.github.com/users/Gustav-Simonsson/following%7B/other_user%7D",
              "gists_url": "https://api.github.com/users/Gustav-Simonsson/gists%7B/gist_id%7D",
              "starred_url": "https://api.github.com/users/Gustav-Simonsson/starred%7B/owner%7D%7B/repo%7D",
              "subscriptions_url": "https://api.github.com/users/Gustav-Simonsson/subscriptions",
              "organizations_url": "https://api.github.com/users/Gustav-Simonsson/orgs",
              "repos_url": "https://api.github.com/users/Gustav-Simonsson/repos",
              "events_url": "https://api.github.com/users/Gustav-Simonsson/events%7B/privacy%7D",
              "received_events_url": "https://api.github.com/users/Gustav-Simonsson/received_events",
              "type": "User",
              "site_admin": false
            }
          ],
          "author_association": "NONE",
          "locked": false,
          "comments": 3,
          "closed_at": "2016-01-08T23:51:22Z",
          "created_at": "2015-05-08T12:45:09Z",
          "updated_at": "2016-01-08T23:52:14Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 121619833,
      "node_id": "MDEyOklzc3VlQ29tbWVudDEyMTYxOTgzMw==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/121619833",
      "actor": {
        "login": "peterdettman",
        "id": 3423981,
        "node_id": "MDQ6VXNlcjM0MjM5ODE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3423981?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/peterdettman",
        "html_url": "https://github.com/peterdettman",
        "followers_url": "https://api.github.com/users/peterdettman/followers",
        "following_url": "https://api.github.com/users/peterdettman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/peterdettman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/peterdettman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/peterdettman/subscriptions",
        "organizations_url": "https://api.github.com/users/peterdettman/orgs",
        "repos_url": "https://api.github.com/users/peterdettman/repos",
        "events_url": "https://api.github.com/users/peterdettman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/peterdettman/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-15T13:37:34Z",
      "updated_at": "2015-07-15T13:37:34Z",
      "author_association": "CONTRIBUTOR",
      "body": "@apoelstra See https://github.com/peterdettman/secp256k1/commit/de5436efcc37a0b051058ba60647284d7bef4337 for some ideas on how to recover another 1% or so from the cmov table-lookup.\n",
      "user": {
        "login": "peterdettman",
        "id": 3423981,
        "node_id": "MDQ6VXNlcjM0MjM5ODE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3423981?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/peterdettman",
        "html_url": "https://github.com/peterdettman",
        "followers_url": "https://api.github.com/users/peterdettman/followers",
        "following_url": "https://api.github.com/users/peterdettman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/peterdettman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/peterdettman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/peterdettman/subscriptions",
        "organizations_url": "https://api.github.com/users/peterdettman/orgs",
        "repos_url": "https://api.github.com/users/peterdettman/repos",
        "events_url": "https://api.github.com/users/peterdettman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/peterdettman/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#issuecomment-121619833",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/252"
    },
    {
      "event": "mentioned",
      "id": 356462019,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzU2NDYyMDE5",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/356462019",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-15T13:37:34Z"
    },
    {
      "event": "subscribed",
      "id": 356462020,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDM1NjQ2MjAyMA==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/356462020",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-15T13:37:34Z"
    },
    {
      "event": "commented",
      "id": 121702534,
      "node_id": "MDEyOklzc3VlQ29tbWVudDEyMTcwMjUzNA==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/121702534",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-15T18:19:12Z",
      "updated_at": "2015-07-15T18:19:12Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks Peter. I've cherry-picked that commit. The total perf hit from doing constant-time lookups now looks like 1.7% to me.\n",
      "user": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#issuecomment-121702534",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/252"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 368477793,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzY4NDc3Nzkz",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/368477793",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-29T15:42:06Z"
    },
    {
      "event": "commented",
      "id": 125993596,
      "node_id": "MDEyOklzc3VlQ29tbWVudDEyNTk5MzU5Ng==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/125993596",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-29T15:42:38Z",
      "updated_at": "2015-07-29T15:42:38Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebase; change API to take a pubkey_t rather than point/pointlen, and to take a context_t.\n",
      "user": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#issuecomment-125993596",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/252"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTY2NDg2MTg6YmFhNzVkYTU5ZDdjYWU5MDZhYjMxYmY1NWU3YzI3ZTlhMDgzNjZmMg==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/baa75da59d7cae906ab31bf55e7c27e9a08366f2",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/baa75da59d7cae906ab31bf55e7c27e9a08366f2",
      "tree": {
        "sha": "fbc2d1ac8fd4ac652bdbd5505b018c014d2c3edc",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/fbc2d1ac8fd4ac652bdbd5505b018c014d2c3edc"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/ae4f0c6eecd67ee514d6d6ae99ec949c084e300c",
          "sha": "ae4f0c6eecd67ee514d6d6ae99ec949c084e300c",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/ae4f0c6eecd67ee514d6d6ae99ec949c084e300c"
        }
      ],
      "message": "tests: add a couple tests\n\n  - Add zero/one sanity check tests for ecmult\n\n  - Add unit test for secp256k1_scalar_split_lambda_var\n\n  - Typo fix in `ge_equals_ge`; was comparing b->y to itself, should\n    have been comparing a->y to b->y\n\n  - Normalize y-coordinate in `random_group_element_test`; this is\n    needed to pass random group elements as the first argument to\n    `ge_equals_ge`, which I will do in a future commit.",
      "committer": {
        "name": "Andrew Poelstra",
        "email": "apoelstra@wpsoftware.net",
        "date": "2015-07-29T18:26:12Z"
      },
      "author": {
        "name": "Andrew Poelstra",
        "email": "apoelstra@wpsoftware.net",
        "date": "2015-05-14T02:16:13Z"
      },
      "sha": "baa75da59d7cae906ab31bf55e7c27e9a08366f2"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 368680584,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzY4NjgwNTg0",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/368680584",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-29T18:49:31Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 368876927,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzY4ODc2OTI3",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/368876927",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-29T22:22:07Z"
    },
    {
      "event": "commented",
      "id": 126124078,
      "node_id": "MDEyOklzc3VlQ29tbWVudDEyNjEyNDA3OA==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/126124078",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-29T23:14:55Z",
      "updated_at": "2015-07-29T23:14:55Z",
      "author_association": "CONTRIBUTOR",
      "body": "I've added a commit which moves the ECDH code into its own module but leaves the constant-time multiply code in the main library. It also renames the const-multiply functions, so the result is kinda a mess of renaming and moving.\n\nI'll go back and rebase the original changeset as though this had been the layout from the start, but first I'd like an ACK that this is how we want to organize things.\n",
      "user": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#issuecomment-126124078",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/252"
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5MDE2NDM6djI=",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5MDE2NDY6djI=",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "line-commented",
      "id": null,
      "node_id": "MDIzOlB1bGxSZXF1ZXN0UmV2aWV3VGhyZWFkMjI5MDE2NDk6djI=",
      "url": null,
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null
    },
    {
      "event": "commented",
      "id": 126709258,
      "node_id": "MDEyOklzc3VlQ29tbWVudDEyNjcwOTI1OA==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/126709258",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-31T14:31:28Z",
      "updated_at": "2015-07-31T14:44:37Z",
      "author_association": "CONTRIBUTOR",
      "body": "ACK design, with a few more nits.\n\nPlease squash and I'll merge.\n\nEDIT: no need to squash everything, but some logical steps are nice... ecmult_const then ecmult_const + endo then optimizations then ECDH module... or whatever you like.\n",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#issuecomment-126709258",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/252"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTY2NDg2MTg6NDQwMTUwMDA2MDY0Mjk1MDM4ZDRkN2ZjYjdmZTI3OTZiZjE2NzJkZg==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/440150006064295038d4d7fcb7fe2796bf1672df",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/440150006064295038d4d7fcb7fe2796bf1672df",
      "tree": {
        "sha": "b5c851f8740fe466630bc410a57a0957fcf7acad",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/b5c851f8740fe466630bc410a57a0957fcf7acad"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/baa75da59d7cae906ab31bf55e7c27e9a08366f2",
          "sha": "baa75da59d7cae906ab31bf55e7c27e9a08366f2",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/baa75da59d7cae906ab31bf55e7c27e9a08366f2"
        }
      ],
      "message": "Add constant-time multiply `secp256k1_ecmult_const` for ECDH\n\nDesigned with clear separation of the wNAF conversion, precomputation\nand exponentiation (since the precomp at least we will probably want\nto separate in the API for users who reuse points a lot.\n\nFuture work:\n  - actually separate precomp in the API\n  - do multiexp rather than single exponentiation",
      "committer": {
        "name": "Andrew Poelstra",
        "email": "apoelstra@wpsoftware.net",
        "date": "2015-07-31T17:39:09Z"
      },
      "author": {
        "name": "Andrew Poelstra",
        "email": "apoelstra@wpsoftware.net",
        "date": "2015-05-13T22:31:47Z"
      },
      "sha": "440150006064295038d4d7fcb7fe2796bf1672df"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 370845404,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzcwODQ1NDA0",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/370845404",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-31T19:53:11Z"
    },
    {
      "event": "commented",
      "id": 126796985,
      "node_id": "MDEyOklzc3VlQ29tbWVudDEyNjc5Njk4NQ==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/126796985",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-31T19:53:32Z",
      "updated_at": "2015-07-31T19:53:32Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks for the comments @sipa. All fixed, and rebased for a cleaner history.\n",
      "user": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#issuecomment-126796985",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/252"
    },
    {
      "event": "mentioned",
      "id": 370845624,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50MzcwODQ1NjI0",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/370845624",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-31T19:53:32Z"
    },
    {
      "event": "subscribed",
      "id": 370845625,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDM3MDg0NTYyNQ==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/370845625",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-07-31T19:53:32Z"
    },
    {
      "event": "commented",
      "id": 126918042,
      "node_id": "MDEyOklzc3VlQ29tbWVudDEyNjkxODA0Mg==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/126918042",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-08-01T14:16:33Z",
      "updated_at": "2015-08-01T14:16:33Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks! Can you also make some changes to .travis so this gets tested?\n",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#issuecomment-126918042",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/252"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTY2NDg2MTg6MDczOWJiYjZmMDU2YjI2YmI4NDAwNjAxMjAzMzMzM2E3MzE3MGQ0Mg==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/0739bbb6f056b26bb84006012033333a73170d42",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/0739bbb6f056b26bb84006012033333a73170d42",
      "tree": {
        "sha": "5b4ebd1c3914f50463ac296101979e80e6c050bd",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/5b4ebd1c3914f50463ac296101979e80e6c050bd"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/440150006064295038d4d7fcb7fe2796bf1672df",
          "sha": "440150006064295038d4d7fcb7fe2796bf1672df",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/440150006064295038d4d7fcb7fe2796bf1672df"
        }
      ],
      "message": "Add ECDH module which works by hashing the output of ecmult_const",
      "committer": {
        "name": "Andrew Poelstra",
        "email": "apoelstra@wpsoftware.net",
        "date": "2015-08-01T15:57:33Z"
      },
      "author": {
        "name": "Andrew Poelstra",
        "email": "apoelstra@wpsoftware.net",
        "date": "2015-06-29T20:06:28Z"
      },
      "sha": "0739bbb6f056b26bb84006012033333a73170d42"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTY2NDg2MTg6OTFjMGNlOTVjYWJkYTUyZDAzZWRmZTUyNDUzYTEwMDRmYmIwMWQxZQ==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/91c0ce95cabda52d03edfe52453a1004fbb01d1e",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/91c0ce95cabda52d03edfe52453a1004fbb01d1e",
      "tree": {
        "sha": "d54ce9dc236dd149e9ed434a1074e6aeddc39214",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/d54ce9dc236dd149e9ed434a1074e6aeddc39214"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/0739bbb6f056b26bb84006012033333a73170d42",
          "sha": "0739bbb6f056b26bb84006012033333a73170d42",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/0739bbb6f056b26bb84006012033333a73170d42"
        }
      ],
      "message": "Add benchmarks for ECDH and const-time multiplication",
      "committer": {
        "name": "Andrew Poelstra",
        "email": "apoelstra@wpsoftware.net",
        "date": "2015-08-01T15:57:36Z"
      },
      "author": {
        "name": "Andrew Poelstra",
        "email": "apoelstra@wpsoftware.net",
        "date": "2015-05-15T19:46:08Z"
      },
      "sha": "91c0ce95cabda52d03edfe52453a1004fbb01d1e"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTY2NDg2MTg6ZWQzNWQ0M2EwY2QyOTk0YjkxNjUwMDY1YzA4M2M0ZTkzN2M3ODYwMA==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/ed35d43a0cd2994b91650065c083c4e937c78600",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/ed35d43a0cd2994b91650065c083c4e937c78600",
      "tree": {
        "sha": "7381ab36f8ad685b9e2f76da78113abd78b9d112",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/7381ab36f8ad685b9e2f76da78113abd78b9d112"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/91c0ce95cabda52d03edfe52453a1004fbb01d1e",
          "sha": "91c0ce95cabda52d03edfe52453a1004fbb01d1e",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/91c0ce95cabda52d03edfe52453a1004fbb01d1e"
        }
      ],
      "message": "Make `secp256k1_scalar_add_bit` conditional; make `secp256k1_scalar_split_lambda_var` constant time\n\nThis has the effect of making `secp256k1_scalar_mul_shift_var` constant\ntime in both input scalars. Keep the _var name because it is NOT constant\ntime in the shift amount.\n\nAs used in `secp256k1_scalar_split_lambda_var`, the shift is always\nthe constant 272, so this function becomes constant time, and it\nloses the `_var` suffix.",
      "committer": {
        "name": "Andrew Poelstra",
        "email": "apoelstra@wpsoftware.net",
        "date": "2015-08-01T15:57:36Z"
      },
      "author": {
        "name": "Andrew Poelstra",
        "email": "apoelstra@wpsoftware.net",
        "date": "2015-05-22T16:51:51Z"
      },
      "sha": "ed35d43a0cd2994b91650065c083c4e937c78600"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTY2NDg2MTg6OTJlNTNmYzRjODA4MDU0NmI0YTg1YWVmODMxNWQxYTU0NWZiYjNhYg==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/92e53fc4c8080546b4a85aef8315d1a545fbb3ab",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/92e53fc4c8080546b4a85aef8315d1a545fbb3ab",
      "tree": {
        "sha": "7cfe9852ddf4793e9621c4385ba5d621a399ac10",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/7cfe9852ddf4793e9621c4385ba5d621a399ac10"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/ed35d43a0cd2994b91650065c083c4e937c78600",
          "sha": "ed35d43a0cd2994b91650065c083c4e937c78600",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/ed35d43a0cd2994b91650065c083c4e937c78600"
        }
      ],
      "message": "Implement endomorphism optimization for secp256k1_ecmult_const",
      "committer": {
        "name": "Andrew Poelstra",
        "email": "apoelstra@wpsoftware.net",
        "date": "2015-08-01T15:57:36Z"
      },
      "author": {
        "name": "Andrew Poelstra",
        "email": "apoelstra@wpsoftware.net",
        "date": "2015-05-22T17:09:36Z"
      },
      "sha": "92e53fc4c8080546b4a85aef8315d1a545fbb3ab"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "MDY6Q29tbWl0MTY2NDg2MTg6NzJhZTQ0M2FmYjUzNjIyMWE4NTIzNjQ2ZWE0YTg4MTYyMzQxYzNkZg==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/72ae443afb536221a8523646ea4a88162341c3df",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/72ae443afb536221a8523646ea4a88162341c3df",
      "tree": {
        "sha": "eda9caa9b6a0fc383b74a8737941f0ed17524cb0",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/eda9caa9b6a0fc383b74a8737941f0ed17524cb0"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/92e53fc4c8080546b4a85aef8315d1a545fbb3ab",
          "sha": "92e53fc4c8080546b4a85aef8315d1a545fbb3ab",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/92e53fc4c8080546b4a85aef8315d1a545fbb3ab"
        }
      ],
      "message": "Improve perf. of cmov-based table lookup",
      "committer": {
        "name": "Andrew Poelstra",
        "email": "apoelstra@wpsoftware.net",
        "date": "2015-08-01T15:57:36Z"
      },
      "author": {
        "name": "Peter Dettman",
        "email": "peter.dettman@gmail.com",
        "date": "2015-07-15T13:33:35Z"
      },
      "sha": "72ae443afb536221a8523646ea4a88162341c3df"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 371182003,
      "node_id": "MDIzOkhlYWRSZWZGb3JjZVB1c2hlZEV2ZW50MzcxMTgyMDAz",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/371182003",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-08-01T15:57:47Z"
    },
    {
      "event": "merged",
      "id": 371434334,
      "node_id": "MDExOk1lcmdlZEV2ZW50MzcxNDM0MzM0",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/371434334",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "72ae443afb536221a8523646ea4a88162341c3df",
      "commit_url": "https://api.github.com/repos/bitcoin-core/secp256k1/commits/72ae443afb536221a8523646ea4a88162341c3df",
      "created_at": "2015-08-02T17:33:20Z"
    },
    {
      "event": "closed",
      "id": 371434335,
      "node_id": "MDExOkNsb3NlZEV2ZW50MzcxNDM0MzM1",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/371434335",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-08-02T17:33:20Z"
    },
    {
      "event": "referenced",
      "id": 371434336,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDM3MTQzNDMzNg==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/371434336",
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "d84a3784f41108e9b25c665ddd7200ec3bb5df57",
      "commit_url": "https://api.github.com/repos/bitcoin-core/secp256k1/commits/d84a3784f41108e9b25c665ddd7200ec3bb5df57",
      "created_at": "2015-08-02T17:33:20Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-08-28T00:35:15Z",
      "updated_at": "2015-08-28T00:35:15Z",
      "source": {
        "issue": {
          "id": 95553911,
          "node_id": "MDU6SXNzdWU5NTU1MzkxMQ==",
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/277",
          "repository_url": "https://api.github.com/repos/bitcoin-core/secp256k1",
          "labels_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/277/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/277/comments",
          "events_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/277/events",
          "html_url": "https://github.com/bitcoin-core/secp256k1/issues/277",
          "number": 277,
          "state": "closed",
          "state_reason": "completed",
          "title": "Support for optional parts",
          "body": "So far, all pieces of libsecp256k1 functionality have been part of a single offered interface. This made sense as long as all we were doing was implementing a pre-existing ECDSA standard.\n\nHowever, there are now a few self-defined algorithms implemented and under review (Schnorr/SHA256, ECDH SHA256, ECDH x-only) and a few more externally maintained patches for extra functionality.\n\nI wonder what kind of model we want for these. I feel that it's not optimal to \"force\" these standards on people using the library for pure ECDSA, but dozens of patch sets is not a maintainable situation either.\n\nOf course, functionality could be compiled optionally, which is pretty easy because of the library's all-internal-implementations-is-in-headers, but there would be a question of headers. secp256k1.h could get optional parts, which get macro processed before install time, or (my preference) have separate .h files (secp256k1/ecdsa.h secp256k1/eckey.h secp256k1/schnorr.h, ...).\n\nOpinions? @gmaxwell @apoelstra @peterdettman @theuni @laanwj?\n",
          "user": {
            "login": "sipa",
            "id": 548488,
            "node_id": "MDQ6VXNlcjU0ODQ4OA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/sipa",
            "html_url": "https://github.com/sipa",
            "followers_url": "https://api.github.com/users/sipa/followers",
            "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
            "organizations_url": "https://api.github.com/users/sipa/orgs",
            "repos_url": "https://api.github.com/users/sipa/repos",
            "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/sipa/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 4,
          "closed_at": "2015-08-28T00:35:15Z",
          "created_at": "2015-07-16T23:41:32Z",
          "updated_at": "2015-08-28T00:35:15Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 154039664,
      "node_id": "MDEyOklzc3VlQ29tbWVudDE1NDAzOTY2NA==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/154039664",
      "actor": {
        "login": "Kagami",
        "id": 533383,
        "node_id": "MDQ6VXNlcjUzMzM4Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/533383?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Kagami",
        "html_url": "https://github.com/Kagami",
        "followers_url": "https://api.github.com/users/Kagami/followers",
        "following_url": "https://api.github.com/users/Kagami/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Kagami/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Kagami/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Kagami/subscriptions",
        "organizations_url": "https://api.github.com/users/Kagami/orgs",
        "repos_url": "https://api.github.com/users/Kagami/repos",
        "events_url": "https://api.github.com/users/Kagami/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Kagami/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-11-05T11:51:26Z",
      "updated_at": "2015-11-05T11:51:26Z",
      "author_association": "NONE",
      "body": "It's a bit unfortunate that `secp256k1` always hash the derived secret, because it means I can't use it for existing protocols like [Bitmessage](https://bitmessage.org/wiki/Encryption).\n\nAny ideas how can I get `Px` with `secp256k1`? Only by implementing my own version of `secp256k1_ecdh`? (Note that Bitmessage uses `SHA512(Px)`, so it's not unsafe.)\n",
      "user": {
        "login": "Kagami",
        "id": 533383,
        "node_id": "MDQ6VXNlcjUzMzM4Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/533383?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Kagami",
        "html_url": "https://github.com/Kagami",
        "followers_url": "https://api.github.com/users/Kagami/followers",
        "following_url": "https://api.github.com/users/Kagami/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Kagami/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Kagami/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Kagami/subscriptions",
        "organizations_url": "https://api.github.com/users/Kagami/orgs",
        "repos_url": "https://api.github.com/users/Kagami/repos",
        "events_url": "https://api.github.com/users/Kagami/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Kagami/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#issuecomment-154039664",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/252"
    },
    {
      "event": "commented",
      "id": 154052769,
      "node_id": "MDEyOklzc3VlQ29tbWVudDE1NDA1Mjc2OQ==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/154052769",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-11-05T12:59:55Z",
      "updated_at": "2015-11-05T12:59:55Z",
      "author_association": "CONTRIBUTOR",
      "body": "@Kagami As you say, ECIES actually only needs a hash of Px, though it's not our hash. Can you open an issue requesting we extend the ECDH API to support a custom hash function (like the signing functions support custom nonce functions)?\n\nThis is something we've considered but haven't had any concrete usecases and I guess it forgot to get written down..\n",
      "user": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#issuecomment-154052769",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/252"
    },
    {
      "event": "mentioned",
      "id": 455682671,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDU1NjgyNjcx",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/455682671",
      "actor": {
        "login": "Kagami",
        "id": 533383,
        "node_id": "MDQ6VXNlcjUzMzM4Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/533383?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Kagami",
        "html_url": "https://github.com/Kagami",
        "followers_url": "https://api.github.com/users/Kagami/followers",
        "following_url": "https://api.github.com/users/Kagami/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Kagami/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Kagami/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Kagami/subscriptions",
        "organizations_url": "https://api.github.com/users/Kagami/orgs",
        "repos_url": "https://api.github.com/users/Kagami/repos",
        "events_url": "https://api.github.com/users/Kagami/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Kagami/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-11-05T12:59:55Z"
    },
    {
      "event": "subscribed",
      "id": 455682672,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ1NTY4MjY3Mg==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/455682672",
      "actor": {
        "login": "Kagami",
        "id": 533383,
        "node_id": "MDQ6VXNlcjUzMzM4Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/533383?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Kagami",
        "html_url": "https://github.com/Kagami",
        "followers_url": "https://api.github.com/users/Kagami/followers",
        "following_url": "https://api.github.com/users/Kagami/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Kagami/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Kagami/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Kagami/subscriptions",
        "organizations_url": "https://api.github.com/users/Kagami/orgs",
        "repos_url": "https://api.github.com/users/Kagami/repos",
        "events_url": "https://api.github.com/users/Kagami/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Kagami/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-11-05T12:59:55Z"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "Kagami",
        "id": 533383,
        "node_id": "MDQ6VXNlcjUzMzM4Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/533383?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Kagami",
        "html_url": "https://github.com/Kagami",
        "followers_url": "https://api.github.com/users/Kagami/followers",
        "following_url": "https://api.github.com/users/Kagami/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Kagami/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Kagami/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Kagami/subscriptions",
        "organizations_url": "https://api.github.com/users/Kagami/orgs",
        "repos_url": "https://api.github.com/users/Kagami/repos",
        "events_url": "https://api.github.com/users/Kagami/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Kagami/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2015-11-05T13:09:59Z",
      "updated_at": "2015-11-05T13:09:59Z",
      "source": {
        "issue": {
          "id": 115280748,
          "node_id": "MDU6SXNzdWUxMTUyODA3NDg=",
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/352",
          "repository_url": "https://api.github.com/repos/bitcoin-core/secp256k1",
          "labels_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/352/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/352/comments",
          "events_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/352/events",
          "html_url": "https://github.com/bitcoin-core/secp256k1/issues/352",
          "number": 352,
          "state": "closed",
          "state_reason": "completed",
          "title": "Support custom hash functions in ECDH API",
          "body": "Current ECDH implementation always hashes both `Px` and `Py` of point multiplication result with SHA256. It makes impossible to use `secp256k1` with existing protocols like [Bitmessage](https://bitmessage.org/wiki/Encryption) which uses `SHA512(Px)` as shared secret. As mentioned [here](https://github.com/bitcoin/secp256k1/pull/252#issuecomment-154052769), possible solution for this is to accept custom hash function in API similar to custom nonce function.\n\ncc @apoelstra\n",
          "user": {
            "login": "Kagami",
            "id": 533383,
            "node_id": "MDQ6VXNlcjUzMzM4Mw==",
            "avatar_url": "https://avatars.githubusercontent.com/u/533383?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/Kagami",
            "html_url": "https://github.com/Kagami",
            "followers_url": "https://api.github.com/users/Kagami/followers",
            "following_url": "https://api.github.com/users/Kagami/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/Kagami/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/Kagami/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/Kagami/subscriptions",
            "organizations_url": "https://api.github.com/users/Kagami/orgs",
            "repos_url": "https://api.github.com/users/Kagami/repos",
            "events_url": "https://api.github.com/users/Kagami/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/Kagami/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [],
          "assignees": [],
          "author_association": "NONE",
          "locked": false,
          "comments": 18,
          "closed_at": "2019-10-11T17:46:38Z",
          "created_at": "2015-11-05T13:09:59Z",
          "updated_at": "2019-10-11T17:46:38Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2016-11-28T05:19:01Z",
      "updated_at": "2016-11-28T05:19:01Z",
      "source": {
        "issue": {
          "id": 48477330,
          "node_id": "MDU6SXNzdWU0ODQ3NzMzMA==",
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/100",
          "repository_url": "https://api.github.com/repos/bitcoin-core/secp256k1",
          "labels_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/100/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/100/comments",
          "events_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/100/events",
          "html_url": "https://github.com/bitcoin-core/secp256k1/issues/100",
          "number": 100,
          "state": "closed",
          "state_reason": "completed",
          "title": "add generic constant time multi-exp for ECDH",
          "body": "There should be a public interface offering a constant-time generic multiexp,  e.g. out_point = s1_P1 + s2_P2 + ...  + sn*Pn, for use in ECDH and ECDH with forward secrecy.   (unless there is some speedup I'm not thinking of which only works for the non-multiexp case).\n\nMaybe API wise it could split precomputation and the multiply, for applications where points are reused?  e.g. pass in a set of precomputed tables?\n",
          "user": {
            "login": "gmaxwell",
            "id": 858454,
            "node_id": "MDQ6VXNlcjg1ODQ1NA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/gmaxwell",
            "html_url": "https://github.com/gmaxwell",
            "followers_url": "https://api.github.com/users/gmaxwell/followers",
            "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
            "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
            "repos_url": "https://api.github.com/users/gmaxwell/repos",
            "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [],
          "assignee": {
            "login": "sipa",
            "id": 548488,
            "node_id": "MDQ6VXNlcjU0ODQ4OA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/sipa",
            "html_url": "https://github.com/sipa",
            "followers_url": "https://api.github.com/users/sipa/followers",
            "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
            "organizations_url": "https://api.github.com/users/sipa/orgs",
            "repos_url": "https://api.github.com/users/sipa/repos",
            "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/sipa/received_events",
            "type": "User",
            "site_admin": false
          },
          "assignees": [
            {
              "login": "sipa",
              "id": 548488,
              "node_id": "MDQ6VXNlcjU0ODQ4OA==",
              "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
              "gravatar_id": "",
              "url": "https://api.github.com/users/sipa",
              "html_url": "https://github.com/sipa",
              "followers_url": "https://api.github.com/users/sipa/followers",
              "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
              "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
              "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
              "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
              "organizations_url": "https://api.github.com/users/sipa/orgs",
              "repos_url": "https://api.github.com/users/sipa/repos",
              "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
              "received_events_url": "https://api.github.com/users/sipa/received_events",
              "type": "User",
              "site_admin": false
            }
          ],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 2,
          "closed_at": "2016-11-28T05:19:01Z",
          "created_at": "2014-11-12T06:18:48Z",
          "updated_at": "2016-11-28T05:19:01Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "head_ref_deleted",
      "id": 1129081779,
      "node_id": "MDE5OkhlYWRSZWZEZWxldGVkRXZlbnQxMTI5MDgxNzc5",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/1129081779",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2017-06-19T13:21:47Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/33412268",
      "pull_request_review_id": null,
      "id": 33412268,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzNDEyMjY4",
      "diff_hunk": "@@ -223,6 +225,32 @@ int secp256k1_ecdsa_recover_compact(const secp256k1_context_t* ctx, const unsign\n     return ret;\n }\n \n+int secp256k1_point_multiply(unsigned char *point, int *pointlen, const unsigned char *scalar) {\n+    int ret = 0;\n+    int overflow = 0;\n+    secp256k1_gej_t res;\n+    secp256k1_ge_t pt;\n+    secp256k1_scalar_t s;\n+    DEBUG_CHECK(point != NULL);\n+    DEBUG_CHECK(pointlen != NULL);\n+    DEBUG_CHECK(scalar != NULL);\n+\n+    if (secp256k1_eckey_pubkey_parse(&pt, point, *pointlen)) {\n+        secp256k1_scalar_set_b32(&s, scalar, &overflow);\n+        if (overflow) {\n+            ret = -2;\n+        } else {\n+            secp256k1_ecdh_point_multiply(&res, &pt, &s);\n+            secp256k1_ge_set_gej(&pt, &res);\n+            ret = secp256k1_eckey_pubkey_serialize(&pt, point, pointlen, *pointlen <= 33);",
      "path": "src/secp256k1.c",
      "position": null,
      "original_position": 30,
      "commit_id": "72ae443afb536221a8523646ea4a88162341c3df",
      "original_commit_id": "2896833062ddf973d27b725e990a9a23f63d65a7",
      "in_reply_to_id": null,
      "user": {
        "login": "peterdettman",
        "id": 3423981,
        "node_id": "MDQ6VXNlcjM0MjM5ODE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3423981?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/peterdettman",
        "html_url": "https://github.com/peterdettman",
        "followers_url": "https://api.github.com/users/peterdettman/followers",
        "following_url": "https://api.github.com/users/peterdettman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/peterdettman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/peterdettman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/peterdettman/subscriptions",
        "organizations_url": "https://api.github.com/users/peterdettman/orgs",
        "repos_url": "https://api.github.com/users/peterdettman/repos",
        "events_url": "https://api.github.com/users/peterdettman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/peterdettman/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The output point is supposed to be secret (ECDH agreement), but _pubkey_serialize uses _normalize_var internally because it's assuming a public key point.\n",
      "created_at": "2015-06-27T12:01:36Z",
      "updated_at": "2015-08-01T15:57:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#discussion_r33412268",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/33412268"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/252"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/33412404",
      "pull_request_review_id": null,
      "id": 33412404,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzNDEyNDA0",
      "diff_hunk": "@@ -217,6 +217,24 @@ SECP256K1_WARN_UNUSED_RESULT int secp256k1_ecdsa_recover_compact(\n   int recid\n ) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4) SECP256K1_ARG_NONNULL(5);\n \n+\n+/** Do an elliptic curve scalar multiplication in constant time.\n+ *  Returns: 1: exponentiation was successful\n+ *          -1: scalar was zero (cannot serialize output point)\n+ *          -2: scalar overflow\n+ *          -3: invalid input point\n+ *  In:      scalar:   a 32-byte scalar with which to multiple the point",
      "path": "include/secp256k1.h",
      "position": null,
      "original_position": 10,
      "commit_id": "72ae443afb536221a8523646ea4a88162341c3df",
      "original_commit_id": "2896833062ddf973d27b725e990a9a23f63d65a7",
      "in_reply_to_id": null,
      "user": {
        "login": "peterdettman",
        "id": 3423981,
        "node_id": "MDQ6VXNlcjM0MjM5ODE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3423981?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/peterdettman",
        "html_url": "https://github.com/peterdettman",
        "followers_url": "https://api.github.com/users/peterdettman/followers",
        "following_url": "https://api.github.com/users/peterdettman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/peterdettman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/peterdettman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/peterdettman/subscriptions",
        "organizations_url": "https://api.github.com/users/peterdettman/orgs",
        "repos_url": "https://api.github.com/users/peterdettman/repos",
        "events_url": "https://api.github.com/users/peterdettman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/peterdettman/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "multiple -> multiply\n",
      "created_at": "2015-06-27T12:32:46Z",
      "updated_at": "2015-08-01T15:57:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#discussion_r33412404",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/33412404"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/252"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/33475533",
      "pull_request_review_id": null,
      "id": 33475533,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzNDc1NTMz",
      "diff_hunk": "@@ -223,6 +225,32 @@ int secp256k1_ecdsa_recover_compact(const secp256k1_context_t* ctx, const unsign\n     return ret;\n }\n \n+int secp256k1_point_multiply(unsigned char *point, int *pointlen, const unsigned char *scalar) {\n+    int ret = 0;\n+    int overflow = 0;\n+    secp256k1_gej_t res;\n+    secp256k1_ge_t pt;\n+    secp256k1_scalar_t s;\n+    DEBUG_CHECK(point != NULL);\n+    DEBUG_CHECK(pointlen != NULL);\n+    DEBUG_CHECK(scalar != NULL);\n+\n+    if (secp256k1_eckey_pubkey_parse(&pt, point, *pointlen)) {\n+        secp256k1_scalar_set_b32(&s, scalar, &overflow);\n+        if (overflow) {\n+            ret = -2;\n+        } else {\n+            secp256k1_ecdh_point_multiply(&res, &pt, &s);\n+            secp256k1_ge_set_gej(&pt, &res);\n+            ret = secp256k1_eckey_pubkey_serialize(&pt, point, pointlen, *pointlen <= 33);",
      "path": "src/secp256k1.c",
      "position": null,
      "original_position": 30,
      "commit_id": "72ae443afb536221a8523646ea4a88162341c3df",
      "original_commit_id": "2896833062ddf973d27b725e990a9a23f63d65a7",
      "in_reply_to_id": null,
      "user": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yikes! Thanks for catching this.\n",
      "created_at": "2015-06-29T15:25:33Z",
      "updated_at": "2015-08-01T15:57:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#discussion_r33475533",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/33475533"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/252"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/33538920",
      "pull_request_review_id": null,
      "id": 33538920,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzNTM4OTIw",
      "diff_hunk": "@@ -0,0 +1,49 @@\n+/**********************************************************************\n+ * Copyright (c) 2015 Pieter Wuille, Andrew Poelstra                  *\n+ * Distributed under the MIT software license, see the accompanying   *\n+ * file COPYING or http://www.opensource.org/licenses/mit-license.php.*\n+ **********************************************************************/\n+\n+#include <string.h>\n+\n+#include \"include/secp256k1.h\"\n+#include \"util.h\"\n+#include \"bench.h\"\n+\n+typedef struct {\n+    unsigned char point[33];\n+    int pointlen;\n+    unsigned char scalar[32];\n+} bench_multiply_t;\n+\n+static void bench_multiply_setup(void* arg) {\n+    int i;\n+    bench_multiply_t *data = (bench_multiply_t*)arg;\n+    const unsigned char point[] = {\n+        0x03,\n+        0x54, 0x94, 0xc1, 0x5d, 0x32, 0x09, 0x97, 0x06,\n+        0xc2, 0x39, 0x5f, 0x94, 0x34, 0x87, 0x45, 0xfd,\n+        0x75, 0x7c, 0xe3, 0x0e, 0x4e, 0x8c, 0x90, 0xfb,\n+        0xa2, 0xba, 0xd1, 0x84, 0xf8, 0x83, 0xc6, 0x9f\n+    };\n+\n+    for (i = 0; i < 32; i++) data->scalar[i] = i + 1;\n+    data->pointlen = sizeof(point);\n+    memcpy(data->point, point, data->pointlen);\n+}\n+\n+static void bench_multiply(void* arg) {\n+    int i;\n+    bench_multiply_t *data = (bench_multiply_t*)arg;\n+\n+    for (i = 0; i < 20000; i++) {\n+        CHECK(secp256k1_ecdh_point_multiply(data->point, &data->pointlen, data->scalar) == 1);",
      "path": "src/bench_ecdh.c",
      "position": null,
      "original_position": 40,
      "commit_id": "72ae443afb536221a8523646ea4a88162341c3df",
      "original_commit_id": "370c270267ca48023b3dc0afaf9633c1125e83ef",
      "in_reply_to_id": null,
      "user": {
        "login": "peterdettman",
        "id": 3423981,
        "node_id": "MDQ6VXNlcjM0MjM5ODE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3423981?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/peterdettman",
        "html_url": "https://github.com/peterdettman",
        "followers_url": "https://api.github.com/users/peterdettman/followers",
        "following_url": "https://api.github.com/users/peterdettman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/peterdettman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/peterdettman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/peterdettman/subscriptions",
        "organizations_url": "https://api.github.com/users/peterdettman/orgs",
        "repos_url": "https://api.github.com/users/peterdettman/repos",
        "events_url": "https://api.github.com/users/peterdettman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/peterdettman/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Seems to have been missed in the API change?\n",
      "created_at": "2015-06-30T04:07:00Z",
      "updated_at": "2015-08-01T15:57:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#discussion_r33538920",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/33538920"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/252"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/33608679",
      "pull_request_review_id": null,
      "id": 33608679,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzNjA4Njc5",
      "diff_hunk": "@@ -0,0 +1,49 @@\n+/**********************************************************************\n+ * Copyright (c) 2015 Pieter Wuille, Andrew Poelstra                  *\n+ * Distributed under the MIT software license, see the accompanying   *\n+ * file COPYING or http://www.opensource.org/licenses/mit-license.php.*\n+ **********************************************************************/\n+\n+#include <string.h>\n+\n+#include \"include/secp256k1.h\"\n+#include \"util.h\"\n+#include \"bench.h\"\n+\n+typedef struct {\n+    unsigned char point[33];\n+    int pointlen;\n+    unsigned char scalar[32];\n+} bench_multiply_t;\n+\n+static void bench_multiply_setup(void* arg) {\n+    int i;\n+    bench_multiply_t *data = (bench_multiply_t*)arg;\n+    const unsigned char point[] = {\n+        0x03,\n+        0x54, 0x94, 0xc1, 0x5d, 0x32, 0x09, 0x97, 0x06,\n+        0xc2, 0x39, 0x5f, 0x94, 0x34, 0x87, 0x45, 0xfd,\n+        0x75, 0x7c, 0xe3, 0x0e, 0x4e, 0x8c, 0x90, 0xfb,\n+        0xa2, 0xba, 0xd1, 0x84, 0xf8, 0x83, 0xc6, 0x9f\n+    };\n+\n+    for (i = 0; i < 32; i++) data->scalar[i] = i + 1;\n+    data->pointlen = sizeof(point);\n+    memcpy(data->point, point, data->pointlen);\n+}\n+\n+static void bench_multiply(void* arg) {\n+    int i;\n+    bench_multiply_t *data = (bench_multiply_t*)arg;\n+\n+    for (i = 0; i < 20000; i++) {\n+        CHECK(secp256k1_ecdh_point_multiply(data->point, &data->pointlen, data->scalar) == 1);",
      "path": "src/bench_ecdh.c",
      "position": null,
      "original_position": 40,
      "commit_id": "72ae443afb536221a8523646ea4a88162341c3df",
      "original_commit_id": "370c270267ca48023b3dc0afaf9633c1125e83ef",
      "in_reply_to_id": null,
      "user": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Yeah, oops. Should we put `-Werror` in Travis to prevent this oversight in future?\n",
      "created_at": "2015-06-30T18:45:36Z",
      "updated_at": "2015-08-01T15:57:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#discussion_r33608679",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/33608679"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/252"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/33643557",
      "pull_request_review_id": null,
      "id": 33643557,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzNjQzNTU3",
      "diff_hunk": "@@ -217,6 +217,24 @@ SECP256K1_WARN_UNUSED_RESULT int secp256k1_ecdsa_recover_compact(\n   int recid\n ) SECP256K1_ARG_NONNULL(1) SECP256K1_ARG_NONNULL(2) SECP256K1_ARG_NONNULL(3) SECP256K1_ARG_NONNULL(4) SECP256K1_ARG_NONNULL(5);\n \n+/** Compute an EC Diffie-Hellman secret in constant time\n+ *  Returns: 1: exponentiation was successful\n+ *           0: scalar was zero (cannot serialize output point)\n+ *          -1: scalar overflow\n+ *          -2: invalid input point",
      "path": "include/secp256k1.h",
      "position": null,
      "original_position": 8,
      "commit_id": "72ae443afb536221a8523646ea4a88162341c3df",
      "original_commit_id": "48dc8e3001a927f42c5a7f46c540e0c1b2f76909",
      "in_reply_to_id": null,
      "user": {
        "login": "peterdettman",
        "id": 3423981,
        "node_id": "MDQ6VXNlcjM0MjM5ODE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3423981?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/peterdettman",
        "html_url": "https://github.com/peterdettman",
        "followers_url": "https://api.github.com/users/peterdettman/followers",
        "following_url": "https://api.github.com/users/peterdettman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/peterdettman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/peterdettman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/peterdettman/subscriptions",
        "organizations_url": "https://api.github.com/users/peterdettman/orgs",
        "repos_url": "https://api.github.com/users/peterdettman/repos",
        "events_url": "https://api.github.com/users/peterdettman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/peterdettman/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The error codes seem out-of-sync with the method body.\n",
      "created_at": "2015-07-01T02:22:06Z",
      "updated_at": "2015-08-01T15:57:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#discussion_r33643557",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/33643557"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/252"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/33663329",
      "pull_request_review_id": null,
      "id": 33663329,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzNjYzMzI5",
      "diff_hunk": "@@ -1235,6 +1253,148 @@ void run_ge(void) {\n     test_add_neg_y_diff_x();\n }\n \n+/***** ECDH TESTS *****/\n+\n+void ecdh_random_mult(void) {\n+    /* random starting point A (on the curve) */\n+    secp256k1_ge_t a = SECP256K1_GE_CONST(\n+        0x6d986544, 0x57ff52b8, 0xcf1b8126, 0x5b802a5b,\n+        0xa97f9263, 0xb1e88044, 0x93351325, 0x91bc450a,\n+        0x535c59f7, 0x325e5d2b, 0xc391fbe8, 0x3c12787c,\n+        0x337e4a98, 0xe82a9011, 0x0123ba37, 0xdd769c7d\n+    );\n+    /* random initial factor xn */\n+    secp256k1_scalar_t xn = SECP256K1_SCALAR_CONST(\n+        0x649d4f77, 0xc4242df7, 0x7f2079c9, 0x14530327,\n+        0xa31b876a, 0xd2d8ce2a, 0x2236d5c6, 0xd7b2029b\n+    );\n+    /* expected xn * A (from sage) */\n+    secp256k1_ge_t expected_b = SECP256K1_GE_CONST(\n+        0x23773684, 0x4d209dc7, 0x098a786f, 0x20d06fcd,\n+        0x070a38bf, 0xc11ac651, 0x03004319, 0x1e2a8786,\n+        0xed8c3b8e, 0xc06dd57b, 0xd06ea66e, 0x45492b0f,\n+        0xb84e4e1b, 0xfb77e21f, 0x96baae2a, 0x63dec956\n+    );\n+    secp256k1_gej_t b;\n+    secp256k1_point_multiply(&b, &a, &xn);\n+\n+    CHECK(secp256k1_ge_is_valid_var(&a));\n+    ge_equals_gej(&expected_b, &b);\n+}\n+\n+void ecdh_commutativity(void) {\n+    secp256k1_scalar_t a;\n+    secp256k1_scalar_t b;\n+    secp256k1_gej_t res1;\n+    secp256k1_gej_t res2;\n+    secp256k1_ge_t mid1;\n+    secp256k1_ge_t mid2;\n+    random_scalar_order_test(&a);\n+    random_scalar_order_test(&b);\n+\n+    secp256k1_point_multiply(&res1, &secp256k1_ge_const_g, &a);\n+    secp256k1_point_multiply(&res2, &secp256k1_ge_const_g, &b);\n+    secp256k1_ge_set_gej(&mid1, &res1);\n+    secp256k1_ge_set_gej(&mid2, &res2);\n+    secp256k1_point_multiply(&res1, &mid1, &b);\n+    secp256k1_point_multiply(&res2, &mid2, &a);\n+    secp256k1_ge_set_gej(&mid1, &res1);\n+    secp256k1_ge_set_gej(&mid2, &res2);\n+    ge_equals_ge(&mid1, &mid2);\n+}\n+\n+void ecdh_mult_zero_one(void) {\n+    secp256k1_scalar_t zero = SECP256K1_SCALAR_CONST(0, 0, 0, 0, 0, 0, 0, 0);\n+    secp256k1_scalar_t one = SECP256K1_SCALAR_CONST(0, 0, 0, 0, 0, 0, 0, 1);\n+    secp256k1_scalar_t negone;\n+    secp256k1_gej_t res1;\n+    secp256k1_ge_t res2;\n+    secp256k1_ge_t point;\n+    secp256k1_scalar_negate(&negone, &one);\n+\n+    random_group_element_test(&point);\n+    secp256k1_point_multiply(&res1, &point, &zero);\n+    secp256k1_ge_set_gej(&res2, &res1);\n+    CHECK(secp256k1_ge_is_infinity(&res2));\n+    secp256k1_point_multiply(&res1, &point, &one);\n+    secp256k1_ge_set_gej(&res2, &res1);\n+    ge_equals_ge(&res2, &point);\n+    secp256k1_point_multiply(&res1, &point, &negone);\n+    secp256k1_gej_neg(&res1, &res1);\n+    secp256k1_ge_set_gej(&res2, &res1);\n+    ge_equals_ge(&res2, &point);\n+}\n+\n+void ecdh_chain_multiply(void) {\n+    /* Check known result (randomly generated test problem from sage) */\n+    const secp256k1_scalar_t scalar = SECP256K1_SCALAR_CONST(\n+        0x4968d524, 0x2abf9b7a, 0x466abbcf, 0x34b11b6d,\n+        0xcd83d307, 0x827bed62, 0x05fad0ce, 0x18fae63b\n+    );\n+    const secp256k1_gej_t expected_point = SECP256K1_GEJ_CONST(\n+        0x5494c15d, 0x32099706, 0xc2395f94, 0x348745fd,\n+        0x757ce30e, 0x4e8c90fb, 0xa2bad184, 0xf883c69f,\n+        0x5d195d20, 0xe191bf7f, 0x1be3e55f, 0x56a80196,\n+        0x6071ad01, 0xf1462f66, 0xc997fa94, 0xdb858435\n+    );\n+    secp256k1_gej_t point;\n+    secp256k1_ge_t res;\n+    int i;\n+\n+    secp256k1_gej_set_ge(&point, &secp256k1_ge_const_g);\n+    for (i = 0; i < 100; ++i) {\n+        secp256k1_ge_t tmp;\n+        secp256k1_ge_set_gej(&tmp, &point);\n+        secp256k1_point_multiply(&point, &tmp, &scalar);\n+    }\n+    secp256k1_ge_set_gej(&res, &point);\n+    ge_equals_gej(&res, &expected_point);\n+}\n+\n+void ecdh_generator_basepoint(void) {\n+    secp256k1_ge_t gen = secp256k1_ge_const_g;\n+    unsigned char point[33];\n+    unsigned char point2[33];\n+    int pointlen = sizeof(point), point2len = sizeof(point2);\n+    int i;\n+\n+    /* Check against pubkey creation when the basepoint is the generator */\n+    for (i = 0; i < 100; ++i) {\n+        secp256k1_sha256_t sha;\n+        unsigned char s_b32[32];\n+        unsigned char output_ecdh[32];\n+        unsigned char output_ser[32];\n+        secp256k1_scalar_t s;\n+\n+        random_scalar_order(&s);\n+        secp256k1_scalar_get_b32(s_b32, &s);\n+\n+        /* compute using ECDH function */\n+        secp256k1_eckey_pubkey_serialize(&gen, point, &pointlen, 1);\n+        CHECK(secp256k1_ecdh(output_ecdh, point, &pointlen, s_b32) == 1);\n+        /* compute \"explicitly\" */\n+        secp256k1_eckey_pubkey_serialize(&gen, point2, &point2len, 1);\n+        CHECK(secp256k1_ec_pubkey_create(ctx, point2, &point2len, s_b32, 1) == 1);\n+\n+        secp256k1_sha256_initialize(&sha);\n+        secp256k1_sha256_write(&sha, point2, sizeof(point2));\n+        secp256k1_sha256_finalize(&sha, output_ser);\n+        /* compare */\n+        CHECK(memcmp(output_ecdh, output_ser, sizeof(output_ser)) == 0);\n+    }\n+}\n+\n+void run_ecdh_tests(void) {\n+    ecdh_mult_zero_one();\n+    ecdh_random_mult();\n+    ecdh_commutativity();\n+    ecdh_chain_multiply();\n+}\n+\n+void run_ecdh_api_tests(void) {\n+    ecdh_generator_basepoint();\n+}",
      "path": "src/tests.c",
      "position": null,
      "original_position": 194,
      "commit_id": "72ae443afb536221a8523646ea4a88162341c3df",
      "original_commit_id": "48dc8e3001a927f42c5a7f46c540e0c1b2f76909",
      "in_reply_to_id": null,
      "user": {
        "login": "peterdettman",
        "id": 3423981,
        "node_id": "MDQ6VXNlcjM0MjM5ODE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3423981?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/peterdettman",
        "html_url": "https://github.com/peterdettman",
        "followers_url": "https://api.github.com/users/peterdettman/followers",
        "following_url": "https://api.github.com/users/peterdettman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/peterdettman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/peterdettman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/peterdettman/subscriptions",
        "organizations_url": "https://api.github.com/users/peterdettman/orgs",
        "repos_url": "https://api.github.com/users/peterdettman/repos",
        "events_url": "https://api.github.com/users/peterdettman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/peterdettman/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Method run_ecdh_api_tests not actually called?\n",
      "created_at": "2015-07-01T09:44:58Z",
      "updated_at": "2015-08-01T15:57:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#discussion_r33663329",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/33663329"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/252"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/33810486",
      "pull_request_review_id": null,
      "id": 33810486,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzODEwNDg2",
      "diff_hunk": "@@ -1235,6 +1253,148 @@ void run_ge(void) {\n     test_add_neg_y_diff_x();\n }\n \n+/***** ECDH TESTS *****/\n+\n+void ecdh_random_mult(void) {\n+    /* random starting point A (on the curve) */\n+    secp256k1_ge_t a = SECP256K1_GE_CONST(\n+        0x6d986544, 0x57ff52b8, 0xcf1b8126, 0x5b802a5b,\n+        0xa97f9263, 0xb1e88044, 0x93351325, 0x91bc450a,\n+        0x535c59f7, 0x325e5d2b, 0xc391fbe8, 0x3c12787c,\n+        0x337e4a98, 0xe82a9011, 0x0123ba37, 0xdd769c7d\n+    );\n+    /* random initial factor xn */\n+    secp256k1_scalar_t xn = SECP256K1_SCALAR_CONST(\n+        0x649d4f77, 0xc4242df7, 0x7f2079c9, 0x14530327,\n+        0xa31b876a, 0xd2d8ce2a, 0x2236d5c6, 0xd7b2029b\n+    );\n+    /* expected xn * A (from sage) */\n+    secp256k1_ge_t expected_b = SECP256K1_GE_CONST(\n+        0x23773684, 0x4d209dc7, 0x098a786f, 0x20d06fcd,\n+        0x070a38bf, 0xc11ac651, 0x03004319, 0x1e2a8786,\n+        0xed8c3b8e, 0xc06dd57b, 0xd06ea66e, 0x45492b0f,\n+        0xb84e4e1b, 0xfb77e21f, 0x96baae2a, 0x63dec956\n+    );\n+    secp256k1_gej_t b;\n+    secp256k1_point_multiply(&b, &a, &xn);\n+\n+    CHECK(secp256k1_ge_is_valid_var(&a));\n+    ge_equals_gej(&expected_b, &b);\n+}\n+\n+void ecdh_commutativity(void) {\n+    secp256k1_scalar_t a;\n+    secp256k1_scalar_t b;\n+    secp256k1_gej_t res1;\n+    secp256k1_gej_t res2;\n+    secp256k1_ge_t mid1;\n+    secp256k1_ge_t mid2;\n+    random_scalar_order_test(&a);\n+    random_scalar_order_test(&b);\n+\n+    secp256k1_point_multiply(&res1, &secp256k1_ge_const_g, &a);\n+    secp256k1_point_multiply(&res2, &secp256k1_ge_const_g, &b);\n+    secp256k1_ge_set_gej(&mid1, &res1);\n+    secp256k1_ge_set_gej(&mid2, &res2);\n+    secp256k1_point_multiply(&res1, &mid1, &b);\n+    secp256k1_point_multiply(&res2, &mid2, &a);\n+    secp256k1_ge_set_gej(&mid1, &res1);\n+    secp256k1_ge_set_gej(&mid2, &res2);\n+    ge_equals_ge(&mid1, &mid2);\n+}\n+\n+void ecdh_mult_zero_one(void) {\n+    secp256k1_scalar_t zero = SECP256K1_SCALAR_CONST(0, 0, 0, 0, 0, 0, 0, 0);\n+    secp256k1_scalar_t one = SECP256K1_SCALAR_CONST(0, 0, 0, 0, 0, 0, 0, 1);\n+    secp256k1_scalar_t negone;\n+    secp256k1_gej_t res1;\n+    secp256k1_ge_t res2;\n+    secp256k1_ge_t point;\n+    secp256k1_scalar_negate(&negone, &one);\n+\n+    random_group_element_test(&point);\n+    secp256k1_point_multiply(&res1, &point, &zero);\n+    secp256k1_ge_set_gej(&res2, &res1);\n+    CHECK(secp256k1_ge_is_infinity(&res2));\n+    secp256k1_point_multiply(&res1, &point, &one);\n+    secp256k1_ge_set_gej(&res2, &res1);\n+    ge_equals_ge(&res2, &point);\n+    secp256k1_point_multiply(&res1, &point, &negone);\n+    secp256k1_gej_neg(&res1, &res1);\n+    secp256k1_ge_set_gej(&res2, &res1);\n+    ge_equals_ge(&res2, &point);\n+}\n+\n+void ecdh_chain_multiply(void) {\n+    /* Check known result (randomly generated test problem from sage) */\n+    const secp256k1_scalar_t scalar = SECP256K1_SCALAR_CONST(\n+        0x4968d524, 0x2abf9b7a, 0x466abbcf, 0x34b11b6d,\n+        0xcd83d307, 0x827bed62, 0x05fad0ce, 0x18fae63b\n+    );\n+    const secp256k1_gej_t expected_point = SECP256K1_GEJ_CONST(\n+        0x5494c15d, 0x32099706, 0xc2395f94, 0x348745fd,\n+        0x757ce30e, 0x4e8c90fb, 0xa2bad184, 0xf883c69f,\n+        0x5d195d20, 0xe191bf7f, 0x1be3e55f, 0x56a80196,\n+        0x6071ad01, 0xf1462f66, 0xc997fa94, 0xdb858435\n+    );\n+    secp256k1_gej_t point;\n+    secp256k1_ge_t res;\n+    int i;\n+\n+    secp256k1_gej_set_ge(&point, &secp256k1_ge_const_g);\n+    for (i = 0; i < 100; ++i) {\n+        secp256k1_ge_t tmp;\n+        secp256k1_ge_set_gej(&tmp, &point);\n+        secp256k1_point_multiply(&point, &tmp, &scalar);\n+    }\n+    secp256k1_ge_set_gej(&res, &point);\n+    ge_equals_gej(&res, &expected_point);\n+}\n+\n+void ecdh_generator_basepoint(void) {\n+    secp256k1_ge_t gen = secp256k1_ge_const_g;\n+    unsigned char point[33];\n+    unsigned char point2[33];\n+    int pointlen = sizeof(point), point2len = sizeof(point2);\n+    int i;\n+\n+    /* Check against pubkey creation when the basepoint is the generator */\n+    for (i = 0; i < 100; ++i) {\n+        secp256k1_sha256_t sha;\n+        unsigned char s_b32[32];\n+        unsigned char output_ecdh[32];\n+        unsigned char output_ser[32];\n+        secp256k1_scalar_t s;\n+\n+        random_scalar_order(&s);\n+        secp256k1_scalar_get_b32(s_b32, &s);\n+\n+        /* compute using ECDH function */\n+        secp256k1_eckey_pubkey_serialize(&gen, point, &pointlen, 1);\n+        CHECK(secp256k1_ecdh(output_ecdh, point, &pointlen, s_b32) == 1);\n+        /* compute \"explicitly\" */\n+        secp256k1_eckey_pubkey_serialize(&gen, point2, &point2len, 1);\n+        CHECK(secp256k1_ec_pubkey_create(ctx, point2, &point2len, s_b32, 1) == 1);\n+\n+        secp256k1_sha256_initialize(&sha);\n+        secp256k1_sha256_write(&sha, point2, sizeof(point2));\n+        secp256k1_sha256_finalize(&sha, output_ser);\n+        /* compare */\n+        CHECK(memcmp(output_ecdh, output_ser, sizeof(output_ser)) == 0);\n+    }\n+}\n+\n+void run_ecdh_tests(void) {\n+    ecdh_mult_zero_one();\n+    ecdh_random_mult();\n+    ecdh_commutativity();\n+    ecdh_chain_multiply();\n+}\n+\n+void run_ecdh_api_tests(void) {\n+    ecdh_generator_basepoint();\n+}",
      "path": "src/tests.c",
      "position": null,
      "original_position": 194,
      "commit_id": "72ae443afb536221a8523646ea4a88162341c3df",
      "original_commit_id": "48dc8e3001a927f42c5a7f46c540e0c1b2f76909",
      "in_reply_to_id": null,
      "user": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Ugh, thanks, this was a rebasing error.\n",
      "created_at": "2015-07-02T18:52:58Z",
      "updated_at": "2015-08-01T15:57:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#discussion_r33810486",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/33810486"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/252"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/34213565",
      "pull_request_review_id": null,
      "id": 34213565,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0MjEzNTY1",
      "diff_hunk": "@@ -223,6 +225,50 @@ int secp256k1_ecdsa_recover_compact(const secp256k1_context_t* ctx, const unsign\n     return ret;\n }\n \n+int secp256k1_ecdh(unsigned char *result, unsigned char *point, int *pointlen, const unsigned char *scalar) {\n+    int ret = 0;\n+    int overflow = 0;\n+    secp256k1_gej_t res;\n+    secp256k1_ge_t pt;\n+    secp256k1_scalar_t s;\n+    DEBUG_CHECK(point != NULL);\n+    DEBUG_CHECK(pointlen != NULL);\n+    DEBUG_CHECK(scalar != NULL);",
      "path": "src/secp256k1.c",
      "position": null,
      "original_position": 21,
      "commit_id": "72ae443afb536221a8523646ea4a88162341c3df",
      "original_commit_id": "0436dfcf62f5f47c3b8dacd49fba8de436f56030",
      "in_reply_to_id": null,
      "user": {
        "login": "peterdettman",
        "id": 3423981,
        "node_id": "MDQ6VXNlcjM0MjM5ODE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3423981?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/peterdettman",
        "html_url": "https://github.com/peterdettman",
        "followers_url": "https://api.github.com/users/peterdettman/followers",
        "following_url": "https://api.github.com/users/peterdettman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/peterdettman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/peterdettman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/peterdettman/subscriptions",
        "organizations_url": "https://api.github.com/users/peterdettman/orgs",
        "repos_url": "https://api.github.com/users/peterdettman/repos",
        "events_url": "https://api.github.com/users/peterdettman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/peterdettman/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "DEBUG_CHECK(result != NULL). Also, point can now be const, and pointlen by-value.\n",
      "created_at": "2015-07-09T00:26:53Z",
      "updated_at": "2015-08-01T15:57:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#discussion_r34213565",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/34213565"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/252"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/34241954",
      "pull_request_review_id": null,
      "id": 34241954,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0MjQxOTU0",
      "diff_hunk": "@@ -0,0 +1,219 @@\n+/**********************************************************************\n+ * Copyright (c) 2015 Pieter Wuille, Andrew Poelstra                  *\n+ * Distributed under the MIT software license, see the accompanying   *\n+ * file COPYING or http://www.opensource.org/licenses/mit-license.php.*\n+ **********************************************************************/\n+\n+#ifndef _SECP256K1_ECDH_IMPL_\n+#define _SECP256K1_ECDH_IMPL_\n+\n+#include \"scalar.h\"\n+#include \"group.h\"\n+#include \"ecdh.h\"\n+#include \"ecmult_impl.h\"\n+\n+#ifdef USE_ENDOMORPHISM\n+    #define WNAF_BITS 128\n+#else\n+    #define WNAF_BITS 256\n+#endif\n+#define WNAF_SIZE(w) ((WNAF_BITS + (w) - 1) / (w))\n+\n+/** Convert a number to WNAF notation. The number becomes represented by sum(2^{wi} * wnaf[i], i=0..return_val)\n+ *  with the following guarantees:\n+ *  - each wnaf[i] an odd integer between -(1 << w) and (1 << w)\n+ *  - each wnaf[i] is nonzero\n+ *  - the number of words set is returned; this is always (256 + w - 1) / w\n+ *\n+ *  Adapted from `The Width-w NAF Method Provides Small Memory and Fast Elliptic Scalar\n+ *  Multiplications Secure against Side Channel Attacks`, Okeya and Tagaki. M. Joye (Ed.)\n+ *  CT-RSA 2003, LNCS 2612, pp. 328-443, 2003. Springer-Verlagy Berlin Heidelberg 2003\n+ *\n+ *  Numbers reference steps of `Algorithm SPA-resistant Width-w NAF with Odd Scalar` on pp. 335\n+ */\n+static int secp256k1_ecdh_wnaf(int *wnaf, secp256k1_scalar_t s, int w) {\n+    int global_sign = 1;\n+    int skew = 0;\n+    int word = 0;\n+    /* 1 2 3 */\n+    int u_last;\n+    int u;\n+\n+#ifdef USE_ENDOMORPHISM\n+    /* If we are using the endomorphism, we cannot handle even numbers by negating\n+     * them, since we are working with 128-bit numbers whose negations would be 256\n+     * bits, eliminating the performance advantage. Instead we use a technique from\n+     * Section 4.2 of the Okeya/Tagaki paper, which is to add either 1 (for even)\n+     * or 2 (for odd) to the number we are encoding, then compensating after the\n+     * multiplication. */\n+    /* Negative 128-bit numbers will be negated, since otherwise they are 256-bit */\n+    int flip = secp256k1_scalar_is_high(&s);\n+    /* We add 1 to even numbers, 2 to odd ones, noting that negation flips parity */\n+    int bit = flip ^ (s.d[0] & 1);\n+    /* We check for negative one, since adding 2 to it will cause an overflow */\n+    secp256k1_scalar_t neg_s;\n+    int not_neg_one;\n+    secp256k1_scalar_negate(&neg_s, &s);\n+    not_neg_one = !secp256k1_scalar_is_one(&neg_s);\n+    secp256k1_scalar_cadd_bit(&s, bit, not_neg_one);\n+    /* If we had negative one, flip == 1, s.d[0] == 0, bit == 1, so caller expects\n+     * that we added two to it and flipped it. In fact for -1 these operations are\n+     * identical. We only flipped, but since skewing is required (in the sense that\n+     * the skew must be 1 or 2, never zero) and flipping is not, we need to change\n+     * our flags to claim that we only skewed. */\n+    global_sign = secp256k1_scalar_cond_negate(&s, flip);\n+    global_sign *= not_neg_one * 2 - 1;\n+    skew = 1 << bit;\n+#else\n+    /* Otherwise, we just negate to force oddness */\n+    int is_even = secp256k1_scalar_is_even(&s);\n+    global_sign = secp256k1_scalar_cond_negate(&s, is_even);\n+#endif\n+\n+    /* 4 */\n+    u_last = secp256k1_scalar_shr_int(&s, w);\n+    while (word * w < WNAF_BITS) {\n+        int sign;\n+        int even;\n+\n+        /* 4.1 4.4 */\n+        u = secp256k1_scalar_shr_int(&s, w);\n+        /* 4.2 */\n+        even = ((u & 1) == 0);\n+        sign = 2 * (u_last > 0) - 1;\n+        u += sign * even;\n+        u_last -= sign * even * (1 << w);\n+\n+        /* 4.3, adapted for global sign change */\n+        wnaf[word++] = u_last * global_sign;\n+\n+        u_last = u;\n+    }\n+    wnaf[word] = u * global_sign;\n+\n+    VERIFY_CHECK(secp256k1_scalar_is_zero(&s));\n+    VERIFY_CHECK(word == WNAF_SIZE(w));\n+    return skew;\n+}\n+\n+\n+static void secp256k1_point_multiply(secp256k1_gej_t *r, const secp256k1_ge_t *a, const secp256k1_scalar_t *scalar) {\n+    secp256k1_ge_t pre_a[ECMULT_TABLE_SIZE(WINDOW_A)];\n+    secp256k1_ge_t tmpa;\n+    secp256k1_fe_t Z;\n+\n+#ifdef USE_ENDOMORPHISM\n+    secp256k1_ge_t pre_a_lam[ECMULT_TABLE_SIZE(WINDOW_A)];\n+    int wnaf_1[1 + WNAF_SIZE(WINDOW_A - 1)];\n+    int wnaf_lam[1 + WNAF_SIZE(WINDOW_A - 1)];\n+    int skew_1;\n+    int skew_lam;\n+    secp256k1_scalar_t q_1, q_lam;\n+#else\n+    int wnaf[1 + WNAF_SIZE(WINDOW_A - 1)];\n+#endif\n+\n+    int i;\n+    secp256k1_scalar_t sc = *scalar;\n+\n+    /* build wnaf representation for q. */\n+#ifdef USE_ENDOMORPHISM\n+    /* split q into q_1 and q_lam (where q = q_1 + q_lam*lambda, and q_1 and q_lam are ~128 bit) */\n+    secp256k1_scalar_split_lambda(&q_1, &q_lam, &sc);\n+    /* no need for zero correction when using endomorphism since even\n+     * numbers have one added to them anyway */\n+    skew_1   = secp256k1_ecdh_wnaf(wnaf_1,   q_1,   WINDOW_A - 1);\n+    skew_lam = secp256k1_ecdh_wnaf(wnaf_lam, q_lam, WINDOW_A - 1);\n+#else\n+    int is_zero = secp256k1_scalar_is_zero(scalar);\n+    /* the wNAF ladder cannot handle zero, so bump this to one .. we will\n+     * correct the result after the fact */\n+    sc.d[0] += is_zero;\n+    VERIFY_CHECK(!secp256k1_scalar_is_zero(&sc));\n+\n+    secp256k1_ecdh_wnaf(wnaf, sc, WINDOW_A - 1);\n+#endif\n+\n+    /* Calculate odd multiples of a.\n+     * All multiples are brought to the same Z 'denominator', which is stored\n+     * in Z. Due to secp256k1' isomorphism we can do all operations pretending\n+     * that the Z coordinate was 1, use affine addition formulae, and correct\n+     * the Z coordinate of the result once at the end.\n+     */\n+    secp256k1_gej_set_ge(r, a);\n+    secp256k1_ecmult_odd_multiples_table_globalz_windowa(pre_a, &Z, r);\n+#ifdef USE_ENDOMORPHISM\n+    for (i = 0; i < ECMULT_TABLE_SIZE(WINDOW_A); i++) {\n+        secp256k1_ge_mul_lambda(&pre_a_lam[i], &pre_a[i]);\n+    }\n+#endif\n+    secp256k1_gej_set_infinity(r);\n+\n+    for (i = WNAF_SIZE(WINDOW_A - 1); i >= 0; i--) {\n+        int n;\n+        int j;\n+        for (j = 0; j < WINDOW_A - 1; ++j) {\n+            /* This is a variable-time doubling, but it is actually constant-time for\n+             * nonzero points. We know on the first iteration that `r` will be zero\n+             * and know (by uniqueness of wNAF) that `r` will never be zero after\n+             * that iteration, so this does not result in a timing leak. */\n+            secp256k1_gej_double_var(r, r, NULL);\n+        }\n+#ifdef USE_ENDOMORPHISM\n+        n = wnaf_1[i];\n+        ECMULT_TABLE_GET_GE(&tmpa, pre_a, n, WINDOW_A);\n+        VERIFY_CHECK(n != 0);\n+        secp256k1_gej_add_ge(r, r, &tmpa);\n+\n+        n = wnaf_lam[i];\n+        ECMULT_TABLE_GET_GE(&tmpa, pre_a_lam, n, WINDOW_A);\n+        VERIFY_CHECK(n != 0);\n+        secp256k1_gej_add_ge(r, r, &tmpa);\n+#else\n+        n = wnaf[i];\n+        VERIFY_CHECK(n != 0);\n+        ECMULT_TABLE_GET_GE(&tmpa, pre_a, n, WINDOW_A);",
      "path": "src/ecdh_impl.h",
      "position": null,
      "original_position": 175,
      "commit_id": "72ae443afb536221a8523646ea4a88162341c3df",
      "original_commit_id": "0436dfcf62f5f47c3b8dacd49fba8de436f56030",
      "in_reply_to_id": null,
      "user": {
        "login": "peterdettman",
        "id": 3423981,
        "node_id": "MDQ6VXNlcjM0MjM5ODE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3423981?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/peterdettman",
        "html_url": "https://github.com/peterdettman",
        "followers_url": "https://api.github.com/users/peterdettman/followers",
        "following_url": "https://api.github.com/users/peterdettman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/peterdettman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/peterdettman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/peterdettman/subscriptions",
        "organizations_url": "https://api.github.com/users/peterdettman/orgs",
        "repos_url": "https://api.github.com/users/peterdettman/repos",
        "events_url": "https://api.github.com/users/peterdettman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/peterdettman/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "_GET_GE is a simple table lookup, with the index derived from bits of the scalar, so we'll need a _cmov-based alternative.\n",
      "created_at": "2015-07-09T10:23:06Z",
      "updated_at": "2015-08-01T15:57:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#discussion_r34241954",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/34241954"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/252"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/34247966",
      "pull_request_review_id": null,
      "id": 34247966,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0MjQ3OTY2",
      "diff_hunk": "@@ -0,0 +1,219 @@\n+/**********************************************************************\n+ * Copyright (c) 2015 Pieter Wuille, Andrew Poelstra                  *\n+ * Distributed under the MIT software license, see the accompanying   *\n+ * file COPYING or http://www.opensource.org/licenses/mit-license.php.*\n+ **********************************************************************/\n+\n+#ifndef _SECP256K1_ECDH_IMPL_\n+#define _SECP256K1_ECDH_IMPL_\n+\n+#include \"scalar.h\"\n+#include \"group.h\"\n+#include \"ecdh.h\"\n+#include \"ecmult_impl.h\"\n+\n+#ifdef USE_ENDOMORPHISM\n+    #define WNAF_BITS 128\n+#else\n+    #define WNAF_BITS 256\n+#endif\n+#define WNAF_SIZE(w) ((WNAF_BITS + (w) - 1) / (w))\n+\n+/** Convert a number to WNAF notation. The number becomes represented by sum(2^{wi} * wnaf[i], i=0..return_val)\n+ *  with the following guarantees:\n+ *  - each wnaf[i] an odd integer between -(1 << w) and (1 << w)\n+ *  - each wnaf[i] is nonzero\n+ *  - the number of words set is returned; this is always (256 + w - 1) / w\n+ *\n+ *  Adapted from `The Width-w NAF Method Provides Small Memory and Fast Elliptic Scalar\n+ *  Multiplications Secure against Side Channel Attacks`, Okeya and Tagaki. M. Joye (Ed.)\n+ *  CT-RSA 2003, LNCS 2612, pp. 328-443, 2003. Springer-Verlagy Berlin Heidelberg 2003\n+ *\n+ *  Numbers reference steps of `Algorithm SPA-resistant Width-w NAF with Odd Scalar` on pp. 335\n+ */\n+static int secp256k1_ecdh_wnaf(int *wnaf, secp256k1_scalar_t s, int w) {\n+    int global_sign = 1;\n+    int skew = 0;\n+    int word = 0;\n+    /* 1 2 3 */\n+    int u_last;\n+    int u;\n+\n+#ifdef USE_ENDOMORPHISM\n+    /* If we are using the endomorphism, we cannot handle even numbers by negating\n+     * them, since we are working with 128-bit numbers whose negations would be 256\n+     * bits, eliminating the performance advantage. Instead we use a technique from\n+     * Section 4.2 of the Okeya/Tagaki paper, which is to add either 1 (for even)\n+     * or 2 (for odd) to the number we are encoding, then compensating after the\n+     * multiplication. */\n+    /* Negative 128-bit numbers will be negated, since otherwise they are 256-bit */\n+    int flip = secp256k1_scalar_is_high(&s);\n+    /* We add 1 to even numbers, 2 to odd ones, noting that negation flips parity */\n+    int bit = flip ^ (s.d[0] & 1);\n+    /* We check for negative one, since adding 2 to it will cause an overflow */\n+    secp256k1_scalar_t neg_s;\n+    int not_neg_one;\n+    secp256k1_scalar_negate(&neg_s, &s);\n+    not_neg_one = !secp256k1_scalar_is_one(&neg_s);\n+    secp256k1_scalar_cadd_bit(&s, bit, not_neg_one);\n+    /* If we had negative one, flip == 1, s.d[0] == 0, bit == 1, so caller expects\n+     * that we added two to it and flipped it. In fact for -1 these operations are\n+     * identical. We only flipped, but since skewing is required (in the sense that\n+     * the skew must be 1 or 2, never zero) and flipping is not, we need to change\n+     * our flags to claim that we only skewed. */\n+    global_sign = secp256k1_scalar_cond_negate(&s, flip);\n+    global_sign *= not_neg_one * 2 - 1;\n+    skew = 1 << bit;\n+#else\n+    /* Otherwise, we just negate to force oddness */\n+    int is_even = secp256k1_scalar_is_even(&s);\n+    global_sign = secp256k1_scalar_cond_negate(&s, is_even);\n+#endif\n+\n+    /* 4 */\n+    u_last = secp256k1_scalar_shr_int(&s, w);\n+    while (word * w < WNAF_BITS) {\n+        int sign;\n+        int even;\n+\n+        /* 4.1 4.4 */\n+        u = secp256k1_scalar_shr_int(&s, w);\n+        /* 4.2 */\n+        even = ((u & 1) == 0);\n+        sign = 2 * (u_last > 0) - 1;\n+        u += sign * even;\n+        u_last -= sign * even * (1 << w);\n+\n+        /* 4.3, adapted for global sign change */\n+        wnaf[word++] = u_last * global_sign;\n+\n+        u_last = u;\n+    }\n+    wnaf[word] = u * global_sign;\n+\n+    VERIFY_CHECK(secp256k1_scalar_is_zero(&s));\n+    VERIFY_CHECK(word == WNAF_SIZE(w));\n+    return skew;\n+}\n+\n+\n+static void secp256k1_point_multiply(secp256k1_gej_t *r, const secp256k1_ge_t *a, const secp256k1_scalar_t *scalar) {\n+    secp256k1_ge_t pre_a[ECMULT_TABLE_SIZE(WINDOW_A)];\n+    secp256k1_ge_t tmpa;\n+    secp256k1_fe_t Z;\n+\n+#ifdef USE_ENDOMORPHISM\n+    secp256k1_ge_t pre_a_lam[ECMULT_TABLE_SIZE(WINDOW_A)];\n+    int wnaf_1[1 + WNAF_SIZE(WINDOW_A - 1)];\n+    int wnaf_lam[1 + WNAF_SIZE(WINDOW_A - 1)];\n+    int skew_1;\n+    int skew_lam;\n+    secp256k1_scalar_t q_1, q_lam;\n+#else\n+    int wnaf[1 + WNAF_SIZE(WINDOW_A - 1)];\n+#endif\n+\n+    int i;\n+    secp256k1_scalar_t sc = *scalar;\n+\n+    /* build wnaf representation for q. */\n+#ifdef USE_ENDOMORPHISM\n+    /* split q into q_1 and q_lam (where q = q_1 + q_lam*lambda, and q_1 and q_lam are ~128 bit) */\n+    secp256k1_scalar_split_lambda(&q_1, &q_lam, &sc);\n+    /* no need for zero correction when using endomorphism since even\n+     * numbers have one added to them anyway */\n+    skew_1   = secp256k1_ecdh_wnaf(wnaf_1,   q_1,   WINDOW_A - 1);\n+    skew_lam = secp256k1_ecdh_wnaf(wnaf_lam, q_lam, WINDOW_A - 1);\n+#else\n+    int is_zero = secp256k1_scalar_is_zero(scalar);\n+    /* the wNAF ladder cannot handle zero, so bump this to one .. we will\n+     * correct the result after the fact */\n+    sc.d[0] += is_zero;\n+    VERIFY_CHECK(!secp256k1_scalar_is_zero(&sc));\n+\n+    secp256k1_ecdh_wnaf(wnaf, sc, WINDOW_A - 1);\n+#endif\n+\n+    /* Calculate odd multiples of a.\n+     * All multiples are brought to the same Z 'denominator', which is stored\n+     * in Z. Due to secp256k1' isomorphism we can do all operations pretending\n+     * that the Z coordinate was 1, use affine addition formulae, and correct\n+     * the Z coordinate of the result once at the end.\n+     */\n+    secp256k1_gej_set_ge(r, a);\n+    secp256k1_ecmult_odd_multiples_table_globalz_windowa(pre_a, &Z, r);\n+#ifdef USE_ENDOMORPHISM\n+    for (i = 0; i < ECMULT_TABLE_SIZE(WINDOW_A); i++) {\n+        secp256k1_ge_mul_lambda(&pre_a_lam[i], &pre_a[i]);\n+    }\n+#endif\n+    secp256k1_gej_set_infinity(r);\n+\n+    for (i = WNAF_SIZE(WINDOW_A - 1); i >= 0; i--) {\n+        int n;\n+        int j;\n+        for (j = 0; j < WINDOW_A - 1; ++j) {\n+            /* This is a variable-time doubling, but it is actually constant-time for\n+             * nonzero points. We know on the first iteration that `r` will be zero\n+             * and know (by uniqueness of wNAF) that `r` will never be zero after\n+             * that iteration, so this does not result in a timing leak. */\n+            secp256k1_gej_double_var(r, r, NULL);\n+        }\n+#ifdef USE_ENDOMORPHISM\n+        n = wnaf_1[i];\n+        ECMULT_TABLE_GET_GE(&tmpa, pre_a, n, WINDOW_A);\n+        VERIFY_CHECK(n != 0);\n+        secp256k1_gej_add_ge(r, r, &tmpa);\n+\n+        n = wnaf_lam[i];\n+        ECMULT_TABLE_GET_GE(&tmpa, pre_a_lam, n, WINDOW_A);\n+        VERIFY_CHECK(n != 0);\n+        secp256k1_gej_add_ge(r, r, &tmpa);\n+#else\n+        n = wnaf[i];\n+        VERIFY_CHECK(n != 0);\n+        ECMULT_TABLE_GET_GE(&tmpa, pre_a, n, WINDOW_A);\n+        secp256k1_gej_add_ge(r, r, &tmpa);\n+#endif\n+    }\n+\n+    if (!r->infinity) {\n+        secp256k1_fe_mul(&r->z, &r->z, &Z);\n+    }",
      "path": "src/ecdh_impl.h",
      "position": null,
      "original_position": 182,
      "commit_id": "72ae443afb536221a8523646ea4a88162341c3df",
      "original_commit_id": "0436dfcf62f5f47c3b8dacd49fba8de436f56030",
      "in_reply_to_id": null,
      "user": {
        "login": "peterdettman",
        "id": 3423981,
        "node_id": "MDQ6VXNlcjM0MjM5ODE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3423981?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/peterdettman",
        "html_url": "https://github.com/peterdettman",
        "followers_url": "https://api.github.com/users/peterdettman/followers",
        "following_url": "https://api.github.com/users/peterdettman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/peterdettman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/peterdettman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/peterdettman/subscriptions",
        "organizations_url": "https://api.github.com/users/peterdettman/orgs",
        "repos_url": "https://api.github.com/users/peterdettman/repos",
        "events_url": "https://api.github.com/users/peterdettman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/peterdettman/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Just perform the _fe_mul unconditionally?\n",
      "created_at": "2015-07-09T12:06:32Z",
      "updated_at": "2015-08-01T15:57:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#discussion_r34247966",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/34247966"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/252"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/34255418",
      "pull_request_review_id": null,
      "id": 34255418,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0MjU1NDE4",
      "diff_hunk": "@@ -0,0 +1,219 @@\n+/**********************************************************************\n+ * Copyright (c) 2015 Pieter Wuille, Andrew Poelstra                  *\n+ * Distributed under the MIT software license, see the accompanying   *\n+ * file COPYING or http://www.opensource.org/licenses/mit-license.php.*\n+ **********************************************************************/\n+\n+#ifndef _SECP256K1_ECDH_IMPL_\n+#define _SECP256K1_ECDH_IMPL_\n+\n+#include \"scalar.h\"\n+#include \"group.h\"\n+#include \"ecdh.h\"\n+#include \"ecmult_impl.h\"\n+\n+#ifdef USE_ENDOMORPHISM\n+    #define WNAF_BITS 128\n+#else\n+    #define WNAF_BITS 256\n+#endif\n+#define WNAF_SIZE(w) ((WNAF_BITS + (w) - 1) / (w))\n+\n+/** Convert a number to WNAF notation. The number becomes represented by sum(2^{wi} * wnaf[i], i=0..return_val)\n+ *  with the following guarantees:\n+ *  - each wnaf[i] an odd integer between -(1 << w) and (1 << w)\n+ *  - each wnaf[i] is nonzero\n+ *  - the number of words set is returned; this is always (256 + w - 1) / w\n+ *\n+ *  Adapted from `The Width-w NAF Method Provides Small Memory and Fast Elliptic Scalar\n+ *  Multiplications Secure against Side Channel Attacks`, Okeya and Tagaki. M. Joye (Ed.)\n+ *  CT-RSA 2003, LNCS 2612, pp. 328-443, 2003. Springer-Verlagy Berlin Heidelberg 2003\n+ *\n+ *  Numbers reference steps of `Algorithm SPA-resistant Width-w NAF with Odd Scalar` on pp. 335\n+ */\n+static int secp256k1_ecdh_wnaf(int *wnaf, secp256k1_scalar_t s, int w) {\n+    int global_sign = 1;\n+    int skew = 0;\n+    int word = 0;\n+    /* 1 2 3 */\n+    int u_last;\n+    int u;\n+\n+#ifdef USE_ENDOMORPHISM\n+    /* If we are using the endomorphism, we cannot handle even numbers by negating\n+     * them, since we are working with 128-bit numbers whose negations would be 256\n+     * bits, eliminating the performance advantage. Instead we use a technique from\n+     * Section 4.2 of the Okeya/Tagaki paper, which is to add either 1 (for even)\n+     * or 2 (for odd) to the number we are encoding, then compensating after the\n+     * multiplication. */\n+    /* Negative 128-bit numbers will be negated, since otherwise they are 256-bit */\n+    int flip = secp256k1_scalar_is_high(&s);\n+    /* We add 1 to even numbers, 2 to odd ones, noting that negation flips parity */\n+    int bit = flip ^ (s.d[0] & 1);\n+    /* We check for negative one, since adding 2 to it will cause an overflow */\n+    secp256k1_scalar_t neg_s;\n+    int not_neg_one;\n+    secp256k1_scalar_negate(&neg_s, &s);\n+    not_neg_one = !secp256k1_scalar_is_one(&neg_s);\n+    secp256k1_scalar_cadd_bit(&s, bit, not_neg_one);\n+    /* If we had negative one, flip == 1, s.d[0] == 0, bit == 1, so caller expects\n+     * that we added two to it and flipped it. In fact for -1 these operations are\n+     * identical. We only flipped, but since skewing is required (in the sense that\n+     * the skew must be 1 or 2, never zero) and flipping is not, we need to change\n+     * our flags to claim that we only skewed. */\n+    global_sign = secp256k1_scalar_cond_negate(&s, flip);\n+    global_sign *= not_neg_one * 2 - 1;\n+    skew = 1 << bit;\n+#else\n+    /* Otherwise, we just negate to force oddness */\n+    int is_even = secp256k1_scalar_is_even(&s);\n+    global_sign = secp256k1_scalar_cond_negate(&s, is_even);\n+#endif\n+\n+    /* 4 */\n+    u_last = secp256k1_scalar_shr_int(&s, w);\n+    while (word * w < WNAF_BITS) {\n+        int sign;\n+        int even;\n+\n+        /* 4.1 4.4 */\n+        u = secp256k1_scalar_shr_int(&s, w);\n+        /* 4.2 */\n+        even = ((u & 1) == 0);\n+        sign = 2 * (u_last > 0) - 1;\n+        u += sign * even;\n+        u_last -= sign * even * (1 << w);\n+\n+        /* 4.3, adapted for global sign change */\n+        wnaf[word++] = u_last * global_sign;\n+\n+        u_last = u;\n+    }\n+    wnaf[word] = u * global_sign;\n+\n+    VERIFY_CHECK(secp256k1_scalar_is_zero(&s));\n+    VERIFY_CHECK(word == WNAF_SIZE(w));\n+    return skew;\n+}\n+\n+\n+static void secp256k1_point_multiply(secp256k1_gej_t *r, const secp256k1_ge_t *a, const secp256k1_scalar_t *scalar) {\n+    secp256k1_ge_t pre_a[ECMULT_TABLE_SIZE(WINDOW_A)];\n+    secp256k1_ge_t tmpa;\n+    secp256k1_fe_t Z;\n+\n+#ifdef USE_ENDOMORPHISM\n+    secp256k1_ge_t pre_a_lam[ECMULT_TABLE_SIZE(WINDOW_A)];\n+    int wnaf_1[1 + WNAF_SIZE(WINDOW_A - 1)];\n+    int wnaf_lam[1 + WNAF_SIZE(WINDOW_A - 1)];\n+    int skew_1;\n+    int skew_lam;\n+    secp256k1_scalar_t q_1, q_lam;\n+#else\n+    int wnaf[1 + WNAF_SIZE(WINDOW_A - 1)];\n+#endif\n+\n+    int i;\n+    secp256k1_scalar_t sc = *scalar;\n+\n+    /* build wnaf representation for q. */\n+#ifdef USE_ENDOMORPHISM\n+    /* split q into q_1 and q_lam (where q = q_1 + q_lam*lambda, and q_1 and q_lam are ~128 bit) */\n+    secp256k1_scalar_split_lambda(&q_1, &q_lam, &sc);\n+    /* no need for zero correction when using endomorphism since even\n+     * numbers have one added to them anyway */\n+    skew_1   = secp256k1_ecdh_wnaf(wnaf_1,   q_1,   WINDOW_A - 1);\n+    skew_lam = secp256k1_ecdh_wnaf(wnaf_lam, q_lam, WINDOW_A - 1);\n+#else\n+    int is_zero = secp256k1_scalar_is_zero(scalar);\n+    /* the wNAF ladder cannot handle zero, so bump this to one .. we will\n+     * correct the result after the fact */\n+    sc.d[0] += is_zero;\n+    VERIFY_CHECK(!secp256k1_scalar_is_zero(&sc));\n+\n+    secp256k1_ecdh_wnaf(wnaf, sc, WINDOW_A - 1);\n+#endif\n+\n+    /* Calculate odd multiples of a.\n+     * All multiples are brought to the same Z 'denominator', which is stored\n+     * in Z. Due to secp256k1' isomorphism we can do all operations pretending\n+     * that the Z coordinate was 1, use affine addition formulae, and correct\n+     * the Z coordinate of the result once at the end.\n+     */\n+    secp256k1_gej_set_ge(r, a);\n+    secp256k1_ecmult_odd_multiples_table_globalz_windowa(pre_a, &Z, r);\n+#ifdef USE_ENDOMORPHISM\n+    for (i = 0; i < ECMULT_TABLE_SIZE(WINDOW_A); i++) {\n+        secp256k1_ge_mul_lambda(&pre_a_lam[i], &pre_a[i]);\n+    }\n+#endif\n+    secp256k1_gej_set_infinity(r);\n+\n+    for (i = WNAF_SIZE(WINDOW_A - 1); i >= 0; i--) {\n+        int n;\n+        int j;\n+        for (j = 0; j < WINDOW_A - 1; ++j) {\n+            /* This is a variable-time doubling, but it is actually constant-time for\n+             * nonzero points. We know on the first iteration that `r` will be zero\n+             * and know (by uniqueness of wNAF) that `r` will never be zero after\n+             * that iteration, so this does not result in a timing leak. */\n+            secp256k1_gej_double_var(r, r, NULL);\n+        }\n+#ifdef USE_ENDOMORPHISM\n+        n = wnaf_1[i];\n+        ECMULT_TABLE_GET_GE(&tmpa, pre_a, n, WINDOW_A);\n+        VERIFY_CHECK(n != 0);\n+        secp256k1_gej_add_ge(r, r, &tmpa);\n+\n+        n = wnaf_lam[i];\n+        ECMULT_TABLE_GET_GE(&tmpa, pre_a_lam, n, WINDOW_A);\n+        VERIFY_CHECK(n != 0);\n+        secp256k1_gej_add_ge(r, r, &tmpa);\n+#else\n+        n = wnaf[i];\n+        VERIFY_CHECK(n != 0);\n+        ECMULT_TABLE_GET_GE(&tmpa, pre_a, n, WINDOW_A);",
      "path": "src/ecdh_impl.h",
      "position": null,
      "original_position": 175,
      "commit_id": "72ae443afb536221a8523646ea4a88162341c3df",
      "original_commit_id": "0436dfcf62f5f47c3b8dacd49fba8de436f56030",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Ugh, nice catch!\n",
      "created_at": "2015-07-09T13:39:28Z",
      "updated_at": "2015-08-01T15:57:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#discussion_r34255418",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/34255418"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/252"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/35976390",
      "pull_request_review_id": null,
      "id": 35976390,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1OTc2Mzkw",
      "diff_hunk": "@@ -0,0 +1,51 @@\n+/**********************************************************************\n+ * Copyright (c) 2015 Pieter Wuille, Andrew Poelstra                  *\n+ * Distributed under the MIT software license, see the accompanying   *\n+ * file COPYING or http://www.opensource.org/licenses/mit-license.php.*\n+ **********************************************************************/\n+\n+#include <string.h>\n+\n+#include \"include/secp256k1.h\"\n+#include \"include/secp256k1_ecdh.h\"\n+#include \"util.h\"\n+#include \"bench.h\"\n+\n+typedef struct {\n+    secp256k1_context_t *ctx;\n+    secp256k1_pubkey_t point;\n+    unsigned char scalar[32];\n+} bench_multiply_t;\n+\n+static void bench_multiply_setup(void* arg) {\n+    int i;\n+    bench_multiply_t *data = (bench_multiply_t*)arg;\n+    const unsigned char point[] = {\n+        0x03,\n+        0x54, 0x94, 0xc1, 0x5d, 0x32, 0x09, 0x97, 0x06,\n+        0xc2, 0x39, 0x5f, 0x94, 0x34, 0x87, 0x45, 0xfd,\n+        0x75, 0x7c, 0xe3, 0x0e, 0x4e, 0x8c, 0x90, 0xfb,\n+        0xa2, 0xba, 0xd1, 0x84, 0xf8, 0x83, 0xc6, 0x9f\n+    };\n+\n+    data->ctx = secp256k1_context_create(0);\n+    for (i = 0; i < 32; i++) data->scalar[i] = i + 1;\n+    CHECK(secp256k1_ec_pubkey_parse(data->ctx, &data->point, point, sizeof(point)) == 1);\n+}\n+\n+static void bench_multiply(void* arg) {\n+    int i;\n+    unsigned char res[32];\n+    bench_multiply_t *data = (bench_multiply_t*)arg;\n+\n+    for (i = 0; i < 20000; i++) {\n+        CHECK(secp256k1_ecdh(data->ctx, res, &data->point, data->scalar) == 1);\n+    }\n+}\n+\n+int main(void) {\n+    bench_multiply_t data;\n+\n+    run_benchmark(\"ecdh_mult\", bench_multiply, bench_multiply_setup, NULL, &data, 10, 20000);",
      "path": "src/bench_ecdh.c",
      "position": null,
      "original_position": 49,
      "commit_id": "72ae443afb536221a8523646ea4a88162341c3df",
      "original_commit_id": "e0e79874d2fb3f1ccc987e893338daef20483db9",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Technically, ECDH is no longer just a multiplication.\n",
      "created_at": "2015-07-31T14:09:19Z",
      "updated_at": "2015-08-01T15:57:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#discussion_r35976390",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/35976390"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/252"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/35976567",
      "pull_request_review_id": null,
      "id": 35976567,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1OTc2NTY3",
      "diff_hunk": "@@ -0,0 +1,242 @@\n+/**********************************************************************\n+ * Copyright (c) 2015 Pieter Wuille, Andrew Poelstra                  *\n+ * Distributed under the MIT software license, see the accompanying   *\n+ * file COPYING or http://www.opensource.org/licenses/mit-license.php.*\n+ **********************************************************************/\n+\n+#ifndef _SECP256K1_ECMULT_CONST_IMPL_\n+#define _SECP256K1_ECMULT_CONST_IMPL_\n+\n+#include \"scalar.h\"\n+#include \"group.h\"\n+#include \"ecmult_const.h\"\n+#include \"ecmult_impl.h\"\n+\n+#ifdef USE_ENDOMORPHISM\n+    #define WNAF_BITS 128\n+#else\n+    #define WNAF_BITS 256\n+#endif\n+#define WNAF_SIZE(w) ((WNAF_BITS + (w) - 1) / (w))\n+\n+/* This is like `ECMULT_TABLE_GET_GE` but is constant time */\n+#define ECDH_TABLE_GET_GE(r,pre,n,w) do { \\\n+    int m; \\\n+    int abs_n = (n) * (((n) > 0) * 2 - 1); \\\n+    int idx_n = abs_n / 2; \\\n+    secp256k1_fe_t neg_y; \\\n+    VERIFY_CHECK(((n) & 1) == 1); \\\n+    VERIFY_CHECK((n) >= -((1 << ((w)-1)) - 1)); \\\n+    VERIFY_CHECK((n) <=  ((1 << ((w)-1)) - 1)); \\\n+    VERIFY_SETUP(secp256k1_fe_clear(&(r)->x)); \\\n+    VERIFY_SETUP(secp256k1_fe_clear(&(r)->y)); \\\n+    for (m = 0; m < ECMULT_TABLE_SIZE(w); m++) { \\\n+        /* This loop is used to avoid secret data in array indices. See\n+         * the comment in ecmult_gen_impl.h for rationale. */ \\\n+        secp256k1_fe_cmov(&(r)->x, &(pre)[m].x, m == idx_n); \\\n+        secp256k1_fe_cmov(&(r)->y, &(pre)[m].y, m == idx_n); \\\n+    } \\\n+    (r)->infinity = 0; \\\n+    secp256k1_fe_negate(&neg_y, &(r)->y, 1); \\\n+    secp256k1_fe_cmov(&(r)->y, &neg_y, (n) != abs_n); \\\n+} while(0)\n+\n+/** Convert a number to WNAF notation. The number becomes represented by sum(2^{wi} * wnaf[i], i=0..return_val)\n+ *  with the following guarantees:\n+ *  - each wnaf[i] an odd integer between -(1 << w) and (1 << w)\n+ *  - each wnaf[i] is nonzero\n+ *  - the number of words set is returned; this is always (256 + w - 1) / w",
      "path": "src/ecmult_const_impl.h",
      "position": null,
      "original_position": 48,
      "commit_id": "72ae443afb536221a8523646ea4a88162341c3df",
      "original_commit_id": "e0e79874d2fb3f1ccc987e893338daef20483db9",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Is this true, even with USE_ENDOMORPHISM?\n",
      "created_at": "2015-07-31T14:11:17Z",
      "updated_at": "2015-08-01T15:57:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#discussion_r35976567",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/35976567"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/252"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/35977327",
      "pull_request_review_id": null,
      "id": 35977327,
      "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1OTc3MzI3",
      "diff_hunk": "@@ -0,0 +1,242 @@\n+/**********************************************************************\n+ * Copyright (c) 2015 Pieter Wuille, Andrew Poelstra                  *\n+ * Distributed under the MIT software license, see the accompanying   *\n+ * file COPYING or http://www.opensource.org/licenses/mit-license.php.*\n+ **********************************************************************/\n+\n+#ifndef _SECP256K1_ECMULT_CONST_IMPL_\n+#define _SECP256K1_ECMULT_CONST_IMPL_\n+\n+#include \"scalar.h\"\n+#include \"group.h\"\n+#include \"ecmult_const.h\"\n+#include \"ecmult_impl.h\"\n+\n+#ifdef USE_ENDOMORPHISM\n+    #define WNAF_BITS 128\n+#else\n+    #define WNAF_BITS 256\n+#endif\n+#define WNAF_SIZE(w) ((WNAF_BITS + (w) - 1) / (w))\n+\n+/* This is like `ECMULT_TABLE_GET_GE` but is constant time */\n+#define ECDH_TABLE_GET_GE(r,pre,n,w) do { \\\n+    int m; \\\n+    int abs_n = (n) * (((n) > 0) * 2 - 1); \\\n+    int idx_n = abs_n / 2; \\\n+    secp256k1_fe_t neg_y; \\\n+    VERIFY_CHECK(((n) & 1) == 1); \\\n+    VERIFY_CHECK((n) >= -((1 << ((w)-1)) - 1)); \\\n+    VERIFY_CHECK((n) <=  ((1 << ((w)-1)) - 1)); \\\n+    VERIFY_SETUP(secp256k1_fe_clear(&(r)->x)); \\\n+    VERIFY_SETUP(secp256k1_fe_clear(&(r)->y)); \\\n+    for (m = 0; m < ECMULT_TABLE_SIZE(w); m++) { \\\n+        /* This loop is used to avoid secret data in array indices. See\n+         * the comment in ecmult_gen_impl.h for rationale. */ \\\n+        secp256k1_fe_cmov(&(r)->x, &(pre)[m].x, m == idx_n); \\\n+        secp256k1_fe_cmov(&(r)->y, &(pre)[m].y, m == idx_n); \\\n+    } \\\n+    (r)->infinity = 0; \\\n+    secp256k1_fe_negate(&neg_y, &(r)->y, 1); \\\n+    secp256k1_fe_cmov(&(r)->y, &neg_y, (n) != abs_n); \\\n+} while(0)\n+\n+/** Convert a number to WNAF notation. The number becomes represented by sum(2^{wi} * wnaf[i], i=0..return_val)\n+ *  with the following guarantees:\n+ *  - each wnaf[i] an odd integer between -(1 << w) and (1 << w)\n+ *  - each wnaf[i] is nonzero\n+ *  - the number of words set is returned; this is always (256 + w - 1) / w\n+ *\n+ *  Adapted from `The Width-w NAF Method Provides Small Memory and Fast Elliptic Scalar\n+ *  Multiplications Secure against Side Channel Attacks`, Okeya and Tagaki. M. Joye (Ed.)\n+ *  CT-RSA 2003, LNCS 2612, pp. 328-443, 2003. Springer-Verlagy Berlin Heidelberg 2003\n+ *\n+ *  Numbers reference steps of `Algorithm SPA-resistant Width-w NAF with Odd Scalar` on pp. 335\n+ */\n+static int secp256k1_wnaf_const(int *wnaf, secp256k1_scalar_t s, int w) {\n+    int global_sign = 1;\n+    int skew = 0;\n+    int word = 0;\n+    /* 1 2 3 */\n+    int u_last;\n+    int u;\n+\n+#ifdef USE_ENDOMORPHISM\n+    /* If we are using the endomorphism, we cannot handle even numbers by negating\n+     * them, since we are working with 128-bit numbers whose negations would be 256\n+     * bits, eliminating the performance advantage. Instead we use a technique from\n+     * Section 4.2 of the Okeya/Tagaki paper, which is to add either 1 (for even)\n+     * or 2 (for odd) to the number we are encoding, then compensating after the\n+     * multiplication. */\n+    /* Negative 128-bit numbers will be negated, since otherwise they are 256-bit */\n+    int flip = secp256k1_scalar_is_high(&s);\n+    /* We add 1 to even numbers, 2 to odd ones, noting that negation flips parity */\n+    int bit = flip ^ (s.d[0] & 1);\n+    /* We check for negative one, since adding 2 to it will cause an overflow */\n+    secp256k1_scalar_t neg_s;\n+    int not_neg_one;\n+    secp256k1_scalar_negate(&neg_s, &s);\n+    not_neg_one = !secp256k1_scalar_is_one(&neg_s);\n+    secp256k1_scalar_cadd_bit(&s, bit, not_neg_one);\n+    /* If we had negative one, flip == 1, s.d[0] == 0, bit == 1, so caller expects\n+     * that we added two to it and flipped it. In fact for -1 these operations are\n+     * identical. We only flipped, but since skewing is required (in the sense that\n+     * the skew must be 1 or 2, never zero) and flipping is not, we need to change\n+     * our flags to claim that we only skewed. */\n+    global_sign = secp256k1_scalar_cond_negate(&s, flip);\n+    global_sign *= not_neg_one * 2 - 1;\n+    skew = 1 << bit;\n+#else\n+    /* Otherwise, we just negate to force oddness */\n+    int is_even = secp256k1_scalar_is_even(&s);\n+    global_sign = secp256k1_scalar_cond_negate(&s, is_even);\n+#endif\n+\n+    /* 4 */\n+    u_last = secp256k1_scalar_shr_int(&s, w);\n+    while (word * w < WNAF_BITS) {\n+        int sign;\n+        int even;\n+\n+        /* 4.1 4.4 */\n+        u = secp256k1_scalar_shr_int(&s, w);\n+        /* 4.2 */\n+        even = ((u & 1) == 0);\n+        sign = 2 * (u_last > 0) - 1;\n+        u += sign * even;\n+        u_last -= sign * even * (1 << w);\n+\n+        /* 4.3, adapted for global sign change */\n+        wnaf[word++] = u_last * global_sign;\n+\n+        u_last = u;\n+    }\n+    wnaf[word] = u * global_sign;\n+\n+    VERIFY_CHECK(secp256k1_scalar_is_zero(&s));\n+    VERIFY_CHECK(word == WNAF_SIZE(w));\n+    return skew;\n+}\n+\n+\n+static void secp256k1_ecmult_const(secp256k1_gej_t *r, const secp256k1_ge_t *a, const secp256k1_scalar_t *scalar) {\n+    secp256k1_ge_t pre_a[ECMULT_TABLE_SIZE(WINDOW_A)];\n+    secp256k1_ge_t tmpa;\n+    secp256k1_fe_t Z;\n+\n+#ifdef USE_ENDOMORPHISM\n+    secp256k1_ge_t pre_a_lam[ECMULT_TABLE_SIZE(WINDOW_A)];\n+    int wnaf_1[1 + WNAF_SIZE(WINDOW_A - 1)];\n+    int wnaf_lam[1 + WNAF_SIZE(WINDOW_A - 1)];\n+    int skew_1;\n+    int skew_lam;\n+    secp256k1_scalar_t q_1, q_lam;\n+#else\n+    int wnaf[1 + WNAF_SIZE(WINDOW_A - 1)];\n+#endif\n+\n+    int i;\n+    secp256k1_scalar_t sc = *scalar;\n+\n+    /* build wnaf representation for q. */\n+#ifdef USE_ENDOMORPHISM\n+    /* split q into q_1 and q_lam (where q = q_1 + q_lam*lambda, and q_1 and q_lam are ~128 bit) */\n+    secp256k1_scalar_split_lambda(&q_1, &q_lam, &sc);\n+    /* no need for zero correction when using endomorphism since even\n+     * numbers have one added to them anyway */\n+    skew_1   = secp256k1_wnaf_const(wnaf_1,   q_1,   WINDOW_A - 1);\n+    skew_lam = secp256k1_wnaf_const(wnaf_lam, q_lam, WINDOW_A - 1);\n+#else\n+    int is_zero = secp256k1_scalar_is_zero(scalar);\n+    /* the wNAF ladder cannot handle zero, so bump this to one .. we will\n+     * correct the result after the fact */\n+    sc.d[0] += is_zero;\n+    VERIFY_CHECK(!secp256k1_scalar_is_zero(&sc));\n+\n+    secp256k1_wnaf_const(wnaf, sc, WINDOW_A - 1);\n+#endif\n+\n+    /* Calculate odd multiples of a.\n+     * All multiples are brought to the same Z 'denominator', which is stored\n+     * in Z. Due to secp256k1' isomorphism we can do all operations pretending\n+     * that the Z coordinate was 1, use affine addition formulae, and correct\n+     * the Z coordinate of the result once at the end.\n+     */\n+    secp256k1_gej_set_ge(r, a);\n+    secp256k1_ecmult_odd_multiples_table_globalz_windowa(pre_a, &Z, r);\n+    for (i = 0; i < ECMULT_TABLE_SIZE(WINDOW_A); i++) {\n+        secp256k1_fe_normalize_weak(&pre_a[i].y);\n+    }\n+#ifdef USE_ENDOMORPHISM\n+    for (i = 0; i < ECMULT_TABLE_SIZE(WINDOW_A); i++) {\n+        secp256k1_ge_mul_lambda(&pre_a_lam[i], &pre_a[i]);\n+    }\n+#endif\n+    secp256k1_gej_set_infinity(r);\n+\n+    for (i = WNAF_SIZE(WINDOW_A - 1); i >= 0; i--) {\n+        int n;\n+        int j;\n+        for (j = 0; j < WINDOW_A - 1; ++j) {\n+            /* This is a variable-time doubling, but it is actually constant-time for\n+             * nonzero points. We know on the first iteration that `r` will be zero\n+             * and know (by uniqueness of wNAF) that `r` will never be zero after\n+             * that iteration, so this does not result in a timing leak. */\n+            secp256k1_gej_double_var(r, r, NULL);",
      "path": "src/ecmult_const_impl.h",
      "position": null,
      "original_position": 185,
      "commit_id": "72ae443afb536221a8523646ea4a88162341c3df",
      "original_commit_id": "e0e79874d2fb3f1ccc987e893338daef20483db9",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Would you mind adding a secp256k1_gej_double_nonzero, which just VERIFY_CHECK's for nonzeroness, and dispatches to secp256k1_gej_double_var? Placing the assumption about algorithm internals in a higher level is a bit ugly.\n",
      "created_at": "2015-07-31T14:19:12Z",
      "updated_at": "2015-08-01T15:57:47Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/252#discussion_r35977327",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/35977327"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/252"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": null,
      "side": "RIGHT"
    }
  ]
}