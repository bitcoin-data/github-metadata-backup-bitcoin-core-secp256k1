{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348",
    "id": 1394224325,
    "node_id": "PR_kwDOAP4Jqs5TGizF",
    "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348",
    "diff_url": "https://github.com/bitcoin-core/secp256k1/pull/1348.diff",
    "patch_url": "https://github.com/bitcoin-core/secp256k1/pull/1348.patch",
    "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1348",
    "commits_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1348/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin-core/secp256k1/statuses/31bc9a434811d9d2c0a8058c93957c365b39089b",
    "number": 1348,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "tighten group magnitude limits, save normalize_weak calls in group add methods (revival of #1032)",
    "user": {
      "login": "theStack",
      "id": 91535,
      "node_id": "MDQ6VXNlcjkxNTM1",
      "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theStack",
      "html_url": "https://github.com/theStack",
      "followers_url": "https://api.github.com/users/theStack/followers",
      "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
      "organizations_url": "https://api.github.com/users/theStack/orgs",
      "repos_url": "https://api.github.com/users/theStack/repos",
      "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/theStack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This PR picks up #1032 by peterdettman. It's essentially a rebase on master; the original first commit (09dbba561fdb9d57a2cc9842ce041d9ba29a6189) which introduced group verification methods has mostly been replaced by PR #1299 (commit f20266722ac93ca66d1beb0d2f2d2469b95aafea) and what remains now is only adding a few missing checks at some places. The remaining commits are unchanged, though some (easy-to-solve) conflicts appeared through cherry-picking. The last commit which actually removes the `normalize_weak` calls is obviously the critical one and needs the most attention for review.",
    "labels": [
      {
        "id": 165017692,
        "node_id": "MDU6TGFiZWwxNjUwMTc2OTI=",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/labels/assurance",
        "name": "assurance",
        "description": "",
        "color": "A6DF3D",
        "default": false
      },
      {
        "id": 4975389731,
        "node_id": "LA_kwDOAP4Jqs8AAAABKI5sIw",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/labels/performance",
        "name": "performance",
        "description": "",
        "color": "DE3CCC",
        "default": false
      }
    ],
    "created_at": "2023-06-15T14:12:49Z",
    "updated_at": "2023-07-31T12:36:59Z",
    "mergeable": true,
    "mergeable_state": "clean",
    "merge_commit_sha": "5ef7b23e508599ad4261050803b42b552afe9d21",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "theStack:revival_of_1032",
      "ref": "revival_of_1032",
      "sha": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 452762907,
        "node_id": "R_kgDOGvydGw",
        "name": "secp256k1",
        "full_name": "theStack/secp256k1",
        "owner": {
          "login": "theStack",
          "id": 91535,
          "node_id": "MDQ6VXNlcjkxNTM1",
          "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/theStack",
          "html_url": "https://github.com/theStack",
          "followers_url": "https://api.github.com/users/theStack/followers",
          "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
          "organizations_url": "https://api.github.com/users/theStack/orgs",
          "repos_url": "https://api.github.com/users/theStack/repos",
          "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/theStack/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/theStack/secp256k1",
        "description": "Optimized C library for EC operations on curve secp256k1",
        "fork": true,
        "url": "https://api.github.com/repos/theStack/secp256k1",
        "archive_url": "https://api.github.com/repos/theStack/secp256k1/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/theStack/secp256k1/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/theStack/secp256k1/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/theStack/secp256k1/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/theStack/secp256k1/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/theStack/secp256k1/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/theStack/secp256k1/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/theStack/secp256k1/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/theStack/secp256k1/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/theStack/secp256k1/contributors",
        "deployments_url": "https://api.github.com/repos/theStack/secp256k1/deployments",
        "downloads_url": "https://api.github.com/repos/theStack/secp256k1/downloads",
        "events_url": "https://api.github.com/repos/theStack/secp256k1/events",
        "forks_url": "https://api.github.com/repos/theStack/secp256k1/forks",
        "git_commits_url": "https://api.github.com/repos/theStack/secp256k1/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/theStack/secp256k1/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/theStack/secp256k1/git/tags%7B/sha%7D",
        "git_url": "git://github.com/theStack/secp256k1.git",
        "issue_comment_url": "https://api.github.com/repos/theStack/secp256k1/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/theStack/secp256k1/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/theStack/secp256k1/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/theStack/secp256k1/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/theStack/secp256k1/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/theStack/secp256k1/languages",
        "merges_url": "https://api.github.com/repos/theStack/secp256k1/merges",
        "milestones_url": "https://api.github.com/repos/theStack/secp256k1/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/theStack/secp256k1/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/theStack/secp256k1/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/theStack/secp256k1/releases%7B/id%7D",
        "ssh_url": "git@github.com:theStack/secp256k1.git",
        "stargazers_url": "https://api.github.com/repos/theStack/secp256k1/stargazers",
        "statuses_url": "https://api.github.com/repos/theStack/secp256k1/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/theStack/secp256k1/subscribers",
        "subscription_url": "https://api.github.com/repos/theStack/secp256k1/subscription",
        "tags_url": "https://api.github.com/repos/theStack/secp256k1/tags",
        "teams_url": "https://api.github.com/repos/theStack/secp256k1/teams",
        "trees_url": "https://api.github.com/repos/theStack/secp256k1/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/theStack/secp256k1.git",
        "hooks_url": "https://api.github.com/repos/theStack/secp256k1/hooks",
        "svn_url": "https://github.com/theStack/secp256k1",
        "forks_count": 0,
        "stargazers_count": 0,
        "watchers_count": 0,
        "size": 10372,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-07-28T23:23:48Z",
        "created_at": "2022-01-27T16:42:12Z",
        "updated_at": "2022-01-22T19:24:39Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin-core:master",
      "ref": "master",
      "sha": "c545fdc374964424683d9dac31a828adedabe860",
      "user": {
        "login": "bitcoin-core",
        "id": 13464320,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEzNDY0MzIw",
        "avatar_url": "https://avatars.githubusercontent.com/u/13464320?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin-core",
        "html_url": "https://github.com/bitcoin-core",
        "followers_url": "https://api.github.com/users/bitcoin-core/followers",
        "following_url": "https://api.github.com/users/bitcoin-core/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin-core/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin-core/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin-core/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin-core/orgs",
        "repos_url": "https://api.github.com/users/bitcoin-core/repos",
        "events_url": "https://api.github.com/users/bitcoin-core/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin-core/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 16648618,
        "node_id": "MDEwOlJlcG9zaXRvcnkxNjY0ODYxOA==",
        "name": "secp256k1",
        "full_name": "bitcoin-core/secp256k1",
        "owner": {
          "login": "bitcoin-core",
          "id": 13464320,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjEzNDY0MzIw",
          "avatar_url": "https://avatars.githubusercontent.com/u/13464320?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin-core",
          "html_url": "https://github.com/bitcoin-core",
          "followers_url": "https://api.github.com/users/bitcoin-core/followers",
          "following_url": "https://api.github.com/users/bitcoin-core/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin-core/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin-core/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin-core/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin-core/orgs",
          "repos_url": "https://api.github.com/users/bitcoin-core/repos",
          "events_url": "https://api.github.com/users/bitcoin-core/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin-core/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin-core/secp256k1",
        "description": "Optimized C library for EC operations on curve secp256k1",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1",
        "archive_url": "https://api.github.com/repos/bitcoin-core/secp256k1/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin-core/secp256k1/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin-core/secp256k1/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin-core/secp256k1/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin-core/secp256k1/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin-core/secp256k1/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin-core/secp256k1/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin-core/secp256k1/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin-core/secp256k1/downloads",
        "events_url": "https://api.github.com/repos/bitcoin-core/secp256k1/events",
        "forks_url": "https://api.github.com/repos/bitcoin-core/secp256k1/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin-core/secp256k1.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin-core/secp256k1/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin-core/secp256k1/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin-core/secp256k1/languages",
        "merges_url": "https://api.github.com/repos/bitcoin-core/secp256k1/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin-core/secp256k1/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin-core/secp256k1/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin-core/secp256k1/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin-core/secp256k1.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin-core/secp256k1/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin-core/secp256k1/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin-core/secp256k1/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin-core/secp256k1/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin-core/secp256k1/tags",
        "teams_url": "https://api.github.com/repos/bitcoin-core/secp256k1/teams",
        "trees_url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin-core/secp256k1.git",
        "hooks_url": "https://api.github.com/repos/bitcoin-core/secp256k1/hooks",
        "svn_url": "https://github.com/bitcoin-core/secp256k1",
        "language": "C",
        "forks_count": 962,
        "stargazers_count": 1800,
        "watchers_count": 1800,
        "size": 10374,
        "default_branch": "master",
        "open_issues_count": 144,
        "is_template": false,
        "topics": [],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-07-29T22:34:23Z",
        "created_at": "2014-02-08T17:30:06Z",
        "updated_at": "2023-07-29T15:58:49Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 180,
    "deletions": 73,
    "changed_files": 5,
    "commits": 6,
    "review_comments": 25,
    "comments": 7
  },
  "events": [
    {
      "event": "unsubscribed",
      "id": 9543366868,
      "node_id": "UE_lADOAP4Jqs5o1ylUzwAAAAI41DjU",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/9543366868",
      "actor": {
        "login": "romanz",
        "id": 9900,
        "node_id": "MDQ6VXNlcjk5MDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9900?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/romanz",
        "html_url": "https://github.com/romanz",
        "followers_url": "https://api.github.com/users/romanz/followers",
        "following_url": "https://api.github.com/users/romanz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/romanz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/romanz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/romanz/subscriptions",
        "organizations_url": "https://api.github.com/users/romanz/orgs",
        "repos_url": "https://api.github.com/users/romanz/repos",
        "events_url": "https://api.github.com/users/romanz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/romanz/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-15T17:55:04Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9657615021,
      "node_id": "HRFPE_lADOAP4Jqs5o1ylUzwAAAAI_o4Kt",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/9657615021",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-27T22:15:21Z"
    },
    {
      "event": "commented",
      "id": 1610297630,
      "node_id": "IC_kwDOAP4Jqs5f-zEe",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/1610297630",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-27T22:18:44Z",
      "updated_at": "2023-06-27T22:19:09Z",
      "author_association": "CONTRIBUTOR",
      "body": "Rebased on master (there was a conflict in tests.c due to #1358) and also updated the operations count comments on each of the optimized functions (i.e. `secp256k1_gej_add_ge_var`, `secp256k1_gej_add_zinv_var` and `secp256k1_gej_add_ge`) in the last commit.",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#issuecomment-1610297630",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1348"
    },
    {
      "event": "labeled",
      "id": 9657657600,
      "node_id": "LE_lADOAP4Jqs5o1ylUzwAAAAI_pCkA",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/9657657600",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-27T22:23:29Z",
      "label": {
        "name": "assurance",
        "color": "A6DF3D"
      }
    },
    {
      "event": "labeled",
      "id": 9657657605,
      "node_id": "LE_lADOAP4Jqs5o1ylUzwAAAAI_pCkF",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/9657657605",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-27T22:23:29Z",
      "label": {
        "name": "performance",
        "color": "DE3CCC"
      }
    },
    {
      "event": "reviewed",
      "id": 1522161048,
      "node_id": "PRR_kwDOAP4Jqs5aulWY",
      "url": null,
      "actor": null,
      "commit_id": "e8a702c56d2790803723bfd606d36d3e0c6ff044",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "",
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#pullrequestreview-1522161048",
      "submitted_at": "2023-07-10T14:00:44Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9780634174,
      "node_id": "HRFPE_lADOAP4Jqs5o1ylUzwAAAAJG-KI-",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/9780634174",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-10T23:08:15Z"
    },
    {
      "event": "reviewed",
      "id": 1524234637,
      "node_id": "PRR_kwDOAP4Jqs5a2fmN",
      "url": null,
      "actor": null,
      "commit_id": "6c3e8e3a0b834c989851defbc10fe3c8e4901c8c",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ACK mod nits",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#pullrequestreview-1524234637",
      "submitted_at": "2023-07-11T13:23:35Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
    },
    {
      "event": "commented",
      "id": 1631594936,
      "node_id": "IC_kwDOAP4Jqs5hQCm4",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/1631594936",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-11T22:35:12Z",
      "updated_at": "2023-07-11T22:35:12Z",
      "author_association": "CONTRIBUTOR",
      "body": "I think some of the existing `VERIFY_CHECK`s in `field_impl.h` can be replaced by calls to `secp256k1_fe_verify_magnitude` (If that's desirable but I guess so?)",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#issuecomment-1631594936",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1348"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9816483139,
      "node_id": "HRFPE_lADOAP4Jqs5o1ylUzwAAAAJJG6VD",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/9816483139",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-14T00:02:06Z"
    },
    {
      "event": "commented",
      "id": 1635074253,
      "node_id": "IC_kwDOAP4Jqs5hdUDN",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/1635074253",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-14T00:06:03Z",
      "updated_at": "2023-07-14T00:06:03Z",
      "author_association": "CONTRIBUTOR",
      "body": "Force-pushed with most suggestions tackled.\r\n\r\n> I think some of the existing `VERIFY_CHECK`s in `field_impl.h` can be replaced by calls to `secp256k1_fe_verify_magnitude` (If that's desirable but I guess so?)\r\n\r\nAdded another commit for doing that after the \"secp256k1_ge_table_set_globalz\" one ([203e41b86280d5ea5ed9ab599ddbc21970529601](https://github.com/bitcoin-core/secp256k1/pull/1348/commits/203e41b86280d5ea5ed9ab599ddbc21970529601)).",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#issuecomment-1635074253",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1348"
    },
    {
      "event": "reviewed",
      "id": 1529419517,
      "node_id": "PRR_kwDOAP4Jqs5bKRb9",
      "url": null,
      "actor": null,
      "commit_id": "c119091288d969f256533c7f1400aea2ea3c011f",
      "commit_url": null,
      "created_at": null,
      "author_association": "NONE",
      "body": "",
      "user": {
        "login": "Bezzo100-lab",
        "id": 61251851,
        "node_id": "MDQ6VXNlcjYxMjUxODUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/61251851?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Bezzo100-lab",
        "html_url": "https://github.com/Bezzo100-lab",
        "followers_url": "https://api.github.com/users/Bezzo100-lab/followers",
        "following_url": "https://api.github.com/users/Bezzo100-lab/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Bezzo100-lab/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Bezzo100-lab/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Bezzo100-lab/subscriptions",
        "organizations_url": "https://api.github.com/users/Bezzo100-lab/orgs",
        "repos_url": "https://api.github.com/users/Bezzo100-lab/repos",
        "events_url": "https://api.github.com/users/Bezzo100-lab/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Bezzo100-lab/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#pullrequestreview-1529419517",
      "submitted_at": "2023-07-14T01:01:47Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
    },
    {
      "event": "reviewed",
      "id": 1529422618,
      "node_id": "PRR_kwDOAP4Jqs5bKSMa",
      "url": null,
      "actor": null,
      "commit_id": "c119091288d969f256533c7f1400aea2ea3c011f",
      "commit_url": null,
      "created_at": null,
      "author_association": "NONE",
      "body": "",
      "user": {
        "login": "Bezzo100-lab",
        "id": 61251851,
        "node_id": "MDQ6VXNlcjYxMjUxODUx",
        "avatar_url": "https://avatars.githubusercontent.com/u/61251851?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Bezzo100-lab",
        "html_url": "https://github.com/Bezzo100-lab",
        "followers_url": "https://api.github.com/users/Bezzo100-lab/followers",
        "following_url": "https://api.github.com/users/Bezzo100-lab/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Bezzo100-lab/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Bezzo100-lab/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Bezzo100-lab/subscriptions",
        "organizations_url": "https://api.github.com/users/Bezzo100-lab/orgs",
        "repos_url": "https://api.github.com/users/Bezzo100-lab/repos",
        "events_url": "https://api.github.com/users/Bezzo100-lab/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Bezzo100-lab/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#pullrequestreview-1529422618",
      "submitted_at": "2023-07-14T01:07:36Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9820636328,
      "node_id": "HRFPE_lADOAP4Jqs5o1ylUzwAAAAJJWwSo",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/9820636328",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-14T10:48:35Z"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9826871439,
      "node_id": "HRFPE_lADOAP4Jqs5o1ylUzwAAAAJJuiiP",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/9826871439",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-15T00:04:43Z"
    },
    {
      "event": "reviewed",
      "id": 1540995608,
      "node_id": "PRR_kwDOAP4Jqs5b2boY",
      "url": null,
      "actor": null,
      "commit_id": "78cdcb0c504642a2dab2f1bab354224cadf8fe6f",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Although that could be done in a separate PR, I think this ideally should also remove the restriction to magnitude 31 introduced here: https://github.com/bitcoin-core/secp256k1/pull/1344/commits/07c0e8b82e2cea87f85263512945fed7adffea18#diff-28d9b92418cbddbe487fe84847993cc5da0b096363c83631a525cff25189752cR104 This is anyway now implied by the new limits.\r\n\r\nPossible follow-up PRs/issues: \r\n - Some (but not all) of the group functions verify their input `fe`s.  That doesn't hurt, but it's also not necessary because all field functions do that anyway. Anyway, we should either always do it or never.\r\n - We should really think about `#ifdef VERIFY` now. It seems that the current convention is to put all new VERIFY_CHECKs in ifdefs.  If we do this anyway, then we may as well redefine VERIFY_CHECK to be a noop (and give up on the idea that this macro is \"side-effect safe\". Another consideration is readability the uppercase VERIFY stands out. With more functions like `ge_verify`, it's a bit hard to spot them, so maybe we should actually keep the ifdefs. Or rename the functions to fe_VERIFY.  ",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#pullrequestreview-1540995608",
      "submitted_at": "2023-07-21T12:08:54Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDY5MGIwZmMwNWFiZDc2Y2I3ZjZiZDg3ZTg4YmY3YjhiMGZkMWFiNzA",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/690b0fc05abd76cb7f6bd87e88bf7b8b0fd1ab70",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/690b0fc05abd76cb7f6bd87e88bf7b8b0fd1ab70",
      "tree": {
        "sha": "70724e27147269339da494ddfe36dff0304e91ce",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/70724e27147269339da494ddfe36dff0304e91ce"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/c545fdc374964424683d9dac31a828adedabe860",
          "sha": "c545fdc374964424683d9dac31a828adedabe860",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/c545fdc374964424683d9dac31a828adedabe860"
        }
      ],
      "message": "add missing group element invariant checks\n\nThe group element checks `secp256k1_{ge,gej}_verify` have first been\nimplemented and added in commit f20266722ac93ca66d1beb0d2f2d2469b95aafea\n(PR #1299). This commit adds additional verification calls in group\nfunctions, to match the ones that were originally proposed in commit\n09dbba561fdb9d57a2cc9842ce041d9ba29a6189 of WIP-PR #1032 (which is\nobviously not rebased on #1299 yet).\n\nAlso, for easier review, all functions handling group elements are\nstructured in the following wasy for easier review (idea suggested by\nTim Ruffing):\n\n- on entry, verify all input ge, gej (and fe)\n- empty line\n- actual function body\n- empty line\n- on exit, verify all output ge, gej\n\nCo-authored-by: Peter Dettman <peter.dettman@gmail.com>\nCo-authored-by: Tim Ruffing <crypto@timruffing.de>",
      "committer": {
        "name": "Sebastian Falbesoner",
        "email": "sebastian.falbesoner@gmail.com",
        "date": "2023-07-21T23:52:06Z"
      },
      "author": {
        "name": "Sebastian Falbesoner",
        "email": "sebastian.falbesoner@gmail.com",
        "date": "2023-06-14T22:21:20Z"
      },
      "sha": "690b0fc05abd76cb7f6bd87e88bf7b8b0fd1ab70"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDRlOTY2MWZjNDI2YzYwNjhiMjQ3MmY1MmE3NzJjMzEyYmMyNmFjYzk",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/4e9661fc426c6068b2472f52a772c312bc26acc9",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/4e9661fc426c6068b2472f52a772c312bc26acc9",
      "tree": {
        "sha": "841d6072541a4443b1b2a79e400f5b5076bb3b5e",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/841d6072541a4443b1b2a79e400f5b5076bb3b5e"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/690b0fc05abd76cb7f6bd87e88bf7b8b0fd1ab70",
          "sha": "690b0fc05abd76cb7f6bd87e88bf7b8b0fd1ab70",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/690b0fc05abd76cb7f6bd87e88bf7b8b0fd1ab70"
        }
      ],
      "message": "Add _fe_verify_magnitude (no-op unless VERIFY is enabled)\n\nCo-authored-by: Tim Ruffing <crypto@timruffing.de>",
      "committer": {
        "name": "Sebastian Falbesoner",
        "email": "sebastian.falbesoner@gmail.com",
        "date": "2023-07-21T23:52:06Z"
      },
      "author": {
        "name": "Peter Dettman",
        "email": "peter.dettman@gmail.com",
        "date": "2021-12-05T09:19:52Z"
      },
      "sha": "4e9661fc426c6068b2472f52a772c312bc26acc9"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDQ5YWZkMmY1ZDhjMzIzZDMyYTIxZjJmZTE4MjgyM2I2ZDc3MDRlYjI",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/49afd2f5d8c323d32a21f2fe182823b6d7704eb2",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/49afd2f5d8c323d32a21f2fe182823b6d7704eb2",
      "tree": {
        "sha": "338b5e890cc89ec089f8d3e57e5d711d8fcf7eee",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/338b5e890cc89ec089f8d3e57e5d711d8fcf7eee"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/4e9661fc426c6068b2472f52a772c312bc26acc9",
          "sha": "4e9661fc426c6068b2472f52a772c312bc26acc9",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/4e9661fc426c6068b2472f52a772c312bc26acc9"
        }
      ],
      "message": "Take use of _fe_verify_magnitude in field_impl.h",
      "committer": {
        "name": "Sebastian Falbesoner",
        "email": "sebastian.falbesoner@gmail.com",
        "date": "2023-07-21T23:52:06Z"
      },
      "author": {
        "name": "Sebastian Falbesoner",
        "email": "sebastian.falbesoner@gmail.com",
        "date": "2023-07-13T23:24:22Z"
      },
      "sha": "49afd2f5d8c323d32a21f2fe182823b6d7704eb2"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDE3M2U4ZDA2MWE4ZDE1MjZmODBkOWFlNzlkZDdmMDM3MWQzOGY3ZTA",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/173e8d061a8d1526f80d9ae79dd7f0371d38f7e0",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/173e8d061a8d1526f80d9ae79dd7f0371d38f7e0",
      "tree": {
        "sha": "53c4507183fc8db6b951f5324b93f16393533e2e",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/53c4507183fc8db6b951f5324b93f16393533e2e"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/49afd2f5d8c323d32a21f2fe182823b6d7704eb2",
          "sha": "49afd2f5d8c323d32a21f2fe182823b6d7704eb2",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/49afd2f5d8c323d32a21f2fe182823b6d7704eb2"
        }
      ],
      "message": "Implement current magnitude assumptions\n\nRemove also the explicit magnitude restriction `a->x.magnitude <= 31`\nin `secp256k1_gej_eq_x_var` (introduced in commit\n07c0e8b82e2cea87f85263512945fed7adffea18), as this is implied by the\nnew limits.\n\nCo-authored-by: Sebastian Falbesoner <sebastian.falbesoner@gmail.com>",
      "committer": {
        "name": "Sebastian Falbesoner",
        "email": "sebastian.falbesoner@gmail.com",
        "date": "2023-07-21T23:52:06Z"
      },
      "author": {
        "name": "Peter Dettman",
        "email": "peter.dettman@gmail.com",
        "date": "2021-12-05T09:27:56Z"
      },
      "sha": "173e8d061a8d1526f80d9ae79dd7f0371d38f7e0"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKGQ0NTI3ZDY2ODU4MzVmMzQ2ZjhiY2Q1NTQ4ODQzZDEyMDE1MTI2MmQ",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/d4527d6685835f346f8bcd5548843d120151262d",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/d4527d6685835f346f8bcd5548843d120151262d",
      "tree": {
        "sha": "7bd08206cba420499303e3e2fb07f2b58b3190df",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/7bd08206cba420499303e3e2fb07f2b58b3190df"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/173e8d061a8d1526f80d9ae79dd7f0371d38f7e0",
          "sha": "173e8d061a8d1526f80d9ae79dd7f0371d38f7e0",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/173e8d061a8d1526f80d9ae79dd7f0371d38f7e0"
        }
      ],
      "message": "Tighten group magnitude limits\n\n- adjust test methods that randomize magnitudes\n\nCo-authored-by: Sebastian Falbesoner <sebastian.falbesoner@gmail.com>",
      "committer": {
        "name": "Sebastian Falbesoner",
        "email": "sebastian.falbesoner@gmail.com",
        "date": "2023-07-21T23:52:06Z"
      },
      "author": {
        "name": "Peter Dettman",
        "email": "peter.dettman@gmail.com",
        "date": "2021-12-05T10:59:33Z"
      },
      "sha": "d4527d6685835f346f8bcd5548843d120151262d"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOAP4JqtoAKDMxYmM5YTQzNDgxMWQ5ZDJjMGE4MDU4YzkzOTU3YzM2NWIzOTA4OWI",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/31bc9a434811d9d2c0a8058c93957c365b39089b",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/secp256k1/commit/31bc9a434811d9d2c0a8058c93957c365b39089b",
      "tree": {
        "sha": "6e1b1224e34cf6010d796d4891fd5daf56bf0548",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/trees/6e1b1224e34cf6010d796d4891fd5daf56bf0548"
      },
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "payload": null,
        "signature": null
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/git/commits/d4527d6685835f346f8bcd5548843d120151262d",
          "sha": "d4527d6685835f346f8bcd5548843d120151262d",
          "html_url": "https://github.com/bitcoin-core/secp256k1/commit/d4527d6685835f346f8bcd5548843d120151262d"
        }
      ],
      "message": "Save _normalize_weak calls in group add methods\n\nAlso update the operations count comments in each of the affected\nfunctions accordingly and remove a redundant VERIFY_CHECK in\nsecp256k1_gej_add_ge (the infinity value range check [0,1] is already\ncovered by secp256k1_gej_verify above).\n\nCo-authored-by: Sebastian Falbesoner <sebastian.falbesoner@gmail.com>\nCo-authored-by: Tim Ruffing <crypto@timruffing.de>",
      "committer": {
        "name": "Sebastian Falbesoner",
        "email": "sebastian.falbesoner@gmail.com",
        "date": "2023-07-21T23:52:06Z"
      },
      "author": {
        "name": "Peter Dettman",
        "email": "peter.dettman@gmail.com",
        "date": "2021-12-05T12:11:56Z"
      },
      "sha": "31bc9a434811d9d2c0a8058c93957c365b39089b"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 9889662272,
      "node_id": "HRFPE_lADOAP4Jqs5o1ylUzwAAAAJNeEVA",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/9889662272",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-22T00:27:03Z"
    },
    {
      "event": "commented",
      "id": 1646366546,
      "node_id": "IC_kwDOAP4Jqs5iIY9S",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/1646366546",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-22T01:09:32Z",
      "updated_at": "2023-07-22T01:09:32Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks for the review. Force-pushed, removed the <= 31 magnitude check in `secp256k1_gej_eq_x_var` (included in the commit which introduces the tighter group magnitude limits) and also tackled the two other smaller review comments above.\r\n\r\nSome comments to the follow-up ideas:\r\n\r\n> Some (but not all) of the group functions verify their input fes. That doesn't hurt, but it's also not necessary because all field functions do that anyway. Anyway, we should either always do it or never.\r\n\r\nAny preference between \"always\" and \"never\"? Since the checks are not necessary, I would personally prefer \"never\", leading to less code, even though the diff would be a bit larger (there are more functions taking fe inputs in group_impl.h that already verify the fe than those that miss the check), but that shouldn't matter.\r\n\r\nAs for the `#ifdef VERIFY` subject, what exactly does \"side-effect safe\" mean in this context, is the point here to _allow_ side-effects, and that's why the expression also needs to be executed in non-verify mode? I fail to see why having side-effects in checks would ever be useful or generally desirable (quickly glancing over `git grep VERIFY_CHECK` results also didn't show me any expressions with side-effects, but maybe I'm missing something), so your proposal of redefining VERIFY_CHECK to a no-op in non-verify mode sounds reasonable to me.",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#issuecomment-1646366546",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1348"
    },
    {
      "event": "reviewed",
      "id": 1542761864,
      "node_id": "PRR_kwDOAP4Jqs5b9K2I",
      "url": null,
      "actor": null,
      "commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "ACK 31bc9a434811d9d2c0a8058c93957c365b39089b",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#pullrequestreview-1542761864",
      "submitted_at": "2023-07-24T06:20:44Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
    },
    {
      "event": "commented",
      "id": 1647527201,
      "node_id": "IC_kwDOAP4Jqs5iM0Uh",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/1647527201",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-24T09:14:57Z",
      "updated_at": "2023-07-24T09:14:57Z",
      "author_association": "CONTRIBUTOR",
      "body": "> > Some (but not all) of the group functions verify their input fes. That doesn't hurt, but it's also not necessary because all field functions do that anyway. Anyway, we should either always do it or never.\r\n> \r\n> Any preference between \"always\" and \"never\"? Since the checks are not necessary, I would personally prefer \"never\", leading to less code, even though the diff would be a bit larger (there are more functions taking fe inputs in group_impl.h that already verify the fe than those that miss the check), but that shouldn't matter.\r\n> \r\n\r\nI tend to agree. This will also separate concerns more clearly: The field code verifies the field element, the group code verifies the group elements. And if the group code accesses `fe` internals directly (e.g. `magnitude`), that should be considered a layer violation (and this PR here will fix this by adding `secp256k1_fe_verify_magnitude`).\r\n\r\n> As for the `#ifdef VERIFY` subject, [...]\r\n\r\nSee #1381.",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#issuecomment-1647527201",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1348"
    },
    {
      "event": "reviewed",
      "id": 1543416214,
      "node_id": "PRR_kwDOAP4Jqs5b_qmW",
      "url": null,
      "actor": null,
      "commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "",
      "user": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#pullrequestreview-1543416214",
      "submitted_at": "2023-07-24T13:00:19Z",
      "state": "COMMENTED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
    },
    {
      "event": "commented",
      "id": 1656472260,
      "node_id": "IC_kwDOAP4Jqs5iu8LE",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/1656472260",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-28T23:52:52Z",
      "updated_at": "2023-07-28T23:52:52Z",
      "author_association": "CONTRIBUTOR",
      "body": "@jonasnick: Thanks for the review! I've tried to tackle your suggestions in a separate branch for review of how the proposed changes would look like (https://github.com/theStack/secp256k1/tree/revival_of_1032_magnitude_comments, in particular the last commit https://github.com/theStack/secp256k1/commit/b7c685e74adbd83937990e90f076600fabf8ccf0). This is the range-diff from the current version (which already has one ACK) to the one with tighter limits and magnitude annotations expressed with limit variables (`git range-diff 31bc9...b7c68`):\r\n\r\n<details>\r\n  <summary>Diff</summary>\r\n\r\n```diff\r\n1:  d4527d6 ! 1:  c83afa6 Tighten group magnitude limits\r\n    @@ Commit message\r\n         - adjust test methods that randomize magnitudes\r\n     \r\n         Co-authored-by: Sebastian Falbesoner <sebastian.falbesoner@gmail.com>\r\n    +    Co-authored-by: Jonas Nick <jonasd.nick@gmail.com>\r\n     \r\n      ## src/group.h ##\r\n     @@ src/group.h: typedef struct {\r\n    @@ src/group.h: typedef struct {\r\n     -#define SECP256K1_GEJ_X_MAGNITUDE_MAX 8\r\n     -#define SECP256K1_GEJ_Y_MAGNITUDE_MAX 8\r\n     -#define SECP256K1_GEJ_Z_MAGNITUDE_MAX 8\r\n    -+#define SECP256K1_GE_X_MAGNITUDE_MAX  6\r\n    -+#define SECP256K1_GE_Y_MAGNITUDE_MAX  4\r\n    -+#define SECP256K1_GEJ_X_MAGNITUDE_MAX 6\r\n    ++#define SECP256K1_GE_X_MAGNITUDE_MAX  4\r\n    ++#define SECP256K1_GE_Y_MAGNITUDE_MAX  3\r\n    ++#define SECP256K1_GEJ_X_MAGNITUDE_MAX 4\r\n     +#define SECP256K1_GEJ_Y_MAGNITUDE_MAX 4\r\n    -+#define SECP256K1_GEJ_Z_MAGNITUDE_MAX 2\r\n    ++#define SECP256K1_GEJ_Z_MAGNITUDE_MAX 1\r\n      \r\n      /** Set a group element equal to the point with given X and Y coordinates */\r\n      static void secp256k1_ge_set_xy(secp256k1_ge *r, const secp256k1_fe *x, const secp256k1_fe *y);\r\n2:  31bc9a4 ! 2:  b7c685e Save _normalize_weak calls in group add methods\r\n    @@ Commit message\r\n     \r\n         Co-authored-by: Sebastian Falbesoner <sebastian.falbesoner@gmail.com>\r\n         Co-authored-by: Tim Ruffing <crypto@timruffing.de>\r\n    +    Co-authored-by: Jonas Nick <jonasd.nick@gmail.com>\r\n     \r\n      ## src/group_impl.h ##\r\n     @@ src/group_impl.h: static void secp256k1_gej_add_var(secp256k1_gej *r, const secp256k1_gej *a, cons\r\n    @@ src/group_impl.h: static void secp256k1_gej_add_ge_var(secp256k1_gej *r, const s\r\n     +    s1 = a->y;\r\n          secp256k1_fe_mul(&s2, &b->y, &z12); secp256k1_fe_mul(&s2, &s2, &a->z);\r\n     -    secp256k1_fe_negate(&h, &u1, 1); secp256k1_fe_add(&h, &u2);\r\n    -+    secp256k1_fe_negate(&h, &u1, 6); secp256k1_fe_add(&h, &u2);\r\n    ++    secp256k1_fe_negate(&h, &u1, SECP256K1_GEJ_X_MAGNITUDE_MAX); secp256k1_fe_add(&h, &u2);\r\n          secp256k1_fe_negate(&i, &s2, 1); secp256k1_fe_add(&i, &s1);\r\n          if (secp256k1_fe_normalizes_to_zero_var(&h)) {\r\n              if (secp256k1_fe_normalizes_to_zero_var(&i)) {\r\n    @@ src/group_impl.h: static void secp256k1_gej_add_zinv_var(secp256k1_gej *r, const\r\n     +    s1 = a->y;\r\n          secp256k1_fe_mul(&s2, &b->y, &z12); secp256k1_fe_mul(&s2, &s2, &az);\r\n     -    secp256k1_fe_negate(&h, &u1, 1); secp256k1_fe_add(&h, &u2);\r\n    -+    secp256k1_fe_negate(&h, &u1, 6); secp256k1_fe_add(&h, &u2);\r\n    ++    secp256k1_fe_negate(&h, &u1, SECP256K1_GEJ_X_MAGNITUDE_MAX); secp256k1_fe_add(&h, &u2);\r\n          secp256k1_fe_negate(&i, &s2, 1); secp256k1_fe_add(&i, &s1);\r\n          if (secp256k1_fe_normalizes_to_zero_var(&h)) {\r\n              if (secp256k1_fe_normalizes_to_zero_var(&i)) {\r\n    @@ src/group_impl.h: static void secp256k1_gej_add_ge(secp256k1_gej *r, const secp2\r\n      \r\n          secp256k1_fe_sqr(&zz, &a->z);                       /* z = Z1^2 */\r\n     -    u1 = a->x; secp256k1_fe_normalize_weak(&u1);        /* u1 = U1 = X1*Z2^2 (1) */\r\n    -+    u1 = a->x;                                          /* u1 = U1 = X1*Z2^2 (6) */\r\n    ++    u1 = a->x;                                          /* u1 = U1 = X1*Z2^2 (GEJ_X_M) */\r\n          secp256k1_fe_mul(&u2, &b->x, &zz);                  /* u2 = U2 = X2*Z1^2 (1) */\r\n     -    s1 = a->y; secp256k1_fe_normalize_weak(&s1);        /* s1 = S1 = Y1*Z2^3 (1) */\r\n    -+    s1 = a->y;                                          /* s1 = S1 = Y1*Z2^3 (4) */\r\n    ++    s1 = a->y;                                          /* s1 = S1 = Y1*Z2^3 (GEJ_Y_M) */\r\n          secp256k1_fe_mul(&s2, &b->y, &zz);                  /* s2 = Y2*Z1^2 (1) */\r\n          secp256k1_fe_mul(&s2, &s2, &a->z);                  /* s2 = S2 = Y2*Z1^3 (1) */\r\n     -    t = u1; secp256k1_fe_add(&t, &u2);                  /* t = T = U1+U2 (2) */\r\n     -    m = s1; secp256k1_fe_add(&m, &s2);                  /* m = M = S1+S2 (2) */\r\n    -+    t = u1; secp256k1_fe_add(&t, &u2);                  /* t = T = U1+U2 (7) */\r\n    -+    m = s1; secp256k1_fe_add(&m, &s2);                  /* m = M = S1+S2 (5) */\r\n    ++    t = u1; secp256k1_fe_add(&t, &u2);                  /* t = T = U1+U2 (GEJ_X_M+1) */\r\n    ++    m = s1; secp256k1_fe_add(&m, &s2);                  /* m = M = S1+S2 (GEJ_Y_M+1) */\r\n          secp256k1_fe_sqr(&rr, &t);                          /* rr = T^2 (1) */\r\n     -    secp256k1_fe_negate(&m_alt, &u2, 1);                /* Malt = -X2*Z1^2 */\r\n     -    secp256k1_fe_mul(&tt, &u1, &m_alt);                 /* tt = -U1*U2 (2) */\r\n    @@ src/group_impl.h: static void secp256k1_gej_add_ge(secp256k1_gej *r, const secp2\r\n          rr_alt = s1;\r\n     -    secp256k1_fe_mul_int(&rr_alt, 2);       /* rr = Y1*Z2^3 - Y2*Z1^3 (2) */\r\n     -    secp256k1_fe_add(&m_alt, &u1);          /* Malt = X1*Z2^2 - X2*Z1^2 */\r\n    -+    secp256k1_fe_mul_int(&rr_alt, 2);       /* rr_alt = Y1*Z2^3 - Y2*Z1^3 (8) */\r\n    -+    secp256k1_fe_add(&m_alt, &u1);          /* Malt = X1*Z2^2 - X2*Z1^2 (8) */\r\n    ++    secp256k1_fe_mul_int(&rr_alt, 2);       /* rr_alt = Y1*Z2^3 - Y2*Z1^3 (GEJ_Y_M*2) */\r\n    ++    secp256k1_fe_add(&m_alt, &u1);          /* Malt = X1*Z2^2 - X2*Z1^2 (GEJ_X_M+2) */\r\n      \r\n     -    secp256k1_fe_cmov(&rr_alt, &rr, !degenerate);\r\n     -    secp256k1_fe_cmov(&m_alt, &m, !degenerate);\r\n    -+    secp256k1_fe_cmov(&rr_alt, &rr, !degenerate);       /* rr_alt (8) */\r\n    -+    secp256k1_fe_cmov(&m_alt, &m, !degenerate);         /* m_alt (8) */\r\n    ++    secp256k1_fe_cmov(&rr_alt, &rr, !degenerate);       /* rr_alt (GEJ_Y_M*2) */\r\n    ++    secp256k1_fe_cmov(&m_alt, &m, !degenerate);         /* m_alt (GEJ_X_M+2) */\r\n          /* Now Ralt / Malt = lambda and is guaranteed not to be Ralt / 0.\r\n           * From here on out Ralt and Malt represent the numerator\r\n           * and denominator of lambda; R and M represent the explicit\r\n           * expressions x1^2 + x2^2 + x1x2 and y1 + y2. */\r\n          secp256k1_fe_sqr(&n, &m_alt);                       /* n = Malt^2 (1) */\r\n     -    secp256k1_fe_negate(&q, &t, 2);                     /* q = -T (3) */\r\n    -+    secp256k1_fe_negate(&q, &t, 7);                     /* q = -T (8) */\r\n    ++    secp256k1_fe_negate(&q, &t,\r\n    ++        SECP256K1_GEJ_X_MAGNITUDE_MAX + 1);             /* q = -T (GEJ_X_M+2) */\r\n          secp256k1_fe_mul(&q, &q, &n);                       /* q = Q = -T*Malt^2 (1) */\r\n          /* These two lines use the observation that either M == Malt or M == 0,\r\n           * so M^3 * Malt is either Malt^4 (which is computed by squaring), or\r\n    @@ src/group_impl.h: static void secp256k1_gej_add_ge(secp256k1_gej *r, const secp2\r\n     -    secp256k1_fe_sqr(&n, &n);\r\n     -    secp256k1_fe_cmov(&n, &m, degenerate);              /* n = M^3 * Malt (2) */\r\n     +    secp256k1_fe_sqr(&n, &n);                           /* n = Malt^4 (1) */\r\n    -+    secp256k1_fe_cmov(&n, &m, degenerate);              /* n = M^3 * Malt (5) */\r\n    ++    secp256k1_fe_cmov(&n, &m, degenerate);              /* n = M^3 * Malt (GEJ_Y_M+1) */\r\n          secp256k1_fe_sqr(&t, &rr_alt);                      /* t = Ralt^2 (1) */\r\n          secp256k1_fe_mul(&r->z, &a->z, &m_alt);             /* r->z = Z3 = Malt*Z (1) */\r\n          secp256k1_fe_add(&t, &q);                           /* t = Ralt^2 + Q (2) */\r\n    @@ src/group_impl.h: static void secp256k1_gej_add_ge(secp256k1_gej *r, const secp2\r\n     -    secp256k1_fe_add(&t, &n);                           /* t = Ralt*(2*X3 + Q) + M^3*Malt (3) */\r\n     -    secp256k1_fe_negate(&r->y, &t, 3);                  /* r->y = -(Ralt*(2*X3 + Q) + M^3*Malt) (4) */\r\n     -    secp256k1_fe_half(&r->y);                           /* r->y = Y3 = -(Ralt*(2*X3 + Q) + M^3*Malt)/2 (3) */\r\n    -+    secp256k1_fe_add(&t, &n);                           /* t = Ralt*(2*X3 + Q) + M^3*Malt (6) */\r\n    -+    secp256k1_fe_negate(&r->y, &t, 6);                  /* r->y = -(Ralt*(2*X3 + Q) + M^3*Malt) (7) */\r\n    -+    secp256k1_fe_half(&r->y);                           /* r->y = Y3 = -(Ralt*(2*X3 + Q) + M^3*Malt)/2 (4) */\r\n    ++    secp256k1_fe_add(&t, &n);                           /* t = Ralt*(2*X3 + Q) + M^3*Malt (GEJ_Y_M+2) */\r\n    ++    secp256k1_fe_negate(&r->y, &t,\r\n    ++        SECP256K1_GEJ_Y_MAGNITUDE_MAX + 2);             /* r->y = -(Ralt*(2*X3 + Q) + M^3*Malt) (GEJ_Y_M+3) */\r\n    ++    secp256k1_fe_half(&r->y);                           /* r->y = Y3 = -(Ralt*(2*X3 + Q) + M^3*Malt)/2 ((GEJ_Y_M+3)/2 + 1) */\r\n      \r\n          /* In case a->infinity == 1, replace r with (b->x, b->y, 1). */\r\n          secp256k1_fe_cmov(&r->x, &b->x, a->infinity);\r\n```\r\n\r\n</details>\r\n\r\nAny opinions on what of those changes should be adapted? On one hand I think it's nice to express the magnitudes in a generic way in the comments, on the other hand it probably causes more confusion and is not that helpful (especially for longer expressions). Also, is there any drawback in tightening the limits too much, e.g. increased risk that they have to be lifted again soon, causing extra work? Happy to receive input and change the PR either way.",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#issuecomment-1656472260",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1348"
    },
    {
      "event": "mentioned",
      "id": 9953185595,
      "node_id": "MEE_lADOAP4Jqs5o1ylUzwAAAAJRQY87",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/9953185595",
      "actor": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-28T23:52:52Z"
    },
    {
      "event": "subscribed",
      "id": 9953185601,
      "node_id": "SE_lADOAP4Jqs5o1ylUzwAAAAJRQY9B",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/9953185601",
      "actor": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-28T23:52:52Z"
    },
    {
      "event": "commented",
      "id": 1658291458,
      "node_id": "IC_kwDOAP4Jqs5i14UC",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/1658291458",
      "actor": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-31T12:36:58Z",
      "updated_at": "2023-07-31T12:36:58Z",
      "author_association": "CONTRIBUTOR",
      "body": "@theStack I slightly prefer this variant and I don't think the resulting expressions are particularly confusing. For the code it makes more sense to use the `SECP256K1_GE{,J}_{X,Y,Z}_MAGNITUDE_MAX` constants instead of magic numbers. And then it's easier to follow the comments if they use the same constants.\r\n",
      "user": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#issuecomment-1658291458",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1348"
    },
    {
      "event": "mentioned",
      "id": 9963378882,
      "node_id": "MEE_lADOAP4Jqs5o1ylUzwAAAAJR3RjC",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/9963378882",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-31T12:36:59Z"
    },
    {
      "event": "subscribed",
      "id": 9963378898,
      "node_id": "SE_lADOAP4Jqs5o1ylUzwAAAAJR3RjS",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/9963378898",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-07-31T12:36:59Z"
    }
  ],
  "comments": [
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1258315261",
      "pull_request_review_id": 1522161048,
      "id": 1258315261,
      "node_id": "PRRC_kwDOAP4Jqs5LAF39",
      "diff_hunk": "@@ -352,4 +352,12 @@ static int secp256k1_fe_is_square_var(const secp256k1_fe *a);\n /** Check invariants on a field element (no-op unless VERIFY is enabled). */\n static void secp256k1_fe_verify(const secp256k1_fe *a);\n \n+#ifdef VERIFY\n+\n+/** Assert a context-specific limit m on the magnitude of a. m cannot be outside",
      "path": "src/field.h",
      "position": null,
      "original_position": 6,
      "commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "original_commit_id": "7ba858ed1730aa2e968c83f9305271a8cff71c85",
      "in_reply_to_id": null,
      "user": {
        "login": "sipa",
        "id": 548488,
        "node_id": "MDQ6VXNlcjU0ODQ4OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sipa",
        "html_url": "https://github.com/sipa",
        "followers_url": "https://api.github.com/users/sipa/followers",
        "following_url": "https://api.github.com/users/sipa/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/sipa/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/sipa/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
        "organizations_url": "https://api.github.com/users/sipa/orgs",
        "repos_url": "https://api.github.com/users/sipa/repos",
        "events_url": "https://api.github.com/users/sipa/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/sipa/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This comment is outdated; all implementations now support the same range of magnitudes, 0-32 inclusive (since #1066). That also means the implementation of this `secp256k1_fe_verify_magnitude` can be in field_impl.h rather than in the representation-specific files.",
      "created_at": "2023-07-10T13:58:16Z",
      "updated_at": "2023-07-10T14:00:44Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#discussion_r1258315261",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1258315261"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 357,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1258994909",
      "pull_request_review_id": 1523161603,
      "id": 1258994909,
      "node_id": "PRRC_kwDOAP4Jqs5LCrzd",
      "diff_hunk": "@@ -352,4 +352,12 @@ static int secp256k1_fe_is_square_var(const secp256k1_fe *a);\n /** Check invariants on a field element (no-op unless VERIFY is enabled). */\n static void secp256k1_fe_verify(const secp256k1_fe *a);\n \n+#ifdef VERIFY\n+\n+/** Assert a context-specific limit m on the magnitude of a. m cannot be outside",
      "path": "src/field.h",
      "position": null,
      "original_position": 6,
      "commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "original_commit_id": "7ba858ed1730aa2e968c83f9305271a8cff71c85",
      "in_reply_to_id": 1258315261,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Moved `secp256k1_fe_verify_magnitude` to a (single) implementation in field_impl.h, also removed the VERIFY pre-processor condition from field.h and add a no-op implementation for the case that VERIFY isn't set instead (even though the no-op case isn't currently used, it seems to be more consistent to _fe_verify that way).",
      "created_at": "2023-07-10T23:08:37Z",
      "updated_at": "2023-07-10T23:08:37Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#discussion_r1258994909",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1258994909"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 357,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1259712509",
      "pull_request_review_id": 1524234637,
      "id": 1259712509,
      "node_id": "PRRC_kwDOAP4Jqs5LFa_9",
      "diff_hunk": "@@ -231,6 +235,7 @@ static void secp256k1_ge_table_set_globalz(size_t len, secp256k1_ge *a, const se\n         secp256k1_fe_verify(&zr[i]);\n         /* Ensure all y values are in weak normal form for fast negation of points */\n         secp256k1_fe_normalize_weak(&a[i].y);\n+        secp256k1_ge_verify(&a[i]);",
      "path": "src/group_impl.h",
      "position": null,
      "original_position": 22,
      "commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "original_commit_id": "672b1016ffad59a615eb49b30a6f0d7ad8c4627e",
      "in_reply_to_id": null,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nit: I think the functions would be easier to read, if they all follow the same pattern (in particular the functions with loops:)\r\n * on entry, verify all input ge, gej\r\n * (possibly an empty line if you're willing to add this)\r\n * actual function body\r\n * (possibly an empty line if you're willing to add this)\r\n * on exit, verify all output gej, possibly separated by a newline\r\n\r\n",
      "created_at": "2023-07-11T13:08:57Z",
      "updated_at": "2023-07-11T13:23:35Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#discussion_r1259712509",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1259712509"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 243,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1259718147",
      "pull_request_review_id": 1524234637,
      "id": 1259718147,
      "node_id": "PRRC_kwDOAP4Jqs5LFcYD",
      "diff_hunk": "@@ -352,4 +352,8 @@ static int secp256k1_fe_is_square_var(const secp256k1_fe *a);\n /** Check invariants on a field element (no-op unless VERIFY is enabled). */\n static void secp256k1_fe_verify(const secp256k1_fe *a);\n \n+/** Assert a context-specific limit m on the magnitude of a, where\n+ *  m must be in the supported range [0,32] (no-op unless VERIFY is enabled). */\n+static void secp256k1_fe_verify_magnitude(const secp256k1_fe *a, int m);",
      "path": "src/field.h",
      "position": null,
      "original_position": 6,
      "commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "original_commit_id": "d0d4d09df2d084b529a7ad6f3bc439d032615d0c",
      "in_reply_to_id": null,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "nits in the comment: \r\n - s/Assert/Check (Assert is actually the better term, but we write check everywhere else for this. Or change it in the entire code base ;))\r\n - \"context-specific\" can be a bit unclear. And I don't think it adds much.\r\n - Maybe just: \"Check that the magnitude of a is at most m. (...) \"? ",
      "created_at": "2023-07-11T13:13:17Z",
      "updated_at": "2023-07-11T13:23:35Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#discussion_r1259718147",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1259718147"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
        }
      },
      "start_line": null,
      "original_start_line": 355,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 356,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1259724131",
      "pull_request_review_id": 1524234637,
      "id": 1259724131,
      "node_id": "PRRC_kwDOAP4Jqs5LFd1j",
      "diff_hunk": "@@ -89,9 +89,9 @@ static void secp256k1_gej_verify(const secp256k1_gej *a) {\n     secp256k1_fe_verify(&a->x);\n     secp256k1_fe_verify(&a->y);\n     secp256k1_fe_verify(&a->z);\n-    secp256k1_fe_verify_magnitude(&a->x, 8);\n-    secp256k1_fe_verify_magnitude(&a->y, 8);\n-    secp256k1_fe_verify_magnitude(&a->z, 8);\n+    secp256k1_fe_verify_magnitude(&a->x, 6);\n+    secp256k1_fe_verify_magnitude(&a->y, 4);\n+    secp256k1_fe_verify_magnitude(&a->z, 2);",
      "path": "src/group_impl.h",
      "position": null,
      "original_position": 20,
      "commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "original_commit_id": "4da686881cd0608b5e17168d643d76c05fa31904",
      "in_reply_to_id": null,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I wonder if it's better to have constants for this. If we change these values here, one needs to change the tests, too, and this is rather easy to miss.\r\n\r\nAlternatively (and slightly worse if you ask me), you could add comments here and in the tests that just state that the values need to match these in the other file.",
      "created_at": "2023-07-11T13:17:55Z",
      "updated_at": "2023-07-11T13:23:35Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#discussion_r1259724131",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1259724131"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
        }
      },
      "start_line": null,
      "original_start_line": 92,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 94,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1259731270",
      "pull_request_review_id": 1524234637,
      "id": 1259731270,
      "node_id": "PRRC_kwDOAP4Jqs5LFflG",
      "diff_hunk": "",
      "path": "src/group_impl.h",
      "position": 1,
      "original_position": 1,
      "commit_id": "6c3e8e3a0b834c989851defbc10fe3c8e4901c8c",
      "original_commit_id": "6c3e8e3a0b834c989851defbc10fe3c8e4901c8c",
      "in_reply_to_id": null,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "The last line here can be removed, it's covered by the `gej_verify`:\r\n\r\nhttps://github.com/theStack/secp256k1/blob/6c3e8e3a0b834c989851defbc10fe3c8e4901c8c/src/group_impl.h#L628-L636\r\n\r\n(Strictly speaking not this PR, but it's at least related.)",
      "created_at": "2023-07-11T13:22:59Z",
      "updated_at": "2023-07-11T13:23:35Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#discussion_r1259731270",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1259731270"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1,
      "original_line": 1,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1263151105",
      "pull_request_review_id": 1529386684,
      "id": 1263151105,
      "node_id": "PRRC_kwDOAP4Jqs5LSigB",
      "diff_hunk": "",
      "path": "src/group_impl.h",
      "position": 1,
      "original_position": 1,
      "commit_id": "6c3e8e3a0b834c989851defbc10fe3c8e4901c8c",
      "original_commit_id": "6c3e8e3a0b834c989851defbc10fe3c8e4901c8c",
      "in_reply_to_id": 1259731270,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Done, included the removal of this line in the last commit with a mention in the commit message.",
      "created_at": "2023-07-14T00:03:15Z",
      "updated_at": "2023-07-14T00:03:15Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#discussion_r1263151105",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1263151105"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 1,
      "original_line": 1,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1263151369",
      "pull_request_review_id": 1529387267,
      "id": 1263151369,
      "node_id": "PRRC_kwDOAP4Jqs5LSikJ",
      "diff_hunk": "@@ -89,9 +89,9 @@ static void secp256k1_gej_verify(const secp256k1_gej *a) {\n     secp256k1_fe_verify(&a->x);\n     secp256k1_fe_verify(&a->y);\n     secp256k1_fe_verify(&a->z);\n-    secp256k1_fe_verify_magnitude(&a->x, 8);\n-    secp256k1_fe_verify_magnitude(&a->y, 8);\n-    secp256k1_fe_verify_magnitude(&a->z, 8);\n+    secp256k1_fe_verify_magnitude(&a->x, 6);\n+    secp256k1_fe_verify_magnitude(&a->y, 4);\n+    secp256k1_fe_verify_magnitude(&a->z, 2);",
      "path": "src/group_impl.h",
      "position": null,
      "original_position": 20,
      "commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "original_commit_id": "4da686881cd0608b5e17168d643d76c05fa31904",
      "in_reply_to_id": 1259724131,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Agree! I've introduced #defines SECP256K1_{GE,GEJ}_{X,Y,Z}_MAGNITUDE_MAX in group.h and used that in the following commit, indeed much nicer now. Happy to receive improvement suggestions for the new constants naming and the place where they are defined.",
      "created_at": "2023-07-14T00:03:32Z",
      "updated_at": "2023-07-14T00:03:32Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#discussion_r1263151369",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1263151369"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
        }
      },
      "start_line": null,
      "original_start_line": 92,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 94,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1263151563",
      "pull_request_review_id": 1529387523,
      "id": 1263151563,
      "node_id": "PRRC_kwDOAP4Jqs5LSinL",
      "diff_hunk": "@@ -352,4 +352,8 @@ static int secp256k1_fe_is_square_var(const secp256k1_fe *a);\n /** Check invariants on a field element (no-op unless VERIFY is enabled). */\n static void secp256k1_fe_verify(const secp256k1_fe *a);\n \n+/** Assert a context-specific limit m on the magnitude of a, where\n+ *  m must be in the supported range [0,32] (no-op unless VERIFY is enabled). */\n+static void secp256k1_fe_verify_magnitude(const secp256k1_fe *a, int m);",
      "path": "src/field.h",
      "position": null,
      "original_position": 6,
      "commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "original_commit_id": "d0d4d09df2d084b529a7ad6f3bc439d032615d0c",
      "in_reply_to_id": 1259718147,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thanks, went with your suggestion.",
      "created_at": "2023-07-14T00:03:57Z",
      "updated_at": "2023-07-14T00:03:57Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#discussion_r1263151563",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1263151563"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
        }
      },
      "start_line": null,
      "original_start_line": 355,
      "start_side": "RIGHT",
      "line": null,
      "original_line": 356,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1263152102",
      "pull_request_review_id": 1529388230,
      "id": 1263152102,
      "node_id": "PRRC_kwDOAP4Jqs5LSivm",
      "diff_hunk": "@@ -231,6 +235,7 @@ static void secp256k1_ge_table_set_globalz(size_t len, secp256k1_ge *a, const se\n         secp256k1_fe_verify(&zr[i]);\n         /* Ensure all y values are in weak normal form for fast negation of points */\n         secp256k1_fe_normalize_weak(&a[i].y);\n+        secp256k1_ge_verify(&a[i]);",
      "path": "src/group_impl.h",
      "position": null,
      "original_position": 22,
      "commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "original_commit_id": "672b1016ffad59a615eb49b30a6f0d7ad8c4627e",
      "in_reply_to_id": 1259712509,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Started working on that but got doubt, as I think that would need additional verification _loops_ at the start and end of a function if the input is an array of ge(j) instances (like in secp256k1_ge_table_set_globalz). Is that what you meant? (If yes, maybe good follow-up material?)",
      "created_at": "2023-07-14T00:05:17Z",
      "updated_at": "2023-07-14T00:05:18Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#discussion_r1263152102",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1263152102"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 243,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1263424158",
      "pull_request_review_id": 1529817904,
      "id": 1263424158,
      "node_id": "PRRC_kwDOAP4Jqs5LTlKe",
      "diff_hunk": "@@ -231,6 +235,7 @@ static void secp256k1_ge_table_set_globalz(size_t len, secp256k1_ge *a, const se\n         secp256k1_fe_verify(&zr[i]);\n         /* Ensure all y values are in weak normal form for fast negation of points */\n         secp256k1_fe_normalize_weak(&a[i].y);\n+        secp256k1_ge_verify(&a[i]);",
      "path": "src/group_impl.h",
      "position": null,
      "original_position": 22,
      "commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "original_commit_id": "672b1016ffad59a615eb49b30a6f0d7ad8c4627e",
      "in_reply_to_id": 1259712509,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> Is that what you meant?\r\n\r\nYes, this would decouple the verification from the actual code. (And loops could be in `#ifdef VERIFY`, though any sane compiler would remove the empty loop.)\r\n\r\n> (If yes, maybe good follow-up material?)\r\n\r\nOkay, fair. I'm happy with any way in the end.\r\n\r\nMy thinking was that the advantage of doing it in this PR is that it will be easier to check for reviewers that verification is present everywhere. (The diff of that commit will be large, but noone will need to read the diff; they can just check if the result catches everything.) But I'm convinced of this already because I did the work to go through the `group_impl.h`.\r\n\r\nIf you think a separate PR for this refactor is better, then yet another way to do this would be to have a separate PR *before this PR*. But this may require more rebasing work.\r\n\r\nI believe you can decide best now that you looked into this. ",
      "created_at": "2023-07-14T07:56:01Z",
      "updated_at": "2023-07-14T07:56:01Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#discussion_r1263424158",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1263424158"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 243,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1263590953",
      "pull_request_review_id": 1530076805,
      "id": 1263590953,
      "node_id": "PRRC_kwDOAP4Jqs5LUN4p",
      "diff_hunk": "@@ -231,6 +235,7 @@ static void secp256k1_ge_table_set_globalz(size_t len, secp256k1_ge *a, const se\n         secp256k1_fe_verify(&zr[i]);\n         /* Ensure all y values are in weak normal form for fast negation of points */\n         secp256k1_fe_normalize_weak(&a[i].y);\n+        secp256k1_ge_verify(&a[i]);",
      "path": "src/group_impl.h",
      "position": null,
      "original_position": 22,
      "commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "original_commit_id": "672b1016ffad59a615eb49b30a6f0d7ad8c4627e",
      "in_reply_to_id": 1259712509,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> My thinking was that the advantage of doing it in this PR is that it will be easier to check for reviewers that verification is present everywhere. (The diff of that commit will be large, but noone will need to read the diff; they can just check if the result catches everything.)\r\n\r\nThat makes sense! Thanks for elaborating, the motivation is now clear to me. Added the suggestion in the first commit. Should be quite trivial to review, only the changes in `secp256k1_ge_table_set_globalz` are a bit more invasive, as the initialization of `i` for the backwards loop is now done later, due to `i` also being used for the verification loop of inputs before. But I think that's actually even a slight improvement because we avoid a potential integer underflow for `i` in the case of `len == 0` (even though that's more theoretical, in practice no-one would call that function with a zero-length I guess).\r\n\r\nI decided to put the input/output verification loops in `#ifdef VERIFY`, mostly for visual reasons (I'd also assume that even without those, most compilers would optimize the loops away anyway), but also happy to remove them if wished.",
      "created_at": "2023-07-14T10:48:47Z",
      "updated_at": "2023-07-14T10:48:48Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#discussion_r1263590953",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1263590953"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 243,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1270576343",
      "pull_request_review_id": 1540995608,
      "id": 1270576343,
      "node_id": "PRRC_kwDOAP4Jqs5Lu3TX",
      "diff_hunk": "@@ -352,4 +352,7 @@ static int secp256k1_fe_is_square_var(const secp256k1_fe *a);\n /** Check invariants on a field element (no-op unless VERIFY is enabled). */\n static void secp256k1_fe_verify(const secp256k1_fe *a);\n \n+/** Check that magnitude of a ist at most m (no-op unless VERIFY is enabled). */",
      "path": "src/field.h",
      "position": null,
      "original_position": 4,
      "commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "original_commit_id": "063e2dba1068abed05ee763c4a91b198d89c53b8",
      "in_reply_to_id": null,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "s/ist/is ;)",
      "created_at": "2023-07-21T11:35:37Z",
      "updated_at": "2023-07-21T12:08:54Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#discussion_r1270576343",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1270576343"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 355,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1270581841",
      "pull_request_review_id": 1540995608,
      "id": 1270581841,
      "node_id": "PRRC_kwDOAP4Jqs5Lu4pR",
      "diff_hunk": "@@ -750,34 +749,34 @@ static void secp256k1_gej_add_ge(secp256k1_gej *r, const secp256k1_gej *a, const\n      * non-indeterminate expression for lambda is (y1 - y2)/(x1 - x2),\n      * so we set R/M equal to this. */\n     rr_alt = s1;\n-    secp256k1_fe_mul_int(&rr_alt, 2);       /* rr = Y1*Z2^3 - Y2*Z1^3 (2) */\n-    secp256k1_fe_add(&m_alt, &u1);          /* Malt = X1*Z2^2 - X2*Z1^2 */\n+    secp256k1_fe_mul_int(&rr_alt, 2);       /* rr_alt = Y1*Z2^3 - Y2*Z1^3 (8) */\n+    secp256k1_fe_add(&m_alt, &u1);          /* Malt = X1*Z2^2 - X2*Z1^2 (8) */\n \n-    secp256k1_fe_cmov(&rr_alt, &rr, !degenerate);\n-    secp256k1_fe_cmov(&m_alt, &m, !degenerate);\n+    secp256k1_fe_cmov(&rr_alt, &rr, !degenerate);       /* rr_alt (8) */\n+    secp256k1_fe_cmov(&m_alt, &m, !degenerate);         /* m_alt (5) */",
      "path": "src/group_impl.h",
      "position": null,
      "original_position": 101,
      "commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "original_commit_id": "78cdcb0c504642a2dab2f1bab354224cadf8fe6f",
      "in_reply_to_id": null,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "8 instead of 5?",
      "created_at": "2023-07-21T11:42:41Z",
      "updated_at": "2023-07-21T12:08:54Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#discussion_r1270581841",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1270581841"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 756,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1271179730",
      "pull_request_review_id": 1541947518,
      "id": 1271179730,
      "node_id": "PRRC_kwDOAP4Jqs5LxKnS",
      "diff_hunk": "@@ -352,4 +352,7 @@ static int secp256k1_fe_is_square_var(const secp256k1_fe *a);\n /** Check invariants on a field element (no-op unless VERIFY is enabled). */\n static void secp256k1_fe_verify(const secp256k1_fe *a);\n \n+/** Check that magnitude of a ist at most m (no-op unless VERIFY is enabled). */",
      "path": "src/field.h",
      "position": null,
      "original_position": 4,
      "commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "original_commit_id": "063e2dba1068abed05ee763c4a91b198d89c53b8",
      "in_reply_to_id": 1270576343,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Oops, probably my mind was switching over to german for a moment when I typed this :sweat_smile: Fixed.",
      "created_at": "2023-07-22T00:27:08Z",
      "updated_at": "2023-07-22T00:27:08Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#discussion_r1271179730",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1271179730"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 355,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1271179814",
      "pull_request_review_id": 1541948154,
      "id": 1271179814,
      "node_id": "PRRC_kwDOAP4Jqs5LxKom",
      "diff_hunk": "@@ -750,34 +749,34 @@ static void secp256k1_gej_add_ge(secp256k1_gej *r, const secp256k1_gej *a, const\n      * non-indeterminate expression for lambda is (y1 - y2)/(x1 - x2),\n      * so we set R/M equal to this. */\n     rr_alt = s1;\n-    secp256k1_fe_mul_int(&rr_alt, 2);       /* rr = Y1*Z2^3 - Y2*Z1^3 (2) */\n-    secp256k1_fe_add(&m_alt, &u1);          /* Malt = X1*Z2^2 - X2*Z1^2 */\n+    secp256k1_fe_mul_int(&rr_alt, 2);       /* rr_alt = Y1*Z2^3 - Y2*Z1^3 (8) */\n+    secp256k1_fe_add(&m_alt, &u1);          /* Malt = X1*Z2^2 - X2*Z1^2 (8) */\n \n-    secp256k1_fe_cmov(&rr_alt, &rr, !degenerate);\n-    secp256k1_fe_cmov(&m_alt, &m, !degenerate);\n+    secp256k1_fe_cmov(&rr_alt, &rr, !degenerate);       /* rr_alt (8) */\n+    secp256k1_fe_cmov(&m_alt, &m, !degenerate);         /* m_alt (5) */",
      "path": "src/group_impl.h",
      "position": null,
      "original_position": 101,
      "commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "original_commit_id": "78cdcb0c504642a2dab2f1bab354224cadf8fe6f",
      "in_reply_to_id": 1270581841,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Fixed.",
      "created_at": "2023-07-22T00:27:33Z",
      "updated_at": "2023-07-22T00:27:33Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#discussion_r1271179814",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1271179814"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": null,
      "original_line": 756,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1272217772",
      "pull_request_review_id": 1543416214,
      "id": 1272217772,
      "node_id": "PRRC_kwDOAP4Jqs5L1ICs",
      "diff_hunk": "@@ -501,11 +553,11 @@ static void secp256k1_gej_add_ge_var(secp256k1_gej *r, const secp256k1_gej *a, c\n     }\n \n     secp256k1_fe_sqr(&z12, &a->z);\n-    u1 = a->x; secp256k1_fe_normalize_weak(&u1);\n+    u1 = a->x;\n     secp256k1_fe_mul(&u2, &b->x, &z12);\n-    s1 = a->y; secp256k1_fe_normalize_weak(&s1);\n+    s1 = a->y;\n     secp256k1_fe_mul(&s2, &b->y, &z12); secp256k1_fe_mul(&s2, &s2, &a->z);\n-    secp256k1_fe_negate(&h, &u1, 1); secp256k1_fe_add(&h, &u2);\n+    secp256k1_fe_negate(&h, &u1, 6); secp256k1_fe_add(&h, &u2);",
      "path": "src/group_impl.h",
      "position": 365,
      "original_position": 365,
      "commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "original_commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "in_reply_to_id": null,
      "user": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Better to replace `6` with `SECP256K1_GE_X_MAGNITUDE_MAX`? Same for the `fe_negate` in `secp256k1_gej_add_zinv_var`.",
      "created_at": "2023-07-24T12:48:30Z",
      "updated_at": "2023-07-24T13:00:19Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#discussion_r1272217772",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1272217772"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
        }
      },
      "start_line": null,
      "original_start_line": null,
      "start_side": null,
      "line": 560,
      "original_line": 560,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1272218956",
      "pull_request_review_id": 1543416214,
      "id": 1272218956,
      "node_id": "PRRC_kwDOAP4Jqs5L1IVM",
      "diff_hunk": "@@ -44,6 +44,14 @@ typedef struct {\n \n #define SECP256K1_GE_STORAGE_CONST_GET(t) SECP256K1_FE_STORAGE_CONST_GET(t.x), SECP256K1_FE_STORAGE_CONST_GET(t.y)\n \n+/** Maximum allowed magnitudes for group element coordinates\n+ *  in affine (x, y) and jacobian (x, y, z) representation. */\n+#define SECP256K1_GE_X_MAGNITUDE_MAX  6\n+#define SECP256K1_GE_Y_MAGNITUDE_MAX  4\n+#define SECP256K1_GEJ_X_MAGNITUDE_MAX 6\n+#define SECP256K1_GEJ_Y_MAGNITUDE_MAX 4\n+#define SECP256K1_GEJ_Z_MAGNITUDE_MAX 2",
      "path": "src/group.h",
      "position": 10,
      "original_position": 10,
      "commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "original_commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "in_reply_to_id": null,
      "user": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "How did you arrive at these values? The tightest limits that let the tests pass are\r\n```\r\n#define SECP256K1_GE_X_MAGNITUDE_MAX  4\r\n#define SECP256K1_GE_Y_MAGNITUDE_MAX  3\r\n#define SECP256K1_GEJ_X_MAGNITUDE_MAX 4\r\n#define SECP256K1_GEJ_Y_MAGNITUDE_MAX 4\r\n#define SECP256K1_GEJ_Z_MAGNITUDE_MAX 1\r\n```",
      "created_at": "2023-07-24T12:49:32Z",
      "updated_at": "2023-07-24T13:00:19Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#discussion_r1272218956",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1272218956"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
        }
      },
      "start_line": 47,
      "original_start_line": 47,
      "start_side": "RIGHT",
      "line": 53,
      "original_line": 53,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1272229726",
      "pull_request_review_id": 1543416214,
      "id": 1272229726,
      "node_id": "PRRC_kwDOAP4Jqs5L1K9e",
      "diff_hunk": "@@ -672,17 +727,17 @@ static void secp256k1_gej_add_ge(secp256k1_gej *r, const secp256k1_gej *a, const\n      */\n \n     secp256k1_fe_sqr(&zz, &a->z);                       /* z = Z1^2 */\n-    u1 = a->x; secp256k1_fe_normalize_weak(&u1);        /* u1 = U1 = X1*Z2^2 (1) */\n+    u1 = a->x;                                          /* u1 = U1 = X1*Z2^2 (6) */",
      "path": "src/group_impl.h",
      "position": 440,
      "original_position": 440,
      "commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "original_commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "in_reply_to_id": null,
      "user": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Do you think it makes sense to express the magnitudes in the in terms of the `SECP256K1_GE{,J}_{X,Y,Z}_MAGNITUDE_MAX` constants (both in code and comments)? For the comments it would then make sense to abbreviate these values as, for example, `GE{,J}_{X,Y,Z}_M`, etc.",
      "created_at": "2023-07-24T12:58:58Z",
      "updated_at": "2023-07-24T13:00:19Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#discussion_r1272229726",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1272229726"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
        }
      },
      "start_line": 675,
      "original_start_line": 675,
      "start_side": "LEFT",
      "line": 730,
      "original_line": 730,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1278176857",
      "pull_request_review_id": 1553112520,
      "id": 1278176857,
      "node_id": "PRRC_kwDOAP4Jqs5ML25Z",
      "diff_hunk": "@@ -44,6 +44,14 @@ typedef struct {\n \n #define SECP256K1_GE_STORAGE_CONST_GET(t) SECP256K1_FE_STORAGE_CONST_GET(t.x), SECP256K1_FE_STORAGE_CONST_GET(t.y)\n \n+/** Maximum allowed magnitudes for group element coordinates\n+ *  in affine (x, y) and jacobian (x, y, z) representation. */\n+#define SECP256K1_GE_X_MAGNITUDE_MAX  6\n+#define SECP256K1_GE_Y_MAGNITUDE_MAX  4\n+#define SECP256K1_GEJ_X_MAGNITUDE_MAX 6\n+#define SECP256K1_GEJ_Y_MAGNITUDE_MAX 4\n+#define SECP256K1_GEJ_Z_MAGNITUDE_MAX 2",
      "path": "src/group.h",
      "position": 10,
      "original_position": 10,
      "commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "original_commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "in_reply_to_id": 1272218956,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Good question. I took these limits over from the original PR by @peterdettman (#1032) without further evaluation. Even on that PR, I verified that with the limits (4,3) and (4,4,1) the tests still pass, so no idea where the (6,4)/(6,4,2) limits were originally coming from. (My best guess would be that in the earliest version of the PR, those were the tightest limits where test would pass?!).",
      "created_at": "2023-07-28T23:49:19Z",
      "updated_at": "2023-07-28T23:49:19Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#discussion_r1278176857",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1278176857"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
        }
      },
      "start_line": 47,
      "original_start_line": 47,
      "start_side": "RIGHT",
      "line": 53,
      "original_line": 53,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1278176894",
      "pull_request_review_id": 1553112562,
      "id": 1278176894,
      "node_id": "PRRC_kwDOAP4Jqs5ML25-",
      "diff_hunk": "@@ -672,17 +727,17 @@ static void secp256k1_gej_add_ge(secp256k1_gej *r, const secp256k1_gej *a, const\n      */\n \n     secp256k1_fe_sqr(&zz, &a->z);                       /* z = Z1^2 */\n-    u1 = a->x; secp256k1_fe_normalize_weak(&u1);        /* u1 = U1 = X1*Z2^2 (1) */\n+    u1 = a->x;                                          /* u1 = U1 = X1*Z2^2 (6) */",
      "path": "src/group_impl.h",
      "position": 440,
      "original_position": 440,
      "commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "original_commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "in_reply_to_id": 1272229726,
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "This sounds like a good idea, as it would avoid the tedious work of adapting the comments if the magnitude limits ever change in the future. On the other hand, the expressions get quite long at the end, e.g. `((GEJ_Y_M+3)/2 + 1)` for the last annotation in `secp256k1_gej_add_ge` (instruction `secp256k1_fe_half(&r->y);`), not sure if this is still that helpful for the reader in constrast to a concrete magnitude number.",
      "created_at": "2023-07-28T23:49:27Z",
      "updated_at": "2023-07-28T23:49:27Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#discussion_r1278176894",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1278176894"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
        }
      },
      "start_line": 675,
      "original_start_line": 675,
      "start_side": "LEFT",
      "line": 730,
      "original_line": 730,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1278220147",
      "pull_request_review_id": 1553168846,
      "id": 1278220147,
      "node_id": "PRRC_kwDOAP4Jqs5MMBdz",
      "diff_hunk": "@@ -44,6 +44,14 @@ typedef struct {\n \n #define SECP256K1_GE_STORAGE_CONST_GET(t) SECP256K1_FE_STORAGE_CONST_GET(t.x), SECP256K1_FE_STORAGE_CONST_GET(t.y)\n \n+/** Maximum allowed magnitudes for group element coordinates\n+ *  in affine (x, y) and jacobian (x, y, z) representation. */\n+#define SECP256K1_GE_X_MAGNITUDE_MAX  6\n+#define SECP256K1_GE_Y_MAGNITUDE_MAX  4\n+#define SECP256K1_GEJ_X_MAGNITUDE_MAX 6\n+#define SECP256K1_GEJ_Y_MAGNITUDE_MAX 4\n+#define SECP256K1_GEJ_Z_MAGNITUDE_MAX 2",
      "path": "src/group.h",
      "position": 10,
      "original_position": 10,
      "commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "original_commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "in_reply_to_id": 1272218956,
      "user": {
        "login": "peterdettman",
        "id": 3423981,
        "node_id": "MDQ6VXNlcjM0MjM5ODE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3423981?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/peterdettman",
        "html_url": "https://github.com/peterdettman",
        "followers_url": "https://api.github.com/users/peterdettman/followers",
        "following_url": "https://api.github.com/users/peterdettman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/peterdettman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/peterdettman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/peterdettman/subscriptions",
        "organizations_url": "https://api.github.com/users/peterdettman/orgs",
        "repos_url": "https://api.github.com/users/peterdettman/repos",
        "events_url": "https://api.github.com/users/peterdettman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/peterdettman/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "> Good question. I took these limits over from the original PR by @peterdettman (#1032) without further evaluation. Even on that PR, I verified that with the limits (4,3) and (4,4,1) the tests still pass, so no idea where the (6,4)/(6,4,2) limits were originally coming from. (My best guess would be that in the earliest version of the PR, those were the tightest limits where test would pass?!).\r\n\r\nThere is an inherent tension between tight limits, which might enable optimizations at method entry, and more generous limits, which might enable optimizations at method exit.\r\n\r\nThe true initial choice of limit was 8, to reflect the tacit assumption throughout the existing group code that it was safe to immediately (i.e. without normalization) mul/sqr any coordinate(s). Abstractly the intention was then to conservatively tighten the limits as necessary to enable specific method-entry optimizations without adding method-exit costs.\r\n\r\nThe only actual optimization applied was the one in the original PR removing the need to _normalize_weak as part of u1, u2 calculations in group addition. This leads to the choice of 6 for x, y.\r\n\r\nMy memory fails me as to the choice of 4 for z, but it might make sense that I was contemplating a possible implementation that calculates the output z using the form (a+b)^2 - a^2 - b^2 (instead of 2.a.b).\r\n",
      "created_at": "2023-07-29T02:56:56Z",
      "updated_at": "2023-07-29T02:56:57Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#discussion_r1278220147",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1278220147"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
        }
      },
      "start_line": 47,
      "original_start_line": 47,
      "start_side": "RIGHT",
      "line": 53,
      "original_line": 53,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1278267598",
      "pull_request_review_id": 1553231519,
      "id": 1278267598,
      "node_id": "PRRC_kwDOAP4Jqs5MMNDO",
      "diff_hunk": "@@ -672,17 +727,17 @@ static void secp256k1_gej_add_ge(secp256k1_gej *r, const secp256k1_gej *a, const\n      */\n \n     secp256k1_fe_sqr(&zz, &a->z);                       /* z = Z1^2 */\n-    u1 = a->x; secp256k1_fe_normalize_weak(&u1);        /* u1 = U1 = X1*Z2^2 (1) */\n+    u1 = a->x;                                          /* u1 = U1 = X1*Z2^2 (6) */",
      "path": "src/group_impl.h",
      "position": 440,
      "original_position": 440,
      "commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "original_commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "in_reply_to_id": 1272229726,
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "I think the version with constants is slightly better.",
      "created_at": "2023-07-29T08:20:59Z",
      "updated_at": "2023-07-29T08:20:59Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#discussion_r1278267598",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1278267598"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
        }
      },
      "start_line": 675,
      "original_start_line": 675,
      "start_side": "LEFT",
      "line": 730,
      "original_line": 730,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1278281619",
      "pull_request_review_id": 1553261704,
      "id": 1278281619,
      "node_id": "PRRC_kwDOAP4Jqs5MMQeT",
      "diff_hunk": "@@ -44,6 +44,14 @@ typedef struct {\n \n #define SECP256K1_GE_STORAGE_CONST_GET(t) SECP256K1_FE_STORAGE_CONST_GET(t.x), SECP256K1_FE_STORAGE_CONST_GET(t.y)\n \n+/** Maximum allowed magnitudes for group element coordinates\n+ *  in affine (x, y) and jacobian (x, y, z) representation. */\n+#define SECP256K1_GE_X_MAGNITUDE_MAX  6\n+#define SECP256K1_GE_Y_MAGNITUDE_MAX  4\n+#define SECP256K1_GEJ_X_MAGNITUDE_MAX 6\n+#define SECP256K1_GEJ_Y_MAGNITUDE_MAX 4\n+#define SECP256K1_GEJ_Z_MAGNITUDE_MAX 2",
      "path": "src/group.h",
      "position": 10,
      "original_position": 10,
      "commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "original_commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "in_reply_to_id": 1272218956,
      "user": {
        "login": "peterdettman",
        "id": 3423981,
        "node_id": "MDQ6VXNlcjM0MjM5ODE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3423981?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/peterdettman",
        "html_url": "https://github.com/peterdettman",
        "followers_url": "https://api.github.com/users/peterdettman/followers",
        "following_url": "https://api.github.com/users/peterdettman/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/peterdettman/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/peterdettman/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/peterdettman/subscriptions",
        "organizations_url": "https://api.github.com/users/peterdettman/orgs",
        "repos_url": "https://api.github.com/users/peterdettman/repos",
        "events_url": "https://api.github.com/users/peterdettman/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/peterdettman/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Oops, not sure why I thought the original PR had z magnitude limit of 4. Anyway the choice was just based on the various extant group formulae at the time.\r\n",
      "created_at": "2023-07-29T10:11:50Z",
      "updated_at": "2023-07-29T10:11:51Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#discussion_r1278281619",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1278281619"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
        }
      },
      "start_line": 47,
      "original_start_line": 47,
      "start_side": "RIGHT",
      "line": 53,
      "original_line": 53,
      "side": "RIGHT"
    },
    {
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1279232666",
      "pull_request_review_id": 1554672782,
      "id": 1279232666,
      "node_id": "PRRC_kwDOAP4Jqs5MP4qa",
      "diff_hunk": "@@ -44,6 +44,14 @@ typedef struct {\n \n #define SECP256K1_GE_STORAGE_CONST_GET(t) SECP256K1_FE_STORAGE_CONST_GET(t.x), SECP256K1_FE_STORAGE_CONST_GET(t.y)\n \n+/** Maximum allowed magnitudes for group element coordinates\n+ *  in affine (x, y) and jacobian (x, y, z) representation. */\n+#define SECP256K1_GE_X_MAGNITUDE_MAX  6\n+#define SECP256K1_GE_Y_MAGNITUDE_MAX  4\n+#define SECP256K1_GEJ_X_MAGNITUDE_MAX 6\n+#define SECP256K1_GEJ_Y_MAGNITUDE_MAX 4\n+#define SECP256K1_GEJ_Z_MAGNITUDE_MAX 2",
      "path": "src/group.h",
      "position": 10,
      "original_position": 10,
      "commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "original_commit_id": "31bc9a434811d9d2c0a8058c93957c365b39089b",
      "in_reply_to_id": 1272218956,
      "user": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false
      },
      "body": "Thanks @peterdettman. The argument that it's a trade-off makes sense. The tighter limits don't add any method-exit costs though. Did you have any specific change in mind that would introduce method-exit costs when using the tighter limits?",
      "created_at": "2023-07-31T12:36:42Z",
      "updated_at": "2023-07-31T12:36:42Z",
      "html_url": "https://github.com/bitcoin-core/secp256k1/pull/1348#discussion_r1279232666",
      "author_association": "CONTRIBUTOR",
      "_links": {
        "self": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/comments/1279232666"
        },
        "pull_request": {
          "href": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/1348"
        }
      },
      "start_line": 47,
      "original_start_line": 47,
      "start_side": "RIGHT",
      "line": 53,
      "original_line": 53,
      "side": "RIGHT"
    }
  ]
}