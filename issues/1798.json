{
  "type": "issue",
  "issue": {
    "id": 3800246232,
    "node_id": "I_kwDOAP4Jqs7igyfY",
    "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1798",
    "repository_url": "https://api.github.com/repos/bitcoin-core/secp256k1",
    "labels_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1798/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1798/comments",
    "events_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1798/events",
    "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1798",
    "number": 1798,
    "state": "open",
    "state_reason": null,
    "title": "Documentation: GLV lattice constants are Eisenstein integer factors of group order",
    "body": "### Summary\n\nThe GLV decomposition in `scalar_impl.h` uses constants `a1, b1, a2, b2` that form the reduced lattice basis. These constants have a beautiful number-theoretic interpretation that is currently undocumented: they are exactly the **Eisenstein integer factors** of the group order `n`.\n\n### Background\n\nThe code already notes:\n```c\nLet l = -1/2 + i*sqrt(3)/2, the complex root of X^2 + X + 1.\n```\n\nWhat isn't mentioned is that `Z[l]` is classically known as the **Eisenstein integers** `Z[ω]`, studied by Gotthold Eisenstein in 1844. This ring has unique factorization, and primes `p ≡ 1 (mod 3)` split as `p = π·π̄ = a² + ab + b²`.\n\n### The Connection\n\nThe secp256k1 group order `n` factors in `Z[ω]` as:\n\n```\nn = N(π) = π · π̄   where   π = a - bω\n```\n\nUsing the standard Eisenstein norm `N(x + yω) = x² - xy + y²`, we have:\n```\nN(a - bω) = a² - a(-b) + (-b)² = a² + ab + b² = n\n```\n\nwhere:\n```\na = 303414439467246543595250775667605759171   (128 bits)\nb = 64502973549206556628585045361533709077    (126 bits)\n```\n\n**The GLV basis constants are exactly these Eisenstein factors:**\n\n| Constant | Value | Eisenstein factor |\n|----------|-------|-------------------|\n| a1 | `0x3086d221a7d46bcde86c90e49284eb15` | b |\n| -b1 | `0xe4437ed6010e88286f547fa90abfe4c3` | a |\n| a2 | `0x114ca50f7a8e2f3f657c1108d9d44cfd8` | a + b |\n| b2 | `0x3086d221a7d46bcde86c90e49284eb15` | b |\n\n### Verification (SageMath)\n\n```python\nn = 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141\na = 303414439467246543595250775667605759171\nb = 64502973549206556628585045361533709077\n\n# Verify norm formula\nassert a^2 + a*b + b^2 == n  # ✓\n\n# Verify in Eisenstein ring\nK.<w> = NumberField(x^2 + x + 1)\npi = a - b*w  # Note: π = a - bω\nassert pi.norm() == n  # ✓\n\n# GLV constants from libsecp256k1\na1 = 0x3086d221a7d46bcde86c90e49284eb15\nb1_neg = 0xe4437ed6010e88286f547fa90abfe4c3\n\nassert a1 == b      # ✓\nassert b1_neg == a  # ✓\n```\n\n### Why This Matters\n\n1. **Independent verification**: The constants can be verified through Eisenstein factorization, not just derived from Frobenius trace\n2. **Educational value**: Connects modern ECC optimization to classical algebraic number theory (1844)\n3. **Mathematical elegance**: The GLV lattice is literally the kernel of the ring homomorphism `Z[ω] → Z_n`\n\n### Suggested Documentation Addition\n\nAdd to the existing comment in `scalar_impl.h`:\n\n```c\n/*\n * Note: Z[l] is classically known as the ring of Eisenstein integers Z[ω],\n * studied by Gotthold Eisenstein (1844). The group order n factors in this\n * ring as n = N(π) where π = a - b*l is an Eisenstein prime with norm\n * N(a - b*l) = a² + ab + b². The lattice basis vectors {a1 + b1*l, a2 + b2*l}\n * correspond exactly to these factors: a1 = b, -b1 = a, a2 = a + b, b2 = b.\n *\n * This provides an independent verification path for the constants through\n * classical algebraic number theory.\n */\n```\n\n### References\n\n- Eisenstein, G. (1844). \"Beweis der allgemeinsten Reciprocitätsgesetze\"\n- Gallant, R., Lambert, R., Vanstone, S. (2001). \"Faster Point Multiplication on Elliptic Curves with Efficient Endomorphisms\"\n- Cox, D. \"Primes of the Form x² + ny²\" — Chapter on Eisenstein integers\n\n---\n\n*This observation connects two mathematical traditions that developed independently: 19th-century algebraic number theory and 21st-century elliptic curve cryptography.*",
    "user": {
      "login": "Justsomebuddy",
      "id": 226256829,
      "node_id": "U_kgDODXxnvQ",
      "avatar_url": "https://avatars.githubusercontent.com/u/226256829?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Justsomebuddy",
      "html_url": "https://github.com/Justsomebuddy",
      "followers_url": "https://api.github.com/users/Justsomebuddy/followers",
      "following_url": "https://api.github.com/users/Justsomebuddy/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/Justsomebuddy/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/Justsomebuddy/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/Justsomebuddy/subscriptions",
      "organizations_url": "https://api.github.com/users/Justsomebuddy/orgs",
      "repos_url": "https://api.github.com/users/Justsomebuddy/repos",
      "events_url": "https://api.github.com/users/Justsomebuddy/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/Justsomebuddy/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "labels": [],
    "assignees": [],
    "author_association": "NONE",
    "locked": false,
    "comments": 1,
    "created_at": "2026-01-10T19:23:38Z",
    "updated_at": "2026-01-13T14:08:40Z"
  },
  "events": [
    {
      "event": "commented",
      "id": 3744537019,
      "node_id": "IC_kwDOAP4Jqs7fMRm7",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3744537019",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-13T14:08:40Z",
      "updated_at": "2026-01-13T14:08:40Z",
      "author_association": "CONTRIBUTOR",
      "body": "This is certainly interesting, but I'm not convinced that this is a meaningful insight to readers of our code. If anything, I believe we could verify this fact in https://github.com/bitcoin-core/secp256k1/blob/master/sage/gen_split_lambda_constants.sage instead of changing the C comments.\n\nCan I ask you whether an LLM was used when creating this issue? If so, how? ",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1798#issuecomment-3744537019",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1798"
    }
  ]
}