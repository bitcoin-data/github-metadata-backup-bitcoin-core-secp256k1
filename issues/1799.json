{
  "type": "issue",
  "issue": {
    "id": 3800673492,
    "node_id": "I_kwDOAP4Jqs7iiazU",
    "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799",
    "repository_url": "https://api.github.com/repos/bitcoin-core/secp256k1",
    "labels_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799/comments",
    "events_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799/events",
    "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799",
    "number": 1799,
    "state": "open",
    "state_reason": "reopened",
    "title": "Silent Payments module: discussion about different scanning approaches (BIP, LabelSet, hybrid)",
    "body": "As suggested in https://github.com/bitcoin-core/secp256k1/pull/1792#issuecomment-3709076530, this issue is created to discuss different scanning approaches for Silent Payments. Currently PRs for both the BIP and LabelSet approaches are open:\n* https://github.com/bitcoin-core/secp256k1/pull/1765\n* https://github.com/bitcoin-core/secp256k1/pull/1792\n\nA prototype implementation of the hybrid approach is available at https://github.com/w0xlt/secp256k1/commit/6c76c7c5fa30c5fa7676511de22c47953ee76bd1#diff-4d053be8d1f6d948b412f26ae89711a9dcd2a2683da581cb52b9f6757480361b\n\nSee https://gist.github.com/theStack/25c77747838610931e8bbeb9d76faf78 for a summary, and https://github.com/theStack/secp256k1lab/blob/add_bip352_module_review_helper/src/secp256k1lab/bip352.py for a Python implementation based on secp256k1lab.\n\nAs the BIP approach suffers from [the worst-case scanning attack](https://github.com/bitcoin-core/secp256k1/pull/1698#pullrequestreview-3341766084), following the LabelSet approach with a limit on labels to scan for is the currently suggested way to proceed.",
    "user": {
      "login": "theStack",
      "id": 91535,
      "node_id": "MDQ6VXNlcjkxNTM1",
      "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theStack",
      "html_url": "https://github.com/theStack",
      "followers_url": "https://api.github.com/users/theStack/followers",
      "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
      "organizations_url": "https://api.github.com/users/theStack/orgs",
      "repos_url": "https://api.github.com/users/theStack/repos",
      "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/theStack/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "labels": [
      {
        "id": 4975353639,
        "node_id": "LA_kwDOAP4Jqs8AAAABKI3fJw",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/labels/feature",
        "name": "feature",
        "description": "",
        "color": "731E95",
        "default": false
      },
      {
        "id": 4975389731,
        "node_id": "LA_kwDOAP4Jqs8AAAABKI5sIw",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/labels/performance",
        "name": "performance",
        "description": "",
        "color": "DE3CCC",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "locked": false,
    "comments": 54,
    "closed_by": {
      "login": "real-or-random",
      "id": 1071625,
      "node_id": "MDQ6VXNlcjEwNzE2MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/real-or-random",
      "html_url": "https://github.com/real-or-random",
      "followers_url": "https://api.github.com/users/real-or-random/followers",
      "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
      "organizations_url": "https://api.github.com/users/real-or-random/orgs",
      "repos_url": "https://api.github.com/users/real-or-random/repos",
      "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/real-or-random/received_events",
      "type": "User",
      "site_admin": false,
      "name": null,
      "patch_url": null
    },
    "created_at": "2026-01-11T03:21:12Z",
    "updated_at": "2026-02-12T15:56:17Z"
  },
  "events": [
    {
      "event": "commented",
      "id": 3733945443,
      "node_id": "IC_kwDOAP4Jqs7ej3xj",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3733945443",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-11T03:39:09Z",
      "updated_at": "2026-01-11T03:39:09Z",
      "author_association": "CONTRIBUTOR",
      "body": "Answering comments https://github.com/bitcoin-core/secp256k1/pull/1792#issuecomment-3709076530 and https://github.com/bitcoin-core/secp256k1/pull/1792#issuecomment-3728203838 here (to keep the discussion in #1792 focused on the LabelSet PR):\n\n@Sjors:\n\n> I think it's fine to initially go for the LabelSet approach, since many current implementations are mobile, which means they benefit from the safety this provides and won't run into the label limit anytime soon.\n\nI agree.\n\n> I do think that hybrid approach is useful. Someone who goes through the trouble of automating label generation might happily add some CPU cores if lets them avoid the complexity of splitting their users across multiple watch keys. Especially if the cost of an attack far outweighs the cost to deal with it.\n\nWhat makes the hybrid approach somewhat unattractive in my opinion is the very clunky API. Users have to pass in the labels information twice, providing both a list of labels and a label cache lookup callback function. The two underlying data structures also have to be maintained and kept in sync accordingly by the user. I would say that this clearly doesn't meet the \"hard to misuse API\" goal that we usually try to follow in this library.\n\n> We could document the hardware required to guarantee that a worst case block takes less than 10 minutes to process. For the hybrid approach that's just a single number IIUC. For the LabelSet approach it's a function of L. With that in place a warning should be enough IMO, for L > ? based on lower end hardware (mobile) and e.g. a 10 second worst case.\n\nDocumenting this makes sense yeah. With \"warning\", I guess you mean something purely in the docs, or is there another way during run-time? (I can't think of any).\n\n@Eunovo:\n\n> I had an offline conversation with @RubenSomsen about this. The conversations around the scanning approaches have been focused on the time it takes to complete a tx scan, but it's also important that we consider the time it takes to scan an entire Block.\n\nThe current per-transaction insights/benchmarks also apply for blocks, if all transactions in a block were equally-sized in terms of number of outputs. That's of course a simplifying assumption, but I think one that is good enough to give a rough estimate in terms of EC point addition cost for common scenarios (see examples below).\n\n> BIP-style scanning scales with the number of outputs, independently of the number of transactions.\n>\n> LabelSet scanning scales with the number of labels * the number of transactions. LabelSet will be Fast when you scan Blocks with few transactions and few labels, but it will get slower compared to BIP-style scanning as the number of transactions increases, even without an increase in the number of labels.\n\nRight. I think what you state is ultimately just a different way of expressing the per-transaction turn-over point inequation $L < 2 * N$ (indicating when LabelSet is faster than BIP), where \"few transactions per block\" maps to a higher N value, and \"high number of transactions per block\" to a lower N value.\n\nTwo concrete example calculations, showing that for up to a few labels, LabelSet approach should be a bit faster:\n* The best-case scenario for the BIP approach is if every transaction consists of only one output (high number of txs per block). Even in that case, for the single-label scenario, the BIP approach has to do twice as many EC point additions per block as for the LabelSet approach (L=1,N=1 => num_txs * 1 < num_txs * 2).\n* A much more realistic scenario is probably to assume that every transaction consists of two outputs (due to change). In that case, scanning up to 3 labels is still faster than the BIP approach (L=3,N=2 => num_txs * 3 < num_txs * 4).\n\n> I think we should do more Block scanning benchmarks. I am interested in doing this myself next week. I can use LabelSet scanning in https://github.com/bitcoin/bitcoin/pull/32966 and benchmark Block scanning times.\n\nThat's a good idea, looking forward to see results on real-world block data.",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3733945443",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "mentioned",
      "id": 21967788466,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUdYdmy",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/21967788466",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-11T03:39:10Z"
    },
    {
      "event": "subscribed",
      "id": 21967788469,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUdYdm1",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/21967788469",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-11T03:39:10Z"
    },
    {
      "event": "mentioned",
      "id": 21967788478,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUdYdm-",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/21967788478",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-11T03:39:10Z"
    },
    {
      "event": "subscribed",
      "id": 21967788483,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUdYdnD",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/21967788483",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-11T03:39:10Z"
    },
    {
      "event": "mentioned",
      "id": 21967788487,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUdYdnH",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/21967788487",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-11T03:39:10Z"
    },
    {
      "event": "subscribed",
      "id": 21967788491,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUdYdnL",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/21967788491",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-11T03:39:10Z"
    },
    {
      "event": "commented",
      "id": 3736792480,
      "node_id": "IC_kwDOAP4Jqs7euu2g",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3736792480",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-12T03:53:48Z",
      "updated_at": "2026-01-12T03:53:48Z",
      "author_association": "MEMBER",
      "body": "> What makes the hybrid approach somewhat unattractive in my opinion is the very clunky API.\n\nI'm not wedded to the particular API, but it's nice to have something with the same scaling properties. But if it's only recommend for power users, having the API be a bit clunky might be acceptable.\n\n> > We could document the hardware required to guarantee that a worst case block takes less than 10 minutes to process. [...]\n> \n> Documenting this makes sense yeah. With \"warning\", I guess you mean something purely in the docs, or is there another way during run-time? (I can't think of any).\n\nJust docs.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3736792480",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "subscribed",
      "id": 21988090045,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUel6C9",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/21988090045",
      "actor": {
        "login": "nymius",
        "id": 155548262,
        "node_id": "U_kgDOCUV6Zg",
        "avatar_url": "https://avatars.githubusercontent.com/u/155548262?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nymius",
        "html_url": "https://github.com/nymius",
        "followers_url": "https://api.github.com/users/nymius/followers",
        "following_url": "https://api.github.com/users/nymius/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nymius/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nymius/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nymius/subscriptions",
        "organizations_url": "https://api.github.com/users/nymius/orgs",
        "repos_url": "https://api.github.com/users/nymius/repos",
        "events_url": "https://api.github.com/users/nymius/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nymius/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-12T12:16:21Z"
    },
    {
      "event": "subscribed",
      "id": 21992122861,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUe1Snt",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/21992122861",
      "actor": {
        "login": "fjahr",
        "id": 1322187,
        "node_id": "MDQ6VXNlcjEzMjIxODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fjahr",
        "html_url": "https://github.com/fjahr",
        "followers_url": "https://api.github.com/users/fjahr/followers",
        "following_url": "https://api.github.com/users/fjahr/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fjahr/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fjahr/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
        "organizations_url": "https://api.github.com/users/fjahr/orgs",
        "repos_url": "https://api.github.com/users/fjahr/repos",
        "events_url": "https://api.github.com/users/fjahr/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fjahr/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-12T15:08:40Z"
    },
    {
      "event": "subscribed",
      "id": 22074618294,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUjv_G2",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22074618294",
      "actor": {
        "login": "stratospher",
        "id": 44024636,
        "node_id": "MDQ6VXNlcjQ0MDI0NjM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/44024636?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/stratospher",
        "html_url": "https://github.com/stratospher",
        "followers_url": "https://api.github.com/users/stratospher/followers",
        "following_url": "https://api.github.com/users/stratospher/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/stratospher/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/stratospher/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/stratospher/subscriptions",
        "organizations_url": "https://api.github.com/users/stratospher/orgs",
        "repos_url": "https://api.github.com/users/stratospher/repos",
        "events_url": "https://api.github.com/users/stratospher/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/stratospher/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-15T16:44:00Z"
    },
    {
      "event": "commented",
      "id": 3769144034,
      "node_id": "IC_kwDOAP4Jqs7gqJLi",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3769144034",
      "actor": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-19T16:11:37Z",
      "updated_at": "2026-01-22T11:01:10Z",
      "author_association": "CONTRIBUTOR",
      "body": "My working assumption is that we ultimately want to support many labels for some use cases and also optimize for few-label wallets. Hence, looking at @theStack's benchmarks, in the long run we should have both the BIP approach and the labelset approach (thanks @w0xlt for coming up with this!).\n\nAs we've discussed, the BIP approach suffers from a quadratic scaling issue under adversarially created transactions. I believe we can address this relatively easily, and I'd prefer to do so before shipping the BIP approach. It would be great to hear thoughts from the BIP authors on this (@RubenSomsen, @josibake). I've discussed possible mitigations with @real-or-random and the ~~most straightforward option seems to be to put a limit on `k`. I do not think this would prevent any realistic use case (I even struggle to imagine a use case that requires more than one `k`)~~ (EDIT: this was based on a misunderstanding, see below). We could run some worst case benchmarks to find a reasonable limit.\n\nI haven't yet looked at the proposed hybrid approach (implementing both approaches under a unified API). What are the advantages? The downside, as mentioned by @theStack, appears to be a clunky API. If there isn't a compelling benefit, I'd lean toward implementing one approach at a time.\n",
      "user": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3769144034",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "mentioned",
      "id": 22142360044,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUnyZns",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22142360044",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-19T16:11:41Z"
    },
    {
      "event": "subscribed",
      "id": 22142360059,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUnyZn7",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22142360059",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-19T16:11:41Z"
    },
    {
      "event": "mentioned",
      "id": 22142360089,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUnyZoZ",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22142360089",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-19T16:11:41Z"
    },
    {
      "event": "subscribed",
      "id": 22142360108,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUnyZos",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22142360108",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-19T16:11:41Z"
    },
    {
      "event": "mentioned",
      "id": 22142360143,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUnyZpP",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22142360143",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-19T16:11:41Z"
    },
    {
      "event": "subscribed",
      "id": 22142360166,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUnyZpm",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22142360166",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-19T16:11:41Z"
    },
    {
      "event": "mentioned",
      "id": 22142360199,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUnyZqH",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22142360199",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-19T16:11:41Z"
    },
    {
      "event": "subscribed",
      "id": 22142360226,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUnyZqi",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22142360226",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-19T16:11:41Z"
    },
    {
      "event": "mentioned",
      "id": 22142360270,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUnyZrO",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22142360270",
      "actor": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-19T16:11:41Z"
    },
    {
      "event": "subscribed",
      "id": 22142360289,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUnyZrh",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22142360289",
      "actor": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-19T16:11:41Z"
    },
    {
      "event": "commented",
      "id": 3773155788,
      "node_id": "IC_kwDOAP4Jqs7g5cnM",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3773155788",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-20T14:27:09Z",
      "updated_at": "2026-01-20T14:27:09Z",
      "author_association": "NONE",
      "body": "I calculated the theoretical numbers for comparison. You can view them [here](https://gist.github.com/RubenSomsen/1e827ee6b48a2e4d489d80b400a461de). I'll be referring to these numbers throughout.\n\nLabels allow the recipient to distinguish the source of funds, without requiring another silent payments address (which would scale linearly - 10 addresses means 10x the scanning cost). I think communicating the functionality to users will be a bit of a challenge because it's hard for people to wrap their head arounds the fact that using a different label for the same address still means the address can be linked to the same user (perhaps a name change will help - \"tagged addresses\"?), but regardless, it's clearly a useful feature and it's crucial for non-donation use cases where recipients need to know who paid them (e.g. an exchange receiving funds from users).\n\nHypothetically, if we ignored the issue of the worst-case targeted attack and I had to pick one algorithm, my strong inclination would be to go with the BIP style approach. The primary reason for this is that we get a clear and consistent upper bound on the maximum scanning cost for all users, irrespective of their label usage. The numbers reveal that we only lose a minor amount of performance for users that don't use labels. This performance can be regained in the future by supporting both algorithms.\n\nBut of course we're talking about this because the issue has been hard to ignore. The numbers show that a worst-case targeted attack block is nearly 360x slower (@Eunovo had this benchmarked at 4 minutes on his laptop) than a non-targeted worst-case block.\n\nIf we wanted to work around it, there is one \"soft\" approach - (1) let the API call contain a limited range for K so it has to be called repeatedly. This basically pushes the problem to wallets, which have to decide if and how to communicate this to the user (e.g., \"An unusually large tx contained at least X outputs for you. It's slow to scan but so far contained Y sats. Want to continue?\").\n\nA more strict approach is to simply (2) limit K in the BIP. Technically this is a backwards incompatible change, but in practice no wallets have supported sending multiple outputs to the same recipient so it seems safe to assume this won't have any practical impact. This does raise the question of what we would limit K to. @Sjors came up with a theoretical scenario where users from one exchange are sending money to another exchange, causing a single transaction with lots of different outputs to the same recipient. At K = 1000, I imagine even this type of scenario would be comfortably covered, but this results in 30x slower block validation (~20 seconds?). What upper bound are we willing to accept for the targeted attack?\n\nThe other approach is to (3) go with the LabelSet approach and limit the use of labels. Again, we'd be faced with having to determine a limit, but this time it seems really inevitable it will limit functionality. If we wanted to match the same non-targeted upper bound as the BIP style approach, this would result in a very conservative label limit of 12. And whatever limit we'd pick, if we put it in the BIP, then any future implementation that does want a higher limit will not be BIP compliant.\n\nNote I think even with the BIP style approach we could be more clear about label usage. Currently there is a very non-committal reference to 100k labels (resulting in a ~4MB lookup table) in the BIP. By default, I'd like for most scanning tools to either scan for no labels other than the change label (primarily light clients because to them label usage has bandwidth overhead), or 100k labels. Anyone who wants to go over 100k (or derive labels in a non-standard way) is on their own.\n\nFinally, there is also the idea of (4) putting a lower limit on the number of sats in an eligible output. I think putting this in the BIP is difficult because any reasonable definition of dust would change with the BTC price, and I'm inclined not to explicitly push for this at the wallet level either, but it does make the attack more costly. At the current dust limit, the attacker has to send ~$7000 worth of sats to the (lucky?) victim. On top of that they have to pay one block's worth of fees, though this can be as low as a few hundred dollars.\n\nPersonally, I feel (2) is the most clear-cut approach, assuming we can agree on a reasonable limit for K, but perhaps (1) is also a decent middle ground if we feel the attack is not all that practical but still want to do something about it.\n\nI'd also like to take this moment to appoint @theStack co-author of BIP352. I think he's proven himself more than capable, and with @josibake's current reduced involvement I think it will greatly help move things forward.",
      "user": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3773155788",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "mentioned",
      "id": 22163028771,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUpBPsj",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22163028771",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-20T14:27:11Z"
    },
    {
      "event": "subscribed",
      "id": 22163028812,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUpBPtM",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22163028812",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-20T14:27:11Z"
    },
    {
      "event": "mentioned",
      "id": 22163028862,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUpBPt-",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22163028862",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-20T14:27:11Z"
    },
    {
      "event": "subscribed",
      "id": 22163028894,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUpBPue",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22163028894",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-20T14:27:11Z"
    },
    {
      "event": "mentioned",
      "id": 22163028935,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUpBPvH",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22163028935",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-20T14:27:11Z"
    },
    {
      "event": "subscribed",
      "id": 22163028958,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUpBPve",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22163028958",
      "actor": {
        "login": "josibake",
        "id": 7444140,
        "node_id": "MDQ6VXNlcjc0NDQxNDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7444140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/josibake",
        "html_url": "https://github.com/josibake",
        "followers_url": "https://api.github.com/users/josibake/followers",
        "following_url": "https://api.github.com/users/josibake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/josibake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/josibake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/josibake/subscriptions",
        "organizations_url": "https://api.github.com/users/josibake/orgs",
        "repos_url": "https://api.github.com/users/josibake/repos",
        "events_url": "https://api.github.com/users/josibake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/josibake/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-20T14:27:11Z"
    },
    {
      "event": "mentioned",
      "id": 22163028999,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUpBPwH",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22163028999",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-20T14:27:11Z"
    },
    {
      "event": "subscribed",
      "id": 22163029026,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUpBPwi",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22163029026",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-20T14:27:11Z"
    },
    {
      "event": "subscribed",
      "id": 22169756984,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUpa6U4",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22169756984",
      "actor": {
        "login": "jsarenik",
        "id": 244565,
        "node_id": "MDQ6VXNlcjI0NDU2NQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/244565?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jsarenik",
        "html_url": "https://github.com/jsarenik",
        "followers_url": "https://api.github.com/users/jsarenik/followers",
        "following_url": "https://api.github.com/users/jsarenik/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jsarenik/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jsarenik/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jsarenik/subscriptions",
        "organizations_url": "https://api.github.com/users/jsarenik/orgs",
        "repos_url": "https://api.github.com/users/jsarenik/repos",
        "events_url": "https://api.github.com/users/jsarenik/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jsarenik/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-20T19:03:08Z"
    },
    {
      "event": "commented",
      "id": 3778552386,
      "node_id": "IC_kwDOAP4Jqs7hOCJC",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3778552386",
      "actor": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-21T14:53:53Z",
      "updated_at": "2026-01-21T14:53:53Z",
      "author_association": "CONTRIBUTOR",
      "body": "Thanks for weighing in @RubenSomsen. I have a clarifying question:\n\n> Sjors came up with a theoretical scenario where users from one exchange are sending money to another exchange, causing a single transaction with lots of different outputs to the same recipient.\n\nWhy would this transaction have outputs with `k > 0`? Wouldn't each user get an address from the destination exchange with a different label?\n",
      "user": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3778552386",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "mentioned",
      "id": 22190359351,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUqpgM3",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22190359351",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-21T14:53:55Z"
    },
    {
      "event": "subscribed",
      "id": 22190359401,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUqpgNp",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22190359401",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-21T14:53:55Z"
    },
    {
      "event": "commented",
      "id": 3778666496,
      "node_id": "IC_kwDOAP4Jqs7hOeAA",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3778666496",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-21T15:10:09Z",
      "updated_at": "2026-01-21T15:10:09Z",
      "author_association": "NONE",
      "body": "@jonasnick thanks for considering the arguments.\n\n`k` changes whenever multiple outputs are sent to the same recipient, irrespective of what label is used. This is needed to ensure the resulting outputs can't be linked. Everything except the label part would be the exact same, and the label is assumed to be public information so anyone could try to subtract it to find the link.",
      "user": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3778666496",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "mentioned",
      "id": 22190786028,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUqrIXs",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22190786028",
      "actor": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-21T15:10:10Z"
    },
    {
      "event": "subscribed",
      "id": 22190786063,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUqrIYP",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22190786063",
      "actor": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-21T15:10:10Z"
    },
    {
      "event": "commented",
      "id": 3779567693,
      "node_id": "IC_kwDOAP4Jqs7hR6BN",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3779567693",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-21T16:45:30Z",
      "updated_at": "2026-01-21T16:45:30Z",
      "author_association": "CONTRIBUTOR",
      "body": "Hey Ruben, thanks for the detailed comments. I, more or less, agree with everything you said. A more detailed response:\n\n> (1) let the API call contain a limited range for K so it has to be called repeatedly.\n\nYeah, I had this idea, too. But it doesn't really convince me unless we see actual demand from wallets. I think scanning should be a background process, so it's okay if it takes something on the order of a few seconds but it shouldn't be crazy. (Where do we draw the line exactly? Okay, bikeshedding very much possible...) But this should be well-documented. If it turns out that wallets need to implement some other, more responsive functionality (e.g., some RPC that scans a single transaction and needs to be quick), then we could reconsider that idea. But currently, I don't think it will be necessary.\n\n  > A more strict approach is to simply (2) limit K in the BIP. \n\nThe fact that @jonasnick and I came to the same conclusion that limiting k seems to be a good idea (without knowing that you had suggested the same) probably means we're on the right track. (Yes, when we talked about it, we wrongly assumed that different labels can work with the same k=0, but even if we need different k values for different labels, limiting k seems fine to me.) I agree that limiting k seems much less restrictive for applications than limiting the number of labels.\n\nYet another idea is to require outputs to be in sequential k order, i.e., the k=0 output appears before the k=1 output in the list of outputs which appears before the k=2 output in the list, etc. @jonasnick had suggested this in one of the PR, but wasn't sure whether it limits flexibility too much.\n\nI like this idea, too. It's more straightforward and feels less like a kludge. It should make the scanning linear in the number of outputs, which should get rid of all the performance issues. (Is it reasonable to get a benchmark here?) And having no limit on k is nice because wallet implementors won't need to scratch their heads around it. And I doubt that this approach is too limiting. It precludes any protocol on top of silent payments which would rely on the order of outputs. \n - Some protocols such as LN do indeed rely on the order of outputs. But you probably wouldn't run them on top of SP?\n - It also excludes BIP69, namely the idea that outputs should appear in deterministic (sorted) order to avoid wallet fingerprinting. This is not an unreasonable idea, but it seems that it has mostly been abandoned, with Electrum being the last big wallet to implement it. See https://github.com/spesmilo/electrum/issues/8849 and also the report mentioned there. So there's not too much value for SP transactions to blend in with BIP69 transactions.\n\n@RubenSomsen What's your opinion on this idea?\n\nThere's also the possibility to combine this with a maximum k, e.g., k=0 to k=99 may be everywhere in the list but outputs with k >= 100 must be sequential. In that sense, it's even a relaxation of simply limiting k. But this seems a bit overengineered.",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3779567693",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "mentioned",
      "id": 22193401676,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUq1G9M",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22193401676",
      "actor": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-21T16:45:32Z"
    },
    {
      "event": "subscribed",
      "id": 22193401701,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUq1G9l",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22193401701",
      "actor": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-21T16:45:32Z"
    },
    {
      "event": "mentioned",
      "id": 22193401765,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUq1G-l",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22193401765",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-21T16:45:32Z"
    },
    {
      "event": "subscribed",
      "id": 22193401783,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUq1G-3",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22193401783",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-21T16:45:32Z"
    },
    {
      "event": "commented",
      "id": 3782354408,
      "node_id": "IC_kwDOAP4Jqs7hciXo",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3782354408",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T03:41:19Z",
      "updated_at": "2026-01-22T03:44:17Z",
      "author_association": "CONTRIBUTOR",
      "body": "> A more strict approach is to simply (2) limit K in the BIP.\n\n> Yet another idea is to require outputs to be in sequential k order, i.e., the k=0 output appears before the k=1 output in the list of outputs which appears before the k=2 output in the list, etc.\n\nHere are worst-case benchmarks for both of these proposed protocol fixes (I called them \"limited k\" and \"ordered k\" rules): https://github.com/theStack/secp256k1/commit/edf222f2106cd45fbaf2f1d47ee87a774c35d42a (based on #1765). A transaction with N=23255 outputs is created, where the matched outputs in the same recipient group (of size K) are placed at the very end, at positions [N-K, N-1], in order to maximize the total number of iterations of the inner loop.\n\nBenchmark results on my arm64 laptop:\n<details>\n<summary>\"limited k\" protocol rule, with K=(10,100,1000) each</summary>\n\n```\n<compile with SP_ORDERED_K_RULE_ENABLED set to 0>\n$ ./build/bin/bench silentpayments_scan_worstcase\nBenchmark                               ,    Min(us)       ,    Avg(us)       ,    Max(us)\n\n[ \"limited k\" protocol rule ]\nsilentpayments_scan_worstcase_K=10      ,   192912.0       ,   192912.0       ,   192912.0\nsilentpayments_scan_worstcase_K=100     ,  1644624.0       ,  1644624.0       ,  1644624.0\nsilentpayments_scan_worstcase_K=1000    , 16637185.0       , 16637185.0       , 16637185.0\n```\n</details>\n\n<details>\n<summary>\"ordered k\" protocol rule, with K=N=23255</summary>\n\n```\n<compile with SP_ORDERED_K_RULE_ENABLED set to 1>\n$ ./build/bin/bench silentpayments_scan_worstcase\nBenchmark                               ,    Min(us)       ,    Avg(us)       ,    Max(us)\n\n[ \"ordered k\" protocol rule ]\nsilentpayments_scan_worstcase_K=23255   ,   416104.0       ,   416104.0       ,   416104.0\n```\n</details>\n\nWith a limit of K=1000, scanning takes ~16s (close to the assumed ~20s stated by @RubenSomsen above) on my machine, while the \"ordered k\" scanning for the absolute worst-case (all outputs match) only took <0.5s. This confirms the assumption that scanning with the \"ordered k\" protocol rule would get rid of all the performance issues.",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3782354408",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "mentioned",
      "id": 22205399322,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUri4Ea",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22205399322",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T03:41:21Z"
    },
    {
      "event": "subscribed",
      "id": 22205399337,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUri4Ep",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22205399337",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T03:41:21Z"
    },
    {
      "event": "commented",
      "id": 3783061285,
      "node_id": "IC_kwDOAP4Jqs7hfO8l",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3783061285",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T08:03:51Z",
      "updated_at": "2026-01-22T08:05:15Z",
      "author_association": "MEMBER",
      "body": "> > (1) let the API call contain a limited range for K so it has to be called repeatedly.\n> \n> Yeah, I had this idea, too. But it doesn't really convince me unless we see actual demand from wallets. I think scanning should be a background process, so it's okay if it takes something on the order of a few seconds but it shouldn't be crazy. (Where do we draw the line exactly? Okay, bikeshedding very much possible...)\n\nOn mobile there's a couple of lines.\n\nOne line is at about 1/100th of a second. Anything that takes longer would block smooth scrolling, since the UI is typically the main thread (disclaimer: it's been a decade since implemented an iOs app that had to worry about this, but [it's still a thing](https://medium.com/lets-code-future/scroll-like-butter-mastering-smooth-scrolling-in-swiftui-ios-18-xcode-16-ready-d821aab44bd5)). That means it needs to be done in a background thread. If we're going to be well above that anyway, then the mobile developer can't avoid using a background thread and we don't have to worry about this particular line.\n\nHaving to use a background thread means they have to worry about thread safety. Although it could still be a single long running thread, dedicated to libsecp operations. But then you can't sign anything, or do any other secp operation, while a heavy block is being scanned. So perhaps developers need to worry about thread safety anyway, and this doesn't make it worse. And perhaps most operations are safe anyway, e.g. scan 1 block, sign a transaction, scan the next block, doesn't really interfere?\n\nStill, (mobile) UI needs to give some feedback to the user. It can be a block height that frequently goes up, or a progress bar that gradually moves. There I would say that a few seconds is the max you want to go by without any feedback, or the user might think the app is frozen.\n\nIf a specific block takes exceptionally long, it's probably also good to show the user something to relax them. That's easier to implement if the call returns after a second or so, saying it needs more. The alternative if for the developer to implement yet another thread that measures the time a call takes and compares it to a baseline.\n\n@theStack wrote:\n\n> Benchmark results on my arm64 laptop:\n\nDesktop users are probably more patient anyway. I think we should measure the performance on mobile phones. Perhaps not the slowest one out there, although it would be nice if the slowest known smartphone that can run an application with libsecp, gets an answer from the library within 1 second.",
      "user": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3783061285",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "mentioned",
      "id": 22209055208,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUrw0no",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22209055208",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T08:03:53Z"
    },
    {
      "event": "subscribed",
      "id": 22209055224,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUrw0n4",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22209055224",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T08:03:53Z"
    },
    {
      "event": "commented",
      "id": 3783699104,
      "node_id": "IC_kwDOAP4Jqs7hhqqg",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3783699104",
      "actor": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T10:40:03Z",
      "updated_at": "2026-01-22T10:40:03Z",
      "author_association": "CONTRIBUTOR",
      "body": "> `k` changes whenever multiple outputs are sent to the same recipient, irrespective of what label is used.\n\nSorry, that was a significant error in my mental model (at least my most recent one). In that case, I agree that having more than one `k` _is_ a relevant use case and I take back what I said about restricting `k` being obviously the most straightforward option.\n\nAnnother thought on the limited-k vs. ordered-k approaches: limited-k appears to lead to a more secure libsecp API. The limit would be enforced in the `secp256k1_silentpayments_sender_create_outputs` function. If it's exceeded, the function returns an error and no transaction will be made.\n\nWith the ordered-k approach we'd instead have to add a warning to the API doc of `sender_create_outputs` stating that the generated outputs must appear exactly in the same order in the transaction. If the wallet would (accidentally) ignore the warning and, e.g., sort the outputs via BIP 69 before making a transaction, it would be a mess to recover the coins.\n",
      "user": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3783699104",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "commented",
      "id": 3784149151,
      "node_id": "IC_kwDOAP4Jqs7hjYif",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3784149151",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T12:31:58Z",
      "updated_at": "2026-01-22T12:31:58Z",
      "author_association": "CONTRIBUTOR",
      "body": "\n> With the ordered-k approach we'd instead have to add a warning to the API doc of `sender_create_outputs` stating that the generated outputs must appear exactly in the same order in the transaction. If the wallet would (accidentally) ignore the warning and, e.g., sort the outputs via BIP 69 before making a transaction, it would be a mess to recover the coins.\n\nThat's a great point.\n\n> Here are worst-case benchmarks for both of these proposed protocol fixes (I called them \"limited k\" and \"ordered k\" rules): [theStack@edf222f](https://github.com/theStack/secp256k1/commit/edf222f2106cd45fbaf2f1d47ee87a774c35d42a) (based on [#1765](https://github.com/bitcoin-core/secp256k1/pull/1765)). A transaction with N=23255 outputs is created, where the matched outputs in the same recipient group (of size K) are placed at the very end, at positions [N-K, N-1], in order to maximize the total number of iterations of the inner loop.\n\nThese are useful numbers, and they confirm that scanning takes O(K * N). I believe for picking a reasonable max `K_max`, we'd rather want to look at entire blocks, as brought up by @Eunovo. The worst-case block is probably one filled with transactions, each having `N = K_max` many outputs. And then we'll start to see the \"quadratic\" impact when considering different `K_max` values. For example, what's the scanning time for a block filled with `N = K_max = 1000` transactions vs. a block filled with (about 10x as many) `N = K_max = 100` transactions?\n",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3784149151",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "mentioned",
      "id": 22214901059,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUsHH1D",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22214901059",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T12:31:59Z"
    },
    {
      "event": "subscribed",
      "id": 22214901086,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUsHH1e",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22214901086",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T12:32:00Z"
    },
    {
      "event": "commented",
      "id": 3784560045,
      "node_id": "IC_kwDOAP4Jqs7hk82t",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3784560045",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T13:56:38Z",
      "updated_at": "2026-01-22T15:06:25Z",
      "author_association": "CONTRIBUTOR",
      "body": "> > Here are worst-case benchmarks for both of these proposed protocol fixes (I called them \"limited k\" and \"ordered k\" rules): [theStack@edf222f](https://github.com/theStack/secp256k1/commit/edf222f2106cd45fbaf2f1d47ee87a774c35d42a) (based on [#1765](https://github.com/bitcoin-core/secp256k1/pull/1765)). A transaction with N=23255 outputs is created, where the matched outputs in the same recipient group (of size K) are placed at the very end, at positions [N-K, N-1], in order to maximize the total number of iterations of the inner loop.\n> \n> These are useful numbers, and they confirm that scanning takes O(K * N). I believe for picking a reasonable max `K_max`, we'd rather want to look at entire blocks, as brought up by [@Eunovo](https://github.com/Eunovo). The worst-case block is probably one filled with transactions, each having `N = K_max` many outputs. And then we'll start to see the \"quadratic\" impact when considering different `K_max` values. For example, what's the scanning time for a block filled with `N = K_max = 1000` transactions vs. a block filled with (about 10x as many) `N = K_max = 100` transactions?\n\nFair point. ~~Note that for transactions where all outputs match (with `N = K_max`), the \"quadratic\" impact can be easily avoided by marking found outputs and skipping those in further iterations (that's currently already done in #1765). If we want to keep that optimization, I'd assume that the worst-case scanning cost per block is reached by maximizing the number of unmatched outputs (in contrast to any found output, those have to be processed over and over again, blowing the cost up) in a single transaction.~~\n\nEDIT: Sorry, that was wrong. If the matched outputs are ordered in reverse by an adversary (i.e. from max_k-1...0), then marking and skipping found outputs alone doesn't gain anything.",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3784560045",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "commented",
      "id": 3784831630,
      "node_id": "IC_kwDOAP4Jqs7hl_KO",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3784831630",
      "actor": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T14:53:48Z",
      "updated_at": "2026-01-22T15:13:03Z",
      "author_association": "NONE",
      "body": "The limited-k and ordered-k proposals shift the problem from '_how do we optimize scanning?_' to '_what constraints are acceptable?_' .\n\nThe discussion about optimizations (LabelSet, hybrid) was initially motivated by the worst-case attack. If we're willing to accept protocol constraints like limited-k or ordered-k, the BIP approach might suffice since these constraints bound the worst-case.\n\nIn this scenario, the benefits of LabelSet would be:                                                                                   \n* Simpler API (no callback function, direct label entries)                                                                                       \n* Simpler implementation (no y-parity handling)\n* Wallet label count constraint (L  500) instead of protocol constraint (limited-k)\n\nBoth alternatives seem acceptable for typical users.",
      "user": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3784831630",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "commented",
      "id": 3785024656,
      "node_id": "IC_kwDOAP4Jqs7hmuSQ",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3785024656",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T15:30:40Z",
      "updated_at": "2026-01-22T15:30:40Z",
      "author_association": "CONTRIBUTOR",
      "body": "@theStack  Let's do some math:\n\nAssume a transaction with N outputs, and K of them are silent payment outputs for a specific recipient, order in reverse (which is the worst case as you've figured out).\n\n - The 1st iteration in the K loop needs to loop over N outputs\n - The 2nd iteration in the K loops needs to loop over N-1 outputs\n - ...\n - The K-th iteration in the K loops needs to loop over N-K+1 outputs\n\nTotal number of iterations of the inner loop for a single transaction with N outputs  is and K silent payment outputs is:\n```\nN + (N-1) + ... + (N-K+1)\n = ((N-K) + K) + ((N-K) + (K-1)) + ... + ((N-K) + 1)\n = K * (N-K) + (K + (K-1) + ... + 1)\n = K * (N-K) + K*(K+1)/2\n = NK - K^2 + K^2/2 + K/2\n = NK - K^2/2 + K/2. \n```\n\nWith the simplifying assumption that the number of outputs in a block is limited to B (and not the number of bytes), and we fit T transactions in it, each transaction has N = B/T outputs. This means that for an entire block with T transactions, the number of iterations of the inner loop is\n```\nT * ((BK/T) - K^2/2 + K/2)\n  = T * (-K^2/2 + K/2) + BK\n```\n\nThis is clearly maximized for T = 1... So if I'm not mistaken, the worst block appears to be one with a single transaction with K at the limit and N as high as possible to still fit in the block. And this matches exactly the benchmarks you've already produced, right? \n",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3785024656",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "mentioned",
      "id": 22219185582,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUsXd2u",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22219185582",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T15:30:41Z"
    },
    {
      "event": "subscribed",
      "id": 22219185676,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUsXd4M",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22219185676",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T15:30:42Z"
    },
    {
      "event": "commented",
      "id": 3785556783,
      "node_id": "IC_kwDOAP4Jqs7howMv",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3785556783",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T17:07:02Z",
      "updated_at": "2026-01-22T17:07:02Z",
      "author_association": "CONTRIBUTOR",
      "body": "> @theStack Let's do some math:\n> ...\n> This is clearly maximized for T = 1... So if I'm not mistaken, the worst block appears to be one with a single transaction with K at the limit and N as high as possible to still fit in the block.\n\n@real-or-random: Nice, I've followed these steps on pen and paper and could eventually (after some temporary sign confusion) reproduce the conclusion. I assume @RubenSomsen reached a similar conclusion, since in the [gist writeup](https://gist.github.com/RubenSomsen/1e827ee6b48a2e4d489d80b400a461de), the \"targeted attack\" scenario only considers the single-transaction, maximum-N case.\n\n>  And this matches exactly the benchmarks you've already produced, right?\n\nYes.\n\n> With the ordered-k approach we'd instead have to add a warning to the API doc of sender_create_outputs stating that the generated outputs must appear exactly in the same order in the transaction. If the wallet would (accidentally) ignore the warning and, e.g., sort the outputs via BIP 69 before making a transaction, it would be a mess to recover the coins.\n\nAnother potential drawback of the \"ordered-k\" rule is that it breaks existing test vectors in the BIP, which currently explicitly check that order does _not_ matter. Adapting those is probably not the end of the world, but in comparison the \"limited-k\" rule is significantly easier to cope with in that regards (and probably less confusing for existing SP wallets testing against the vectors), as only new test vectors would be added; currently, the [largest test case w.r.t. number of outputs](https://github.com/bitcoin/bips/blob/ecb074d487ac709c6321a5b85a6d081bd20ff30b/bip-0352/send_and_receive_test_vectors.json#L2133) is N=4. So in that sense \"ordered-k\" feels slightly more like a breaking change than \"limited-k\".",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3785556783",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "mentioned",
      "id": 22221719152,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUshIZw",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22221719152",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T17:07:03Z"
    },
    {
      "event": "subscribed",
      "id": 22221719186,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUshIaS",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22221719186",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T17:07:04Z"
    },
    {
      "event": "mentioned",
      "id": 22221719224,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUshIa4",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22221719224",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T17:07:04Z"
    },
    {
      "event": "subscribed",
      "id": 22221719255,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUshIbX",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22221719255",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T17:07:04Z"
    },
    {
      "event": "mentioned",
      "id": 22221719301,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUshIcF",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22221719301",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T17:07:04Z"
    },
    {
      "event": "subscribed",
      "id": 22221719322,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUshIca",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22221719322",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T17:07:04Z"
    },
    {
      "event": "commented",
      "id": 3787281788,
      "node_id": "IC_kwDOAP4Jqs7hvVV8",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3787281788",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T23:31:02Z",
      "updated_at": "2026-01-23T12:32:48Z",
      "author_association": "NONE",
      "body": "@real-or-random thanks for your comments.\n\n>require outputs to be in sequential k order\n\nOther than what was already mentioned about \"ordered-k\", I'm also concerned what putting restrictions on output order does to privacy. ~~If a known SP user sends you money from the 1st and 5th output in a tx, it implies they own the 2nd, 3rd and 4th output as well.~~ (edit: incorrect, see [the next comment](#issuecomment-3789112995)) And in coinjoin scenarios, you now have to insist on a certain order for outputs, which reveals information to other coinjoin participants. \n\n@theStack \n\n>I assume @RubenSomsen reached a similar conclusion, since in the [gist writeup](https://gist.github.com/RubenSomsen/1e827ee6b48a2e4d489d80b400a461de), the \"targeted attack\" scenario only considers the single-transaction, maximum-N case.\n\nYes, a single tx with maximum N is the worst case for two reasons:\n\n1. The attack scales directly with the number of outputs, and a single tx is the optimal way to maximize them\n\n2. Whenever limit-K approaches N, you can get an up to 2x speedup by removing checked outputs (note I am assuming the outputs are always randomized). This is why in my [gist](https://gist.github.com/RubenSomsen/1e827ee6b48a2e4d489d80b400a461de) I have a different formula for the \"limit K\" scenario and the unlimited \"worst case\" scenario (where K == N).\n\n@w0xlt\n\n>Wallet label count constraint (L  500) instead of protocol constraint (limited-k)\n\nI think one important point of nuance is that the slowdown from using labels under LabelSet is consistently present. _Every_ user who approaches L=500 will forever be up to 4x slower than BIP style (non-targeted). Under BIP style, if limit K=120 then only _one_ user will be 4x slower (and everyone else will actually be ~3x faster) for as long as that user is being attacked.\n\nI understand not everyone is sold on labels, and it's uncertain what adoption will be like, but I do feel pretty confident in saying we're far more likely to see high label usage than anyone trying to make transactions with lots of outputs to the same recipient in the foreseeable future. Labels enable some pretty common use cases, such as knowing who paid you, accompanying a payment with a description before the payment is made, and even the ability to spend funds that were sent to some set of labels separately from your other funds.\n\n---\n\nLet me test the waters with a concrete proposal - how would people feel about a K=1000 limit (~31x slower, benchmarked at 16 seconds by @theStack)? That's a limit no future use case would conceivably hit in practice. If someone attacked you for a _full day_, filling 144 blocks with outputs to you, UX wise the scanning experience will be equivalent to having been offline for a month and then coming back online (and everyone else gets to scan those 144 blocks ~3x faster than normal).",
      "user": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3787281788",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "mentioned",
      "id": 22229272441,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUs98d5",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22229272441",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T23:31:03Z"
    },
    {
      "event": "subscribed",
      "id": 22229272455,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUs98eH",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22229272455",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T23:31:03Z"
    },
    {
      "event": "mentioned",
      "id": 22229272464,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUs98eQ",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22229272464",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T23:31:03Z"
    },
    {
      "event": "subscribed",
      "id": 22229272470,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUs98eW",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22229272470",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T23:31:03Z"
    },
    {
      "event": "mentioned",
      "id": 22229272481,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUs98eh",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22229272481",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T23:31:03Z"
    },
    {
      "event": "subscribed",
      "id": 22229272499,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUs98ez",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22229272499",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T23:31:03Z"
    },
    {
      "event": "mentioned",
      "id": 22229272544,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUs98fg",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22229272544",
      "actor": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T23:31:04Z"
    },
    {
      "event": "subscribed",
      "id": 22229272565,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUs98f1",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22229272565",
      "actor": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-22T23:31:04Z"
    },
    {
      "event": "commented",
      "id": 3789112995,
      "node_id": "IC_kwDOAP4Jqs7h2Uaj",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3789112995",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-23T08:49:19Z",
      "updated_at": "2026-01-23T08:57:25Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Other than what was already mentioned about \"ordered-k\", I'm also concerned what putting restrictions on output order does to privacy. If a known SP user sends you money from the 1st and 5th output in a tx, it implies they own the 2nd, 3rd and 4th output as well.\n\nI don't think so. The 1st output could have k=0 and the 5th output could have k=1?\n\n> And in coinjoin scenarios, you now have to insist on a certain order for outputs, which reveals information to other coinjoin participants.\n\nMy thinking is that it's not yet clear how exactly a CoinJoin would be created privately. So it's difficult to judge whether ordered-k would have an impact here. But sure, not having ordered-k retains all the flexibility.  \n\nI tend to think that limited-k is the most pragmatic solution.\n\n\n\n> Let me test the waters with a concrete proposal - how would people feel about a K=1000 limit (~31x slower, benchmarked at 16 seconds by [@theStack](https://github.com/theStack))? That's a limit no future use case would conceivably hit in practice. If someone attacked you for a _full day_, filling 144 blocks with outputs to you, UX wise the scanning experience will be equivalent to having been offline for month and then coming back online (and everyone else gets to scan those 144 blocks ~3x faster than normal).\n\nBy the way, one can fit 2324 P2TR outputs in a standard transaction (see https://bitcoinops.org/en/tools/calc-size/). But that would be ~ 2.3 * 16s = 37 s.... \n\n\nI have really no idea what number we should aim at. I can't follow @Sjors's conclusions:\n\n>  although it would be nice if the slowest known smartphone that can run an application with libsecp, gets an answer from the library within 1 second.\n\nMy thinking is that scanning will always take place in a background thread, and in a typical scenario, you'd scan more than one block (e.g., what @RubenSomsen mentions when he says \"equivalent to having been offline for [a] month and then coming back online\"). So there's no scenario of a user actively sitting in front of a phone and waiting for the wallet app to respond. (Sure, if that scenario existed, we would want to aim for something below a second, maybe much lower. But it's not the scenario we need to consider.)\n\nFor a background thread, perhaps even 37 s is not too crazy, considering also that the victim will be paid for the scanning in some sense. Even if your machine is 10x slower, you're still well below the expected block time. And again: If you're offline for a week or a month, you'd also expect your wallet to be busy for quite some time catching up (not only with SP but also just with block validation!). \n\n\n\nSide track: Another possible consideration is multiple CPUs. Scanning of different transactions is easy to parallelize. That would suggest limiting the number N of outputs too. (In theory, one could also parallelize the inner loop, but that insight is worth nothing if we don't implement it that way.) But on the other hand, our limit should probably consider some kind of \"weakest but still meaningful\" scanning client. And it's fair to assume that this is one with just one CPU (or at least just one CPU available for scanning). ",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3789112995",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "closed",
      "id": 22237083917,
      "node_id": "CE_lADOAP4Jqs7iiazUzwAAAAUtbvkN",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22237083917",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-23T08:49:19Z"
    },
    {
      "event": "mentioned",
      "id": 22237084773,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUtbvxl",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22237084773",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-23T08:49:21Z"
    },
    {
      "event": "subscribed",
      "id": 22237084800,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUtbvyA",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22237084800",
      "actor": {
        "login": "Sjors",
        "id": 10217,
        "node_id": "MDQ6VXNlcjEwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sjors",
        "html_url": "https://github.com/Sjors",
        "followers_url": "https://api.github.com/users/Sjors/followers",
        "following_url": "https://api.github.com/users/Sjors/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sjors/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sjors/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
        "organizations_url": "https://api.github.com/users/Sjors/orgs",
        "repos_url": "https://api.github.com/users/Sjors/repos",
        "events_url": "https://api.github.com/users/Sjors/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sjors/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-23T08:49:21Z"
    },
    {
      "event": "mentioned",
      "id": 22237084833,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUtbvyh",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22237084833",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-23T08:49:21Z"
    },
    {
      "event": "subscribed",
      "id": 22237084853,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUtbvy1",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22237084853",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-23T08:49:21Z"
    },
    {
      "event": "reopened",
      "id": 22237086564,
      "node_id": "REE_lADOAP4Jqs7iiazUzwAAAAUtbwNk",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22237086564",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-23T08:49:25Z"
    },
    {
      "event": "commented",
      "id": 3790019192,
      "node_id": "IC_kwDOAP4Jqs7h5xp4",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3790019192",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-23T12:28:27Z",
      "updated_at": "2026-01-23T12:35:16Z",
      "author_association": "NONE",
      "body": ">I don't think so. The 1st output could have k=0 and the 5th output could have k=1?\n\nAh I see, I misunderstood. In that case my argument can be dismissed.\n\n>By the way, one can fit 2324 P2TR outputs in a standard transaction\n\nI would not be opposed to K = 2324 (71x slower) either. At that pace one targeted attack block is equivalent to coming back online after half a day. It's 5x better than the current worst-case, where one targeted attack block takes 2.5 days. \n\n>considering also that the victim will be paid for the scanning in some sense\n\nLet me push back on this a little - there is currently nothing in the spec stopping an attacker from sending 0 sat outputs. There's even the possibility that all outputs are 0 sats except for one and you have to grind through all the 0 sat outputs to figure out whether it's yours. Individual wallets could choose to set limits here, but that won't be consistent across the ecosystem.\n\n>Another possible consideration is multiple CPUs\n\nI think even for limited-k this could apply. Finding a result where `k=1` should be very rare. From `k=2` onward you could just throw all your threads at the problem. For eight threads you'd check `k=2` until `k=9` simultaneously, then at worst you find nothing and seven of your threads will have done some superfluous computation - harmless in practice.\n\n>But on the other hand, our limit should probably consider some kind of \"weakest but still meaningful\" scanning client\n\nI imagine that any device with no more than one CPU would be a light client that also has bandwidth constraints, at which point you'd have to limit your label usage and the LabelSet approach can be applied.\n\nHmm, in thinking about this, I'm realizing one important factor that has been overlooked. Light clients generally do not have access to the full set of taproot outputs (you could download them, and even apply cut-through, but it'd be more bandwidth), so they'd need the LabelSet approach.\n\nThe steps are:\n- Receive tweak data (~33 bytes per eligible tx)\n- Calculate what would be your taproot output(s) (i.e. the LabelSet approach)\n- Check against a filter if they're in the block (more labels == more false positives)\n\nPerhaps we're not getting around the fact that both approaches have use cases...",
      "user": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3790019192",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "comment_deleted",
      "id": 22242034248,
      "node_id": "CDE_lADOAP4Jqs7iiazUzwAAAAUtuoJI",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22242034248",
      "actor": {
        "login": "bitcoin-core",
        "id": 13464320,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEzNDY0MzIw",
        "avatar_url": "https://avatars.githubusercontent.com/u/13464320?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin-core",
        "html_url": "https://github.com/bitcoin-core",
        "followers_url": "https://api.github.com/users/bitcoin-core/followers",
        "following_url": "https://api.github.com/users/bitcoin-core/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin-core/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin-core/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin-core/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin-core/orgs",
        "repos_url": "https://api.github.com/users/bitcoin-core/repos",
        "events_url": "https://api.github.com/users/bitcoin-core/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin-core/received_events",
        "type": "Organization",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-23T12:53:09Z"
    },
    {
      "event": "labeled",
      "id": 22251610208,
      "node_id": "LE_lADOAP4Jqs7iiazUzwAAAAUuTKBg",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22251610208",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-23T20:03:24Z",
      "label": {
        "name": "feature",
        "color": "731E95"
      }
    },
    {
      "event": "labeled",
      "id": 22251610229,
      "node_id": "LE_lADOAP4Jqs7iiazUzwAAAAUuTKB1",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22251610229",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-23T20:03:24Z",
      "label": {
        "name": "performance",
        "color": "DE3CCC"
      }
    },
    {
      "event": "commented",
      "id": 3792306536,
      "node_id": "IC_kwDOAP4Jqs7iCgFo",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3792306536",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-23T20:38:49Z",
      "updated_at": "2026-01-23T20:38:49Z",
      "author_association": "CONTRIBUTOR",
      "body": "Apologies for coming in late, I've just been catching up on the various attacks and approaches to mitigate them.\n\nOne proposal that seems noticeably absent is a BIP-style + filter approach. E.g. rather than maintaining a pre-sorted labels cache, instead pre-generate a probabilistic (bloom/cuckoo/xor/ribbon/etc.) filter and pass that in for queries instead. Then only do a real find if it's found in the filter. Those finds could even be done as a batch at the end.\n\nSIMD could be leveraged to parallelize any necessary hashing operations.\n\nIIUC, that would eliminate any output ordering concerns while requiring a theoretically minimal amount of memory compared to a sorted (hash) set. The cost of course would be a trivial amount of false-positives that would result in unnecessary lookups.\n\n...Or am I greatly over-simplifying the problem? :)",
      "user": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3792306536",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "commented",
      "id": 3793855053,
      "node_id": "IC_kwDOAP4Jqs7iIaJN",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3793855053",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-24T05:30:44Z",
      "updated_at": "2026-01-24T05:30:44Z",
      "author_association": "CONTRIBUTOR",
      "body": "> With a limit of K=1000, scanning takes ~16s on my machine\n\nUpdate on these worst-case benchmarks: due to a silly bug in the code for reversing the matched outputs, half of them landed right at the start of _all_ outputs, rather than within the [n-k,n-1] group at the end (d'oh!). This effectively cut down the scanning time in half; correspondingly, the corrected worst-case benchmark results are about twice as high, i.e. **~32s for K=1000** (rather than the ~16s stated previously). [1] See https://github.com/theStack/secp256k1/commit/b16369f6ed103c973201c99ff1569613da00705b for the fixed version, I'd be glad if someone is willing to run them on their machine, and/or could give the benchmark code a quick sanity check.\n\nThis probably doesn't make finding a reasonable K limit to agree on any easier :| I haven't given much thought on what worst-case time are still acceptable, but in terms of K I guess I would still feel fine if it is limited to the \"hundreds\" range, as that still seems absurdly high for any real use case.\n\n> Hmm, in thinking about this, I'm realizing one important factor that has been overlooked. Light clients generally do not have access to the full set of taproot outputs (you could download them, and even apply cut-through, but it'd be more bandwidth), so they'd need the LabelSet approach.\n> \n> The steps are:\n> \n> * Receive tweak data (~33 bytes per eligible tx)\n> \n> * Calculate what would be your taproot output(s) (i.e. the LabelSet approach)\n> \n> * Check against a filter if they're in the block (more labels == more false positives)\n\nGood point. I think for that scenario we don't need a LabelSet _scanning_ function though: the second step is comparably simple (-> just create one taproot ouput per labeled spend pubkey with k=0), and if the filter matches and the full block/transaction data has been downloaded, the actual scanning can then be done with the BIP approach.\n\nIt took me a while to remember and find it, but luckily an API function for calculating taproot output candidates actually already exists in the [take 3 PR](https://github.com/bitcoin-core/secp256k1/pull/1698/files#diff-cc1930bf159014e5a11852513b2d33f0b931e4a02253651d6c2af458c4968a27R392) for that exact purpose. The reason we took it out for the [take 4 PR](https://github.com/bitcoin-core/secp256k1/pull/1765) was to reduce scope and focus on full-node functionality first. Once we ship that function (and other related ones, like e.g. prevouts_summary (de)serialization) in a future release, I think light clients are all set for the above scenario, and a dedicated LabelSet scanning function should not be strictly necessary.\n\n@theuni: The label cache lookup cost is treated as negligible in comparison to all the other much more expensive (elliptic curve) operations happening in the loop iterations. With the current BIP approach API, providing an efficient lookup function is in the responsibility of the user. I've so far tried out a hash table implementation (khash+rapidhash) and that seemed to work well enough, even for one million entries there was no noticeable decline in performance [2]. Note that the quadratic scaling issue discussed for the BIP approach is independent on the number of labels, it can occur even with L=1, if all outputs of an adversarial tx are targeted to that single labeled address.\n\n[1] note that we could achieve the previous benchmark results by randomizing the outputs within the scan function, to bring down the average iterations to a find a match to N/2. I'm not sure though if that's a good idea; tending to think that modifying \"list of pointer\" arguments is really ugly from an API point of view (even if it's only done for high output counts).\n[2] https://groups.google.com/g/bitcoindev/c/bP6ktUyCOJI/m/HGCF9YxNAQAJ",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3793855053",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "mentioned",
      "id": 22258541559,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUutmP3",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22258541559",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-24T05:30:46Z"
    },
    {
      "event": "subscribed",
      "id": 22258541564,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUutmP8",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22258541564",
      "actor": {
        "login": "theuni",
        "id": 417043,
        "node_id": "MDQ6VXNlcjQxNzA0Mw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theuni",
        "html_url": "https://github.com/theuni",
        "followers_url": "https://api.github.com/users/theuni/followers",
        "following_url": "https://api.github.com/users/theuni/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theuni/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theuni/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
        "organizations_url": "https://api.github.com/users/theuni/orgs",
        "repos_url": "https://api.github.com/users/theuni/repos",
        "events_url": "https://api.github.com/users/theuni/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theuni/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-24T05:30:46Z"
    },
    {
      "event": "commented",
      "id": 3800265704,
      "node_id": "IC_kwDOAP4Jqs7ig3Po",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3800265704",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-26T15:41:22Z",
      "updated_at": "2026-01-26T15:41:22Z",
      "author_association": "NONE",
      "body": "> Let me push back on this a little - there is currently nothing in the spec stopping an attacker from sending 0 sat outputs. There's even the possibility that all outputs are 0 sats except for one and you have to grind through all the 0 sat outputs to figure out whether it's yours. Individual wallets could choose to set limits here, but that won't be consistent across the ecosystem.\n\n@RubenSomsen  I previously thought that it was a good idea for wallets to skip doing any work for 0 sat outputs. If we skip checking `0` outputs in a transaction, with N outputs and M outputs set to `0`:\n\nThe scanner has to check at least `K=0..M-1` to ensure that no potential outputs are lost. This means the scanner has to do `(N-M)` work `M` times.\nIn a worst-case attack with `N_max` outputs and `N_max /2` outputs set to zero, the scanner has to check `K=0..(N_max/2) -1` for `N_max/2`  outputs that have non-zero values.\nThis means any wallet that implements this output skipping technique will have to do this `(N_max^2)/4` work, just to ensure that their wallet doesn't have any payments in the transaction when they could have just checked `K=0` and only done the `N_max` work once.\n\nHence, it's not advisable to implement any limits that determine which outputs to skip, as that could open wallets up to unnecessary scanning work.\n\n> [1] note that we could achieve the previous benchmark results by randomizing the outputs within the scan function, to bring down the average iterations to a find a match to N/2. I'm not sure though if that's a good idea; tending to think that modifying \"list of pointer\" arguments is really ugly from an API point of view (even if it's only done for high output counts).\n\n@theStack  Isn't this already done for the LabelSet approach? The outputs must be sorted to enable binary searches. If we already accept sorting the `tx_outputs`, what is the reason not to accept random shuffling?",
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3800265704",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "mentioned",
      "id": 22292725695,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUwv_-_",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22292725695",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-26T15:41:23Z"
    },
    {
      "event": "subscribed",
      "id": 22292725740,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUwv__s",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22292725740",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-26T15:41:23Z"
    },
    {
      "event": "mentioned",
      "id": 22292725795,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUwwAAj",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22292725795",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-26T15:41:24Z"
    },
    {
      "event": "subscribed",
      "id": 22292725813,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUwwAA1",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22292725813",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-26T15:41:24Z"
    },
    {
      "event": "commented",
      "id": 3800717070,
      "node_id": "IC_kwDOAP4Jqs7iilcO",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3800717070",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-26T17:13:49Z",
      "updated_at": "2026-01-27T17:42:05Z",
      "author_association": "CONTRIBUTOR",
      "body": "> > [1] note that we could achieve the previous benchmark results by randomizing the outputs within the scan function, to bring down the average iterations to a find a match to N/2. I'm not sure though if that's a good idea; tending to think that modifying \"list of pointer\" arguments is really ugly from an API point of view (even if it's only done for high output counts).\n> \n> [@theStack](https://github.com/theStack) Isn't this already done for the LabelSet approach? The outputs must be sorted to enable binary searches. If we already accept sorting the `tx_outputs`, what is the reason not to accept random shuffling?\n\nThat's a good point. The major difference is that for the LabelSet approach the sorting is important even for the common case (=no match) scenario for performance reasons ($L * log(N)$ vs. $L * N$ output comparisons if we do it with binary vs. linear search), while for the BIP approach it is only relevant to reduce scanning time of pathological transactions. I.e. it boils down to a philosophical question whether we should include \"optimizing for the worst-case\" code paths, and whether we value a clean API more than a 2x speed-up for a scenario that the majority of users will likely never hit in their life-time. I'm leaning towards the former, but am still open for both. ~If I'm not mistaken, sorting outputs should have the same effect as shuffling, given that the generated outputs are pseudorandom~ (EDIT: sorting doesn't work, see https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3803840781). We could:\n* ~sort~/randomize the tx outputs internally (as in the LabelSet approach)\n* shift the responsibility to the user, i.e. recommend or demand from the user to ~sort~/randomize outputs prior calling (by mentioning that in the API docs)\n* not do anything of the above\n* (anything else?)\n\nHappy to hear opinions about that.",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3800717070",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "commented",
      "id": 3802064986,
      "node_id": "IC_kwDOAP4Jqs7inuha",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3802064986",
      "actor": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-26T22:31:00Z",
      "updated_at": "2026-01-26T22:31:00Z",
      "author_association": "NONE",
      "body": "Small note: the LabelSet scan path (PR #1792) still has an optimization opportunity: batch inversion for the per-label candidate points. That reduces field inversions from O(L) to O(L/chunk) per k, which materially improves scanning time at larger label counts. See the benchmark discussion here:\n\nhttps://gist.github.com/theStack/25c77747838610931e8bbeb9d76faf78?permalink_comment_id=5897811#gistcomment-5897811\n\nAlso, the hybrid approach still seems valuable for power user label counts, even if the initial API is a bit clunky. The prototype heuristic (`8 * n_tx_outputs < n_labels + 2`) is a reasonable starting point but can be refined using Rubens cost calculations.",
      "user": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3802064986",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "commented",
      "id": 3803840781,
      "node_id": "IC_kwDOAP4Jqs7iugEN",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3803840781",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-27T08:33:58Z",
      "updated_at": "2026-01-27T08:33:58Z",
      "author_association": "CONTRIBUTOR",
      "body": "In the BIP approach:\n\n>  I.e. it boils down to a philosophical question whether we should include \"optimizing for the worst-case\" code paths, and whether we value a clean API more than a 2x speed-up for a scenario that the majority of users will likely never hit in their life-time. I'm leaning towards the former, but am still open for both. If I'm not mistaken, sorting outputs should have the same effect as shuffling, given that the generated outputs are pseudorandom. \n\nWe can't really rely on outputs being pseudorandom. The non-SP outputs don't need to be random at all, and the other values can be ground by the sender. It should suffice to randomize the direction in which the outputs are processed, i.e., whether you start from the top or the bottom. Thus, we only need one random bit per transaction. We could totally let the user pass a randomness argument and hash it together with the txid, or perform some more efficient PRF to get a random bit.",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3803840781",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "commented",
      "id": 3804147611,
      "node_id": "IC_kwDOAP4Jqs7ivq-b",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3804147611",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-27T09:41:58Z",
      "updated_at": "2026-01-27T09:42:33Z",
      "author_association": "CONTRIBUTOR",
      "body": "\n\n> Labels enable some pretty common use cases, such as knowing who paid you [...]\n\nIndeed, and I consider this almost a requirement for a good UX. (Unless your use case is donations, which is a valid use case but just not the only one.)\n\n@w0xlt approach is a great implementation, but I feel that typical clients will need as many labels as incoming payments, and this makes the BIP approach still quite  attractive.  \n\n> Hmm, in thinking about this, I'm realizing one important factor that has been overlooked. Light clients generally do not have access to the full set of taproot outputs (you could download them, and even apply cut-through, but it'd be more bandwidth), so they'd need the LabelSet approach.\n\nHm, indeed. I just took a look at the [take 3 PR](https://github.com/bitcoin-core/secp256k1/pull/1698) again, and this is a bit hidden there in the API and also in the example because that [one doesn't use labels for the light client](https://github.com/josibake/secp256k1/blob/a0d2a33690e51b79aee037a50ce78e438849b823/examples/silentpayments.c#L478).\n\nBut doesn't this also mean that light clients are inherently limited to a small number of labels due to bandwidth? They need to query every candidate output in a light client protocol... Perhaps some tricks could be played, e.g., reusing a label for a new payment after the first payment has been received. I don't know.\n\n> Perhaps we're not getting around the fact that both approaches have use cases...\n\nYes, this appears to be true. \n\nIf we use the BIP approach for full clients, then light clients will be inherently more restricted *in functionality* and not just in terms of trust/privacy. And how are we going to educate wallet devs and users about this?\n\nIf we use the LabelSet approach for full clients, then even those can't have a massive set of labels, i.e., they can't have a massive set of incoming payments (assuming they want to keep track of them). \n",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3804147611",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "mentioned",
      "id": 22312292757,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUx6pGV",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22312292757",
      "actor": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-27T09:41:59Z"
    },
    {
      "event": "subscribed",
      "id": 22312292792,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUx6pG4",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22312292792",
      "actor": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-27T09:41:59Z"
    },
    {
      "event": "commented",
      "id": 3804502278,
      "node_id": "IC_kwDOAP4Jqs7ixBkG",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3804502278",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-27T10:58:23Z",
      "updated_at": "2026-01-27T10:58:23Z",
      "author_association": "NONE",
      "body": "> We can't really rely on outputs being pseudorandom. The non-SP outputs don't need to be random at all, and the other values can be ground by the sender. It should suffice to randomize the direction in which the outputs are processed, i.e., whether you start from the top or the bottom. Thus, we only need one random bit per transaction. We could totally let the user pass a randomness argument and hash it together with the txid, or perform some more efficient PRF to get a random bit.\n\nI may have misunderstood your suggestion, but to divide the expected runtime by 2, we need to perform a uniform random search. Randomising the direction means that the attacker has a 1/2 chance of triggering the worst-case search scenario; full uniform random shuffling will always ensure the worst-case search runtime is divided by 2.\n\n@theStack  Skipping already matched outputs in the scanning algorithm doesn't produce any speedup in the worst-case ordering without random shuffling, because all the matched outputs are at the end.\nA Fisher-Yates shuffle implementation should be O(N) time, so it shouldn't meaningfully affect scanning time, and the changes to the common case scanning time  should be negligible.",
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3804502278",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "mentioned",
      "id": 22314240495,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUyCEnv",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22314240495",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-27T10:58:25Z"
    },
    {
      "event": "subscribed",
      "id": 22314240525,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUyCEoN",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22314240525",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-27T10:58:25Z"
    },
    {
      "event": "commented",
      "id": 3805045568,
      "node_id": "IC_kwDOAP4Jqs7izGNA",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3805045568",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-27T12:48:05Z",
      "updated_at": "2026-01-27T12:48:05Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Randomising the direction means that the attacker has a 1/2 chance of triggering the worst-case search scenario;\n\nI admit I haven't spent much thought on this, and so I may very well be wrong here. But my current thinking is that if the algorithm needs to look at i outputs to find a specific one at position i when starting from the top, then it will need to look at N-i when starting at the bottom (+/- 1, let's not care). On average, that's i+(N-i)/2 = N/2. Is this wrong? (I agree, the attacker has a 1/2 chance of triggering the worst case, but I think such an attacker will also trigger the best case with probability 1/2.)  ",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3805045568",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "commented",
      "id": 3805275083,
      "node_id": "IC_kwDOAP4Jqs7iz-PL",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3805275083",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-27T13:39:30Z",
      "updated_at": "2026-01-27T13:39:30Z",
      "author_association": "NONE",
      "body": "> I admit I haven't spent much thought on this, and so I may very well be wrong here. But my current thinking is that if the algorithm needs to look at i outputs to find a specific one at position i when starting from the top, then it will need to look at N-i when starting at the bottom (+/- 1, let's not care). On average, that's i+(N-i)/2 = N/2. Is this wrong? (I agree, the attacker has a 1/2 chance of triggering the worst case, but I think such an attacker will also trigger the best case with probability 1/2.\n\nIndeed, the attacker can also trigger the best case with a probability of 1/2, but the runtime will have a high variance (very fast and very slow) as opposed to random shuffling, which will always end up around the N/2 runtime.\n\nIt's also possible to randomise the direction N times, so that half of the time the result is in front and the other half is at the end (if the outputs are sorted in `K` ascending or descending order). We can avoid shuffling this way, but I don't know how to provide the randomness. Going by what you said earlier, we will need N random bits?",
      "user": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3805275083",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "commented",
      "id": 3806803578,
      "node_id": "IC_kwDOAP4Jqs7i5zZ6",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3806803578",
      "actor": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-27T18:27:46Z",
      "updated_at": "2026-01-27T18:27:46Z",
      "author_association": "NONE",
      "body": "> Perhaps we're not getting around the fact that both approaches have use cases...\n\nI might be missing something, but doesnt the hybrid approach address all the scenarios discussed here, without requiring  any protocol restrictions?",
      "user": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3806803578",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "commented",
      "id": 3806902380,
      "node_id": "IC_kwDOAP4Jqs7i6Lhs",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3806902380",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-27T18:49:09Z",
      "updated_at": "2026-01-27T20:58:21Z",
      "author_association": "CONTRIBUTOR",
      "body": "@real-or-random:\n\n> We can't really rely on outputs being pseudorandom. The non-SP outputs don't need to be random at all, and the other values can be ground by the sender.\n\nOh right, I forgot about non-SP outputs, and also oversimplified the SP part in my head, assuming that all recipients would have the same labeled spend pubkey, i.e. L=1 (with differently labeled recpient addresses, each SP output can be ground individually). So sorting outputs doesn't help indeed.\n\n> Hm, indeed. I just took a look at the https://github.com/bitcoin-core/secp256k1/pull/1698 again, and this is a bit hidden there in the API and also in the example because that [one doesn't use labels for the light client](https://github.com/josibake/secp256k1/blob/a0d2a33690e51b79aee037a50ce78e438849b823/examples/silentpayments.c#L478).\n>\n> But doesn't this also mean that light clients are inherently limited to a small number of labels due to bandwidth? They need to query every candidate output in a light client protocol... Perhaps some tricks could be played, e.g., reusing a label for a new payment after the first payment has been received. I don't know.\n\nThat's definitely the case, yes. I believe @RubenSomsen has done some calculations on what number of labels is still feasible for light clients, in light of e.g. the increasing false positive rate of BIP158 filters.\n\n> If we use the BIP approach for full clients, then light clients will be inherently more restricted in functionality and not just in terms of trust/privacy.\n\nI can't follow this conclusion, can you elaborate? I'd agree to the statement \"if we only release the BIP approach for now, the SP module is not useful for light clients (yet)\", and think that's still fine for a first release; focusing on full-node functionality first was in fact the main motivation behind opening the [take 4 PR](https://github.com/bitcoin-core/secp256k1/pull/1765) (but again, not sure if you meant it like that).\n\nMy current understanding is: for light clients, neither a BIP nor LabelSet scanning function alone (e.g. [take 5](https://github.com/bitcoin-core/secp256k1/pull/1792) as-is) are helpful. What they need is a function to derive outputs for each of their spend pubkeys (unlabeled and labeled) and k=0 (that's exactly what [`_recipient_create_output_pubkeys`](https://github.com/josibake/secp256k1/blob/a0d2a33690e51b79aee037a50ce78e438849b823/include/secp256k1_silentpayments.h#L416) in the take 3 PR does), in order to check if a block/tx is relevant for them in the first place. Only if that's the case (i.e. one of the derived outputs is included in the downloaded tx's outputs, and thus a k=0 match has been detected manually by the user), then a \"full\" scanning function would come into play, for also finding the potential remaining outputs (k>=1).\n\nSo concluding from that, I'd think that the ingredients \"BIP approach scanning function\" (released now, already useful for full-nodes on its own) and \"k=0 outputs creation function\" (released later) are sufficient for proper light client support, without noticeable drawbacks in performance. Light client scanners will spend most of their time with the outputs creation function (-> common case, no match), and only ever hit the \"full\" scanning functions for matches, so it shouldn't matter too much in the grand scheme whether BIP or LabelSet approach is used for that last step. Did I miss something? The outputs creation function is in some sense a down-sized variant of LabelSet approach. For optimizing it, @w0xlt's batch inversion idea should work as well and could be explored.\n\n@Eunovo:\n> @theStack Skipping already matched outputs in the scanning algorithm doesn't produce any speedup in the worst-case ordering without random shuffling, because all the matched outputs are at the end.\n\nYes. That insight was discussed last week (see https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3784560045 and https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3785024656).\n\n> A Fisher-Yates shuffle implementation should be O(N) time, so it shouldn't meaningfully affect scanning time, and the changes to the common case scanning time should be negligible.\n\nI agree that performance for the common case shouldn't be an issue if we sort. Even if we were worried about that, we could do it conditionally, e.g. only if the number of outputs is larger than a critical number, or even only after the first match (k=0). The point of my previous post was mostly about introducing more complexity and a slightly less ideal API (modifying \"arrays of pointers\" that are supposed to be only inputs is a bit ugly; on the other hand, we do it on the sender API as well...).",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3806902380",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "mentioned",
      "id": 22325832876,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUyuSys",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22325832876",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-27T18:49:11Z"
    },
    {
      "event": "subscribed",
      "id": 22325832905,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUyuSzJ",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22325832905",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-27T18:49:11Z"
    },
    {
      "event": "mentioned",
      "id": 22325832933,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUyuSzl",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22325832933",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-27T18:49:11Z"
    },
    {
      "event": "subscribed",
      "id": 22325832956,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUyuSz8",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22325832956",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-27T18:49:11Z"
    },
    {
      "event": "mentioned",
      "id": 22325832988,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUyuS0c",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22325832988",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-27T18:49:11Z"
    },
    {
      "event": "subscribed",
      "id": 22325833006,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUyuS0u",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22325833006",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-27T18:49:11Z"
    },
    {
      "event": "mentioned",
      "id": 22325833037,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUyuS1N",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22325833037",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-27T18:49:11Z"
    },
    {
      "event": "subscribed",
      "id": 22325833064,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUyuS1o",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22325833064",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-27T18:49:11Z"
    },
    {
      "event": "mentioned",
      "id": 22325833112,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAUyuS2Y",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22325833112",
      "actor": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-27T18:49:11Z"
    },
    {
      "event": "subscribed",
      "id": 22325833141,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAUyuS21",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22325833141",
      "actor": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-27T18:49:11Z"
    },
    {
      "event": "commented",
      "id": 3808196722,
      "node_id": "IC_kwDOAP4Jqs7i_Hhy",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3808196722",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-28T00:04:36Z",
      "updated_at": "2026-01-28T00:04:36Z",
      "author_association": "CONTRIBUTOR",
      "body": "> > Perhaps we're not getting around the fact that both approaches have use cases...\n> \n> I might be missing something, but doesnt the hybrid approach address all the scenarios discussed here, without requiring any protocol restrictions?\n\nLooking at the worst-case scenario: if the number of labels is very large (let's say L=100_000, to mention a number [that is currently mentioned in BIP-352](https://github.com/bitcoin/bips/blob/3177af3bbf84d2d7e19ef5d7d707807f961af029/bip-0352.mediawiki?plain=1#L369)) and an adversarial tx with N=K=23255 is scanned, then both the BIP and LabelSet approach would suffer from a very high scanning time [1], and hence the hybrid approach wouldn't help us to mitigate.\n\nFor supporting use-cases with a high amount of labels, I don't think there is a way around introducing protocol limits (unless we feel okay with worst-case scanning times in the multiple minutes range, but recent discussions haven't indicated that).\n\n[1] Under the assumption that a match is found after iterating over L/2 labels on average with LabelSet, that would be N\\*L/2 = ~1.16 billion inner loop iterations in total, each doing one EC point addition. With BIP style scanning, we have an upper bound of N\\*N/2 = ~270 million inner loop iterations, each doing two EC point additions. So for this specific example, LabelSet seems to do strictly worse, even without the \"randomize outputs\" speedup for the BIP approach. (Maybe we should benchmark it though to verify, these calculations e.g. don't take potential batch inversion optimizations into account.)",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3808196722",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "commented",
      "id": 3813009615,
      "node_id": "IC_kwDOAP4Jqs7jRejP",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3813009615",
      "actor": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-28T18:16:03Z",
      "updated_at": "2026-01-28T18:16:03Z",
      "author_association": "NONE",
      "body": ">   if the number of labels is very large (let's say L=100_000 ... both the BIP and LabelSet approach would suffer from a very high scanning time\n\nYes, I was thinking about PR #1792 (L  500). If we want to support a large number of labels, the hybrid approach alone is unlikely to handle the worst-case scenario. Ill run some benchmarks later.",
      "user": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3813009615",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "commented",
      "id": 3817820088,
      "node_id": "IC_kwDOAP4Jqs7jj0-4",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3817820088",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-29T13:51:22Z",
      "updated_at": "2026-01-29T13:51:27Z",
      "author_association": "CONTRIBUTOR",
      "body": "For randomization:\n\n> Indeed, the attacker can also trigger the best case with a probability of 1/2, but the runtime will have a high variance (very fast and very slow) as opposed to random shuffling, which will always end up around the N/2 runtime.\n> \n> It's also possible to randomise the direction N times, so that half of the time the result is in front and the other half is at the end (if the outputs are sorted in `K` ascending or descending order). We can avoid shuffling this way, but I don't know how to provide the randomness. Going by what you said earlier, we will need N random bits?\n\nOkay, yeah, we may want to randomize the direction in every loop iteration. This still seems to be simpler (and more efficient?) than a random shuffle. Obtaining random bits is an orthogonal issue in the sense that it will be necessary for any kind randomization we may want to use. \n\nTaking a step back, I believe this randomization discussion is relevant to this thread, but it's not the primary thing that is blocking us from making progress. Perhaps what we could do now is to add an (optional?) `rand32` arg, i.e., 32 bytes of caller-provided randomness, to the scanning API. The value could even be entirely unused in the first iteration that we merge, but this leaves us all doors open for future refinements. ",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3817820088",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "commented",
      "id": 3820028498,
      "node_id": "IC_kwDOAP4Jqs7jsQJS",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3820028498",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-29T20:06:17Z",
      "updated_at": "2026-01-29T20:06:17Z",
      "author_association": "CONTRIBUTOR",
      "body": "> Taking a step back, I believe this randomization discussion is relevant to this thread, but it's not the primary thing that is blocking us from making progress.\n\nAgree. The ~2x speedup gained from randomization is nice and we should implement it in some way or another, but it doesn't address the fundamental issue of quadratic scaling. Doing only that, we're unfortunately still operating in the same order of magnitude.\n\nIn my view, the primary blocker to move forward is reaching an agreement on a concrete K_max limit. This is based on my impression that there is general consensus regarding the importance of use cases with a high number of labels, which suggests a BIP-style scanning approach with a protocol fix. Light clients are limited by the number of labels they can use, but that's an inherent problem, and as far as I understood not something a secp256k1 module could solve (releasing the LabelSet approach scanning function in [take 5](https://github.com/bitcoin-core/secp256k1/pull/1792) wouldn't change anything about that fact, as it is only faster if the label count is very low; the main problem though is not having full transaction and prevouts data in the first place).\n\nI'll update the [take 4 draft PR](https://github.com/bitcoin-core/secp256k1/pull/1765), by implementing the limitation with an arbitrary value (maybe with K=1000, since that was [suggested before](https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3787281788) and seems to at least not have received strong objections so far) on both sender and receiver sides, and include the worst-case benchmarks shown above, so it's easier for reviewers to form an opinion and experiment with other K_max values.\n\nHappy to hear feedback about the approach to move on, I'll also ping developers of existing SP wallets to chime in the discussion. One question might be if this is even the right place to discuss protocol changes, or should that happen on the mailing list instead, and/or a PR in the bips repository (my intuition would be to only open a BIPs PR after we already have a consensus on what the limit would be)?\n\n> Perhaps what we could do now is to add an (optional?) rand32 arg, i.e., 32 bytes of caller-provided randomness, to the scanning API. The value could even be entirely unused in the first iteration that we merge, but this leaves us all doors open for future refinements.\n\nMakes sense to stay flexible. Before going ahead with that, an alternative idea: instead of an explicit parameter, would it be an option to leverage the secp256k1_context for that purpose, e.g. with a `_silentpayments_context_randomize` function (that could still be introduced in the future)? I'm asking this since the API is already quite large w.r.t. number of parameters (currently the BIP approach scanning function has 10 parameters, with the additional `rand32` it would be 11...), and passing in a different randomness each time the scan function is called seems not needed; it should be sufficient to set it once at the start when the module is initialized (reusing seems fine, it doesn't gain the attacker any advantage)?",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3820028498",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "commented",
      "id": 3822705303,
      "node_id": "IC_kwDOAP4Jqs7j2dqX",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3822705303",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-30T09:22:03Z",
      "updated_at": "2026-01-30T09:27:07Z",
      "author_association": "CONTRIBUTOR",
      "body": "> would it be an option to leverage the secp256k1_context for that purpose, e.g. with a `_silentpayments_context_randomize` function (that could still be introduced in the future)? [...] and passing in a different randomness each time the scan function is called seems not needed; it should be sufficient to set it once at the start when the module is initialized (reusing seems fine, it doesn't gain the attacker any advantage)?\n\nOh sure. We could reuse the same randomness every time. It's just the secret of some PRF and the attacker won't learn about it if we just throw it into some SHA256 or similar. [1] I'd even go a step further. We already have functionality to randomize the context (for protecting `ecmult_gen`), so we could simply reuse that randomness. This means we don't have to change the API at all, great call.\n\n\n[1] This reminds me of the secret key in the SipHash PRF even. It's \"secret\" but also only relevant to performance in the end.",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3822705303",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "commented",
      "id": 3822979666,
      "node_id": "IC_kwDOAP4Jqs7j3gpS",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3822979666",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-01-30T10:24:23Z",
      "updated_at": "2026-01-30T10:30:14Z",
      "author_association": "CONTRIBUTOR",
      "body": "> > If we use the BIP approach for full clients, then light clients will be inherently more restricted in functionality and not just in terms of trust/privacy.\n> \n> I can't follow this conclusion, can you elaborate? [...]\n> \n> My current understanding is: for light clients, neither a BIP nor LabelSet scanning function alone (e.g. [take 5](https://github.com/bitcoin-core/secp256k1/pull/1792) as-is) are helpful. What they need is a function to derive outputs for each of their spend pubkeys (unlabeled and labeled) and k=0 (that's exactly what [`_recipient_create_output_pubkeys`](https://github.com/josibake/secp256k1/blob/a0d2a33690e51b79aee037a50ce78e438849b823/include/secp256k1_silentpayments.h#L416) in the take 3 PR does), in order to check if a block/tx is relevant for them in the first place. Only if that's the case (i.e. one of the derived outputs is included in the downloaded tx's outputs, and thus a k=0 match has been detected manually by the user), then a \"full\" scanning function would come into play, for also finding the potential remaining outputs (k>=1).\n\nYes, that's my understanding, too. I think the confusion comes from me using the term \"LabelSet approach\" a bit more broadly.\n\nMy thinking is, and I believe that matches Ruben's insight from above, that the performance of light clients will at least have a linear factor in the number L of labels. As you say, a light client will need to derive L outputs (k=0 each) per eligible transaction and will also need to send these over the wire as part of some light client protocol, which checks inclusion in the UTXO set. This means that a light client needs o(L) computation and o(L) bandwidth for scanning. This is similar in performance to the LabelSet scanning approach for full clients, and this makes it slow for use cases with a large number of labels. In contrast, the running time of the BIP approach does not really depend on the number of labels (under our working assumption that lookups in the label cache are O(1)).\n\nThis means that, if we move forward with the BIP approach, then, for instance, a wallet generated on a full client may not be portable to a light client due to the two scanning methods having different performance characteristics. But perhaps this is simply a drawback that we need to accept if we want to move forward at all.\n\nedit: Sorry, I had submitted this accidentally when I was still in the middle of writing.",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3822979666",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "commented",
      "id": 3842046237,
      "node_id": "IC_kwDOAP4Jqs7lAPkd",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3842046237",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T15:35:59Z",
      "updated_at": "2026-02-03T15:35:59Z",
      "author_association": "CONTRIBUTOR",
      "body": "@real-or-random: Thanks for elaborating, that pretty much matches my understanding.\n\n> This means that, if we move forward with the BIP approach, then, for instance, a wallet generated on a full client may not be portable to a light client due to the two scanning methods having different performance characteristics. But perhaps this is simply a drawback that we need to accept if we want to move forward at all.\n\nI agree that this is a potential drawback. If we document that trade-off properly in the API docs and explain the implications of generating/scanning a high number of labels, I tend to think that's acceptable though?\n\nI've drafted a potential change in BIP-352 for introducing a K_max protocol limit as discussed before: https://github.com/theStack/bips/commit/961d1442139ceecd6c0cc5775ef911d69aabed4c (the value 1000 should be seen as a placeholder; what changes with different values is the last sentence in the footnote, e.g. with K_max=100 it would be \"order of seconds\" instead). The [\"take 4\" PR](https://github.com/bitcoin-core/secp256k1/pull/1765) has also been updated to enforce that change: https://github.com/bitcoin-core/secp256k1/pull/1765#issuecomment-3837059903\n\nTo gauge feedback on this protocol restriction in the broader ecosystem, I'm pinging developers of existing and upcoming wallets with Silent Payments support: @benma @craigraw @cygnet3 @Eunovo @jvgelder @nymius @pythcoiner @setavenger @Sosthene00\nPlease comment if you have any concerns about a [K_max protocol restriction](https://github.com/theStack/bips/commit/961d1442139ceecd6c0cc5775ef911d69aabed4c), for current or potential future SP use cases.\n\n(As mentioned in a previous comment, if someone feels the discussion should happen elsewhere, like e.g. the mailing list, I'm fine to move over there as well, though I'm not sure if that's necessary).",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3842046237",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "mentioned",
      "id": 22501070169,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAU9KxVZ",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22501070169",
      "actor": {
        "login": "craigraw",
        "id": 862166,
        "node_id": "MDQ6VXNlcjg2MjE2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/862166?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/craigraw",
        "html_url": "https://github.com/craigraw",
        "followers_url": "https://api.github.com/users/craigraw/followers",
        "following_url": "https://api.github.com/users/craigraw/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/craigraw/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/craigraw/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/craigraw/subscriptions",
        "organizations_url": "https://api.github.com/users/craigraw/orgs",
        "repos_url": "https://api.github.com/users/craigraw/repos",
        "events_url": "https://api.github.com/users/craigraw/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/craigraw/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T15:36:01Z"
    },
    {
      "event": "subscribed",
      "id": 22501070191,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAU9KxVv",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22501070191",
      "actor": {
        "login": "craigraw",
        "id": 862166,
        "node_id": "MDQ6VXNlcjg2MjE2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/862166?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/craigraw",
        "html_url": "https://github.com/craigraw",
        "followers_url": "https://api.github.com/users/craigraw/followers",
        "following_url": "https://api.github.com/users/craigraw/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/craigraw/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/craigraw/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/craigraw/subscriptions",
        "organizations_url": "https://api.github.com/users/craigraw/orgs",
        "repos_url": "https://api.github.com/users/craigraw/repos",
        "events_url": "https://api.github.com/users/craigraw/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/craigraw/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T15:36:01Z"
    },
    {
      "event": "mentioned",
      "id": 22501070343,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAU9KxYH",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22501070343",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T15:36:02Z"
    },
    {
      "event": "subscribed",
      "id": 22501070382,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAU9KxYu",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22501070382",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T15:36:02Z"
    },
    {
      "event": "mentioned",
      "id": 22501070427,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAU9KxZb",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22501070427",
      "actor": {
        "login": "benma",
        "id": 1225267,
        "node_id": "MDQ6VXNlcjEyMjUyNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1225267?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benma",
        "html_url": "https://github.com/benma",
        "followers_url": "https://api.github.com/users/benma/followers",
        "following_url": "https://api.github.com/users/benma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benma/subscriptions",
        "organizations_url": "https://api.github.com/users/benma/orgs",
        "repos_url": "https://api.github.com/users/benma/repos",
        "events_url": "https://api.github.com/users/benma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benma/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T15:36:02Z"
    },
    {
      "event": "subscribed",
      "id": 22501070449,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAU9KxZx",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22501070449",
      "actor": {
        "login": "benma",
        "id": 1225267,
        "node_id": "MDQ6VXNlcjEyMjUyNjc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1225267?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/benma",
        "html_url": "https://github.com/benma",
        "followers_url": "https://api.github.com/users/benma/followers",
        "following_url": "https://api.github.com/users/benma/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/benma/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/benma/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/benma/subscriptions",
        "organizations_url": "https://api.github.com/users/benma/orgs",
        "repos_url": "https://api.github.com/users/benma/repos",
        "events_url": "https://api.github.com/users/benma/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/benma/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T15:36:02Z"
    },
    {
      "event": "mentioned",
      "id": 22501070580,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAU9Kxb0",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22501070580",
      "actor": {
        "login": "jvgelder",
        "id": 7516555,
        "node_id": "MDQ6VXNlcjc1MTY1NTU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7516555?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jvgelder",
        "html_url": "https://github.com/jvgelder",
        "followers_url": "https://api.github.com/users/jvgelder/followers",
        "following_url": "https://api.github.com/users/jvgelder/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jvgelder/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jvgelder/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jvgelder/subscriptions",
        "organizations_url": "https://api.github.com/users/jvgelder/orgs",
        "repos_url": "https://api.github.com/users/jvgelder/repos",
        "events_url": "https://api.github.com/users/jvgelder/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jvgelder/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T15:36:02Z"
    },
    {
      "event": "subscribed",
      "id": 22501070611,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAU9KxcT",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22501070611",
      "actor": {
        "login": "jvgelder",
        "id": 7516555,
        "node_id": "MDQ6VXNlcjc1MTY1NTU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7516555?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jvgelder",
        "html_url": "https://github.com/jvgelder",
        "followers_url": "https://api.github.com/users/jvgelder/followers",
        "following_url": "https://api.github.com/users/jvgelder/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jvgelder/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jvgelder/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jvgelder/subscriptions",
        "organizations_url": "https://api.github.com/users/jvgelder/orgs",
        "repos_url": "https://api.github.com/users/jvgelder/repos",
        "events_url": "https://api.github.com/users/jvgelder/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jvgelder/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T15:36:02Z"
    },
    {
      "event": "mentioned",
      "id": 22501070642,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAU9Kxcy",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22501070642",
      "actor": {
        "login": "Sosthene00",
        "id": 11726747,
        "node_id": "MDQ6VXNlcjExNzI2NzQ3",
        "avatar_url": "https://avatars.githubusercontent.com/u/11726747?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sosthene00",
        "html_url": "https://github.com/Sosthene00",
        "followers_url": "https://api.github.com/users/Sosthene00/followers",
        "following_url": "https://api.github.com/users/Sosthene00/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sosthene00/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sosthene00/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sosthene00/subscriptions",
        "organizations_url": "https://api.github.com/users/Sosthene00/orgs",
        "repos_url": "https://api.github.com/users/Sosthene00/repos",
        "events_url": "https://api.github.com/users/Sosthene00/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sosthene00/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T15:36:02Z"
    },
    {
      "event": "subscribed",
      "id": 22501070667,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAU9KxdL",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22501070667",
      "actor": {
        "login": "Sosthene00",
        "id": 11726747,
        "node_id": "MDQ6VXNlcjExNzI2NzQ3",
        "avatar_url": "https://avatars.githubusercontent.com/u/11726747?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Sosthene00",
        "html_url": "https://github.com/Sosthene00",
        "followers_url": "https://api.github.com/users/Sosthene00/followers",
        "following_url": "https://api.github.com/users/Sosthene00/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Sosthene00/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Sosthene00/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Sosthene00/subscriptions",
        "organizations_url": "https://api.github.com/users/Sosthene00/orgs",
        "repos_url": "https://api.github.com/users/Sosthene00/repos",
        "events_url": "https://api.github.com/users/Sosthene00/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Sosthene00/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T15:36:02Z"
    },
    {
      "event": "mentioned",
      "id": 22501070708,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAU9Kxd0",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22501070708",
      "actor": {
        "login": "setavenger",
        "id": 34041358,
        "node_id": "MDQ6VXNlcjM0MDQxMzU4",
        "avatar_url": "https://avatars.githubusercontent.com/u/34041358?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/setavenger",
        "html_url": "https://github.com/setavenger",
        "followers_url": "https://api.github.com/users/setavenger/followers",
        "following_url": "https://api.github.com/users/setavenger/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/setavenger/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/setavenger/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/setavenger/subscriptions",
        "organizations_url": "https://api.github.com/users/setavenger/orgs",
        "repos_url": "https://api.github.com/users/setavenger/repos",
        "events_url": "https://api.github.com/users/setavenger/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/setavenger/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T15:36:02Z"
    },
    {
      "event": "subscribed",
      "id": 22501070729,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAU9KxeJ",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22501070729",
      "actor": {
        "login": "setavenger",
        "id": 34041358,
        "node_id": "MDQ6VXNlcjM0MDQxMzU4",
        "avatar_url": "https://avatars.githubusercontent.com/u/34041358?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/setavenger",
        "html_url": "https://github.com/setavenger",
        "followers_url": "https://api.github.com/users/setavenger/followers",
        "following_url": "https://api.github.com/users/setavenger/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/setavenger/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/setavenger/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/setavenger/subscriptions",
        "organizations_url": "https://api.github.com/users/setavenger/orgs",
        "repos_url": "https://api.github.com/users/setavenger/repos",
        "events_url": "https://api.github.com/users/setavenger/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/setavenger/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T15:36:02Z"
    },
    {
      "event": "mentioned",
      "id": 22501070760,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAU9Kxeo",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22501070760",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T15:36:02Z"
    },
    {
      "event": "subscribed",
      "id": 22501070799,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAU9KxfP",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22501070799",
      "actor": {
        "login": "Eunovo",
        "id": 37949128,
        "node_id": "MDQ6VXNlcjM3OTQ5MTI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/37949128?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Eunovo",
        "html_url": "https://github.com/Eunovo",
        "followers_url": "https://api.github.com/users/Eunovo/followers",
        "following_url": "https://api.github.com/users/Eunovo/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/Eunovo/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/Eunovo/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/Eunovo/subscriptions",
        "organizations_url": "https://api.github.com/users/Eunovo/orgs",
        "repos_url": "https://api.github.com/users/Eunovo/repos",
        "events_url": "https://api.github.com/users/Eunovo/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/Eunovo/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T15:36:03Z"
    },
    {
      "event": "mentioned",
      "id": 22501070862,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAU9KxgO",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22501070862",
      "actor": {
        "login": "pythcoiner",
        "id": 124568858,
        "node_id": "U_kgDOB2zFGg",
        "avatar_url": "https://avatars.githubusercontent.com/u/124568858?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pythcoiner",
        "html_url": "https://github.com/pythcoiner",
        "followers_url": "https://api.github.com/users/pythcoiner/followers",
        "following_url": "https://api.github.com/users/pythcoiner/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pythcoiner/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pythcoiner/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pythcoiner/subscriptions",
        "organizations_url": "https://api.github.com/users/pythcoiner/orgs",
        "repos_url": "https://api.github.com/users/pythcoiner/repos",
        "events_url": "https://api.github.com/users/pythcoiner/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pythcoiner/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T15:36:03Z"
    },
    {
      "event": "subscribed",
      "id": 22501070896,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAU9Kxgw",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22501070896",
      "actor": {
        "login": "pythcoiner",
        "id": 124568858,
        "node_id": "U_kgDOB2zFGg",
        "avatar_url": "https://avatars.githubusercontent.com/u/124568858?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pythcoiner",
        "html_url": "https://github.com/pythcoiner",
        "followers_url": "https://api.github.com/users/pythcoiner/followers",
        "following_url": "https://api.github.com/users/pythcoiner/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pythcoiner/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pythcoiner/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pythcoiner/subscriptions",
        "organizations_url": "https://api.github.com/users/pythcoiner/orgs",
        "repos_url": "https://api.github.com/users/pythcoiner/repos",
        "events_url": "https://api.github.com/users/pythcoiner/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pythcoiner/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T15:36:03Z"
    },
    {
      "event": "mentioned",
      "id": 22501070943,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAU9Kxhf",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22501070943",
      "actor": {
        "login": "cygnet3",
        "id": 131168104,
        "node_id": "U_kgDOB9F3aA",
        "avatar_url": "https://avatars.githubusercontent.com/u/131168104?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/cygnet3",
        "html_url": "https://github.com/cygnet3",
        "followers_url": "https://api.github.com/users/cygnet3/followers",
        "following_url": "https://api.github.com/users/cygnet3/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/cygnet3/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/cygnet3/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/cygnet3/subscriptions",
        "organizations_url": "https://api.github.com/users/cygnet3/orgs",
        "repos_url": "https://api.github.com/users/cygnet3/repos",
        "events_url": "https://api.github.com/users/cygnet3/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/cygnet3/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T15:36:03Z"
    },
    {
      "event": "subscribed",
      "id": 22501070966,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAU9Kxh2",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22501070966",
      "actor": {
        "login": "cygnet3",
        "id": 131168104,
        "node_id": "U_kgDOB9F3aA",
        "avatar_url": "https://avatars.githubusercontent.com/u/131168104?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/cygnet3",
        "html_url": "https://github.com/cygnet3",
        "followers_url": "https://api.github.com/users/cygnet3/followers",
        "following_url": "https://api.github.com/users/cygnet3/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/cygnet3/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/cygnet3/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/cygnet3/subscriptions",
        "organizations_url": "https://api.github.com/users/cygnet3/orgs",
        "repos_url": "https://api.github.com/users/cygnet3/repos",
        "events_url": "https://api.github.com/users/cygnet3/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/cygnet3/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T15:36:03Z"
    },
    {
      "event": "mentioned",
      "id": 22501071002,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAU9Kxia",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22501071002",
      "actor": {
        "login": "nymius",
        "id": 155548262,
        "node_id": "U_kgDOCUV6Zg",
        "avatar_url": "https://avatars.githubusercontent.com/u/155548262?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nymius",
        "html_url": "https://github.com/nymius",
        "followers_url": "https://api.github.com/users/nymius/followers",
        "following_url": "https://api.github.com/users/nymius/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nymius/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nymius/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nymius/subscriptions",
        "organizations_url": "https://api.github.com/users/nymius/orgs",
        "repos_url": "https://api.github.com/users/nymius/repos",
        "events_url": "https://api.github.com/users/nymius/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nymius/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T15:36:03Z"
    },
    {
      "event": "subscribed",
      "id": 22501071026,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAU9Kxiy",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22501071026",
      "actor": {
        "login": "nymius",
        "id": 155548262,
        "node_id": "U_kgDOCUV6Zg",
        "avatar_url": "https://avatars.githubusercontent.com/u/155548262?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nymius",
        "html_url": "https://github.com/nymius",
        "followers_url": "https://api.github.com/users/nymius/followers",
        "following_url": "https://api.github.com/users/nymius/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nymius/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nymius/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nymius/subscriptions",
        "organizations_url": "https://api.github.com/users/nymius/orgs",
        "repos_url": "https://api.github.com/users/nymius/repos",
        "events_url": "https://api.github.com/users/nymius/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nymius/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T15:36:03Z"
    },
    {
      "event": "commented",
      "id": 3843044305,
      "node_id": "IC_kwDOAP4Jqs7lEDPR",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3843044305",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T18:46:25Z",
      "updated_at": "2026-02-03T18:46:25Z",
      "author_association": "CONTRIBUTOR",
      "body": "> I agree that this is a potential drawback. If we document that trade-off properly in the API docs and explain the implications of generating/scanning a high number of labels, I tend to think that's acceptable though?\n\nI tend to agree. When I wrote my comment above, what I had in mind was using labels for different incoming payments in the sense that you create a fresh label for every incoming payment. But that's totally the wrong way because it defeats the purpose of silent payments, namely to avoid the sender and the recipient needing to interact for every payment. \n\nWith that in mind, I suspect that the average SP recipient user doesn't have too many labels, and then light client scanning will be fine.  \n\nOf course, labels are still useful to distinguish payments for different purposes, e.g., some organization receiving donations for multiple distinct purposes, or an exchange receiving deposits could have a label per user. The latter potentially requires a huge number of labels, but that's certainly an advanced use case, and the exchange won't want to use a light client...\n\nI'm curious if this matches @RubenSomsen's thinking. \n\n> (As mentioned in a previous comment, if someone feels the discussion should happen elsewhere, like e.g. the mailing list, I'm fine to move over there as well, though I'm not sure if that's necessary).\n\nThe discussion started here because the issue was caught when reviewing the PR, and there's nothing wrong with that. It would feel a bit unnatural at this stage to move the discussion to the list now (if you ask me.) In any case, we would like to change the BIP first, and this will happen in the BIPs repo.  It may still be a good idea to mention on the mailing list that there's a discussion going on here, with the note that people can also post to the list if they really don't want to use GitHub. @theStack If you agree, can you post to the list?",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3843044305",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "mentioned",
      "id": 22506065478,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAU9d05G",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22506065478",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T18:46:26Z"
    },
    {
      "event": "subscribed",
      "id": 22506065514,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAU9d05q",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22506065514",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T18:46:26Z"
    },
    {
      "event": "mentioned",
      "id": 22506065555,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAU9d06T",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22506065555",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T18:46:26Z"
    },
    {
      "event": "subscribed",
      "id": 22506065570,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAU9d06i",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22506065570",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T18:46:26Z"
    },
    {
      "event": "commented",
      "id": 3843157542,
      "node_id": "IC_kwDOAP4Jqs7lEe4m",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3843157542",
      "actor": {
        "login": "nymius",
        "id": 155548262,
        "node_id": "U_kgDOCUV6Zg",
        "avatar_url": "https://avatars.githubusercontent.com/u/155548262?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nymius",
        "html_url": "https://github.com/nymius",
        "followers_url": "https://api.github.com/users/nymius/followers",
        "following_url": "https://api.github.com/users/nymius/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nymius/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nymius/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nymius/subscriptions",
        "organizations_url": "https://api.github.com/users/nymius/orgs",
        "repos_url": "https://api.github.com/users/nymius/repos",
        "events_url": "https://api.github.com/users/nymius/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nymius/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-03T19:12:40Z",
      "updated_at": "2026-02-03T20:31:05Z",
      "author_association": "NONE",
      "body": "I've been following the discussion, and I think the rationale for limiting `k` is sane.\nI don't have a real counter example yet where this limitation may be detrimental. The ones I have tried are mainly related to exchanges or larger custodians, but they lead me nowhere.\nMaybe Cake Wallet developers have some ideas about it.\n\nI think that mentioning this on the mailing list may bring new eyes with other perspectives to consider the limit.",
      "user": {
        "login": "nymius",
        "id": 155548262,
        "node_id": "U_kgDOCUV6Zg",
        "avatar_url": "https://avatars.githubusercontent.com/u/155548262?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nymius",
        "html_url": "https://github.com/nymius",
        "followers_url": "https://api.github.com/users/nymius/followers",
        "following_url": "https://api.github.com/users/nymius/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/nymius/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/nymius/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/nymius/subscriptions",
        "organizations_url": "https://api.github.com/users/nymius/orgs",
        "repos_url": "https://api.github.com/users/nymius/repos",
        "events_url": "https://api.github.com/users/nymius/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/nymius/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3843157542",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "commented",
      "id": 3844670399,
      "node_id": "IC_kwDOAP4Jqs7lKQO_",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3844670399",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-04T01:09:46Z",
      "updated_at": "2026-02-04T01:10:14Z",
      "author_association": "NONE",
      "body": ">I'm curious if this matches @RubenSomsen's thinking.\n\nIt's hard to predict how people are going to use labels, but if there are going to be SP only wallets that support a large number of labels, then users may still opt to hand out a lot of labels simply to track their incoming payments in the same way they might do with regular wallets today. That may not play into the strengths of SP, but that doesn't necessarily mean we will not see some of that behavior in practice.\n\nIt's also possible that we'd see some light clients that opt to download all the taproot outputs to do BIP style scanning (i.e. supporting 100k labels). It's more bandwidth, but this can be mitigated to some extent using cut-through, similar to the tweak data.\n\nMy general sense is to try and allow for these possibilities, even if it's not at all certain they will come into existence.",
      "user": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3844670399",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "mentioned",
      "id": 22513982151,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAU98BrH",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22513982151",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-04T01:09:47Z"
    },
    {
      "event": "subscribed",
      "id": 22513982168,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAU98BrY",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22513982168",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-04T01:09:47Z"
    },
    {
      "event": "subscribed",
      "id": 22515168289,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAU-AjQh",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22515168289",
      "actor": {
        "login": "pythcoiner",
        "id": 124568858,
        "node_id": "U_kgDOB2zFGg",
        "avatar_url": "https://avatars.githubusercontent.com/u/124568858?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pythcoiner",
        "html_url": "https://github.com/pythcoiner",
        "followers_url": "https://api.github.com/users/pythcoiner/followers",
        "following_url": "https://api.github.com/users/pythcoiner/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pythcoiner/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pythcoiner/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pythcoiner/subscriptions",
        "organizations_url": "https://api.github.com/users/pythcoiner/orgs",
        "repos_url": "https://api.github.com/users/pythcoiner/repos",
        "events_url": "https://api.github.com/users/pythcoiner/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pythcoiner/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-04T02:26:35Z"
    },
    {
      "event": "subscribed",
      "id": 22515171696,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAU-AkFw",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22515171696",
      "actor": {
        "login": "pythcoiner",
        "id": 124568858,
        "node_id": "U_kgDOB2zFGg",
        "avatar_url": "https://avatars.githubusercontent.com/u/124568858?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pythcoiner",
        "html_url": "https://github.com/pythcoiner",
        "followers_url": "https://api.github.com/users/pythcoiner/followers",
        "following_url": "https://api.github.com/users/pythcoiner/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/pythcoiner/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/pythcoiner/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/pythcoiner/subscriptions",
        "organizations_url": "https://api.github.com/users/pythcoiner/orgs",
        "repos_url": "https://api.github.com/users/pythcoiner/repos",
        "events_url": "https://api.github.com/users/pythcoiner/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/pythcoiner/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-04T02:26:48Z"
    },
    {
      "event": "commented",
      "id": 3846321199,
      "node_id": "IC_kwDOAP4Jqs7lQjQv",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3846321199",
      "actor": {
        "login": "craigraw",
        "id": 862166,
        "node_id": "MDQ6VXNlcjg2MjE2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/862166?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/craigraw",
        "html_url": "https://github.com/craigraw",
        "followers_url": "https://api.github.com/users/craigraw/followers",
        "following_url": "https://api.github.com/users/craigraw/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/craigraw/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/craigraw/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/craigraw/subscriptions",
        "organizations_url": "https://api.github.com/users/craigraw/orgs",
        "repos_url": "https://api.github.com/users/craigraw/repos",
        "events_url": "https://api.github.com/users/craigraw/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/craigraw/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-04T09:29:48Z",
      "updated_at": "2026-02-04T09:29:48Z",
      "author_association": "NONE",
      "body": "> I agree that this is a potential drawback. If we document that trade-off properly in the API docs and explain the implications of generating/scanning a high number of labels, I tend to think that's acceptable though?\n\nI don't agree. The benefit of a high number of labels (which is relatively weak in most cases) does not outweigh the benefit of user optionality to switch wallet software. Putting it another way, I would take a working ecosystem of silent payments wallets using different scanning techniques over a theoretical advantage of tracking incoming payments with labels. Every payment needs a payment confirmation, and we should explore ways of doing this that align with static payment codes rather than compromising the ecosystem with an approach that does not scale well and runs contrary to its design goals.\n\n> Please comment if you have any concerns about a [K_max protocol restriction](https://github.com/theStack/bips/commit/961d1442139ceecd6c0cc5775ef911d69aabed4c), for current or potential future SP use cases.\n\nIMO any use of labels over a small number greatly compromises the practical ability of light clients to recover the wallet. I believe data makes the point best. I estimated the required time to scan 1000 labels using Frigate on an 8x RTX 3060 GPU machine over a 64 week period:\n||Time (ms)|\tTx/sec|\n|-|-|-|\n|No label|\t16,949\t|4,199,074|\n|Change label|\t17,042\t|4,176,159|\n|10 labels|\t19,334\t|3,681,086|\n|30 labels|\t25,109\t|2,834,446|\n|1000 labels (est.) | 291,000 (4.9 min) | 244,000|\n\n\n",
      "user": {
        "login": "craigraw",
        "id": 862166,
        "node_id": "MDQ6VXNlcjg2MjE2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/862166?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/craigraw",
        "html_url": "https://github.com/craigraw",
        "followers_url": "https://api.github.com/users/craigraw/followers",
        "following_url": "https://api.github.com/users/craigraw/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/craigraw/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/craigraw/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/craigraw/subscriptions",
        "organizations_url": "https://api.github.com/users/craigraw/orgs",
        "repos_url": "https://api.github.com/users/craigraw/repos",
        "events_url": "https://api.github.com/users/craigraw/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/craigraw/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3846321199",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "commented",
      "id": 3846948636,
      "node_id": "IC_kwDOAP4Jqs7lS8cc",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3846948636",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-04T11:41:28Z",
      "updated_at": "2026-02-04T11:45:58Z",
      "author_association": "NONE",
      "body": ">The benefit of a high number of labels (which is relatively weak in most cases) does not outweigh the benefit of user optionality to switch wallet software\n\nWhile I don't share the conclusion, I recognize the concern. It is plausible we will have two types of wallets: those that support a large number of labels and those that do not. The former will be cross-compatible with the latter but _not_ vice versa.\n\n>greatly compromises the practical ability of light clients to recover the wallet\n\nAllow me to point out that we need more precise terminology here. In this thread we have been talking about two types of wallets - those that run their own full node and those that use auxiliary data to do the scanning. The latter has (perhaps imprecisely) been referred to as a \"light client\". What you are referring to here is a third model of \"outsourced scanning\". \n\n>I believe data makes the point best\n\nI think this is an interesting model and it needs to be further explored, and the field of parallel GPU computation seems under-explored in general, but I think these benchmarks need more work.\n\nThe benchmarks only implement the LabelSet approach - from what I understand that was design choice to avoid the need to receive, store, or re-calculate a user's labels (up to ~4MB). I am not necessarily convinced that is the right tradeoff.\n\nAnd from what I saw, there were also numbers produced saying 8x RTX 3080 was several times _slower_ than 8x RTX 3060 - which until investigated further makes these numbers seem somewhat unreliable.\n\nThe drop-off in performance with more labels also seems more steep than what we've encountered in other benchmarks, but the general trend is indisputably correct - LabelSet does not perform well at a high number of labels.\n\nBut regardless of where these benchmarks end up, we still have two distinct label limits for wallets. What I'd like to see is for there to be two clear standards to maximize cross-compatibility between the wallets that support the lower number of labels. Otherwise some wallets support 10 labels and some 25, and things do get messy.\n\nWith good engineering we ought to be able to get the more restricted wallets to still support up to 100 labels. Even in the outsourced scanning model without storing data it's doable to re-calculate 100 labels for every scan session and do BIP style scanning. And for light clients that rely on auxiliary data it's possible to implement custom block filters that will perform well enough for this use case. That said, the path with least resistance is certainly to either have 100k labels or none (except change) as the two limits.\n\n---\n\nSummarizing the problem neutrally: BIP style scanning, which is required to support many labels, cannot be applied across the board. For light clients that rely on auxiliary data this is because the bandwidth optimal way does not give access to taproot outputs (though some clients may opt to use more bandwidth). For outsourced scanning the results seem inconclusive, but one problem stems around the fact that the full set of labels needs to be available for every user when scanning. Given that BIP style scanning may not see full adoption, the question arises whether this is a good enough reason to drop label support altogether in order to maximize cross-compatibility.",
      "user": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3846948636",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "commented",
      "id": 3847359298,
      "node_id": "IC_kwDOAP4Jqs7lUgtC",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3847359298",
      "actor": {
        "login": "craigraw",
        "id": 862166,
        "node_id": "MDQ6VXNlcjg2MjE2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/862166?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/craigraw",
        "html_url": "https://github.com/craigraw",
        "followers_url": "https://api.github.com/users/craigraw/followers",
        "following_url": "https://api.github.com/users/craigraw/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/craigraw/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/craigraw/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/craigraw/subscriptions",
        "organizations_url": "https://api.github.com/users/craigraw/orgs",
        "repos_url": "https://api.github.com/users/craigraw/repos",
        "events_url": "https://api.github.com/users/craigraw/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/craigraw/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-04T13:07:42Z",
      "updated_at": "2026-02-04T13:07:42Z",
      "author_association": "NONE",
      "body": "> And from what I saw, there were also numbers produced saying 8x RTX 3080 was several times slower than 8x RTX 3060 - which until investigated further makes these numbers seem somewhat unreliable.\n\nThis is incorrect afaik (see [benchmarks](https://github.com/sparrowwallet/frigate/blob/master/BENCHMARKING.md)) although it does appear that more independent memory controllers and PCIe lanes is a factor. I agree that further research into this is required, but it's somewhat unrelated to this discussion: with an outsourced scanning model that uses ephemeral client keys, you cannot use the BIP style scanning approach. I think we agree here anyway.\n\nI believe it is worth considering other approaches to payment origination/confirmation before committing to a \"two types of sp wallet\" future.\n\n",
      "user": {
        "login": "craigraw",
        "id": 862166,
        "node_id": "MDQ6VXNlcjg2MjE2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/862166?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/craigraw",
        "html_url": "https://github.com/craigraw",
        "followers_url": "https://api.github.com/users/craigraw/followers",
        "following_url": "https://api.github.com/users/craigraw/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/craigraw/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/craigraw/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/craigraw/subscriptions",
        "organizations_url": "https://api.github.com/users/craigraw/orgs",
        "repos_url": "https://api.github.com/users/craigraw/repos",
        "events_url": "https://api.github.com/users/craigraw/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/craigraw/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3847359298",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "commented",
      "id": 3847614999,
      "node_id": "IC_kwDOAP4Jqs7lVfIX",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3847614999",
      "actor": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-04T13:56:49Z",
      "updated_at": "2026-02-04T13:58:38Z",
      "author_association": "NONE",
      "body": ">This is incorrect afaik (see [benchmarks](https://github.com/sparrowwallet/frigate/blob/master/BENCHMARKING.md))\n\nI don't want to publish anything that was not explicitly made public, but those benchmarks do not contain the 3080, while the ones I saw in a spreadsheet do. Am I wrong to assume you have seen them?\n\n>it does appear that more independent memory controllers and PCIe lanes is a factor. I agree that further research into this is required\n\nYes, I am very much interested in having the bottlenecks mapped out.\n\n>an outsourced scanning model that uses ephemeral client keys, you cannot use the BIP style scanning approach\n\nWhile I don't think this affects the more general conclusion that some wallets likely won't be supporting BIP style scanning, I don't fully agree with that statement. At a modest number of labels (e.g. 100), the labels can be generated on-the-fly without prohibitive cost, and then the BIP style approach will be faster. Technically it would also be possible for the user (or a third party on behalf of the user) to send all of its label data (100k = ~4MB) to the server. And depending on how you define \"ephemeral\", storing encrypted label data for which you forget the decryption key (most logically the scan private key) would also work.\n\n>I believe it is worth considering other approaches to payment origination/confirmation\n\nWhat did you have in mind? [Notifications](https://delvingbitcoin.org/t/silent-payments-notifications-via-nostr/2203)?\n\n---\n\nOne more general high level observation: I think the issue is that the \"right\" choice in terms of protocol constraints very much depends on what kind of wallet ecosystem consequently will come into existence - this is difficult to predict and seems to be where the majority of the disagreement originates from.",
      "user": {
        "login": "RubenSomsen",
        "id": 9066803,
        "node_id": "MDQ6VXNlcjkwNjY4MDM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9066803?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RubenSomsen",
        "html_url": "https://github.com/RubenSomsen",
        "followers_url": "https://api.github.com/users/RubenSomsen/followers",
        "following_url": "https://api.github.com/users/RubenSomsen/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/RubenSomsen/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/RubenSomsen/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/RubenSomsen/subscriptions",
        "organizations_url": "https://api.github.com/users/RubenSomsen/orgs",
        "repos_url": "https://api.github.com/users/RubenSomsen/repos",
        "events_url": "https://api.github.com/users/RubenSomsen/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/RubenSomsen/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3847614999",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "commented",
      "id": 3848487567,
      "node_id": "IC_kwDOAP4Jqs7lY0KP",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3848487567",
      "actor": {
        "login": "macgyver13",
        "id": 4712150,
        "node_id": "MDQ6VXNlcjQ3MTIxNTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4712150?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/macgyver13",
        "html_url": "https://github.com/macgyver13",
        "followers_url": "https://api.github.com/users/macgyver13/followers",
        "following_url": "https://api.github.com/users/macgyver13/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/macgyver13/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/macgyver13/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/macgyver13/subscriptions",
        "organizations_url": "https://api.github.com/users/macgyver13/orgs",
        "repos_url": "https://api.github.com/users/macgyver13/repos",
        "events_url": "https://api.github.com/users/macgyver13/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/macgyver13/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-04T16:34:42Z",
      "updated_at": "2026-02-04T16:34:42Z",
      "author_association": "NONE",
      "body": "I'd like to clarify the context around the benchmarking data that's been referenced in this discussion.\n\nThe benchmark spreadsheet I shared was intended to inform hardware selection for hosting a scanning cluster, not to make protocol-level recommendations. The data was collected on virtual instances from vast.ai without performance guarantees, so accuracy may vary.  I shared these results informally with community members to provide general guidance, but intentionally avoided publishing them as definitive facts because the methodology wasn't rigorous enough. My goal was to support informed discussion, not to establish concrete benchmarks.\n\n> And from what I saw, there were also numbers produced saying 8x RTX 3080 was several times slower than 8x RTX 3060 - which until investigated further makes these numbers seem somewhat unreliable.\n\nThe difference between 8x RTX 3060 and 8x RTX 3080 based on my testing is not sufficient to draw strong conclusions. I have had retesting some of the results on my list but have kept putting it off for several months now. Using verifiable hardware and establishing a trusted benchmarking process are probably the next best steps if such data is deemed valuable. I am happy to support that effort - please reach out if you have resources.\n\nRe: [benchmarks](https://github.com/sparrowwallet/frigate/blob/master/BENCHMARKING.md) I will stand behind the claim that more \"lower cost\" GPUs do perform better than fewer \"higher cost\" GPUs under multi-user workloads. \n\nI want to support this important conversation about scanning approaches while ensuring the data is used appropriately - as directional input rather than authoritative measurements.",
      "user": {
        "login": "macgyver13",
        "id": 4712150,
        "node_id": "MDQ6VXNlcjQ3MTIxNTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4712150?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/macgyver13",
        "html_url": "https://github.com/macgyver13",
        "followers_url": "https://api.github.com/users/macgyver13/followers",
        "following_url": "https://api.github.com/users/macgyver13/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/macgyver13/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/macgyver13/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/macgyver13/subscriptions",
        "organizations_url": "https://api.github.com/users/macgyver13/orgs",
        "repos_url": "https://api.github.com/users/macgyver13/repos",
        "events_url": "https://api.github.com/users/macgyver13/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/macgyver13/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3848487567",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "commented",
      "id": 3849763006,
      "node_id": "IC_kwDOAP4Jqs7ldri-",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3849763006",
      "actor": {
        "login": "defenwycke",
        "id": 200950953,
        "node_id": "U_kgDOC_pEqQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/200950953?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/defenwycke",
        "html_url": "https://github.com/defenwycke",
        "followers_url": "https://api.github.com/users/defenwycke/followers",
        "following_url": "https://api.github.com/users/defenwycke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/defenwycke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/defenwycke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/defenwycke/subscriptions",
        "organizations_url": "https://api.github.com/users/defenwycke/orgs",
        "repos_url": "https://api.github.com/users/defenwycke/repos",
        "events_url": "https://api.github.com/users/defenwycke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/defenwycke/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-04T21:10:29Z",
      "updated_at": "2026-02-04T21:11:49Z",
      "author_association": "NONE",
      "body": "Solving BIP-352's Scanning & Labels Problem\n\nHello all,\n\nI'm sorry I didn't see this sooner. I've been working on a project that implements Silent Payments and ran into the same scaling issues you're discussing. Thought I'd share what I landed on - maybe it helps.\n\nThe Scanning Problem\n\nBIP-352's current approach:\n\nFor each transaction:\n    For k in 0..K:\n        tweak = hash(shared_secret || k)\n        check if output matches\n\nK can explode. More outputs = more iterations. It's O(transactions  K) which doesn't scale.\n\nThe fix is simple: include the output index in the tweak.\n\ntweak = hash(shared_secret || output_index)\n\nThat's it. \n\nNow:\n\n    - No K iteration at all\n    - Each output position is inherently unique\n    - Scanning becomes O(n) - one check per output\n    - The output index is already known from the transaction structure\n\nIf you need some entropy for edge cases (same recipient multiple times in one tx), bound a nonce to something small like 0-99:\n\ntweak = hash(shared_secret || output_index || nonce)\n\nBut honestly, output_index alone handles 99% of cases.\n\n---\n\nThe Labels Problem\n\nLabels are trickier. The current approach tweaks the spend pubkey:\n\nlabeled_spend = spend_pubkey + hash(scan_pubkey || label) * G\n\nThis has issues:\n\n    1. If scan_pubkey is public, anyone can enumerate all your labeled addresses\n    2. Sharing multiple labeled addresses reveals they're all you (same scan_pubkey)\n    3. It's still O(n  labels) for full scanning\n\nMy solution: labels are just encrypted metadata, not cryptographic - labels don't need to be in the address derivation at all. They're UX, not a crypto feature.\n\nHow it works:\n\n    1. Recipient creates label locally: { index: 1, name: \"Donations\" }\n    2. Recipient shares address with hint: sp1<addr>?l=1\n    3. Sender sees ?l=1, includes it in encrypted payload\n    4. Address derivation is standard (no label involvement)\n    5. Recipient decrypts payload, sees label: 1, looks up locally  \"Donations\"\n\nThe label number is meaningless without the recipient's local dictionary.\n\n    - Alice's label=1 means \"Donations\"\n    - Bob's label=1 means \"Salary\"\n    - Observer sees encrypted blob with some number in it\n    - Learns nothing\n\nPrivacy properties:\n    - Scanning stays O(n) - labels don't affect it\n    - No address linkability (all payments use same base keys)\n    - Label semantics are recipient-local (never transmitted)\n    - Everyone uses labels (default to 0), so no fingerprinting\n\nImplementation:\n\n    PaymentMetadata {\n        label: u32,           // Just a number\n        memo: Option<String>, // Optional sender note\n    }\n    // Encrypted with ECDH shared secret, included in tx\n\n    I use fixed-size encryption (80 bytes) to prevent size-based fingerprinting. Memo capped at 59 bytes - plenty for \"Invoice #123\" type stuff.\n\n  ---\n\nSummary\n\nBIP-352 Currently:\n\n    K iteration - O(n  K)\n    Labels scanning - O(n  labels)\n    Label linkability - Same scan_pubkey links addresses\n\nSimpler fix:\n  \n    K iteration - Include output_index in tweak  O(n)\n    Labels scanning - Labels in encrypted metadata  O(n)\n    Label linkability - Labels not in derivation  unlinkable\n\nThe key insight: separate the crypto layer from the UX layer. Address derivation should be simple and fast. Labels are just metadata that rides along encrypted.\n\nI estimate if you implement the suggestions you will be ~400x faster than limited-K.\n\nBIP-352 current (K=1000) / single tx = 16.6 sec / with 10 labels = 166 sec\nBIP-352 ordered-K / single tx = 0.4 sec / with 10 labels = 4 sec\nOutput index + metadata labels / single tx = 0.4 sec / with 10 labels = 0.4 sec\n\nHappy to discuss if anyone wants to dig into the details. Good luck.",
      "user": {
        "login": "defenwycke",
        "id": 200950953,
        "node_id": "U_kgDOC_pEqQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/200950953?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/defenwycke",
        "html_url": "https://github.com/defenwycke",
        "followers_url": "https://api.github.com/users/defenwycke/followers",
        "following_url": "https://api.github.com/users/defenwycke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/defenwycke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/defenwycke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/defenwycke/subscriptions",
        "organizations_url": "https://api.github.com/users/defenwycke/orgs",
        "repos_url": "https://api.github.com/users/defenwycke/repos",
        "events_url": "https://api.github.com/users/defenwycke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/defenwycke/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3849763006",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "commented",
      "id": 3849774226,
      "node_id": "IC_kwDOAP4Jqs7lduSS",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3849774226",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-04T21:13:29Z",
      "updated_at": "2026-02-04T21:13:29Z",
      "author_association": "CONTRIBUTOR",
      "body": "@craigraw: Thanks for chiming in. Providing a scanning function that scales well with the number of labels doesn't necessarily mean users will take advantage of that capability immediately (or ever). In my view, the motivation behind releasing the BIP approach now is not primarily to encourage using lots of labels, but to remain most flexible without having to change the API later, if the demand for those use cases ever appears. Other than the small protocol fix needed to avoid the quadratic scaling issue, I don't see much drawbacks in releasing the BIP approach.\n\nIf an API doc warning like \"creation of more than N labels is strongly discouraged for wallet compatibility reasons, only do this if you are fully aware of the drawbacks\" or similar is deemed insufficient (it seemed that this alone didn't convince you), we could go one step further and e.g. restrict the `m` range for the label creation function to raise awareness on the trade-off directly at the root. Of course, all that is only making it slightly harder, and if a user really wants to use a large number of labels, it's trivial to side-step a restriction like this as well.\n\n> > Please comment if you have any concerns about a [K_max protocol restriction](https://github.com/theStack/bips/commit/961d1442139ceecd6c0cc5775ef911d69aabed4c), for current or potential future SP use cases.\n> \n> IMO any use of labels over a small number greatly compromises the practical ability of light clients to recover the wallet. [...]\n\nThis statement is somewhat unrelated to the quoted sentence and the concrete BIP change proposal, which doesn't even mention the term \"label\"; scanning with the BIP approach is vulnerable to the quadratic scaling issue even if only a single label is scanned. I assume your argument is basically \"no wallet should scan using the BIP approach, therefore there is no need to fix this issue in the first place?\". ",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3849774226",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "mentioned",
      "id": 22540597788,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAU_hjoc",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22540597788",
      "actor": {
        "login": "craigraw",
        "id": 862166,
        "node_id": "MDQ6VXNlcjg2MjE2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/862166?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/craigraw",
        "html_url": "https://github.com/craigraw",
        "followers_url": "https://api.github.com/users/craigraw/followers",
        "following_url": "https://api.github.com/users/craigraw/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/craigraw/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/craigraw/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/craigraw/subscriptions",
        "organizations_url": "https://api.github.com/users/craigraw/orgs",
        "repos_url": "https://api.github.com/users/craigraw/repos",
        "events_url": "https://api.github.com/users/craigraw/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/craigraw/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-04T21:13:31Z"
    },
    {
      "event": "subscribed",
      "id": 22540597823,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAU_hjo_",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22540597823",
      "actor": {
        "login": "craigraw",
        "id": 862166,
        "node_id": "MDQ6VXNlcjg2MjE2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/862166?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/craigraw",
        "html_url": "https://github.com/craigraw",
        "followers_url": "https://api.github.com/users/craigraw/followers",
        "following_url": "https://api.github.com/users/craigraw/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/craigraw/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/craigraw/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/craigraw/subscriptions",
        "organizations_url": "https://api.github.com/users/craigraw/orgs",
        "repos_url": "https://api.github.com/users/craigraw/repos",
        "events_url": "https://api.github.com/users/craigraw/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/craigraw/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-04T21:13:31Z"
    },
    {
      "event": "commented",
      "id": 3851519875,
      "node_id": "IC_kwDOAP4Jqs7lkYeD",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3851519875",
      "actor": {
        "login": "craigraw",
        "id": 862166,
        "node_id": "MDQ6VXNlcjg2MjE2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/862166?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/craigraw",
        "html_url": "https://github.com/craigraw",
        "followers_url": "https://api.github.com/users/craigraw/followers",
        "following_url": "https://api.github.com/users/craigraw/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/craigraw/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/craigraw/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/craigraw/subscriptions",
        "organizations_url": "https://api.github.com/users/craigraw/orgs",
        "repos_url": "https://api.github.com/users/craigraw/repos",
        "events_url": "https://api.github.com/users/craigraw/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/craigraw/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-05T07:25:33Z",
      "updated_at": "2026-02-05T07:25:33Z",
      "author_association": "NONE",
      "body": "> This statement is somewhat unrelated to the quoted sentence and the concrete BIP change proposal\n\nIt was, apologies - my statement was rather a contribution to this general discussion. To answer your question directly, I have no specific concerns with a K_max protocol restriction. \n\n> I assume your argument is basically \"no wallet should scan using the BIP approach, therefore there is no need to fix this issue in the first place?\".\n\nNo, this is not my argument. Wallets should explore different approaches to scanning depending on their needs. Exchanges may use specialised implementations with BIP style scanning to handle very large numbers of labels. But this module might be considered the reference implementation for scanning, so decisions made here will affect the whole ecosystem. \n\n> If an API doc warning like \"creation of more than N labels is strongly discouraged for wallet compatibility reasons, only do this if you are fully aware of the drawbacks\"\n\nWhat number did you have in mind for N? I think this is really the critical question, since it may influence the winners and losers in scanning approaches if we are to aim for wallet compatibility.\n\n> Other than the small protocol fix needed to avoid the quadratic scaling issue, I don't see much drawbacks in releasing the BIP approach.\n\nI assume by \"the BIP approach\" you also mean the accompanying API doc. One drawback is the risk that the API doc warning is ignored and we end up with a fractured ecosystem of wallets that cannot reliably recover each other's funds. Another drawback lies in making public servers or light client scanning too slow in trying to support some documented minimum number of labels. Although we can't quantify these risks precisely, both of them are at some degree probably fatal to widespread adoption.",
      "user": {
        "login": "craigraw",
        "id": 862166,
        "node_id": "MDQ6VXNlcjg2MjE2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/862166?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/craigraw",
        "html_url": "https://github.com/craigraw",
        "followers_url": "https://api.github.com/users/craigraw/followers",
        "following_url": "https://api.github.com/users/craigraw/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/craigraw/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/craigraw/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/craigraw/subscriptions",
        "organizations_url": "https://api.github.com/users/craigraw/orgs",
        "repos_url": "https://api.github.com/users/craigraw/repos",
        "events_url": "https://api.github.com/users/craigraw/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/craigraw/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3851519875",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "commented",
      "id": 3854349955,
      "node_id": "IC_kwDOAP4Jqs7lvLaD",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3854349955",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-05T15:20:59Z",
      "updated_at": "2026-02-05T15:20:59Z",
      "author_association": "CONTRIBUTOR",
      "body": "Two quick remarks:\n\n> I believe it is worth considering other approaches to payment origination/confirmation before committing to a \"two types of sp wallet\" future.\n\n - It is certainly worth considering other approaches, but I haven't seen many of these worked out. \n - Assuming people will want to use both types, I doubt that this future is avoidable at all. Already from an implementation point of view, we wouldn't want to have a slower-than-possible full scanning algorithm just because other approaches to scanning do inherently scale worse.\n",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3854349955",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "commented",
      "id": 3854387279,
      "node_id": "IC_kwDOAP4Jqs7lvUhP",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3854387279",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-05T15:27:58Z",
      "updated_at": "2026-02-05T15:27:58Z",
      "author_association": "CONTRIBUTOR",
      "body": "\n> The fix is simple: include the output index in the tweak.\n> \n> tweak = hash(shared_secret || output_index)\n\nThat's a stronger form of \"ordered k\" with even more restrictions and, arguably, an annoying API. The caller needs to know upfront not just the order of all SP outputs but even their position. This could be very annoying if you want to mix SP outputs with non-SP outputs. And makes the drawback pointed out by @jonasnick even worse, namely that if you put the outputs at the wrong position, they'll be lost (or at least difficult to recover -- but note that the recipient may not even be aware that there should have been an incoming payment, so there's no reason for them to even consider some difficult recovery procedure).\n\n---\n> \n> The Labels Problem\n>\n> ```\n> 3. Sender sees ?l=1, includes it in encrypted payload\n\nThis requires sending some payload as part of the tx, and this will be a fundamental change to the SP design. It's too late to talk about this for v1. ",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3854387279",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "mentioned",
      "id": 22562269183,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAVA0Of_",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22562269183",
      "actor": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-05T15:28:00Z"
    },
    {
      "event": "subscribed",
      "id": 22562269230,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAVA0Ogu",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22562269230",
      "actor": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-05T15:28:00Z"
    },
    {
      "event": "commented",
      "id": 3855320711,
      "node_id": "IC_kwDOAP4Jqs7ly4aH",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3855320711",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-05T18:04:47Z",
      "updated_at": "2026-02-05T18:04:47Z",
      "author_association": "CONTRIBUTOR",
      "body": "> > If an API doc warning like \"creation of more than N labels is strongly discouraged for wallet compatibility reasons, only do this if you are fully aware of the drawbacks\"\n> \n> What number did you have in mind for N? I think this is really the critical question, since it may influence the winners and losers in scanning approaches if we are to aim for wallet compatibility.\n\nUnfortunately I don't have a good answer to that, and think that probably needs more research. The obvious conservative pick for maximum wallet compatibility would be N=1, since this is the bare minimum to still be compliant with BIP-352 recommendations.\n\n> > Other than the small protocol fix needed to avoid the quadratic scaling issue, I don't see much drawbacks in releasing the BIP approach.\n> \n> I assume by \"the BIP approach\" you also mean the accompanying API doc. \n\nYes.\n\n> One drawback is the risk that the API doc warning is ignored and we end up with a fractured ecosystem of wallets that cannot reliably recover each other's funds. [...]\n\nI see your concerns, but want to point out that this problem would not disappear by avoiding a certain scanning approach. If we assumed for one moment that the BIP approach doesn't exist and all wallets used the LabelSet approach, then we could still end up with a large discrepancy between the number of labels created. For some light client wallets it's likely reasonable to only ever scan for the change label, while other wallets attached to full nodes might be targeted to only run on powerful servers that have the computing power to even scan for hundreds or thousands of labels (used e.g. by exchanges), even without the attractive \"each additional label is free\" property of the BIP approach.\n\nI'm not sure how much a secp256k1 module could help prevent the \"fractured ecosystem\" issue, other than providing proper API docs. I do agree that it would be irresponsible to recommend creating lots of labels as a default, without at least mentioning the potential wallet interoperability drawbacks. The current PR #1765 has a [TODO](https://github.com/bitcoin-core/secp256k1/pull/1765#issuecomment-3854991697) for that in the API docs, concrete suggestions are welcome.",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3855320711",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "commented",
      "id": 3856088596,
      "node_id": "IC_kwDOAP4Jqs7l1z4U",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3856088596",
      "actor": {
        "login": "defenwycke",
        "id": 200950953,
        "node_id": "U_kgDOC_pEqQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/200950953?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/defenwycke",
        "html_url": "https://github.com/defenwycke",
        "followers_url": "https://api.github.com/users/defenwycke/followers",
        "following_url": "https://api.github.com/users/defenwycke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/defenwycke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/defenwycke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/defenwycke/subscriptions",
        "organizations_url": "https://api.github.com/users/defenwycke/orgs",
        "repos_url": "https://api.github.com/users/defenwycke/repos",
        "events_url": "https://api.github.com/users/defenwycke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/defenwycke/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-05T20:44:19Z",
      "updated_at": "2026-02-05T20:44:19Z",
      "author_association": "NONE",
      "body": "@real-or-random \n\n>That's a stronger form of \"ordered k\" with even more restrictions and, arguably, an annoying API. The caller needs to know upfront not just the order of all SP outputs but even their position. This could be very annoying if you want to mix SP outputs with non-SP outputs. And makes the drawback pointed out by @jonasnick even worse, namely that if you put the outputs at the wrong position, they'll be lost (or at least difficult to recover -- but note that the recipient may not even be aware that there should have been an incoming payment, so there's no reason for them to even consider some difficult recovery procedure).\n\nYour correct! I'm switching to a count based K. This will remove fund loss risk when shuffling within my project. Keep up the good work.",
      "user": {
        "login": "defenwycke",
        "id": 200950953,
        "node_id": "U_kgDOC_pEqQ",
        "avatar_url": "https://avatars.githubusercontent.com/u/200950953?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/defenwycke",
        "html_url": "https://github.com/defenwycke",
        "followers_url": "https://api.github.com/users/defenwycke/followers",
        "following_url": "https://api.github.com/users/defenwycke/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/defenwycke/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/defenwycke/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/defenwycke/subscriptions",
        "organizations_url": "https://api.github.com/users/defenwycke/orgs",
        "repos_url": "https://api.github.com/users/defenwycke/repos",
        "events_url": "https://api.github.com/users/defenwycke/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/defenwycke/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3856088596",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "mentioned",
      "id": 22570630775,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAVBUH53",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22570630775",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-05T20:44:21Z"
    },
    {
      "event": "subscribed",
      "id": 22570630800,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAVBUH6Q",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22570630800",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-05T20:44:21Z"
    },
    {
      "event": "mentioned",
      "id": 22570630835,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAVBUH6z",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22570630835",
      "actor": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-05T20:44:21Z"
    },
    {
      "event": "subscribed",
      "id": 22570630852,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAVBUH7E",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22570630852",
      "actor": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-05T20:44:21Z"
    },
    {
      "event": "commented",
      "id": 3858265190,
      "node_id": "IC_kwDOAP4Jqs7l-HRm",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3858265190",
      "actor": {
        "login": "craigraw",
        "id": 862166,
        "node_id": "MDQ6VXNlcjg2MjE2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/862166?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/craigraw",
        "html_url": "https://github.com/craigraw",
        "followers_url": "https://api.github.com/users/craigraw/followers",
        "following_url": "https://api.github.com/users/craigraw/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/craigraw/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/craigraw/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/craigraw/subscriptions",
        "organizations_url": "https://api.github.com/users/craigraw/orgs",
        "repos_url": "https://api.github.com/users/craigraw/repos",
        "events_url": "https://api.github.com/users/craigraw/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/craigraw/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-06T06:23:24Z",
      "updated_at": "2026-02-06T06:23:24Z",
      "author_association": "NONE",
      "body": "> The obvious conservative pick for maximum wallet compatibility would be N=1, since this is the bare minimum to still be compliant with BIP-352 recommendations.\n\nI agree with this choice. IMO when faced with a clear and serious risk for a speculative and relatively weak upside, the conservative choice is the correct engineering decision should wallet interoperability be a goal.\n\n> I see your concerns, but want to point out that this problem would not disappear by avoiding a certain scanning approach.\n\nI agree (but again this is not my argument).\n\n> I do agree that it would be irresponsible to recommend creating lots of labels as a default, without at least mentioning the potential wallet interoperability drawbacks.\n\nSpeaking generally, I see it as a problem of omission. Without a clear recommendation in the BIP highlighting the risks of lots of labels, we have recommendations elsewhere that encourage this. For example, take the image at https://bitcoin.design/guide/how-it-works/silent-payments/#labels, part of a well known and much referenced guide to creating wallet interfaces. It clearly recommends adding a label for \"Invoice #47654\", suggesting that it is reasonable for a mobile (light client) wallet to create a new label for every invoice. Based on your quoted statement, we agree this is irresponsible. I don't blame the UX designer who created this though - we have not provided the technical guidance to indicate the risks to wallet interoperability. \n\n> I'm not sure how much a secp256k1 module could help prevent the \"fractured ecosystem\" issue, other than providing proper API docs.\n\nSomething is better than nothing. If the API docs discussed the risks to wallet interoperability and recommended N = 1 for maximum interoperability, we would as a developer community at least have a quotable reference.",
      "user": {
        "login": "craigraw",
        "id": 862166,
        "node_id": "MDQ6VXNlcjg2MjE2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/862166?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/craigraw",
        "html_url": "https://github.com/craigraw",
        "followers_url": "https://api.github.com/users/craigraw/followers",
        "following_url": "https://api.github.com/users/craigraw/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/craigraw/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/craigraw/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/craigraw/subscriptions",
        "organizations_url": "https://api.github.com/users/craigraw/orgs",
        "repos_url": "https://api.github.com/users/craigraw/repos",
        "events_url": "https://api.github.com/users/craigraw/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/craigraw/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3858265190",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "commented",
      "id": 3891774608,
      "node_id": "IC_kwDOAP4Jqs7n98SQ",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/3891774608",
      "actor": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-12T15:56:17Z",
      "updated_at": "2026-02-12T15:56:17Z",
      "author_association": "CONTRIBUTOR",
      "body": "The announcement of a potential [K_max restriction](https://github.com/theStack/bips/commit/961d1442139ceecd6c0cc5775ef911d69aabed4c) with request for feedback (see [comment pinging SP wallet devs](https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3842046237) here and the [mailing list post](https://groups.google.com/g/bitcoindev/c/tgcAQVqvzVg)) has passed one week, and so far no concerns about a limit have been expressed. Two SP wallet developers have confirmed explicitly that they don't see a problem with this change (https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3843157542, https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3851519875), @craigraw was expressing the need of clear API documentation, to strive for maximum wallet compatibility. I agree that this is important, and the stated suggestion sounds reasonable to me:\n\n> If the API docs discussed the risks to wallet interoperability and recommended N = 1 for maximum interoperability, we would as a developer community at least have a quotable reference.\n\n(This is only slightly related to the K_max protocol change and the BIP vs. LabelSet decision-making process though, as we'd want to include such a warning in the API docs about the drawbacks of creating a larger number of labels in either scanning approach.)\n\nIt's still an open question what concrete value to set K_max to, and there are [some](https://github.com/bitcoin-core/secp256k1/pull/1765#issuecomment-3856872222) [optimizations](https://github.com/bitcoin-core/secp256k1/pull/1765#issuecomment-3882064264) [investigated](https://github.com/bitcoin-core/secp256k1/pull/1765#issuecomment-3888202232) (shout out to @w0xlt) that look promising and might affect this decision, but my conclusion from what I've written above is that we should focus on the BIP scanning approach, as the primary blocker (quadratic scaling issue) can be mitigated. If there are no objections, I will close the [LabelSet scanning PR](https://github.com/bitcoin-core/secp256k1/pull/1792) and open a BIP-352 PR with a proposed K_max limit soon, with the goal of getting the [BIP scanning PR](https://github.com/bitcoin-core/secp256k1/pull/1765) PR ready. ",
      "user": {
        "login": "theStack",
        "id": 91535,
        "node_id": "MDQ6VXNlcjkxNTM1",
        "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/theStack",
        "html_url": "https://github.com/theStack",
        "followers_url": "https://api.github.com/users/theStack/followers",
        "following_url": "https://api.github.com/users/theStack/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/theStack/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/theStack/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
        "organizations_url": "https://api.github.com/users/theStack/orgs",
        "repos_url": "https://api.github.com/users/theStack/repos",
        "events_url": "https://api.github.com/users/theStack/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/theStack/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1799#issuecomment-3891774608",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1799"
    },
    {
      "event": "mentioned",
      "id": 22739931647,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAVLZ9H_",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22739931647",
      "actor": {
        "login": "craigraw",
        "id": 862166,
        "node_id": "MDQ6VXNlcjg2MjE2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/862166?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/craigraw",
        "html_url": "https://github.com/craigraw",
        "followers_url": "https://api.github.com/users/craigraw/followers",
        "following_url": "https://api.github.com/users/craigraw/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/craigraw/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/craigraw/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/craigraw/subscriptions",
        "organizations_url": "https://api.github.com/users/craigraw/orgs",
        "repos_url": "https://api.github.com/users/craigraw/repos",
        "events_url": "https://api.github.com/users/craigraw/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/craigraw/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-12T15:56:18Z"
    },
    {
      "event": "subscribed",
      "id": 22739931681,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAVLZ9Ih",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22739931681",
      "actor": {
        "login": "craigraw",
        "id": 862166,
        "node_id": "MDQ6VXNlcjg2MjE2Ng==",
        "avatar_url": "https://avatars.githubusercontent.com/u/862166?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/craigraw",
        "html_url": "https://github.com/craigraw",
        "followers_url": "https://api.github.com/users/craigraw/followers",
        "following_url": "https://api.github.com/users/craigraw/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/craigraw/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/craigraw/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/craigraw/subscriptions",
        "organizations_url": "https://api.github.com/users/craigraw/orgs",
        "repos_url": "https://api.github.com/users/craigraw/repos",
        "events_url": "https://api.github.com/users/craigraw/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/craigraw/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-12T15:56:18Z"
    },
    {
      "event": "mentioned",
      "id": 22739931746,
      "node_id": "MEE_lADOAP4Jqs7iiazUzwAAAAVLZ9Ji",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22739931746",
      "actor": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-12T15:56:19Z"
    },
    {
      "event": "subscribed",
      "id": 22739931768,
      "node_id": "SE_lADOAP4Jqs7iiazUzwAAAAVLZ9J4",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/22739931768",
      "actor": {
        "login": "w0xlt",
        "id": 94266259,
        "node_id": "U_kgDOBZ5jkw",
        "avatar_url": "https://avatars.githubusercontent.com/u/94266259?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/w0xlt",
        "html_url": "https://github.com/w0xlt",
        "followers_url": "https://api.github.com/users/w0xlt/followers",
        "following_url": "https://api.github.com/users/w0xlt/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/w0xlt/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/w0xlt/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/w0xlt/subscriptions",
        "organizations_url": "https://api.github.com/users/w0xlt/orgs",
        "repos_url": "https://api.github.com/users/w0xlt/repos",
        "events_url": "https://api.github.com/users/w0xlt/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/w0xlt/received_events",
        "type": "User",
        "site_admin": false,
        "name": null,
        "patch_url": null
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2026-02-12T15:56:19Z"
    }
  ]
}