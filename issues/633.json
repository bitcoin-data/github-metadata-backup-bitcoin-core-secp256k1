{
  "type": "issue",
  "issue": {
    "id": 451705959,
    "node_id": "MDU6SXNzdWU0NTE3MDU5NTk=",
    "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/633",
    "repository_url": "https://api.github.com/repos/bitcoin-core/secp256k1",
    "labels_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/633/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/633/comments",
    "events_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/633/events",
    "html_url": "https://github.com/bitcoin-core/secp256k1/issues/633",
    "number": 633,
    "state": "closed",
    "state_reason": "completed",
    "title": "How to exponentiate arbitrary group element instead of ctx->initial?",
    "body": "I explored the library and finally came up with the following code for generating a random element on the elliptic curve. \r\n```\r\n\tsecp256k1_ecmult_gen_context context;\r\n\tvoid * prealloc = checked_malloc(&default_error_callback, SECP256K1_ECMULT_GEN_CONTEXT_PREALLOCATED_SIZE);\r\n\r\n        secp256k1_ecmult_gen_context_init(&context);\r\n        secp256k1_ecmult_gen_context_build(&context, &prealloc);\r\n\r\n\tunsigned char exp[32];\r\n\tsecp256k1_scalar exponent;\r\n\tsecp256k1_gej generator;\r\n\tint overflow;\r\n    \tsecp256k1_rand256(exp);\r\n\tsecp256k1_scalar_set_b32(&exponent, exp, &overflow);\r\n\tsecp256k1_ecmult_gen(&context, &generator, &exponent);\r\n```\r\nThe function ```secp256k1_ecmult_gen``` raises the ```context->initial``` group element to given exponent. \r\n1) Is there an inbuilt function to raise a given group element to a given exponent?\r\n2) I see 2 files ```ecmult_impl.h``` and ```ecmult_gen_impl.h```. What's the difference?\r\n3) If my point is in ```secp256k1_ge``` group, should I first convert it into ```secp256k1_gej``` group using ```secp256k1_gej_set_ge()``` function and then apply the above function? Or is there a more efficient way?",
    "user": {
      "login": "vusirikala",
      "id": 7092734,
      "node_id": "MDQ6VXNlcjcwOTI3MzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7092734?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vusirikala",
      "html_url": "https://github.com/vusirikala",
      "followers_url": "https://api.github.com/users/vusirikala/followers",
      "following_url": "https://api.github.com/users/vusirikala/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/vusirikala/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/vusirikala/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/vusirikala/subscriptions",
      "organizations_url": "https://api.github.com/users/vusirikala/orgs",
      "repos_url": "https://api.github.com/users/vusirikala/repos",
      "events_url": "https://api.github.com/users/vusirikala/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/vusirikala/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [],
    "assignees": [],
    "author_association": "NONE",
    "locked": false,
    "comments": 3,
    "closed_at": "2019-06-07T10:51:24Z",
    "created_at": "2019-06-03T21:52:13Z",
    "updated_at": "2019-06-07T10:51:24Z"
  },
  "events": [
    {
      "event": "commented",
      "id": 498487144,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQ5ODQ4NzE0NA==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/498487144",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2019-06-04T01:44:07Z",
      "updated_at": "2019-06-04T01:46:13Z",
      "author_association": "CONTRIBUTOR",
      "body": "You haven't provided enough context to answer, the correct function depends on the nature of the protocol you're constructing.  To exponentiate a variable base you potentially either secp256k1_ecmult_const() or secp256k1_ecmult with you point in a and ng=0 depending on your needs.  _gen means with the generator-- a fixed base, and isn't what you want.\r\n\r\nThere are other functions that let you efficiently compute the sum of P_i^a_i for many i.\r\n\r\nGe can be converted to gej using secp256k1_gej_set_ge. Generally if a function exist that takes a ge you want to use a ge because it'll be faster to operate using ge.\r\n\r\nThe non _impl .h files have the function prototypes that describe what the functions do (though I see ecmult_const's is lacking).  Alternatively, it's usually easiest to find things by walking in from the external API,  e.g. ecdsa_verification uses a variable base, and ECDH uses a variable base in constant time.\r\n\r\nIf your goal is to generate a random group element exponentiation is probably not what you want: it's slow-ish and it means you know the discrete log of the selected point, in many protocols you need a 'random' point specifically so you do not know the discrete log.  In those cases hashing onto the x-value and retrying with a new hash if the result wasn't on the curve or using shallue_van_de_woestijne from secp256k1-zkp if constant time is appropriate, may be preferred/necessary.\r\n\r\nDo take care, the insides of the library are not a general user interface and are not as footgun proof as the external interfaces. Their user is expected to have some understanding about how they work under the hood, and of course any work that builds its own cryptosystem has the according risks from doing so!  At a minimum exponentiating a random point with a random value means that the result might be the point at infinity, which cannot be serialized in the standard serializations... so correct code should have some way of handling that.\r\n\r\n",
      "user": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/633#issuecomment-498487144",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/633"
    },
    {
      "event": "cross-referenced",
      "id": null,
      "node_id": null,
      "url": null,
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2019-06-04T01:54:07Z",
      "updated_at": "2019-06-04T01:54:07Z",
      "source": {
        "issue": {
          "id": 451760861,
          "node_id": "MDExOlB1bGxSZXF1ZXN0Mjg0Nzg3NTI5",
          "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/634",
          "repository_url": "https://api.github.com/repos/bitcoin-core/secp256k1",
          "labels_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/634/labels%7B/name%7D",
          "comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/634/comments",
          "events_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/634/events",
          "html_url": "https://github.com/bitcoin-core/secp256k1/pull/634",
          "number": 634,
          "state": "closed",
          "state_reason": null,
          "title": "Add a descriptive comment for secp256k1_ecmult_const.",
          "body": "Helps issue #633 ",
          "user": {
            "login": "gmaxwell",
            "id": 858454,
            "node_id": "MDQ6VXNlcjg1ODQ1NA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/gmaxwell",
            "html_url": "https://github.com/gmaxwell",
            "followers_url": "https://api.github.com/users/gmaxwell/followers",
            "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
            "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
            "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
            "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
            "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
            "repos_url": "https://api.github.com/users/gmaxwell/repos",
            "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
            "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
            "type": "User",
            "site_admin": false
          },
          "labels": [],
          "assignees": [],
          "author_association": "CONTRIBUTOR",
          "locked": false,
          "comments": 0,
          "pull_request": {
            "url": "https://api.github.com/repos/bitcoin-core/secp256k1/pulls/634",
            "html_url": "https://github.com/bitcoin-core/secp256k1/pull/634",
            "diff_url": "https://github.com/bitcoin-core/secp256k1/pull/634.diff",
            "patch_url": "https://github.com/bitcoin-core/secp256k1/pull/634.patch"
          },
          "closed_at": "2019-06-04T23:06:39Z",
          "created_at": "2019-06-04T01:54:07Z",
          "updated_at": "2019-06-04T23:06:39Z"
        },
        "type": "issue"
      }
    },
    {
      "event": "commented",
      "id": 498501030,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQ5ODUwMTAzMA==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/498501030",
      "actor": {
        "login": "vusirikala",
        "id": 7092734,
        "node_id": "MDQ6VXNlcjcwOTI3MzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7092734?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vusirikala",
        "html_url": "https://github.com/vusirikala",
        "followers_url": "https://api.github.com/users/vusirikala/followers",
        "following_url": "https://api.github.com/users/vusirikala/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vusirikala/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vusirikala/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vusirikala/subscriptions",
        "organizations_url": "https://api.github.com/users/vusirikala/orgs",
        "repos_url": "https://api.github.com/users/vusirikala/repos",
        "events_url": "https://api.github.com/users/vusirikala/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vusirikala/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2019-06-04T03:02:31Z",
      "updated_at": "2019-06-04T03:02:31Z",
      "author_association": "NONE",
      "body": "That's a really nice answer. You mentioned that ```Ge can be converted to gej using secp256k1_gej_set_ge. Generally if a function exist that takes a ge you want to use a ge because it'll be faster to operate using ge.``` Did you mean it'll be faster to operate using gej? Because I heard operations on projective coordinates are usually faster.",
      "user": {
        "login": "vusirikala",
        "id": 7092734,
        "node_id": "MDQ6VXNlcjcwOTI3MzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7092734?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vusirikala",
        "html_url": "https://github.com/vusirikala",
        "followers_url": "https://api.github.com/users/vusirikala/followers",
        "following_url": "https://api.github.com/users/vusirikala/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/vusirikala/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/vusirikala/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/vusirikala/subscriptions",
        "organizations_url": "https://api.github.com/users/vusirikala/orgs",
        "repos_url": "https://api.github.com/users/vusirikala/repos",
        "events_url": "https://api.github.com/users/vusirikala/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/vusirikala/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/633#issuecomment-498501030",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/633"
    },
    {
      "event": "commented",
      "id": 498515815,
      "node_id": "MDEyOklzc3VlQ29tbWVudDQ5ODUxNTgxNQ==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/498515815",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2019-06-04T04:23:54Z",
      "updated_at": "2019-06-04T04:28:01Z",
      "author_association": "CONTRIBUTOR",
      "body": "Good question.  I didn't make an error.  Operations which _output_ projective coordinates (gej) are faster but taking an affine (ge) input can be faster.\r\n\r\nA ge point can be seen as a projective point with z=1 and it's particularly simple to square or multiply by one. :) Libsecp256k1 has functions like gej_add_ge  (gej = gej + ge) which are faster than a generic gej = gej + gej.\r\n\r\nNone of libsecp256k1's internals output affine, except for the specific conversion functions.\r\n\r\nThe function secp256k1_ecmult is somewhat special in that it gets affine-input like performance without requiring ge input due to doing some internal magic (it performs the operations using affine-input group law on an isomorphic curve).",
      "user": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/633#issuecomment-498515815",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/633"
    },
    {
      "event": "referenced",
      "id": 2389691169,
      "node_id": "MDE1OlJlZmVyZW5jZWRFdmVudDIzODk2OTExNjk=",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/2389691169",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": "fa3301713549d118e57ebe6551d062903ddd6b63",
      "commit_url": "https://api.github.com/repos/bitcoin-core/secp256k1/commits/fa3301713549d118e57ebe6551d062903ddd6b63",
      "created_at": "2019-06-04T23:06:39Z"
    },
    {
      "event": "closed",
      "id": 2396922356,
      "node_id": "MDExOkNsb3NlZEV2ZW50MjM5NjkyMjM1Ng==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/2396922356",
      "actor": {
        "login": "gmaxwell",
        "id": 858454,
        "node_id": "MDQ6VXNlcjg1ODQ1NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gmaxwell",
        "html_url": "https://github.com/gmaxwell",
        "followers_url": "https://api.github.com/users/gmaxwell/followers",
        "following_url": "https://api.github.com/users/gmaxwell/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/gmaxwell/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/gmaxwell/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
        "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
        "repos_url": "https://api.github.com/users/gmaxwell/repos",
        "events_url": "https://api.github.com/users/gmaxwell/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2019-06-07T10:51:24Z"
    }
  ]
}