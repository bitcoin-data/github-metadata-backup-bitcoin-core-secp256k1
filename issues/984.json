{
  "type": "issue",
  "issue": {
    "id": 1011574714,
    "node_id": "I_kwDOAP4Jqs48S2e6",
    "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/984",
    "repository_url": "https://api.github.com/repos/bitcoin-core/secp256k1",
    "labels_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/984/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/984/comments",
    "events_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/984/events",
    "html_url": "https://github.com/bitcoin-core/secp256k1/issues/984",
    "number": 984,
    "state": "closed",
    "state_reason": "completed",
    "title": "Test failure when building against OpenSSL 3 on macOS",
    "body": "Building 2a3a97c665475bc00d5d60f2f04830202983a631:\r\n```bash\r\n./autogen.sh\r\n./configure\r\nBuild Options:\r\n  with ecmult precomp     = yes\r\n  with external callbacks = no\r\n  with benchmarks         = yes\r\n  with tests              = yes\r\n  with openssl tests      = yes\r\n  with coverage           = no\r\n  module ecdh             = no\r\n  module recovery         = no\r\n  module extrakeys        = no\r\n  module schnorrsig       = no\r\n\r\n  asm                     = x86_64\r\n  ecmult window size      = 15\r\n  ecmult gen prec. bits   = 4\r\n\r\n  valgrind                = no\r\n  CC                      = gcc\r\n  CPPFLAGS                = -I/usr/local/opt/valgrind/include \r\n  SECP_CFLAGS             = -O2  -std=c89 -pedantic -Wno-long-long -Wnested-externs -Wshadow -Wstrict-prototypes -Wundef -Wno-overlength-strings -Wall -Wno-unused-function -Wextra -Wcast-align -Wconditional-uninitialized -fvisibility=hidden \r\n  CFLAGS                  = -g -O2\r\n  LDFLAGS                 = \r\n\r\n  CC_FOR_BUILD            = gcc\r\n  CPPFLAGS_FOR_BUILD      = -I/usr/local/opt/valgrind/include \r\n  SECP_CFLAGS_FOR_BUILD   = -O2  -std=c89 -pedantic -Wno-long-long -Wnested-externs -Wshadow -Wstrict-prototypes -Wundef -Wno-overlength-strings -Wall -Wno-unused-function -Wextra -Wcast-align -Wconditional-uninitialized -fvisibility=hidden \r\n  CFLAGS_FOR_BUILD        = -g -O2\r\n  LDFLAGS_FOR_BUILD       = \r\n...\r\ngmake check -j9\r\n...\r\n  CCLD     bench_internal\r\n  CCLD     bench_ecmult\r\n  CCLD     libsecp256k1.la\r\n  CCLD     bench_verify\r\n  CCLD     bench_sign\r\n6 warnings generated.\r\n  CCLD     tests\r\ngmake  check-TESTS\r\ngmake[1]: Entering directory '/Users/michael/github/secp256k1'\r\ngmake[2]: Entering directory '/Users/michael/github/secp256k1'\r\nPASS: exhaustive_tests\r\n./build-aux/test-driver: line 112: 88313 Abort trap: 6           \"$@\" >> \"$log_file\" 2>&1\r\nFAIL: tests\r\n============================================================================\r\nTestsuite summary for libsecp256k1 0.1\r\n============================================================================\r\n# TOTAL: 2\r\n# PASS:  1\r\n# SKIP:  0\r\n# XFAIL: 0\r\n# FAIL:  1\r\n# XPASS: 0\r\n# ERROR: 0\r\n============================================================================\r\nSee ./test-suite.log\r\n============================================================================\r\ngmake[2]: *** [Makefile:1307: test-suite.log] Error 1\r\n```\r\n\r\ntest-suite.log:\r\n```bash\r\n========================================\r\n   libsecp256k1 0.1: ./test-suite.log\r\n========================================\r\n\r\n# TOTAL: 2\r\n# PASS:  1\r\n# SKIP:  0\r\n# XFAIL: 0\r\n# FAIL:  1\r\n# XPASS: 0\r\n# ERROR: 0\r\n\r\n.. contents:: :depth: 2\r\n\r\nFAIL: tests\r\n===========\r\n\r\ntest count = 64\r\nrandom seed = 59e74cf6fdde17e225a9ade47f72f707\r\nFailure 10 on 30 24 02 06 b1 c3 87 ff 07 00 02 1a 45 00 00 08 00 00 00 00 00 00 00 10 00 00 00 02 00 00 00 00 00 00 80 ff 07 80 \r\nsrc/tests.c:6015: test condition failed: ret == 0\r\nFAIL tests (exit status: 134)\r\n```\r\n\r\n[config.log](https://github.com/bitcoin-core/secp256k1/files/7255733/config.log)\r\n\r\nIf I build against an older version of OpenSSL, i.e 1.1, I don't see any issues:\r\n```bash\r\n./autogen.sh\r\nCRYPTO_LIBS=\"-L/usr/local/opt/openssl@1.1/lib\" CRYPTO_CFLAGS=\"-I/usr/local/opt/openssl@1.1/include\" ./configure\r\ngmake check -j9\r\n....\r\ngmake  check-TESTS\r\ngmake[1]: Entering directory '/Users/michael/github/secp256k1'\r\ngmake[2]: Entering directory '/Users/michael/github/secp256k1'\r\nPASS: exhaustive_tests\r\nPASS: tests\r\n============================================================================\r\nTestsuite summary for libsecp256k1 0.1\r\n============================================================================\r\n# TOTAL: 2\r\n# PASS:  2\r\n# SKIP:  0\r\n# XFAIL: 0\r\n# FAIL:  0\r\n# XPASS: 0\r\n# ERROR: 0\r\n============================================================================\r\n```",
    "user": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [],
    "assignees": [],
    "author_association": "MEMBER",
    "locked": false,
    "comments": 3,
    "closed_at": "2021-10-16T22:36:46Z",
    "created_at": "2021-09-30T00:47:56Z",
    "updated_at": "2021-10-16T22:36:46Z"
  },
  "events": [
    {
      "event": "connected",
      "id": 5392473038,
      "node_id": "COE_lADOAP4Jqs48S2e6zwAAAAFBapvO",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/5392473038",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-01T07:38:26Z"
    },
    {
      "event": "commented",
      "id": 932953932,
      "node_id": "IC_kwDOAP4Jqs43m79M",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/932953932",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-03T13:42:13Z",
      "updated_at": "2021-10-03T13:42:13Z",
      "author_association": "MEMBER",
      "body": "> This does mean that any non-bitcoin libsecp256k1 users that need to interoperate with openssl may now experience inconsistencies. ... and maybe it suggests that libsecp256k1 should increase the strictness of its standard ecdsa parser to match the bitcoin strictder, which should also make it consistent with openssl 3. (legacy signatures in the blockchain are supported by the 'lax' parser in contrib in any case).\r\n\r\nThis would be a breaking change, so I don't think we should do it. I'd prefer API stability over compatibility with OpenSSL 3. There are some (blockchain/encoding-critical) projects out there that rely on libsecp256k1 (without the lax parser).\r\n\r\n",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/984#issuecomment-932953932",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/984"
    },
    {
      "event": "commented",
      "id": 932997505,
      "node_id": "IC_kwDOAP4Jqs43nGmB",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/932997505",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-03T17:58:11Z",
      "updated_at": "2021-10-03T17:59:45Z",
      "author_association": "MEMBER",
      "body": "> As far as breaking, the obvious thing to do would be to just introduce the stricter parser under a different name and recommend it, and mark the old one as deprecated (and potentially move it to contrib with the other lax parsers).\r\n\r\nOk sure, we could do this but it's work and I don't think Bitcoin Core would benefit from this, so we should not spend time on this. And new applications shouldn't use ECDSA at all. ",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/984#issuecomment-932997505",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/984"
    },
    {
      "event": "commented",
      "id": 934928448,
      "node_id": "IC_kwDOAP4Jqs43ueBA",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/934928448",
      "actor": {
        "login": "andypost",
        "id": 73713,
        "node_id": "MDQ6VXNlcjczNzEz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73713?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andypost",
        "html_url": "https://github.com/andypost",
        "followers_url": "https://api.github.com/users/andypost/followers",
        "following_url": "https://api.github.com/users/andypost/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andypost/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andypost/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andypost/subscriptions",
        "organizations_url": "https://api.github.com/users/andypost/orgs",
        "repos_url": "https://api.github.com/users/andypost/repos",
        "events_url": "https://api.github.com/users/andypost/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andypost/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-05T22:14:25Z",
      "updated_at": "2021-10-05T22:14:25Z",
      "author_association": "NONE",
      "body": "The related issue https://github.com/bitcoin/bitcoin/issues/23048",
      "user": {
        "login": "andypost",
        "id": 73713,
        "node_id": "MDQ6VXNlcjczNzEz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73713?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andypost",
        "html_url": "https://github.com/andypost",
        "followers_url": "https://api.github.com/users/andypost/followers",
        "following_url": "https://api.github.com/users/andypost/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/andypost/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/andypost/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/andypost/subscriptions",
        "organizations_url": "https://api.github.com/users/andypost/orgs",
        "repos_url": "https://api.github.com/users/andypost/repos",
        "events_url": "https://api.github.com/users/andypost/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/andypost/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/984#issuecomment-934928448",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/984"
    },
    {
      "event": "closed",
      "id": 5473556899,
      "node_id": "CE_lADOAP4Jqs48S2e6zwAAAAFGP9mj",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/5473556899",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-10-16T22:36:46Z"
    }
  ]
}