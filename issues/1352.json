{
  "type": "issue",
  "issue": {
    "id": 1762415109,
    "node_id": "I_kwDOAP4Jqs5pDFIF",
    "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1352",
    "repository_url": "https://api.github.com/repos/bitcoin-core/secp256k1",
    "labels_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1352/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1352/comments",
    "events_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/1352/events",
    "html_url": "https://github.com/bitcoin-core/secp256k1/issues/1352",
    "number": 1352,
    "state": "open",
    "state_reason": null,
    "title": "\"sizeof(secp256k1_ge_storage) != 64\" path not tested",
    "body": "The `sizeof(secp256k1_ge_storage) != 64` path in `secp256k1_pubkey_load` and `secp256k1_pubkey_save` is not tested currently because we're not aware of a compiler/platform where this condition is true.\r\n\r\nThis is my analysis from #1349:\r\n\r\n---\r\n\r\n\r\nI lean towards getting rid of the code path entirely because I don't think it's relevant in the real world:\r\n\r\n`secp256k1_ge_storage` is a struct with two `secp256k1_fe_storage` fields. The C standard allows the compiler to add padding between the fields and at the end of the struct, but no sane compiler in the end would do this: The only reason to add padding is to ensure alignment, but such padding is never necessary between two fields of the same type. (If this was an array with two members instead of a struct with two members, then the alignment requirements would be the same, but no padding would be allowed.) \r\n\r\nSimilarly, `secp256k1_fe_storage` is a struct with a single array of `uintXX_t`. No padding is allowed between array elements. Again, C allows the compiler to insert padding at the end of the struct, but there's no absolute reason to do so in this case.\r\n\r\nFor the `uintXX_t` itself, this guaranteed to have no padding *bits*, i.e., it's guaranteed to have exactly XX bits.\r\n\r\nSo claim that for any existing compiler in the real world, `sizeof(secp256k1_ge_storage) == 64`, and we could assert this in `assumptions.h`.\r\n \r\nAlternatives:\r\n - Get rid of the optimization and just never rely on the fact that `sizeof(secp256k1_ge_storage) == 64` (but that's slower)\r\n - Switch `secp256k1_ge_storage` and `secp256k1_fe_storage` to be actual array types so that the compiler is not allowed to add padding (but that's pretty bad C style: `sizeof()` has different semantics on array types, `=` assignment is not possible, returning and passing by value is not possible, ...)\r\n - Have a test override (but that's complex and makes testing harder)\r\n\r\n_Originally posted by @real-or-random in https://github.com/bitcoin-core/secp256k1/issues/1349#issuecomment-1595781559_\r\n           ",
    "user": {
      "login": "real-or-random",
      "id": 1071625,
      "node_id": "MDQ6VXNlcjEwNzE2MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/real-or-random",
      "html_url": "https://github.com/real-or-random",
      "followers_url": "https://api.github.com/users/real-or-random/followers",
      "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
      "organizations_url": "https://api.github.com/users/real-or-random/orgs",
      "repos_url": "https://api.github.com/users/real-or-random/repos",
      "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/real-or-random/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 165017692,
        "node_id": "MDU6TGFiZWwxNjUwMTc2OTI=",
        "url": "https://api.github.com/repos/bitcoin-core/secp256k1/labels/assurance",
        "name": "assurance",
        "description": "",
        "color": "A6DF3D",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "locked": false,
    "comments": 0,
    "created_at": "2023-06-18T18:38:00Z",
    "updated_at": "2023-06-28T21:33:07Z"
  },
  "events": [
    {
      "event": "mentioned",
      "id": 9561774013,
      "node_id": "MEE_lADOAP4Jqs5pDFIFzwAAAAI57Re9",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/9561774013",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-18T18:38:00Z"
    },
    {
      "event": "subscribed",
      "id": 9561774017,
      "node_id": "SE_lADOAP4Jqs5pDFIFzwAAAAI57RfB",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/9561774017",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-18T18:38:00Z"
    },
    {
      "event": "labeled",
      "id": 9561775703,
      "node_id": "LE_lADOAP4Jqs5pDFIFzwAAAAI57R5X",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/9561775703",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-06-18T18:38:32Z",
      "label": {
        "name": "assurance",
        "color": "A6DF3D"
      }
    }
  ]
}