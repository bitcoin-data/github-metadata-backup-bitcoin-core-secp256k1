{
  "type": "issue",
  "issue": {
    "id": 179034234,
    "node_id": "MDU6SXNzdWUxNzkwMzQyMzQ=",
    "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/419",
    "repository_url": "https://api.github.com/repos/bitcoin-core/secp256k1",
    "labels_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/419/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/419/comments",
    "events_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/419/events",
    "html_url": "https://github.com/bitcoin-core/secp256k1/issues/419",
    "number": 419,
    "state": "closed",
    "state_reason": "completed",
    "title": "Verify failing with particular Tx",
    "body": "I have verified the full Testnet chain up to block 929166, working on block 929167 there is this transaction which does not verify through my software: https://api.blockcypher.com/v1/btc/test3/txs/23202c2534be0567d4b339142f8a9a53545123eb61f61717fdedbef8effc53e0?limit=50&includeHex=true\n\nIt is a P2SH, with the following details:\nscriptSig: <02A14A78351C4B47F3099120D4565A8E7E6DFBDA1E4B570DFC573A9B2894038D11> <093006020101020101017CAC>\nredeemScript: <300602010102010101> OP_SWAP OP_CHECKSIG\n\nThe signature gives R and S values of 1?\n\nThese are steps the process goes through:\n\n<300602010102010101>\n<02A14A78351C4B47F3099120D4565A8E7E6DFBDA1E4B570DFC573A9B2894038D11>\n\nOP_SWAP\n\n<02A14A78351C4B47F3099120D4565A8E7E6DFBDA1E4B570DFC573A9B2894038D11>\n<300602010102010101>\n\nPublic Key: <02A14A78351C4B47F3099120D4565A8E7E6DFBDA1E4B570DFC573A9B2894038D11>\nSignature: <300602010102010101>\n\nTxHashType: 01\nPublic Key: <02A14A78351C4B47F3099120D4565A8E7E6DFBDA1E4B570DFC573A9B2894038D11>\nSignature: <3006020101020101>\nVerifyHash: 355ED31E8E528CCA2F19DC4A0BEAD610CF750CDE1065D17B508AE04073E9FA3F\n\nOP_CHECKSIG = FAIL\n\nI know this has been verified through the library because my reference Bitcoin Core (v0.13.0) client passed this transaction to me.\n\nI do not understand how this transaction can be verified with the signature that has been passed in.\n\nI would appreciate any help.\n",
    "user": {
      "login": "jamescarter-le",
      "id": 1643692,
      "node_id": "MDQ6VXNlcjE2NDM2OTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1643692?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jamescarter-le",
      "html_url": "https://github.com/jamescarter-le",
      "followers_url": "https://api.github.com/users/jamescarter-le/followers",
      "following_url": "https://api.github.com/users/jamescarter-le/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/jamescarter-le/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/jamescarter-le/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/jamescarter-le/subscriptions",
      "organizations_url": "https://api.github.com/users/jamescarter-le/orgs",
      "repos_url": "https://api.github.com/users/jamescarter-le/repos",
      "events_url": "https://api.github.com/users/jamescarter-le/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/jamescarter-le/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [],
    "assignees": [],
    "author_association": "NONE",
    "locked": false,
    "comments": 1,
    "closed_at": "2016-09-24T15:22:19Z",
    "created_at": "2016-09-24T15:01:47Z",
    "updated_at": "2016-09-24T15:24:14Z"
  },
  "events": [
    {
      "event": "commented",
      "id": 249370191,
      "node_id": "MDEyOklzc3VlQ29tbWVudDI0OTM3MDE5MQ==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/249370191",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2016-09-24T15:22:19Z",
      "updated_at": "2016-09-24T15:24:14Z",
      "author_association": "CONTRIBUTOR",
      "body": "I can verify (with Sage) that the signature you've given does not validate with the hash you've given. At first glance it looks like you've extracted the data correctly so I assume the hash is wrong. My guess is something to do with Core's search-and-replace code that removes the signature from the data that gets hashed -- though I had thought all the known tricks around this had been exploited long ago on testnet, so I'm surprised you can validate Testnet up to here then can't.\n\nAs to \"how can a 1,1 signature validate\", the answer is that this transaction was designed to require pubkey recovery to spend: the public key provided in the scriptSig is not one that anybody knows a secret key to, but was computed from the (1,1) signature and the signature hash.\n\nClosing this issue since the secp bugtracker is not a help channel -- for more information please ask about this on IRC. You can find me as @andytoshi on many Bitcoin-related channels.\n",
      "user": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/419#issuecomment-249370191",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/419"
    },
    {
      "event": "closed",
      "id": 801277408,
      "node_id": "MDExOkNsb3NlZEV2ZW50ODAxMjc3NDA4",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/801277408",
      "actor": {
        "login": "apoelstra",
        "id": 1351933,
        "node_id": "MDQ6VXNlcjEzNTE5MzM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1351933?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apoelstra",
        "html_url": "https://github.com/apoelstra",
        "followers_url": "https://api.github.com/users/apoelstra/followers",
        "following_url": "https://api.github.com/users/apoelstra/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/apoelstra/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/apoelstra/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/apoelstra/subscriptions",
        "organizations_url": "https://api.github.com/users/apoelstra/orgs",
        "repos_url": "https://api.github.com/users/apoelstra/repos",
        "events_url": "https://api.github.com/users/apoelstra/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/apoelstra/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2016-09-24T15:22:20Z"
    }
  ]
}