{
  "type": "issue",
  "issue": {
    "id": 936214643,
    "node_id": "MDU6SXNzdWU5MzYyMTQ2NDM=",
    "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/961",
    "repository_url": "https://api.github.com/repos/bitcoin-core/secp256k1",
    "labels_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/961/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/961/comments",
    "events_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/961/events",
    "html_url": "https://github.com/bitcoin-core/secp256k1/issues/961",
    "number": 961,
    "state": "open",
    "state_reason": null,
    "title": "Policy for SECP256K1_WARN_UNUSED_RESULT",
    "body": "\r\n> By the way, I am wondering whether attribute `SECP256K1_WARN_UNUSED_RESULT` should be added to function `secp256k1_ecdsa_sign`: as (according to the documentation of this function) the nonce generation function may fail, it seems to be a good idea to force callers to check the value returned by this function. What do you think about this?\r\n\r\nThe default nonce generation function will fail only with astronomically low probability. So if you know that you have a valid secret key and you use the default nonce function (99% of the use cases), it's okay not to check the return value.\r\n\r\nHaving said that, I think we're not entirely consistent here... For example, the same argument would apply to `secp256k1_ec_seckey_verify` (https://github.com/bitcoin-core/secp256k1/blob/master/include/secp256k1.h#L632). Even `secp256k1_ec_pubkey_negate` \r\nhttps://github.com/bitcoin-core/secp256k1/blob/master/include/secp256k1.h#L650 has  `SECP256K1_WARN_UNUSED_RESULT` even if it's guaranteed to return 1 according to the docs...\r\n\r\nMaybe we should have a look at this in https://github.com/bitcoin-core/secp256k1/pull/783 or in a follow up PR.\r\n\r\n_Originally posted by @real-or-random in https://github.com/bitcoin-core/secp256k1/issues/960#issuecomment-873285651_\r\n\r\nSo I wonder what our (unwritten) policy for `SECP256K1_WARN_UNUSED_RESULT` should be. I think we're overdoing it in the two mentioned cases but I'm happy to hear other opinions.",
    "user": {
      "login": "real-or-random",
      "id": 1071625,
      "node_id": "MDQ6VXNlcjEwNzE2MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/real-or-random",
      "html_url": "https://github.com/real-or-random",
      "followers_url": "https://api.github.com/users/real-or-random/followers",
      "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
      "organizations_url": "https://api.github.com/users/real-or-random/orgs",
      "repos_url": "https://api.github.com/users/real-or-random/repos",
      "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/real-or-random/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [],
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "locked": false,
    "comments": 2,
    "created_at": "2021-07-03T09:25:13Z",
    "updated_at": "2024-10-07T14:56:29Z"
  },
  "events": [
    {
      "event": "mentioned",
      "id": 4974022187,
      "node_id": "MDE0Ok1lbnRpb25lZEV2ZW50NDk3NDAyMjE4Nw==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/4974022187",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-03T09:25:13Z"
    },
    {
      "event": "subscribed",
      "id": 4974022188,
      "node_id": "MDE1OlN1YnNjcmliZWRFdmVudDQ5NzQwMjIxODg=",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/4974022188",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-03T09:25:13Z"
    },
    {
      "event": "commented",
      "id": 874551212,
      "node_id": "MDEyOklzc3VlQ29tbWVudDg3NDU1MTIxMg==",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/874551212",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-07-06T08:05:44Z",
      "updated_at": "2021-07-06T08:05:44Z",
      "author_association": "CONTRIBUTOR",
      "body": "> > The default nonce generation function will fail only with astronomically low probability\r\n> \r\n> I don't get this. ecdsa_sign will retry the nonce function if it fails. The failure case for ecdsa_sign is when the secret is invalid, e.g. an attacker has convinced you to tweak your key in various ways that result in invalid private keys.\r\n\r\nOk, I was wrong. The correct statement is that the default nonce generation will never fail.\r\necdsa_sign fails if \"the nonce generation function failed, or the secret key was invalid.\"\r\n\r\nDo you have an opinion about `SECP256K1_WARN_UNUSED_RESULT`?",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/961#issuecomment-874551212",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/961"
    },
    {
      "event": "commented",
      "id": 2397166587,
      "node_id": "IC_kwDOAP4Jqs6O4dv7",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/comments/2397166587",
      "actor": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-07T14:56:28Z",
      "updated_at": "2024-10-07T14:56:28Z",
      "author_association": "CONTRIBUTOR",
      "body": ">> are there any musig API functions where the SECP256K1_WARN_UNUSED_RESULT attribute should be added?\r\n>\r\n>That's a good point. I couldn't discover a consistent pattern we're currently following (e.g, `secp256k1_ec_pubkey_parse` has the warning, `secp256k1_tagged_sha256` has the warning even though it always returns 1, and `signature_parse_der`, `signature_parse_compact` don't). I think this should be made more consistent treewide with a note to CONTRIBUTING.md.\r\n>\r\n>There are different rules we could follow:\r\n>1. Just add the warning basically everywhere. Maybe that could be annoying sometimes if the user has data from a trusted source.\r\n>2. Add it to functions returning a boolean result that would be pointless to call without checking for the result (e.g., verify).\r\n>3. Add to all functions that can fail without calling a callback (e.g. they can fail because they are receiving data from untrusted sources -- at least in normal scenarios).\r\n>4. Add it to all functions you need to call before verify to make sure that verify doesn't succeed due to invalid values. However, this would be defense-in-depth because it shouldn't happen anyway.\r\n>5. Add it to all functions that operate on a seckey and produce a public output (e.g. sign) and all the functions the user needs to call before. This prevents that an invalid output (e.g., signature) accidentally leaks information about the seckey. However, users should already be protected from this because we zeroize the outputs if these functions fail.\r\n>6. Add it to functions which sound particularly scary (nonce generation).\r\n>\r\n>I added it to a few more functions (following basically rules 2, 3, 4, 6), because removing the warning is backwards compatible.\r\n\r\n_Originally posted by @jonasnick in https://github.com/bitcoin-core/secp256k1/issues/1479#issuecomment-2396288010_\r\n            ",
      "user": {
        "login": "real-or-random",
        "id": 1071625,
        "node_id": "MDQ6VXNlcjEwNzE2MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1071625?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/real-or-random",
        "html_url": "https://github.com/real-or-random",
        "followers_url": "https://api.github.com/users/real-or-random/followers",
        "following_url": "https://api.github.com/users/real-or-random/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/real-or-random/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/real-or-random/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/real-or-random/subscriptions",
        "organizations_url": "https://api.github.com/users/real-or-random/orgs",
        "repos_url": "https://api.github.com/users/real-or-random/repos",
        "events_url": "https://api.github.com/users/real-or-random/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/real-or-random/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/secp256k1/issues/961#issuecomment-2397166587",
      "issue_url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/961"
    },
    {
      "event": "mentioned",
      "id": 14542259734,
      "node_id": "MEE_lADOAP4Jqs43zYBzzwAAAANiyUYW",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/14542259734",
      "actor": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-07T14:56:29Z"
    },
    {
      "event": "subscribed",
      "id": 14542259747,
      "node_id": "SE_lADOAP4Jqs43zYBzzwAAAANiyUYj",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/14542259747",
      "actor": {
        "login": "jonasnick",
        "id": 2582071,
        "node_id": "MDQ6VXNlcjI1ODIwNzE=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jonasnick",
        "html_url": "https://github.com/jonasnick",
        "followers_url": "https://api.github.com/users/jonasnick/followers",
        "following_url": "https://api.github.com/users/jonasnick/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jonasnick/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jonasnick/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
        "organizations_url": "https://api.github.com/users/jonasnick/orgs",
        "repos_url": "https://api.github.com/users/jonasnick/repos",
        "events_url": "https://api.github.com/users/jonasnick/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jonasnick/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-07T14:56:29Z"
    },
    {
      "event": "unsubscribed",
      "id": 14542325603,
      "node_id": "UE_lADOAP4Jqs43zYBzzwAAAANiykdj",
      "url": "https://api.github.com/repos/bitcoin-core/secp256k1/issues/events/14542325603",
      "actor": {
        "login": "romanz",
        "id": 9900,
        "node_id": "MDQ6VXNlcjk5MDA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9900?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/romanz",
        "html_url": "https://github.com/romanz",
        "followers_url": "https://api.github.com/users/romanz/followers",
        "following_url": "https://api.github.com/users/romanz/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/romanz/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/romanz/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/romanz/subscriptions",
        "organizations_url": "https://api.github.com/users/romanz/orgs",
        "repos_url": "https://api.github.com/users/romanz/repos",
        "events_url": "https://api.github.com/users/romanz/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/romanz/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-10-07T14:59:56Z"
    }
  ]
}